"use strict";(self["webpackChunkpavel_betiu_portfolio"]=self["webpackChunkpavel_betiu_portfolio"]||[]).push([[18],{56612:function(e,t,s){s.d(t,{b:function(){return l}});var a=s(82482),i=s(44161);class l{constructor(){(0,a.Z)(this,"tpred",[{task:"c1",result:'{"l1":0.25, "l2": 0.75}'},{task:"c2",result:'{"l1":0.6, "l2": 0.4}'},{task:"c3",result:"0.74"}]),(0,a.Z)(this,"tpred2",[{task:"c1",result:"0.74"},{task:"c2",result:"0.26"}])}async getAllModels(){return await i.Z.post("pipeline/models")}async textPredict(e,t){return await i.Z.post(`pipeline/models/${e}/predict`,{text:t})}async submitCSV(e,t){const s=new FormData;return s.append("csvfile",t),await i.Z.post(`pipeline/models/${e}/predict`,s)}async downloadFeatures(e){return await i.Z.post(`pipeline/models/${e}/features`,{},{responseType:"blob"})}async dummyTextPredict(e,t){return new Promise((e=>setTimeout((()=>e(this.tpred)),1573)))}}},85365:function(e,t,s){s.d(t,{V:function(){return i},m:function(){return l}});s(70560);function a(e){return Number.isInteger(e)?e.toString():e<.001?e.toExponential(3):e.toFixed(3)}function i(e,t){const s={columns:[{key:"model_id",displayName:"ID"},{key:"model_dataset",displayName:"Dataset"},{key:"model_task_type",displayName:"Task type"},{key:"model_params",displayName:"Parameters"},{key:"model_metrics",displayName:"Metrics/Performance"},{key:"model_action",displayName:"Actions"}],rows:[]};for(const i of e){if("TRANSFORMER"===i["type"]){for(const e of Object.keys(i["params"]))"number"==typeof i["params"][e]&&(i["params"][e]=a(i["params"][e]));for(const e of Object.keys(i["metrics"]))"number"==typeof i["metrics"][e]&&(i["metrics"][e]=a(i["metrics"][e]))}if("XGBOOST"===i["type"]){for(const e of i["params"])for(const t of Object.keys(e))"number"==typeof e[t]&&(e[t]=a(e[t]));for(const e of i["metrics"])for(const t of Object.keys(e))"number"==typeof e[t]&&(e[t]=a(e[t]))}const e={};e["model_id"]=i["id"],e["model_params"]=i["params"],e["model_dataset"]=i["dataset"],e["model_task_type"]=i["type"],e["model_metrics"]=i["metrics"],e["model_action"]=t,s.rows.push(e)}return s}function l(e){const t={columns:[{key:"task",displayName:"Task"},{key:"result",displayName:"Result"}],rows:[]};for(const s of e){const e={};e["task"]=s["task"];const a=JSON.parse(s["result"]);let i={};if(Object.keys(a).length>0){let e=null;for(const t of Object.keys(JSON.parse(s["result"])))(null==e||i[e]<a[t])&&(e=t),i[t]=a[t];i["maxKey"]=e}else i=a;e["result"]=i,t.rows.push(e)}return t}},86041:function(e,t,s){s.d(t,{Z:function(){return d}});var a={};s.r(a);var i=s(73396);function l(e,t,s,a,l,o){const r=(0,i.up)("p-column"),n=(0,i.up)("p-datatable");return(0,i.wg)(),(0,i.j4)(n,{value:s.data.rows,responsiveLayout:s.isScrollable?"scroll":"",scrollable:s.isScrollable,scrollHeight:s.setScrollHeight,stripedRows:!0},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.data.columns,(t=>((0,i.wg)(),(0,i.j4)(r,{field:t.key,header:t.displayName,key:t.key,sortable:s.isSortable},(0,i.Nv)({_:2},[s.withCustomBody?{name:"body",fn:(0,i.w5)((({data:s})=>[(0,i.WI)(e.$slots,"column",{rowData:s,currentColumnData:t})])),key:"0"}:void 0]),1032,["field","header","sortable"])))),128))])),_:3},8,["value","responsiveLayout","scrollable","scrollHeight"])}var o={props:{data:a.TableInput,isScrollable:{type:Boolean,default:!0,required:!1},isSortable:{type:Boolean,default:!0,required:!1},withCustomBody:{type:Boolean,default:!1,required:!1},setScrollHeight:{type:String,default:"750px",required:!1}},data(){return{}}},r=s(40089);const n=(0,r.Z)(o,[["render",l]]);var d=n},38018:function(e,t,s){s.r(t),s.d(t,{default:function(){return V}});var a=s(73396),i=s(87139);const l={class:"container px-2 py-8"},o={key:0,class:"badge rounded-pill bg-primary"},r={class:"card shadow-lg p-2"},n={key:0,class:"d-flex flex-column justify-content-between align-items-center"},d={class:"d-flex h-100 w-100 flex-row justify-content-between align-items-center"},c=["onClick"],u=["onClick"],m={key:1},y={id:"model-params-list",class:"overflow-auto"},p={key:0,class:"list-group"},f={id:"param-key"},b={id:"param-value",class:"badge rounded-pill bg-secondary"},w={key:1,class:"list-group"},k={id:"param-key"},h={key:0,id:"param-value",class:"badge rounded-pill bg-secondary"},g={key:1,id:"param-value",class:"badge rounded-pill bg-secondary"},_={key:2,id:"param-value",class:"badge rounded-pill bg-secondary"},v={key:2},D={id:"model-metrics-list",class:"overflow-auto"},S={key:0,class:"list-group"},O={id:"metric-key"},j={id:"metric-value",class:"badge rounded-pill bg-secondary"},C={key:1,class:"list-group"},N={id:"metric-key"},B={id:"metric-value",class:"badge rounded-pill bg-secondary"},x={key:3},z={style:{"font-size":"0.9rem"}},$={key:4},q={style:{"font-size":"0.9rem"}},I={key:5},T={style:{"font-size":"0.9rem"}},R={key:1,class:"d-flex justify-content-center align-items-center"};function J(e,t,s,J,M,H){const F=(0,a.up)("Table"),E=(0,a.up)("p-progress-spinner");return(0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(e.$style["body"])},[(0,a._)("div",l,[H.filteredByDataset||H.filteredByJobId?((0,a.wg)(),(0,a.iD)("label",o,(0,i.zw)(H.filteredBy()),1)):(0,a.kq)("",!0),(0,a._)("div",r,[null!==M.tableContent?((0,a.wg)(),(0,a.j4)(F,{key:0,data:H.tableData,isScrollable:!1,withCustomBody:!0},{column:(0,a.w5)((({rowData:e,currentColumnData:t})=>["model_action"==t.key?((0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.model_action,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t.name},[(0,a._)("button",{id:"model-action-button",style:(0,i.j5)(t.name?"width: 120%":""),class:(0,i.C_)("btn btn-sm "+t.styleClass),onClick:s=>t.action(e.model_id)},(0,i.zw)(t.name),15,c)])))),128))]),"XGBOOST"==e.model_task_type?((0,a.wg)(),(0,a.iD)("button",{key:0,id:"model-action-button",style:{width:"100%"},class:"btn btn-sm btn-light",onClick:t=>H.downloadFeatures(e.model_id)},"Download features",8,u)):(0,a.kq)("",!0)])):"model_params"==t.key?((0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("div",y,["XGBOOST"==e.model_task_type?((0,a.wg)(),(0,a.iD)("ul",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.model_params.entries(),(([e,t])=>((0,a.wg)(),(0,a.iD)("li",{key:e,class:"list-group-item d-flex flex-column justify-content-center align-items-center"},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Object.keys(t),(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"d-flex w-100 justify-content-between align-items-center"},[(0,a._)("h6",f,(0,i.zw)(e),1),(0,a._)("span",b,(0,i.zw)(t[e]),1)])))),128))])))),128))])):"TRANSFORMER"==e.model_task_type?((0,a.wg)(),(0,a.iD)("ul",w,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Object.keys(e.model_params),(t=>((0,a.wg)(),(0,a.iD)("li",{key:t,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,a._)("h6",k,(0,i.zw)(t),1),"features"===t&&JSON.parse(!1===e.model_params[t].use)?((0,a.wg)(),(0,a.iD)("span",h,"NO")):"features"===t&&JSON.parse(!0===e.model_params[t].use)?((0,a.wg)(),(0,a.iD)("span",g,(0,i.zw)(Object.keys(e.model_params[t])[1])+": "+(0,i.zw)(e.model_params[t][Object.keys(e.model_params[t])[1]]),1)):((0,a.wg)(),(0,a.iD)("span",_,(0,i.zw)(e.model_params[t]),1))])))),128))])):(0,a.kq)("",!0)])])):"model_metrics"==t.key?((0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("div",D,["XGBOOST"==e.model_task_type?((0,a.wg)(),(0,a.iD)("ul",S,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.model_metrics.entries(),(([e,t])=>((0,a.wg)(),(0,a.iD)("li",{key:e,class:"list-group-item d-flex flex-column justify-content-center align-items-center"},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Object.keys(t),(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"d-flex w-100 justify-content-between align-items-center"},[(0,a._)("h6",O,(0,i.zw)(e),1),(0,a._)("span",j,(0,i.zw)(t[e]),1)])))),128))])))),128))])):"TRANSFORMER"==e.model_task_type?((0,a.wg)(),(0,a.iD)("ul",C,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Object.keys(e.model_metrics),(t=>((0,a.wg)(),(0,a.iD)("li",{key:t,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,a._)("h6",N,(0,i.zw)(t),1),(0,a._)("span",B,(0,i.zw)(e.model_metrics[t]),1)])))),128))])):(0,a.kq)("",!0)])])):"model_id"==t.key?((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("h6",z,(0,i.zw)(e.model_id),1)])):"model_task_type"==t.key?((0,a.wg)(),(0,a.iD)("div",$,[(0,a._)("h6",q,(0,i.zw)(e.model_task_type),1)])):"model_dataset"==t.key?((0,a.wg)(),(0,a.iD)("div",I,[(0,a._)("h6",T,(0,i.zw)(e.model_dataset),1)])):(0,a.kq)("",!0)])),_:1},8,["data"])):((0,a.wg)(),(0,a.iD)("div",R,[(0,a.Wm)(E)]))])])],2)}s(13429),s(70560),s(98858),s(61318),s(33228);var M=s(86041),H=s(19223),F=(s(95144),s(85365)),E=s(56612),Z=s(37263),K={name:"ModelsView",data(){return{toastService:(0,a.f3)(Z.F),datasetService:null,modelService:null,datasetsInfo:[],tableContent:null,actions:[{name:"Predict",styleClass:"btn-primary",action:e=>{let t=this.tableContent.filter((t=>t["id"]===e))[0],s=JSON.stringify(t),a=btoa(s);this.$router.push({path:`/models/${e}/prediction`,query:{data:a}})}},{styleClass:"btn-outline-danger btn-circle pi pi-trash",action:e=>{this.info("NOT IMPLEMENTED",`Delete action for id: ${e}`)}}]}},components:{Table:M.Z},created(){this.datasetService=(0,a.f3)(H.M),this.modelService=new E.b,this.initialize()},computed:{tableData:{get(){return(0,F.V)(this.tableContent,this.actions)}},filteredByDataset:{get(){return!(!this.$route.query["filterBy"]||!this.$route.query["datasetId"]||"dataset_id"!==this.$route.query["filterBy"])}},filteredByJobId:{get(){return!(!this.$route.query["filterBy"]||!this.$route.query["jobId"]||"job_id"!==this.$route.query["filterBy"])}}},methods:{initialize(){let e=null;this.filteredByDataset&&(e=Number(this.$route.query["datasetId"]));let t=null;this.filteredByJobId&&(t=Number(this.$route.query["jobId"])),this.datasetService.getDatasets().then((s=>{let a=s["datasets"];a=a.map((e=>({id:e["id"],name:e["name"]}))),this.datasetsInfo=a,this.modelService.getAllModels().then((s=>{let a=s.data;if(1==this.filteredByDataset){const t=this.datasetsInfo.filter((t=>t["id"]===e))[0]["name"];a=a.filter((e=>e["dataset"]===t))}1==this.filteredByJobId&&(a=a.filter((e=>e["job_id"]===t))),this.tableContent=JSON.parse(JSON.stringify(a));for(let e=0;e<this.tableContent.length;e++)this.tableContent[e]["metrics"]=JSON.parse(this.tableContent[e]["metrics"]),this.tableContent[e]["params"]=JSON.parse(this.tableContent[e]["params"])})).catch((e=>{this.error("Error")}))})).catch((e=>this.error("Error",e)))},downloadFeatures(e){this.modelService.downloadFeatures(e).then((e=>{console.log(e);let t=new Blob([e.data],{type:"application/vnd.ms-excel"});this.saveAs(t,"Feature importance.xlsx")}))},saveAs(e,t){const s=window.URL.createObjectURL(e),a=document.createElement("a");a.style.display="none",a.href=s,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a)},filteredBy(){return this.filteredByDataset?`dataset_id = ${this.$route.query["datasetId"]}`:this.filteredByJobId?`job_id = ${this.$route.query["jobId"]}`:null},success(e,t){this.toastService&&this.toastService.success(t,e)},info(e,t){this.toastService&&this.toastService.info(t,e)},error(e,t){this.toastService&&this.toastService.error(t,e,-1)}},watch:{"$route.query":function(e,t){this.initialize()}}},A={body:"ModelsView_body_h2uzn",container:"ModelsView_container_xiQP2"},P=s(40089);const Y={};Y["$style"]=A;const L=(0,P.Z)(K,[["render",J],["__cssModules",Y],["__scopeId","data-v-4ba9d85e"]]);var V=L}}]);