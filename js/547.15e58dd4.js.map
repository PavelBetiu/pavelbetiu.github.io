{"version":3,"file":"js/547.15e58dd4.js","mappings":"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V,GAAO,OAAOA,EAAIlrB,KAAI,SAAS3C,GAAK,MAAO,CAAEA,GAAG,GAAI,IAAKA,GAAG,EAAG,IAAM,IAAFA,EAAQ,GAAI,CAI/F,IAAI0jC,GAAWD,GAAO,CAErB,EACA,SACA,SACA,MACA,IACA,SACA,SACA,MAGA,EACA,SACA,SACA,MACA,IACA,SACA,SACA,MAEA,QACA,MACA,IACA,QACA,QACA,MACA,SACA,QACA,SACA,SACA,SACA,SACA,QACA,SACA,MACA,SAEA,IACA,SACA,SACA,MACA,QACA,QACA,MACA,IACA,MACA,SACA,SACA,SACA,SACA,SACA,SACA,SAEA,QACA,QACA,SACA,SACA,SACA,SACA,QACA,QACA,MACA,QACA,MACA,QACA,SACA,SACA,QACA,QAGA,EACA,SACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,IAEG7C,GAAS5S,GAAI0V,IAGbxH,GAAO,CACX,EAAM,SACN,EAAM,UACN,GAAM,UACN,GAAM,QACN,GAAM,SACN,GAAM,QACN,GAAM,OACN,GAAM,gBACN,IAAM,SAGFyH,GAAQ,CACX,SAAiB,EACjB,UAAiB,EACjB,UAAiB,GACjB,QAAiB,GACjB,SAAiB,GACjB,QAAiB,GACjB,OAAiB,GACjB,gBAAiB,GACjB,QAAiB,KAGdC,GAAgB,CACnB,yBACA,kBACA,mBACA,gBACA,iBACA,iBACA,mBACA,qBACA,iBACA,kBACA,sBACA,wBACA,oBACA,yBAOGC,GAAgC,CAEnC,6EAA8E,YAC9E,uDAAwD,YACxD,0DAA2D,YAC3D,uDAAwD,YACxD,gFAAiF,YAGjF,4EAA6E,SAC7E,qCAAsC,SACtC,sCAAuC,OAGvC,6EAA8E,SAC9E,sCAAuC,SAGvC,0CAA2C,SAC3C,sCAAuC,SACvC,0CAA2C,OAC3C,sCAAuC,OAGvC,8EAA+E,UAC/E,uCAAwC,UAGxC,gFAAiF,OACjF,yCAA0C,OAG1C,yEAA0E,SAC1E,kCAAmC,SAGnC,6DAA8D,YAC9D,sEAAuE,YACvE,wEAAyE,WAGzE,wEAAyE,OAC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IAAK,gBACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,MACL,IAAK,cACL,IAAK,iBACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,eACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,kBACL,IAAK,YACL,IAAK,iBACL,IAAK,cACL,IAAK,eACL,IAAK,eACL,IAAK,YACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,gBACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,gBACL,IAAK,YACL,IAAK,aACL,IAAK,UACL,IAAK,OACL,IAAK,cACL,IAAK,UACL,IAAK,YACL,IAAK,iBACL,IAAK,cACL,IAAK,oBACL,IAAK,gBACL,IAAK,eACL,IAAK,iBACL,IAAK,kBACL,IAAK,cACL,IAAK,qBACL,IAAK,SACL,IAAK,cACL,IAAK,WACL,IAAK,WACL,IAAK,eACL,IAAK,eACL,IAAK,iBACL,IAAK,eACL,IAAK,kBACL,IAAK,qBACL,IAAK,aACL,IAAK,YACL,IAAK,YACL,IAAK,gBACL,IAAK,cACL,IAAK,eACL,IAAK,kBACL,IAAK,oBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,cACL,IAAK,UACL,IAAK,SACL,IAAK,cACL,IAAK,UACL,IAAK,oBACL,IAAK,kBACL,IAAK,QACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,eACL,IAAK,aACL,IAAK,eACL,IAAK,gBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,iBACL,IAAK,YACL,IAAK,cACL,IAAK,eACL,IAAK,aACL,IAAK,aACL,IAAK,gBACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,qBACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,kBACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,cACL,IAAK,iBACL,IAAK,qBACL,IAAK,YACL,IAAK,oBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,WACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,eACL,IAAK,cACL,IAAK,YACL,IAAK,kBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,aACL,IAAK,oBACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,mBACL,IAAK,qBACL,IAAK,yBACL,IAAK,cACL,IAAK,aACL,IAAK,mBACL,IAAK,sBACL,IAAK,eACL,IAAK,eACL,IAAK,gBACL,IAAK,cACL,IAAK,kBACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,2BACL,IAAK,eACL,IAAK,iBACL,IAAK,aACL,IAAK,iBACL,IAAK,YACL,IAAK,mBACL,IAAK,cACL,IAAK,wBACL,IAAK,kBACL,IAAK,qBACL,IAAK,kBACL,IAAK,kBACL,IAAK,kBACL,IAAK,qBACL,IAAK,aACL,IAAK,iBACL,IAAK,eACL,IAAK,mBACL,IAAK,aACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,iBACL,IAAK,uBACL,IAAK,0BACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,cACL,IAAK,aACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,cACL,IAAK,mBACL,IAAK,uBACL,IAAK,mBACL,IAAK,kBACL,IAAK,mBACL,IAAK,cACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,eACL,IAAK,oBACL,IAAK,sBACL,IAAK,sBACL,IAAK,mBACL,IAAK,qBACL,IAAK,qBACL,IAAK,gBACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,gBACL,IAAK,wBACL,IAAK,qBACL,I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L,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,WACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,aACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,OACL,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,SACL,IAAK,aACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,WACL,IAAK,OACL,IAAK,QACL,IAAK,aACL,IAAK,KACL,IAAK,QACL,IAAK,SACL,IAAK,YACL,IAAK,cACL,IAAK,iBACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,cACL,IAAK,WACL,IAAK,iBACL,IAAK,aACL,IAAK,YACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,aACL,IAAK,cACL,IAAK,eACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,SACL,IAAK,SACL,IAAK,aACL,IAAK,YACL,IAAK,OACL,IAAK,YACL,IAAK,QACL,IAAK,OACL,IAAK,SACL,IAAK,YACL,IAAK,QACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,cACL,IAAK,SACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,MACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,QACL,IAAK,WACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,OACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,YACL,IAAK,cACL,IAAK,QACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,oBACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,QACL,IAAK,cACL,IAAK,cACL,IAAK,WACL,IAAK,eACL,IAAK,YACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,YACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,cACL,IAAK,WACL,IAAK,MACL,IAAK,YACL,IAAK,aACL,IAAK,qBACL,IAAK,mBACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,aACL,IAAK,cACL,IAAK,YACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,SACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,OACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,WACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,aACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,cACL,IAAK,UACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,MACL,IAAK,cACL,IAAK,MACL,IAAK,aACL,IAAK,gBACL,IAAK,UACL,IAAK,eACL,IAAK,UACL,IAAK,WACL,IAAK,SACL,IAAK,YACL,IAAK,cAEHD,GAAW,CACb,EAAG,EACH,EAAG,EACH,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,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","sources":["webpack://pavel-betiu-portfolio/./node_modules/@e965/xlsx/dist/cpexcel.js","webpack://pavel-betiu-portfolio/./node_modules/@e965/xlsx/xlsx.js","webpack://pavel-betiu-portfolio/./node_modules/assertion-error/index.js","webpack://pavel-betiu-portfolio/./node_modules/chai/index.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/assertion.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/config.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/core/assertions.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/interface/assert.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/interface/expect.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/interface/should.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/addChainableMethod.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/addLengthGuard.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/addMethod.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/addProperty.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/compareByInspect.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/expectTypes.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/flag.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/getActual.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/getMessage.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/getOperator.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/getOwnEnumerableProperties.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/getOwnEnumerablePropertySymbols.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/getProperties.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/index.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/inspect.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/isNaN.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/isProxyEnabled.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/objDisplay.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/overwriteChainableMethod.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/overwriteMethod.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/overwriteProperty.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/proxify.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/test.js","webpack://pavel-betiu-portfolio/./node_modules/chai/lib/chai/utils/transferFlags.js","webpack://pavel-betiu-portfolio/./node_modules/check-error/index.js","webpack://pavel-betiu-portfolio/./node_modules/deep-eql/index.js","webpack://pavel-betiu-portfolio/./node_modules/get-func-name/index.js","webpack://pavel-betiu-portfolio/./node_modules/loupe/loupe.js","webpack://pavel-betiu-portfolio/./node_modules/pathval/index.js","webpack://pavel-betiu-portfolio/./node_modules/type-detect/type-detect.js","webpack://pavel-betiu-portfolio/./src/components/qgen/GenerateQuestions.vue","webpack://pavel-betiu-portfolio/./src/components/qgen/WizardTab.vue","webpack://pavel-betiu-portfolio/./src/components/qgen/WizardTab.vue?d675","webpack://pavel-betiu-portfolio/./src/components/qgen/Wizard.vue","webpack://pavel-betiu-portfolio/./src/util/throttle.js","webpack://pavel-betiu-portfolio/./src/components/qgen/Wizard.vue?47b5","webpack://pavel-betiu-portfolio/./node_modules/chai/index.mjs","webpack://pavel-betiu-portfolio/./src/components/qgen/qgen-converters.ts","webpack://pavel-betiu-portfolio/./src/util/excel-utils.ts","webpack://pavel-betiu-portfolio/./src/components/qgen/GenerateQuestions.vue?27ba","webpack://pavel-betiu-portfolio/./src/components/widgets/Table.vue","webpack://pavel-betiu-portfolio/./src/components/widgets/Table.vue?67eb","webpack://pavel-betiu-portfolio/./node_modules/json-as-xlsx/dist/index.js"],"sourcesContent":["/*! cpexcel.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/*jshint -W100 */\nvar cptable = {version:\"1.15.0\"};\ncptable[437] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[620] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[737] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[850] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[852] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[857] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[861] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[865] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[866] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[874] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[895] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[932] = (function(){ var d = [], e = {}, D = [], j;\nD[0] = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");\nfor(j = 0; j != D[0].length; ++j) if(D[0][j].charCodeAt(0) !== 0xFFFD) { e[D[0][j]] = 0 + j; d[0 + j] = D[0][j];}\nD[129] = \"\".split(\"\");\nfor(j = 0; j != D[129].length; ++j) if(D[129][j].charCodeAt(0) !== 0xFFFD) { e[D[129][j]] = 33024 + j; d[33024 + j] = D[129][j];}\nD[130] = \"\".split(\"\");\nfor(j = 0; j != D[130].length; ++j) if(D[130][j].charCodeAt(0) !== 0xFFFD) { e[D[130][j]] = 33280 + j; d[33280 + j] = D[130][j];}\nD[131] = \"\".split(\"\");\nfor(j = 0; j != D[131].length; ++j) if(D[131][j].charCodeAt(0) !== 0xFFFD) { e[D[131][j]] = 33536 + j; d[33536 + j] = D[131][j];}\nD[132] = \"\".split(\"\");\nfor(j = 0; j != D[132].length; ++j) if(D[132][j].charCodeAt(0) !== 0xFFFD) { e[D[132][j]] = 33792 + j; d[33792 + j] = D[132][j];}\nD[135] = \"\".split(\"\");\nfor(j = 0; j != D[135].length; ++j) if(D[135][j].charCodeAt(0) !== 0xFFFD) { e[D[135][j]] = 34560 + j; d[34560 + j] = D[135][j];}\nD[136] = \"\".split(\"\");\nfor(j = 0; j != D[136].length; ++j) if(D[136][j].charCodeAt(0) !== 0xFFFD) { e[D[136][j]] = 34816 + j; d[34816 + j] = D[136][j];}\nD[137] = \"\".split(\"\");\nfor(j = 0; j != D[137].length; ++j) if(D[137][j].charCodeAt(0) !== 0xFFFD) { e[D[137][j]] = 35072 + j; d[35072 + j] = D[137][j];}\nD[138] = \"\".split(\"\");\nfor(j = 0; j != D[138].length; ++j) if(D[138][j].charCodeAt(0) !== 0xFFFD) { e[D[138][j]] = 35328 + j; d[35328 + j] = D[138][j];}\nD[139] = \"\".split(\"\");\nfor(j = 0; j != D[139].length; ++j) if(D[139][j].charCodeAt(0) !== 0xFFFD) { e[D[139][j]] = 35584 + j; d[35584 + j] = D[139][j];}\nD[140] = \"\".split(\"\");\nfor(j = 0; j != D[140].length; ++j) if(D[140][j].charCodeAt(0) !== 0xFFFD) { e[D[140][j]] = 35840 + j; d[35840 + j] = D[140][j];}\nD[141] = \"\".split(\"\");\nfor(j = 0; j != D[141].length; ++j) if(D[141][j].charCodeAt(0) !== 0xFFFD) { e[D[141][j]] = 36096 + j; d[36096 + j] = D[141][j];}\nD[142] = \"\".split(\"\");\nfor(j = 0; j != D[142].length; ++j) if(D[142][j].charCodeAt(0) !== 0xFFFD) { e[D[142][j]] = 36352 + j; d[36352 + j] = D[142][j];}\nD[143] = \"\".split(\"\");\nfor(j = 0; j != D[143].length; ++j) if(D[143][j].charCodeAt(0) !== 0xFFFD) { e[D[143][j]] = 36608 + j; d[36608 + j] = D[143][j];}\nD[144] = \"\".split(\"\");\nfor(j = 0; j != D[144].length; ++j) if(D[144][j].charCodeAt(0) !== 0xFFFD) { e[D[144][j]] = 36864 + j; d[36864 + j] = D[144][j];}\nD[145] = \"\".split(\"\");\nfor(j = 0; j != D[145].length; ++j) if(D[145][j].charCodeAt(0) !== 0xFFFD) { e[D[145][j]] = 37120 + j; d[37120 + j] = D[145][j];}\nD[146] = \"\".split(\"\");\nfor(j = 0; j != D[146].length; ++j) if(D[146][j].charCodeAt(0) !== 0xFFFD) { e[D[146][j]] = 37376 + j; d[37376 + j] = D[146][j];}\nD[147] = \"\".split(\"\");\nfor(j = 0; j != D[147].length; ++j) if(D[147][j].charCodeAt(0) !== 0xFFFD) { e[D[147][j]] = 37632 + j; d[37632 + j] = D[147][j];}\nD[148] = \"\".split(\"\");\nfor(j = 0; j != D[148].length; ++j) if(D[148][j].charCodeAt(0) !== 0xFFFD) { e[D[148][j]] = 37888 + j; d[37888 + j] = D[148][j];}\nD[149] = \"\".split(\"\");\nfor(j = 0; j != D[149].length; ++j) if(D[149][j].charCodeAt(0) !== 0xFFFD) { e[D[149][j]] = 38144 + j; d[38144 + j] = D[149][j];}\nD[150] = \"\".split(\"\");\nfor(j = 0; j != D[150].length; ++j) if(D[150][j].charCodeAt(0) !== 0xFFFD) { e[D[150][j]] = 38400 + j; d[38400 + j] = D[150][j];}\nD[151] = \"\".split(\"\");\nfor(j = 0; j != D[151].length; ++j) if(D[151][j].charCodeAt(0) !== 0xFFFD) { e[D[151][j]] = 38656 + j; d[38656 + j] = D[151][j];}\nD[152] = \"\".split(\"\");\nfor(j = 0; j != D[152].length; ++j) if(D[152][j].charCodeAt(0) !== 0xFFFD) { e[D[152][j]] = 38912 + j; d[38912 + j] = D[152][j];}\nD[153] = \"\".split(\"\");\nfor(j = 0; j != D[153].length; ++j) if(D[153][j].charCodeAt(0) !== 0xFFFD) { e[D[153][j]] = 39168 + j; d[39168 + j] = D[153][j];}\nD[154] = \"\".split(\"\");\nfor(j = 0; j != D[154].length; ++j) if(D[154][j].charCodeAt(0) !== 0xFFFD) { e[D[154][j]] = 39424 + j; d[39424 + j] = D[154][j];}\nD[155] = \"\".split(\"\");\nfor(j = 0; j != D[155].length; ++j) if(D[155][j].charCodeAt(0) !== 0xFFFD) { e[D[155][j]] = 39680 + j; d[39680 + j] = D[155][j];}\nD[156] = \"\".split(\"\");\nfor(j = 0; j != D[156].length; ++j) if(D[156][j].charCodeAt(0) !== 0xFFFD) { e[D[156][j]] = 39936 + j; d[39936 + j] = D[156][j];}\nD[157] = \"\".split(\"\");\nfor(j = 0; j != D[157].length; ++j) if(D[157][j].charCodeAt(0) !== 0xFFFD) { e[D[157][j]] = 40192 + j; d[40192 + j] = D[157][j];}\nD[158] = \"\".split(\"\");\nfor(j = 0; j != D[158].length; ++j) if(D[158][j].charCodeAt(0) !== 0xFFFD) { e[D[158][j]] = 40448 + j; d[40448 + j] = D[158][j];}\nD[159] = \"\".split(\"\");\nfor(j = 0; j != D[159].length; ++j) if(D[159][j].charCodeAt(0) !== 0xFFFD) { e[D[159][j]] = 40704 + j; d[40704 + j] = D[159][j];}\nD[224] = \"\".split(\"\");\nfor(j = 0; j != D[224].length; ++j) if(D[224][j].charCodeAt(0) !== 0xFFFD) { e[D[224][j]] = 57344 + j; d[57344 + j] = D[224][j];}\nD[225] = \"\".split(\"\");\nfor(j = 0; j != D[225].length; ++j) if(D[225][j].charCodeAt(0) !== 0xFFFD) { e[D[225][j]] = 57600 + j; d[57600 + j] = D[225][j];}\nD[226] = \"\".split(\"\");\nfor(j = 0; j != D[226].length; ++j) if(D[226][j].charCodeAt(0) !== 0xFFFD) { e[D[226][j]] = 57856 + j; d[57856 + j] = D[226][j];}\nD[227] = \"\".split(\"\");\nfor(j = 0; j != D[227].length; ++j) if(D[227][j].charCodeAt(0) !== 0xFFFD) { e[D[227][j]] = 58112 + j; d[58112 + j] = D[227][j];}\nD[228] = \"\".split(\"\");\nfor(j = 0; j != D[228].length; ++j) if(D[228][j].charCodeAt(0) !== 0xFFFD) { e[D[228][j]] = 58368 + j; d[58368 + j] = D[228][j];}\nD[229] = \"\".split(\"\");\nfor(j = 0; j != D[229].length; ++j) if(D[229][j].charCodeAt(0) !== 0xFFFD) { e[D[229][j]] = 58624 + j; d[58624 + j] = D[229][j];}\nD[230] = \"\".split(\"\");\nfor(j = 0; j != D[230].length; ++j) if(D[230][j].charCodeAt(0) !== 0xFFFD) { e[D[230][j]] = 58880 + j; d[58880 + j] = D[230][j];}\nD[231] = \"\".split(\"\");\nfor(j = 0; j != D[231].length; ++j) if(D[231][j].charCodeAt(0) !== 0xFFFD) { e[D[231][j]] = 59136 + j; d[59136 + j] = D[231][j];}\nD[232] = \"\".split(\"\");\nfor(j = 0; j != D[232].length; ++j) if(D[232][j].charCodeAt(0) !== 0xFFFD) { e[D[232][j]] = 59392 + j; d[59392 + j] = D[232][j];}\nD[233] = \"\".split(\"\");\nfor(j = 0; j != D[233].length; ++j) if(D[233][j].charCodeAt(0) !== 0xFFFD) { e[D[233][j]] = 59648 + j; d[59648 + j] = D[233][j];}\nD[234] = \"\".split(\"\");\nfor(j = 0; j != D[234].length; ++j) if(D[234][j].charCodeAt(0) !== 0xFFFD) { e[D[234][j]] = 59904 + j; d[59904 + j] = D[234][j];}\nD[237] = \"\".split(\"\");\nfor(j = 0; j != D[237].length; ++j) if(D[237][j].charCodeAt(0) !== 0xFFFD) { e[D[237][j]] = 60672 + j; d[60672 + j] = D[237][j];}\nD[238] = \"\".split(\"\");\nfor(j = 0; j != D[238].length; ++j) if(D[238][j].charCodeAt(0) !== 0xFFFD) { e[D[238][j]] = 60928 + j; d[60928 + j] = D[238][j];}\nD[250] = \"\".split(\"\");\nfor(j = 0; j != D[250].length; ++j) if(D[250][j].charCodeAt(0) !== 0xFFFD) { e[D[250][j]] = 64000 + j; d[64000 + j] = D[250][j];}\nD[251] = \"\".split(\"\");\nfor(j = 0; j != D[251].length; ++j) if(D[251][j].charCodeAt(0) !== 0xFFFD) { e[D[251][j]] = 64256 + j; d[64256 + j] = D[251][j];}\nD[252] = \"\".split(\"\");\nfor(j = 0; j != D[252].length; ++j) if(D[252][j].charCodeAt(0) !== 0xFFFD) { e[D[252][j]] = 64512 + j; d[64512 + j] = D[252][j];}\nreturn {\"enc\": e, \"dec\": d }; })();\ncptable[936] = (function(){ var d = [], e = {}, D = [], j;\nD[0] = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");\nfor(j = 0; j != D[0].length; ++j) if(D[0][j].charCodeAt(0) !== 0xFFFD) { e[D[0][j]] = 0 + j; d[0 + j] = D[0][j];}\nD[129] = \"\".split(\"\");\nfor(j = 0; j != D[129].length; ++j) if(D[129][j].charCodeAt(0) !== 0xFFFD) { e[D[129][j]] = 33024 + j; d[33024 + j] = D[129][j];}\nD[130] = \"\".split(\"\");\nfor(j = 0; j != D[130].length; ++j) if(D[130][j].charCodeAt(0) !== 0xFFFD) { e[D[130][j]] = 33280 + j; d[33280 + j] = D[130][j];}\nD[131] = \"\".split(\"\");\nfor(j = 0; j != D[131].length; ++j) if(D[131][j].charCodeAt(0) !== 0xFFFD) { e[D[131][j]] = 33536 + j; d[33536 + j] = D[131][j];}\nD[132] = \"\".split(\"\");\nfor(j = 0; j != D[132].length; ++j) if(D[132][j].charCodeAt(0) !== 0xFFFD) { e[D[132][j]] = 33792 + j; d[33792 + j] = D[132][j];}\nD[133] = \"\".split(\"\");\nfor(j = 0; j != D[133].length; ++j) if(D[133][j].charCodeAt(0) !== 0xFFFD) { e[D[133][j]] = 34048 + j; d[34048 + j] = D[133][j];}\nD[134] = \"\".split(\"\");\nfor(j = 0; j != D[134].length; ++j) if(D[134][j].charCodeAt(0) !== 0xFFFD) { e[D[134][j]] = 34304 + j; d[34304 + j] = D[134][j];}\nD[135] = \"\".split(\"\");\nfor(j = 0; j != D[135].length; ++j) if(D[135][j].charCodeAt(0) !== 0xFFFD) { e[D[135][j]] = 34560 + j; d[34560 + j] = D[135][j];}\nD[136] = \"\".split(\"\");\nfor(j = 0; j != D[136].length; ++j) if(D[136][j].charCodeAt(0) !== 0xFFFD) { e[D[136][j]] = 34816 + j; d[34816 + j] = D[136][j];}\nD[137] = \"\".split(\"\");\nfor(j = 0; j != D[137].length; ++j) if(D[137][j].charCodeAt(0) !== 0xFFFD) { e[D[137][j]] = 35072 + j; d[35072 + j] = D[137][j];}\nD[138] = \"\".split(\"\");\nfor(j = 0; j != D[138].length; ++j) if(D[138][j].charCodeAt(0) !== 0xFFFD) { e[D[138][j]] = 35328 + j; d[35328 + j] = D[138][j];}\nD[139] = \"\".split(\"\");\nfor(j = 0; j != D[139].length; ++j) if(D[139][j].charCodeAt(0) !== 0xFFFD) { e[D[139][j]] = 35584 + j; d[35584 + j] = D[139][j];}\nD[140] = \"\".split(\"\");\nfor(j = 0; j != D[140].length; ++j) if(D[140][j].charCodeAt(0) !== 0xFFFD) { e[D[140][j]] = 35840 + j; d[35840 + j] = D[140][j];}\nD[141] = \"\".split(\"\");\nfor(j = 0; j != D[141].length; ++j) if(D[141][j].charCodeAt(0) !== 0xFFFD) { e[D[141][j]] = 36096 + j; d[36096 + j] = D[141][j];}\nD[142] = \"\".split(\"\");\nfor(j = 0; j != D[142].length; ++j) if(D[142][j].charCodeAt(0) !== 0xFFFD) { e[D[142][j]] = 36352 + j; d[36352 + j] = D[142][j];}\nD[143] = \"\".split(\"\");\nfor(j = 0; j != D[143].length; ++j) if(D[143][j].charCodeAt(0) !== 0xFFFD) { e[D[143][j]] = 36608 + j; d[36608 + j] = D[143][j];}\nD[144] = \"\".split(\"\");\nfor(j = 0; j != D[144].length; ++j) if(D[144][j].charCodeAt(0) !== 0xFFFD) { e[D[144][j]] = 36864 + j; d[36864 + j] = D[144][j];}\nD[145] = \"\".split(\"\");\nfor(j = 0; j != D[145].length; ++j) if(D[145][j].charCodeAt(0) !== 0xFFFD) { e[D[145][j]] = 37120 + j; d[37120 + j] = D[145][j];}\nD[146] = \"\".split(\"\");\nfor(j = 0; j != D[146].length; ++j) if(D[146][j].charCodeAt(0) !== 0xFFFD) { e[D[146][j]] = 37376 + j; d[37376 + j] = D[146][j];}\nD[147] = \"\".split(\"\");\nfor(j = 0; j != D[147].length; ++j) if(D[147][j].charCodeAt(0) !== 0xFFFD) { e[D[147][j]] = 37632 + j; d[37632 + j] = D[147][j];}\nD[148] = \"\".split(\"\");\nfor(j = 0; j != D[148].length; ++j) if(D[148][j].charCodeAt(0) !== 0xFFFD) { e[D[148][j]] = 37888 + j; d[37888 + j] = D[148][j];}\nD[149] = \"\".split(\"\");\nfor(j = 0; j != D[149].length; ++j) if(D[149][j].charCodeAt(0) !== 0xFFFD) { e[D[149][j]] = 38144 + j; d[38144 + j] = D[149][j];}\nD[150] = \"\".split(\"\");\nfor(j = 0; j != D[150].length; ++j) if(D[150][j].charCodeAt(0) !== 0xFFFD) { e[D[150][j]] = 38400 + j; d[38400 + j] = D[150][j];}\nD[151] = \"\".split(\"\");\nfor(j = 0; j != D[151].length; ++j) if(D[151][j].charCodeAt(0) !== 0xFFFD) { e[D[151][j]] = 38656 + j; d[38656 + j] = D[151][j];}\nD[152] = \"\".split(\"\");\nfor(j = 0; j != D[152].length; ++j) if(D[152][j].charCodeAt(0) !== 0xFFFD) { e[D[152][j]] = 38912 + j; d[38912 + j] = D[152][j];}\nD[153] = \"\".split(\"\");\nfor(j = 0; j != D[153].length; ++j) if(D[153][j].charCodeAt(0) !== 0xFFFD) { e[D[153][j]] = 39168 + j; d[39168 + j] = D[153][j];}\nD[154] = \"\".split(\"\");\nfor(j = 0; j != D[154].length; ++j) if(D[154][j].charCodeAt(0) !== 0xFFFD) { e[D[154][j]] = 39424 + j; d[39424 + j] = D[154][j];}\nD[155] = \"\".split(\"\");\nfor(j = 0; j != D[155].length; ++j) if(D[155][j].charCodeAt(0) !== 0xFFFD) { e[D[155][j]] = 39680 + j; d[39680 + j] = D[155][j];}\nD[156] = \"\".split(\"\");\nfor(j = 0; j != D[156].length; ++j) if(D[156][j].charCodeAt(0) !== 0xFFFD) { e[D[156][j]] = 39936 + j; d[39936 + j] = D[156][j];}\nD[157] = \"\".split(\"\");\nfor(j = 0; j != D[157].length; ++j) if(D[157][j].charCodeAt(0) !== 0xFFFD) { e[D[157][j]] = 40192 + j; d[40192 + j] = D[157][j];}\nD[158] = \"\".split(\"\");\nfor(j = 0; j != D[158].length; ++j) if(D[158][j].charCodeAt(0) !== 0xFFFD) { e[D[158][j]] = 40448 + j; d[40448 + j] = D[158][j];}\nD[159] = \"\".split(\"\");\nfor(j = 0; j != D[159].length; ++j) if(D[159][j].charCodeAt(0) !== 0xFFFD) { e[D[159][j]] = 40704 + j; d[40704 + j] = D[159][j];}\nD[160] = \"\".split(\"\");\nfor(j = 0; j != D[160].length; ++j) if(D[160][j].charCodeAt(0) !== 0xFFFD) { e[D[160][j]] = 40960 + j; d[40960 + j] = D[160][j];}\nD[161] = \"\".split(\"\");\nfor(j = 0; j != D[161].length; ++j) if(D[161][j].charCodeAt(0) !== 0xFFFD) { e[D[161][j]] = 41216 + j; d[41216 + j] = D[161][j];}\nD[162] = \"\".split(\"\");\nfor(j = 0; j != D[162].length; ++j) if(D[162][j].charCodeAt(0) !== 0xFFFD) { e[D[162][j]] = 41472 + j; d[41472 + j] = D[162][j];}\nD[163] = \"\".split(\"\");\nfor(j = 0; j != D[163].length; ++j) if(D[163][j].charCodeAt(0) !== 0xFFFD) { e[D[163][j]] = 41728 + j; d[41728 + j] = D[163][j];}\nD[164] = \"\".split(\"\");\nfor(j = 0; j != D[164].length; ++j) if(D[164][j].charCodeAt(0) !== 0xFFFD) { e[D[164][j]] = 41984 + j; d[41984 + j] = D[164][j];}\nD[165] = \"\".split(\"\");\nfor(j = 0; j != D[165].length; ++j) if(D[165][j].charCodeAt(0) !== 0xFFFD) { e[D[165][j]] = 42240 + j; d[42240 + j] = D[165][j];}\nD[166] = \"\".split(\"\");\nfor(j = 0; j != D[166].length; ++j) if(D[166][j].charCodeAt(0) !== 0xFFFD) { e[D[166][j]] = 42496 + j; d[42496 + j] = D[166][j];}\nD[167] = \"\".split(\"\");\nfor(j = 0; j != D[167].length; ++j) if(D[167][j].charCodeAt(0) !== 0xFFFD) { e[D[167][j]] = 42752 + j; d[42752 + j] = D[167][j];}\nD[168] = \"\".split(\"\");\nfor(j = 0; j != D[168].length; ++j) if(D[168][j].charCodeAt(0) !== 0xFFFD) { e[D[168][j]] = 43008 + j; d[43008 + j] = D[168][j];}\nD[169] = \"\".split(\"\");\nfor(j = 0; j != D[169].length; ++j) if(D[169][j].charCodeAt(0) !== 0xFFFD) { e[D[169][j]] = 43264 + j; d[43264 + j] = D[169][j];}\nD[170] = \"\".split(\"\");\nfor(j = 0; j != D[170].length; ++j) if(D[170][j].charCodeAt(0) !== 0xFFFD) { e[D[170][j]] = 43520 + j; d[43520 + j] = D[170][j];}\nD[171] = \"\".split(\"\");\nfor(j = 0; j != D[171].length; ++j) if(D[171][j].charCodeAt(0) !== 0xFFFD) { e[D[171][j]] = 43776 + j; d[43776 + j] = D[171][j];}\nD[172] = \"\".split(\"\");\nfor(j = 0; j != D[172].length; ++j) if(D[172][j].charCodeAt(0) !== 0xFFFD) { e[D[172][j]] = 44032 + j; d[44032 + j] = D[172][j];}\nD[173] = \"\".split(\"\");\nfor(j = 0; j != D[173].length; ++j) if(D[173][j].charCodeAt(0) !== 0xFFFD) { e[D[173][j]] = 44288 + j; d[44288 + j] = D[173][j];}\nD[174] = \"\".split(\"\");\nfor(j = 0; j != D[174].length; ++j) if(D[174][j].charCodeAt(0) !== 0xFFFD) { e[D[174][j]] = 44544 + j; d[44544 + j] = D[174][j];}\nD[175] = \"\".split(\"\");\nfor(j = 0; j != D[175].length; ++j) if(D[175][j].charCodeAt(0) !== 0xFFFD) { e[D[175][j]] = 44800 + j; d[44800 + j] = D[175][j];}\nD[176] = \"\".split(\"\");\nfor(j = 0; j != D[176].length; ++j) if(D[176][j].charCodeAt(0) !== 0xFFFD) { e[D[176][j]] = 45056 + j; d[45056 + j] = D[176][j];}\nD[177] = \"\".split(\"\");\nfor(j = 0; j != D[177].length; ++j) if(D[177][j].charCodeAt(0) !== 0xFFFD) { e[D[177][j]] = 45312 + j; d[45312 + j] = D[177][j];}\nD[178] = \"\".split(\"\");\nfor(j = 0; j != D[178].length; ++j) if(D[178][j].charCodeAt(0) !== 0xFFFD) { e[D[178][j]] = 45568 + j; d[45568 + j] = D[178][j];}\nD[179] = \"\".split(\"\");\nfor(j = 0; j != D[179].length; ++j) if(D[179][j].charCodeAt(0) !== 0xFFFD) { e[D[179][j]] = 45824 + j; d[45824 + j] = D[179][j];}\nD[180] = \"\".split(\"\");\nfor(j = 0; j != D[180].length; ++j) if(D[180][j].charCodeAt(0) !== 0xFFFD) { e[D[180][j]] = 46080 + j; d[46080 + j] = D[180][j];}\nD[181] = \"\".split(\"\");\nfor(j = 0; j != D[181].length; ++j) if(D[181][j].charCodeAt(0) !== 0xFFFD) { e[D[181][j]] = 46336 + j; d[46336 + j] = D[181][j];}\nD[182] = \"\".split(\"\");\nfor(j = 0; j != D[182].length; ++j) if(D[182][j].charCodeAt(0) !== 0xFFFD) { e[D[182][j]] = 46592 + j; d[46592 + j] = D[182][j];}\nD[183] = \"\".split(\"\");\nfor(j = 0; j != D[183].length; ++j) if(D[183][j].charCodeAt(0) !== 0xFFFD) { e[D[183][j]] = 46848 + j; d[46848 + j] = D[183][j];}\nD[184] = \"\".split(\"\");\nfor(j = 0; j != D[184].length; ++j) if(D[184][j].charCodeAt(0) !== 0xFFFD) { e[D[184][j]] = 47104 + j; d[47104 + j] = D[184][j];}\nD[185] = \"\".split(\"\");\nfor(j = 0; j != D[185].length; ++j) if(D[185][j].charCodeAt(0) !== 0xFFFD) { e[D[185][j]] = 47360 + j; d[47360 + j] = D[185][j];}\nD[186] = \"\".split(\"\");\nfor(j = 0; j != D[186].length; ++j) if(D[186][j].charCodeAt(0) !== 0xFFFD) { e[D[186][j]] = 47616 + j; d[47616 + j] = D[186][j];}\nD[187] = \"\".split(\"\");\nfor(j = 0; j != D[187].length; ++j) if(D[187][j].charCodeAt(0) !== 0xFFFD) { e[D[187][j]] = 47872 + j; d[47872 + j] = D[187][j];}\nD[188] = \"\".split(\"\");\nfor(j = 0; j != D[188].length; ++j) if(D[188][j].charCodeAt(0) !== 0xFFFD) { e[D[188][j]] = 48128 + j; d[48128 + j] = D[188][j];}\nD[189] = \"\".split(\"\");\nfor(j = 0; j != D[189].length; ++j) if(D[189][j].charCodeAt(0) !== 0xFFFD) { e[D[189][j]] = 48384 + j; d[48384 + j] = D[189][j];}\nD[190] = \"\".split(\"\");\nfor(j = 0; j != D[190].length; ++j) if(D[190][j].charCodeAt(0) !== 0xFFFD) { e[D[190][j]] = 48640 + j; d[48640 + j] = D[190][j];}\nD[191] = \"\".split(\"\");\nfor(j = 0; j != D[191].length; ++j) if(D[191][j].charCodeAt(0) !== 0xFFFD) { e[D[191][j]] = 48896 + j; d[48896 + j] = D[191][j];}\nD[192] = \"\".split(\"\");\nfor(j = 0; j != D[192].length; ++j) if(D[192][j].charCodeAt(0) !== 0xFFFD) { e[D[192][j]] = 49152 + j; d[49152 + j] = D[192][j];}\nD[193] = \"\".split(\"\");\nfor(j = 0; j != D[193].length; ++j) if(D[193][j].charCodeAt(0) !== 0xFFFD) { e[D[193][j]] = 49408 + j; d[49408 + j] = D[193][j];}\nD[194] = \"\".split(\"\");\nfor(j = 0; j != D[194].length; ++j) if(D[194][j].charCodeAt(0) !== 0xFFFD) { e[D[194][j]] = 49664 + j; d[49664 + j] = D[194][j];}\nD[195] = \"\".split(\"\");\nfor(j = 0; j != D[195].length; ++j) if(D[195][j].charCodeAt(0) !== 0xFFFD) { e[D[195][j]] = 49920 + j; d[49920 + j] = D[195][j];}\nD[196] = \"\".split(\"\");\nfor(j = 0; j != D[196].length; ++j) if(D[196][j].charCodeAt(0) !== 0xFFFD) { e[D[196][j]] = 50176 + j; d[50176 + j] = D[196][j];}\nD[197] = \"\".split(\"\");\nfor(j = 0; j != D[197].length; ++j) if(D[197][j].charCodeAt(0) !== 0xFFFD) { e[D[197][j]] = 50432 + j; d[50432 + j] = D[197][j];}\nD[198] = \"\".split(\"\");\nfor(j = 0; j != D[198].length; ++j) if(D[198][j].charCodeAt(0) !== 0xFFFD) { e[D[198][j]] = 50688 + j; d[50688 + j] = D[198][j];}\nD[199] = \"\".split(\"\");\nfor(j = 0; j != D[199].length; ++j) if(D[199][j].charCodeAt(0) !== 0xFFFD) { e[D[199][j]] = 50944 + j; d[50944 + j] = D[199][j];}\nD[200] = \"\".split(\"\");\nfor(j = 0; j != D[200].length; ++j) if(D[200][j].charCodeAt(0) !== 0xFFFD) { e[D[200][j]] = 51200 + j; d[51200 + j] = D[200][j];}\nD[201] = \"\".split(\"\");\nfor(j = 0; j != D[201].length; ++j) if(D[201][j].charCodeAt(0) !== 0xFFFD) { e[D[201][j]] = 51456 + j; d[51456 + j] = D[201][j];}\nD[202] = \"\".split(\"\");\nfor(j = 0; j != D[202].length; ++j) if(D[202][j].charCodeAt(0) !== 0xFFFD) { e[D[202][j]] = 51712 + j; d[51712 + j] = D[202][j];}\nD[203] = \"\".split(\"\");\nfor(j = 0; j != D[203].length; ++j) if(D[203][j].charCodeAt(0) !== 0xFFFD) { e[D[203][j]] = 51968 + j; d[51968 + j] = D[203][j];}\nD[204] = \"\".split(\"\");\nfor(j = 0; j != D[204].length; ++j) if(D[204][j].charCodeAt(0) !== 0xFFFD) { e[D[204][j]] = 52224 + j; d[52224 + j] = D[204][j];}\nD[205] = \"\".split(\"\");\nfor(j = 0; j != D[205].length; ++j) if(D[205][j].charCodeAt(0) !== 0xFFFD) { e[D[205][j]] = 52480 + j; d[52480 + j] = D[205][j];}\nD[206] = \"\".split(\"\");\nfor(j = 0; j != D[206].length; ++j) if(D[206][j].charCodeAt(0) !== 0xFFFD) { e[D[206][j]] = 52736 + j; d[52736 + j] = D[206][j];}\nD[207] = \"\".split(\"\");\nfor(j = 0; j != D[207].length; ++j) if(D[207][j].charCodeAt(0) !== 0xFFFD) { e[D[207][j]] = 52992 + j; d[52992 + j] = D[207][j];}\nD[208] = \"\".split(\"\");\nfor(j = 0; j != D[208].length; ++j) if(D[208][j].charCodeAt(0) !== 0xFFFD) { e[D[208][j]] = 53248 + j; d[53248 + j] = D[208][j];}\nD[209] = \"\".split(\"\");\nfor(j = 0; j != D[209].length; ++j) if(D[209][j].charCodeAt(0) !== 0xFFFD) { e[D[209][j]] = 53504 + j; d[53504 + j] = D[209][j];}\nD[210] = \"\".split(\"\");\nfor(j = 0; j != D[210].length; ++j) if(D[210][j].charCodeAt(0) !== 0xFFFD) { e[D[210][j]] = 53760 + j; d[53760 + j] = D[210][j];}\nD[211] = \"\".split(\"\");\nfor(j = 0; j != D[211].length; ++j) if(D[211][j].charCodeAt(0) !== 0xFFFD) { e[D[211][j]] = 54016 + j; d[54016 + j] = D[211][j];}\nD[212] = \"\".split(\"\");\nfor(j = 0; j != D[212].length; ++j) if(D[212][j].charCodeAt(0) !== 0xFFFD) { e[D[212][j]] = 54272 + j; d[54272 + j] = D[212][j];}\nD[213] = \"\".split(\"\");\nfor(j = 0; j != D[213].length; ++j) if(D[213][j].charCodeAt(0) !== 0xFFFD) { e[D[213][j]] = 54528 + j; d[54528 + j] = D[213][j];}\nD[214] = \"\".split(\"\");\nfor(j = 0; j != D[214].length; ++j) if(D[214][j].charCodeAt(0) !== 0xFFFD) { e[D[214][j]] = 54784 + j; d[54784 + j] = D[214][j];}\nD[215] = \"\".split(\"\");\nfor(j = 0; j != D[215].length; ++j) if(D[215][j].charCodeAt(0) !== 0xFFFD) { e[D[215][j]] = 55040 + j; d[55040 + j] = D[215][j];}\nD[216] = \"\".split(\"\");\nfor(j = 0; j != D[216].length; ++j) if(D[216][j].charCodeAt(0) !== 0xFFFD) { e[D[216][j]] = 55296 + j; d[55296 + j] = D[216][j];}\nD[217] = \"\".split(\"\");\nfor(j = 0; j != D[217].length; ++j) if(D[217][j].charCodeAt(0) !== 0xFFFD) { e[D[217][j]] = 55552 + j; d[55552 + j] = D[217][j];}\nD[218] = \"\".split(\"\");\nfor(j = 0; j != D[218].length; ++j) if(D[218][j].charCodeAt(0) !== 0xFFFD) { e[D[218][j]] = 55808 + j; d[55808 + j] = D[218][j];}\nD[219] = \"\".split(\"\");\nfor(j = 0; j != D[219].length; ++j) if(D[219][j].charCodeAt(0) !== 0xFFFD) { e[D[219][j]] = 56064 + j; d[56064 + j] = D[219][j];}\nD[220] = \"\".split(\"\");\nfor(j = 0; j != D[220].length; ++j) if(D[220][j].charCodeAt(0) !== 0xFFFD) { e[D[220][j]] = 56320 + j; d[56320 + j] = D[220][j];}\nD[221] = \"\".split(\"\");\nfor(j = 0; j != D[221].length; ++j) if(D[221][j].charCodeAt(0) !== 0xFFFD) { e[D[221][j]] = 56576 + j; d[56576 + j] = D[221][j];}\nD[222] = \"\".split(\"\");\nfor(j = 0; j != D[222].length; ++j) if(D[222][j].charCodeAt(0) !== 0xFFFD) { e[D[222][j]] = 56832 + j; d[56832 + j] = D[222][j];}\nD[223] = \"\".split(\"\");\nfor(j = 0; j != D[223].length; ++j) if(D[223][j].charCodeAt(0) !== 0xFFFD) { e[D[223][j]] = 57088 + j; d[57088 + j] = D[223][j];}\nD[224] = \"\".split(\"\");\nfor(j = 0; j != D[224].length; ++j) if(D[224][j].charCodeAt(0) !== 0xFFFD) { e[D[224][j]] = 57344 + j; d[57344 + j] = D[224][j];}\nD[225] = \"\".split(\"\");\nfor(j = 0; j != D[225].length; ++j) if(D[225][j].charCodeAt(0) !== 0xFFFD) { e[D[225][j]] = 57600 + j; d[57600 + j] = D[225][j];}\nD[226] = \"\".split(\"\");\nfor(j = 0; j != D[226].length; ++j) if(D[226][j].charCodeAt(0) !== 0xFFFD) { e[D[226][j]] = 57856 + j; d[57856 + j] = D[226][j];}\nD[227] = \"\".split(\"\");\nfor(j = 0; j != D[227].length; ++j) if(D[227][j].charCodeAt(0) !== 0xFFFD) { e[D[227][j]] = 58112 + j; d[58112 + j] = D[227][j];}\nD[228] = \"\".split(\"\");\nfor(j = 0; j != D[228].length; ++j) if(D[228][j].charCodeAt(0) !== 0xFFFD) { e[D[228][j]] = 58368 + j; d[58368 + j] = D[228][j];}\nD[229] = \"\".split(\"\");\nfor(j = 0; j != D[229].length; ++j) if(D[229][j].charCodeAt(0) !== 0xFFFD) { e[D[229][j]] = 58624 + j; d[58624 + j] = D[229][j];}\nD[230] = \"\".split(\"\");\nfor(j = 0; j != D[230].length; ++j) if(D[230][j].charCodeAt(0) !== 0xFFFD) { e[D[230][j]] = 58880 + j; d[58880 + j] = D[230][j];}\nD[231] = \"\".split(\"\");\nfor(j = 0; j != D[231].length; ++j) if(D[231][j].charCodeAt(0) !== 0xFFFD) { e[D[231][j]] = 59136 + j; d[59136 + j] = D[231][j];}\nD[232] = \"\".split(\"\");\nfor(j = 0; j != D[232].length; ++j) if(D[232][j].charCodeAt(0) !== 0xFFFD) { e[D[232][j]] = 59392 + j; d[59392 + j] = D[232][j];}\nD[233] = \"\".split(\"\");\nfor(j = 0; j != D[233].length; ++j) if(D[233][j].charCodeAt(0) !== 0xFFFD) { e[D[233][j]] = 59648 + j; d[59648 + j] = D[233][j];}\nD[234] = \"\".split(\"\");\nfor(j = 0; j != D[234].length; ++j) if(D[234][j].charCodeAt(0) !== 0xFFFD) { e[D[234][j]] = 59904 + j; d[59904 + j] = D[234][j];}\nD[235] = \"\".split(\"\");\nfor(j = 0; j != D[235].length; ++j) if(D[235][j].charCodeAt(0) !== 0xFFFD) { e[D[235][j]] = 60160 + j; d[60160 + j] = D[235][j];}\nD[236] = \"\".split(\"\");\nfor(j = 0; j != D[236].length; ++j) if(D[236][j].charCodeAt(0) !== 0xFFFD) { e[D[236][j]] = 60416 + j; d[60416 + j] = D[236][j];}\nD[237] = \"\".split(\"\");\nfor(j = 0; j != D[237].length; ++j) if(D[237][j].charCodeAt(0) !== 0xFFFD) { e[D[237][j]] = 60672 + j; d[60672 + j] = D[237][j];}\nD[238] = \"\".split(\"\");\nfor(j = 0; j != D[238].length; ++j) if(D[238][j].charCodeAt(0) !== 0xFFFD) { e[D[238][j]] = 60928 + j; d[60928 + j] = D[238][j];}\nD[239] = \"\".split(\"\");\nfor(j = 0; j != D[239].length; ++j) if(D[239][j].charCodeAt(0) !== 0xFFFD) { e[D[239][j]] = 61184 + j; d[61184 + j] = D[239][j];}\nD[240] = \"\".split(\"\");\nfor(j = 0; j != D[240].length; ++j) if(D[240][j].charCodeAt(0) !== 0xFFFD) { e[D[240][j]] = 61440 + j; d[61440 + j] = D[240][j];}\nD[241] = \"\".split(\"\");\nfor(j = 0; j != D[241].length; ++j) if(D[241][j].charCodeAt(0) !== 0xFFFD) { e[D[241][j]] = 61696 + j; d[61696 + j] = D[241][j];}\nD[242] = \"\".split(\"\");\nfor(j = 0; j != D[242].length; ++j) if(D[242][j].charCodeAt(0) !== 0xFFFD) { e[D[242][j]] = 61952 + j; d[61952 + j] = D[242][j];}\nD[243] = \"\".split(\"\");\nfor(j = 0; j != D[243].length; ++j) if(D[243][j].charCodeAt(0) !== 0xFFFD) { e[D[243][j]] = 62208 + j; d[62208 + j] = D[243][j];}\nD[244] = \"\".split(\"\");\nfor(j = 0; j != D[244].length; ++j) if(D[244][j].charCodeAt(0) !== 0xFFFD) { e[D[244][j]] = 62464 + j; d[62464 + j] = D[244][j];}\nD[245] = \"\".split(\"\");\nfor(j = 0; j != D[245].length; ++j) if(D[245][j].charCodeAt(0) !== 0xFFFD) { e[D[245][j]] = 62720 + j; d[62720 + j] = D[245][j];}\nD[246] = \"\".split(\"\");\nfor(j = 0; j != D[246].length; ++j) if(D[246][j].charCodeAt(0) !== 0xFFFD) { e[D[246][j]] = 62976 + j; d[62976 + j] = D[246][j];}\nD[247] = \"\".split(\"\");\nfor(j = 0; j != D[247].length; ++j) if(D[247][j].charCodeAt(0) !== 0xFFFD) { e[D[247][j]] = 63232 + j; d[63232 + j] = D[247][j];}\nD[248] = \"\".split(\"\");\nfor(j = 0; j != D[248].length; ++j) if(D[248][j].charCodeAt(0) !== 0xFFFD) { e[D[248][j]] = 63488 + j; d[63488 + j] = D[248][j];}\nD[249] = \"\".split(\"\");\nfor(j = 0; j != D[249].length; ++j) if(D[249][j].charCodeAt(0) !== 0xFFFD) { e[D[249][j]] = 63744 + j; d[63744 + j] = D[249][j];}\nD[250] = \"\".split(\"\");\nfor(j = 0; j != D[250].length; ++j) if(D[250][j].charCodeAt(0) !== 0xFFFD) { e[D[250][j]] = 64000 + j; d[64000 + j] = D[250][j];}\nD[251] = \"\".split(\"\");\nfor(j = 0; j != D[251].length; ++j) if(D[251][j].charCodeAt(0) !== 0xFFFD) { e[D[251][j]] = 64256 + j; d[64256 + j] = D[251][j];}\nD[252] = \"\".split(\"\");\nfor(j = 0; j != D[252].length; ++j) if(D[252][j].charCodeAt(0) !== 0xFFFD) { e[D[252][j]] = 64512 + j; d[64512 + j] = D[252][j];}\nD[253] = \"\".split(\"\");\nfor(j = 0; j != D[253].length; ++j) if(D[253][j].charCodeAt(0) !== 0xFFFD) { e[D[253][j]] = 64768 + j; d[64768 + j] = D[253][j];}\nD[254] = \"\".split(\"\");\nfor(j = 0; j != D[254].length; ++j) if(D[254][j].charCodeAt(0) !== 0xFFFD) { e[D[254][j]] = 65024 + j; d[65024 + j] = D[254][j];}\nreturn {\"enc\": e, \"dec\": d }; })();\ncptable[949] = (function(){ var d = [], e = {}, D = [], j;\nD[0] = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");\nfor(j = 0; j != D[0].length; ++j) if(D[0][j].charCodeAt(0) !== 0xFFFD) { e[D[0][j]] = 0 + j; d[0 + j] = D[0][j];}\nD[129] = \"\".split(\"\");\nfor(j = 0; j != D[129].length; ++j) if(D[129][j].charCodeAt(0) !== 0xFFFD) { e[D[129][j]] = 33024 + j; d[33024 + j] = D[129][j];}\nD[130] = \"\".split(\"\");\nfor(j = 0; j != D[130].length; ++j) if(D[130][j].charCodeAt(0) !== 0xFFFD) { e[D[130][j]] = 33280 + j; d[33280 + j] = D[130][j];}\nD[131] = \"\".split(\"\");\nfor(j = 0; j != D[131].length; ++j) if(D[131][j].charCodeAt(0) !== 0xFFFD) { e[D[131][j]] = 33536 + j; d[33536 + j] = D[131][j];}\nD[132] = \"\".split(\"\");\nfor(j = 0; j != D[132].length; ++j) if(D[132][j].charCodeAt(0) !== 0xFFFD) { e[D[132][j]] = 33792 + j; d[33792 + j] = D[132][j];}\nD[133] = \"\".split(\"\");\nfor(j = 0; j != D[133].length; ++j) if(D[133][j].charCodeAt(0) !== 0xFFFD) { e[D[133][j]] = 34048 + j; d[34048 + j] = D[133][j];}\nD[134] = \"\".split(\"\");\nfor(j = 0; j != D[134].length; ++j) if(D[134][j].charCodeAt(0) !== 0xFFFD) { e[D[134][j]] = 34304 + j; d[34304 + j] = D[134][j];}\nD[135] = \"\".split(\"\");\nfor(j = 0; j != D[135].length; ++j) if(D[135][j].charCodeAt(0) !== 0xFFFD) { e[D[135][j]] = 34560 + j; d[34560 + j] = D[135][j];}\nD[136] = \"\".split(\"\");\nfor(j = 0; j != D[136].length; ++j) if(D[136][j].charCodeAt(0) !== 0xFFFD) { e[D[136][j]] = 34816 + j; d[34816 + j] = D[136][j];}\nD[137] = \"\".split(\"\");\nfor(j = 0; j != D[137].length; ++j) if(D[137][j].charCodeAt(0) !== 0xFFFD) { e[D[137][j]] = 35072 + j; d[35072 + j] = D[137][j];}\nD[138] = \"\".split(\"\");\nfor(j = 0; j != D[138].length; ++j) if(D[138][j].charCodeAt(0) !== 0xFFFD) { e[D[138][j]] = 35328 + j; d[35328 + j] = D[138][j];}\nD[139] = \"\".split(\"\");\nfor(j = 0; j != D[139].length; ++j) if(D[139][j].charCodeAt(0) !== 0xFFFD) { e[D[139][j]] = 35584 + j; d[35584 + j] = D[139][j];}\nD[140] = \"\".split(\"\");\nfor(j = 0; j != D[140].length; ++j) if(D[140][j].charCodeAt(0) !== 0xFFFD) { e[D[140][j]] = 35840 + j; d[35840 + j] = D[140][j];}\nD[141] = \"\".split(\"\");\nfor(j = 0; j != D[141].length; ++j) if(D[141][j].charCodeAt(0) !== 0xFFFD) { e[D[141][j]] = 36096 + j; d[36096 + j] = D[141][j];}\nD[142] = \"\".split(\"\");\nfor(j = 0; j != D[142].length; ++j) if(D[142][j].charCodeAt(0) !== 0xFFFD) { e[D[142][j]] = 36352 + j; d[36352 + j] = D[142][j];}\nD[143] = \"\".split(\"\");\nfor(j = 0; j != D[143].length; ++j) if(D[143][j].charCodeAt(0) !== 0xFFFD) { e[D[143][j]] = 36608 + j; d[36608 + j] = D[143][j];}\nD[144] = \"\".split(\"\");\nfor(j = 0; j != D[144].length; ++j) if(D[144][j].charCodeAt(0) !== 0xFFFD) { e[D[144][j]] = 36864 + j; d[36864 + j] = D[144][j];}\nD[145] = \"\".split(\"\");\nfor(j = 0; j != D[145].length; ++j) if(D[145][j].charCodeAt(0) !== 0xFFFD) { e[D[145][j]] = 37120 + j; d[37120 + j] = D[145][j];}\nD[146] = \"\".split(\"\");\nfor(j = 0; j != D[146].length; ++j) if(D[146][j].charCodeAt(0) !== 0xFFFD) { e[D[146][j]] = 37376 + j; d[37376 + j] = D[146][j];}\nD[147] = \"\".split(\"\");\nfor(j = 0; j != D[147].length; ++j) if(D[147][j].charCodeAt(0) !== 0xFFFD) { e[D[147][j]] = 37632 + j; d[37632 + j] = D[147][j];}\nD[148] = \"\".split(\"\");\nfor(j = 0; j != D[148].length; ++j) if(D[148][j].charCodeAt(0) !== 0xFFFD) { e[D[148][j]] = 37888 + j; d[37888 + j] = D[148][j];}\nD[149] = \"\".split(\"\");\nfor(j = 0; j != D[149].length; ++j) if(D[149][j].charCodeAt(0) !== 0xFFFD) { e[D[149][j]] = 38144 + j; d[38144 + j] = D[149][j];}\nD[150] = \"\".split(\"\");\nfor(j = 0; j != D[150].length; ++j) if(D[150][j].charCodeAt(0) !== 0xFFFD) { e[D[150][j]] = 38400 + j; d[38400 + j] = D[150][j];}\nD[151] = \"\".split(\"\");\nfor(j = 0; j != D[151].length; ++j) if(D[151][j].charCodeAt(0) !== 0xFFFD) { e[D[151][j]] = 38656 + j; d[38656 + j] = D[151][j];}\nD[152] = \"\".split(\"\");\nfor(j = 0; j != D[152].length; ++j) if(D[152][j].charCodeAt(0) !== 0xFFFD) { e[D[152][j]] = 38912 + j; d[38912 + j] = D[152][j];}\nD[153] = \"\".split(\"\");\nfor(j = 0; j != D[153].length; ++j) if(D[153][j].charCodeAt(0) !== 0xFFFD) { e[D[153][j]] = 39168 + j; d[39168 + j] = D[153][j];}\nD[154] = \"\".split(\"\");\nfor(j = 0; j != D[154].length; ++j) if(D[154][j].charCodeAt(0) !== 0xFFFD) { e[D[154][j]] = 39424 + j; d[39424 + j] = D[154][j];}\nD[155] = \"\".split(\"\");\nfor(j = 0; j != D[155].length; ++j) if(D[155][j].charCodeAt(0) !== 0xFFFD) { e[D[155][j]] = 39680 + j; d[39680 + j] = D[155][j];}\nD[156] = \"\".split(\"\");\nfor(j = 0; j != D[156].length; ++j) if(D[156][j].charCodeAt(0) !== 0xFFFD) { e[D[156][j]] = 39936 + j; d[39936 + j] = D[156][j];}\nD[157] = \"\".split(\"\");\nfor(j = 0; j != D[157].length; ++j) if(D[157][j].charCodeAt(0) !== 0xFFFD) { e[D[157][j]] = 40192 + j; d[40192 + j] = D[157][j];}\nD[158] = \"\".split(\"\");\nfor(j = 0; j != D[158].length; ++j) if(D[158][j].charCodeAt(0) !== 0xFFFD) { e[D[158][j]] = 40448 + j; d[40448 + j] = D[158][j];}\nD[159] = \"\".split(\"\");\nfor(j = 0; j != D[159].length; ++j) if(D[159][j].charCodeAt(0) !== 0xFFFD) { e[D[159][j]] = 40704 + j; d[40704 + j] = D[159][j];}\nD[160] = \"\".split(\"\");\nfor(j = 0; j != D[160].length; ++j) if(D[160][j].charCodeAt(0) !== 0xFFFD) { e[D[160][j]] = 40960 + j; d[40960 + j] = D[160][j];}\nD[161] = \"\".split(\"\");\nfor(j = 0; j != D[161].length; ++j) if(D[161][j].charCodeAt(0) !== 0xFFFD) { e[D[161][j]] = 41216 + j; d[41216 + j] = D[161][j];}\nD[162] = \"\".split(\"\");\nfor(j = 0; j != D[162].length; ++j) if(D[162][j].charCodeAt(0) !== 0xFFFD) { e[D[162][j]] = 41472 + j; d[41472 + j] = D[162][j];}\nD[163] = \"\".split(\"\");\nfor(j = 0; j != D[163].length; ++j) if(D[163][j].charCodeAt(0) !== 0xFFFD) { e[D[163][j]] = 41728 + j; d[41728 + j] = D[163][j];}\nD[164] = \"\".split(\"\");\nfor(j = 0; j != D[164].length; ++j) if(D[164][j].charCodeAt(0) !== 0xFFFD) { e[D[164][j]] = 41984 + j; d[41984 + j] = D[164][j];}\nD[165] = \"\".split(\"\");\nfor(j = 0; j != D[165].length; ++j) if(D[165][j].charCodeAt(0) !== 0xFFFD) { e[D[165][j]] = 42240 + j; d[42240 + j] = D[165][j];}\nD[166] = \"\".split(\"\");\nfor(j = 0; j != D[166].length; ++j) if(D[166][j].charCodeAt(0) !== 0xFFFD) { e[D[166][j]] = 42496 + j; d[42496 + j] = D[166][j];}\nD[167] = \"\".split(\"\");\nfor(j = 0; j != D[167].length; ++j) if(D[167][j].charCodeAt(0) !== 0xFFFD) { e[D[167][j]] = 42752 + j; d[42752 + j] = D[167][j];}\nD[168] = \"\".split(\"\");\nfor(j = 0; j != D[168].length; ++j) if(D[168][j].charCodeAt(0) !== 0xFFFD) { e[D[168][j]] = 43008 + j; d[43008 + j] = D[168][j];}\nD[169] = \"\".split(\"\");\nfor(j = 0; j != D[169].length; ++j) if(D[169][j].charCodeAt(0) !== 0xFFFD) { e[D[169][j]] = 43264 + j; d[43264 + j] = D[169][j];}\nD[170] = \"\".split(\"\");\nfor(j = 0; j != D[170].length; ++j) if(D[170][j].charCodeAt(0) !== 0xFFFD) { e[D[170][j]] = 43520 + j; d[43520 + j] = D[170][j];}\nD[171] = \"\".split(\"\");\nfor(j = 0; j != D[171].length; ++j) if(D[171][j].charCodeAt(0) !== 0xFFFD) { e[D[171][j]] = 43776 + j; d[43776 + j] = D[171][j];}\nD[172] = \"\".split(\"\");\nfor(j = 0; j != D[172].length; ++j) if(D[172][j].charCodeAt(0) !== 0xFFFD) { e[D[172][j]] = 44032 + j; d[44032 + j] = D[172][j];}\nD[173] = \"\".split(\"\");\nfor(j = 0; j != D[173].length; ++j) if(D[173][j].charCodeAt(0) !== 0xFFFD) { e[D[173][j]] = 44288 + j; d[44288 + j] = D[173][j];}\nD[174] = \"\".split(\"\");\nfor(j = 0; j != D[174].length; ++j) if(D[174][j].charCodeAt(0) !== 0xFFFD) { e[D[174][j]] = 44544 + j; d[44544 + j] = D[174][j];}\nD[175] = \"\".split(\"\");\nfor(j = 0; j != D[175].length; ++j) if(D[175][j].charCodeAt(0) !== 0xFFFD) { e[D[175][j]] = 44800 + j; d[44800 + j] = D[175][j];}\nD[176] = \"\".split(\"\");\nfor(j = 0; j != D[176].length; ++j) if(D[176][j].charCodeAt(0) !== 0xFFFD) { e[D[176][j]] = 45056 + j; d[45056 + j] = D[176][j];}\nD[177] = \"\".split(\"\");\nfor(j = 0; j != D[177].length; ++j) if(D[177][j].charCodeAt(0) !== 0xFFFD) { e[D[177][j]] = 45312 + j; d[45312 + j] = D[177][j];}\nD[178] = \"\".split(\"\");\nfor(j = 0; j != D[178].length; ++j) if(D[178][j].charCodeAt(0) !== 0xFFFD) { e[D[178][j]] = 45568 + j; d[45568 + j] = D[178][j];}\nD[179] = \"\".split(\"\");\nfor(j = 0; j != D[179].length; ++j) if(D[179][j].charCodeAt(0) !== 0xFFFD) { e[D[179][j]] = 45824 + j; d[45824 + j] = D[179][j];}\nD[180] = \"\".split(\"\");\nfor(j = 0; j != D[180].length; ++j) if(D[180][j].charCodeAt(0) !== 0xFFFD) { e[D[180][j]] = 46080 + j; d[46080 + j] = D[180][j];}\nD[181] = \"\".split(\"\");\nfor(j = 0; j != D[181].length; ++j) if(D[181][j].charCodeAt(0) !== 0xFFFD) { e[D[181][j]] = 46336 + j; d[46336 + j] = D[181][j];}\nD[182] = \"\".split(\"\");\nfor(j = 0; j != D[182].length; ++j) if(D[182][j].charCodeAt(0) !== 0xFFFD) { e[D[182][j]] = 46592 + j; d[46592 + j] = D[182][j];}\nD[183] = \"\".split(\"\");\nfor(j = 0; j != D[183].length; ++j) if(D[183][j].charCodeAt(0) !== 0xFFFD) { e[D[183][j]] = 46848 + j; d[46848 + j] = D[183][j];}\nD[184] = \"\".split(\"\");\nfor(j = 0; j != D[184].length; ++j) if(D[184][j].charCodeAt(0) !== 0xFFFD) { e[D[184][j]] = 47104 + j; d[47104 + j] = D[184][j];}\nD[185] = \"\".split(\"\");\nfor(j = 0; j != D[185].length; ++j) if(D[185][j].charCodeAt(0) !== 0xFFFD) { e[D[185][j]] = 47360 + j; d[47360 + j] = D[185][j];}\nD[186] = \"\".split(\"\");\nfor(j = 0; j != D[186].length; ++j) if(D[186][j].charCodeAt(0) !== 0xFFFD) { e[D[186][j]] = 47616 + j; d[47616 + j] = D[186][j];}\nD[187] = \"\".split(\"\");\nfor(j = 0; j != D[187].length; ++j) if(D[187][j].charCodeAt(0) !== 0xFFFD) { e[D[187][j]] = 47872 + j; d[47872 + j] = D[187][j];}\nD[188] = \"\".split(\"\");\nfor(j = 0; j != D[188].length; ++j) if(D[188][j].charCodeAt(0) !== 0xFFFD) { e[D[188][j]] = 48128 + j; d[48128 + j] = D[188][j];}\nD[189] = \"\".split(\"\");\nfor(j = 0; j != D[189].length; ++j) if(D[189][j].charCodeAt(0) !== 0xFFFD) { e[D[189][j]] = 48384 + j; d[48384 + j] = D[189][j];}\nD[190] = \"\".split(\"\");\nfor(j = 0; j != D[190].length; ++j) if(D[190][j].charCodeAt(0) !== 0xFFFD) { e[D[190][j]] = 48640 + j; d[48640 + j] = D[190][j];}\nD[191] = \"\".split(\"\");\nfor(j = 0; j != D[191].length; ++j) if(D[191][j].charCodeAt(0) !== 0xFFFD) { e[D[191][j]] = 48896 + j; d[48896 + j] = D[191][j];}\nD[192] = \"\".split(\"\");\nfor(j = 0; j != D[192].length; ++j) if(D[192][j].charCodeAt(0) !== 0xFFFD) { e[D[192][j]] = 49152 + j; d[49152 + j] = D[192][j];}\nD[193] = \"\".split(\"\");\nfor(j = 0; j != D[193].length; ++j) if(D[193][j].charCodeAt(0) !== 0xFFFD) { e[D[193][j]] = 49408 + j; d[49408 + j] = D[193][j];}\nD[194] = \"\".split(\"\");\nfor(j = 0; j != D[194].length; ++j) if(D[194][j].charCodeAt(0) !== 0xFFFD) { e[D[194][j]] = 49664 + j; d[49664 + j] = D[194][j];}\nD[195] = \"\".split(\"\");\nfor(j = 0; j != D[195].length; ++j) if(D[195][j].charCodeAt(0) !== 0xFFFD) { e[D[195][j]] = 49920 + j; d[49920 + j] = D[195][j];}\nD[196] = \"\".split(\"\");\nfor(j = 0; j != D[196].length; ++j) if(D[196][j].charCodeAt(0) !== 0xFFFD) { e[D[196][j]] = 50176 + j; d[50176 + j] = D[196][j];}\nD[197] = \"\".split(\"\");\nfor(j = 0; j != D[197].length; ++j) if(D[197][j].charCodeAt(0) !== 0xFFFD) { e[D[197][j]] = 50432 + j; d[50432 + j] = D[197][j];}\nD[198] = \"\".split(\"\");\nfor(j = 0; j != D[198].length; ++j) if(D[198][j].charCodeAt(0) !== 0xFFFD) { e[D[198][j]] = 50688 + j; d[50688 + j] = D[198][j];}\nD[199] = \"\".split(\"\");\nfor(j = 0; j != D[199].length; ++j) if(D[199][j].charCodeAt(0) !== 0xFFFD) { e[D[199][j]] = 50944 + j; d[50944 + j] = D[199][j];}\nD[200] = \"\".split(\"\");\nfor(j = 0; j != D[200].length; ++j) if(D[200][j].charCodeAt(0) !== 0xFFFD) { e[D[200][j]] = 51200 + j; d[51200 + j] = D[200][j];}\nD[202] = \"\".split(\"\");\nfor(j = 0; j != D[202].length; ++j) if(D[202][j].charCodeAt(0) !== 0xFFFD) { e[D[202][j]] = 51712 + j; d[51712 + j] = D[202][j];}\nD[203] = \"\".split(\"\");\nfor(j = 0; j != D[203].length; ++j) if(D[203][j].charCodeAt(0) !== 0xFFFD) { e[D[203][j]] = 51968 + j; d[51968 + j] = D[203][j];}\nD[204] = \"\".split(\"\");\nfor(j = 0; j != D[204].length; ++j) if(D[204][j].charCodeAt(0) !== 0xFFFD) { e[D[204][j]] = 52224 + j; d[52224 + j] = D[204][j];}\nD[205] = \"\".split(\"\");\nfor(j = 0; j != D[205].length; ++j) if(D[205][j].charCodeAt(0) !== 0xFFFD) { e[D[205][j]] = 52480 + j; d[52480 + j] = D[205][j];}\nD[206] = \"\".split(\"\");\nfor(j = 0; j != D[206].length; ++j) if(D[206][j].charCodeAt(0) !== 0xFFFD) { e[D[206][j]] = 52736 + j; d[52736 + j] = D[206][j];}\nD[207] = \"\".split(\"\");\nfor(j = 0; j != D[207].length; ++j) if(D[207][j].charCodeAt(0) !== 0xFFFD) { e[D[207][j]] = 52992 + j; d[52992 + j] = D[207][j];}\nD[208] = \"\".split(\"\");\nfor(j = 0; j != D[208].length; ++j) if(D[208][j].charCodeAt(0) !== 0xFFFD) { e[D[208][j]] = 53248 + j; d[53248 + j] = D[208][j];}\nD[209] = \"\".split(\"\");\nfor(j = 0; j != D[209].length; ++j) if(D[209][j].charCodeAt(0) !== 0xFFFD) { e[D[209][j]] = 53504 + j; d[53504 + j] = D[209][j];}\nD[210] = \"\".split(\"\");\nfor(j = 0; j != D[210].length; ++j) if(D[210][j].charCodeAt(0) !== 0xFFFD) { e[D[210][j]] = 53760 + j; d[53760 + j] = D[210][j];}\nD[211] = \"\".split(\"\");\nfor(j = 0; j != D[211].length; ++j) if(D[211][j].charCodeAt(0) !== 0xFFFD) { e[D[211][j]] = 54016 + j; d[54016 + j] = D[211][j];}\nD[212] = \"\".split(\"\");\nfor(j = 0; j != D[212].length; ++j) if(D[212][j].charCodeAt(0) !== 0xFFFD) { e[D[212][j]] = 54272 + j; d[54272 + j] = D[212][j];}\nD[213] = \"\".split(\"\");\nfor(j = 0; j != D[213].length; ++j) if(D[213][j].charCodeAt(0) !== 0xFFFD) { e[D[213][j]] = 54528 + j; d[54528 + j] = D[213][j];}\nD[214] = \"\".split(\"\");\nfor(j = 0; j != D[214].length; ++j) if(D[214][j].charCodeAt(0) !== 0xFFFD) { e[D[214][j]] = 54784 + j; d[54784 + j] = D[214][j];}\nD[215] = \"\".split(\"\");\nfor(j = 0; j != D[215].length; ++j) if(D[215][j].charCodeAt(0) !== 0xFFFD) { e[D[215][j]] = 55040 + j; d[55040 + j] = D[215][j];}\nD[216] = \"\".split(\"\");\nfor(j = 0; j != D[216].length; ++j) if(D[216][j].charCodeAt(0) !== 0xFFFD) { e[D[216][j]] = 55296 + j; d[55296 + j] = D[216][j];}\nD[217] = \"\".split(\"\");\nfor(j = 0; j != D[217].length; ++j) if(D[217][j].charCodeAt(0) !== 0xFFFD) { e[D[217][j]] = 55552 + j; d[55552 + j] = D[217][j];}\nD[218] = \"\".split(\"\");\nfor(j = 0; j != D[218].length; ++j) if(D[218][j].charCodeAt(0) !== 0xFFFD) { e[D[218][j]] = 55808 + j; d[55808 + j] = D[218][j];}\nD[219] = \"\".split(\"\");\nfor(j = 0; j != D[219].length; ++j) if(D[219][j].charCodeAt(0) !== 0xFFFD) { e[D[219][j]] = 56064 + j; d[56064 + j] = D[219][j];}\nD[220] = \"\".split(\"\");\nfor(j = 0; j != D[220].length; ++j) if(D[220][j].charCodeAt(0) !== 0xFFFD) { e[D[220][j]] = 56320 + j; d[56320 + j] = D[220][j];}\nD[221] = \"\".split(\"\");\nfor(j = 0; j != D[221].length; ++j) if(D[221][j].charCodeAt(0) !== 0xFFFD) { e[D[221][j]] = 56576 + j; d[56576 + j] = D[221][j];}\nD[222] = \"\".split(\"\");\nfor(j = 0; j != D[222].length; ++j) if(D[222][j].charCodeAt(0) !== 0xFFFD) { e[D[222][j]] = 56832 + j; d[56832 + j] = D[222][j];}\nD[223] = \"\".split(\"\");\nfor(j = 0; j != D[223].length; ++j) if(D[223][j].charCodeAt(0) !== 0xFFFD) { e[D[223][j]] = 57088 + j; d[57088 + j] = D[223][j];}\nD[224] = \"\".split(\"\");\nfor(j = 0; j != D[224].length; ++j) if(D[224][j].charCodeAt(0) !== 0xFFFD) { e[D[224][j]] = 57344 + j; d[57344 + j] = D[224][j];}\nD[225] = \"\".split(\"\");\nfor(j = 0; j != D[225].length; ++j) if(D[225][j].charCodeAt(0) !== 0xFFFD) { e[D[225][j]] = 57600 + j; d[57600 + j] = D[225][j];}\nD[226] = \"\".split(\"\");\nfor(j = 0; j != D[226].length; ++j) if(D[226][j].charCodeAt(0) !== 0xFFFD) { e[D[226][j]] = 57856 + j; d[57856 + j] = D[226][j];}\nD[227] = \"\".split(\"\");\nfor(j = 0; j != D[227].length; ++j) if(D[227][j].charCodeAt(0) !== 0xFFFD) { e[D[227][j]] = 58112 + j; d[58112 + j] = D[227][j];}\nD[228] = \"\".split(\"\");\nfor(j = 0; j != D[228].length; ++j) if(D[228][j].charCodeAt(0) !== 0xFFFD) { e[D[228][j]] = 58368 + j; d[58368 + j] = D[228][j];}\nD[229] = \"\".split(\"\");\nfor(j = 0; j != D[229].length; ++j) if(D[229][j].charCodeAt(0) !== 0xFFFD) { e[D[229][j]] = 58624 + j; d[58624 + j] = D[229][j];}\nD[230] = \"\".split(\"\");\nfor(j = 0; j != D[230].length; ++j) if(D[230][j].charCodeAt(0) !== 0xFFFD) { e[D[230][j]] = 58880 + j; d[58880 + j] = D[230][j];}\nD[231] = \"\".split(\"\");\nfor(j = 0; j != D[231].length; ++j) if(D[231][j].charCodeAt(0) !== 0xFFFD) { e[D[231][j]] = 59136 + j; d[59136 + j] = D[231][j];}\nD[232] = \"\".split(\"\");\nfor(j = 0; j != D[232].length; ++j) if(D[232][j].charCodeAt(0) !== 0xFFFD) { e[D[232][j]] = 59392 + j; d[59392 + j] = D[232][j];}\nD[233] = \"\".split(\"\");\nfor(j = 0; j != D[233].length; ++j) if(D[233][j].charCodeAt(0) !== 0xFFFD) { e[D[233][j]] = 59648 + j; d[59648 + j] = D[233][j];}\nD[234] = \"\".split(\"\");\nfor(j = 0; j != D[234].length; ++j) if(D[234][j].charCodeAt(0) !== 0xFFFD) { e[D[234][j]] = 59904 + j; d[59904 + j] = D[234][j];}\nD[235] = \"\".split(\"\");\nfor(j = 0; j != D[235].length; ++j) if(D[235][j].charCodeAt(0) !== 0xFFFD) { e[D[235][j]] = 60160 + j; d[60160 + j] = D[235][j];}\nD[236] = \"\".split(\"\");\nfor(j = 0; j != D[236].length; ++j) if(D[236][j].charCodeAt(0) !== 0xFFFD) { e[D[236][j]] = 60416 + j; d[60416 + j] = D[236][j];}\nD[237] = \"\".split(\"\");\nfor(j = 0; j != D[237].length; ++j) if(D[237][j].charCodeAt(0) !== 0xFFFD) { e[D[237][j]] = 60672 + j; d[60672 + j] = D[237][j];}\nD[238] = \"\".split(\"\");\nfor(j = 0; j != D[238].length; ++j) if(D[238][j].charCodeAt(0) !== 0xFFFD) { e[D[238][j]] = 60928 + j; d[60928 + j] = D[238][j];}\nD[239] = \"\".split(\"\");\nfor(j = 0; j != D[239].length; ++j) if(D[239][j].charCodeAt(0) !== 0xFFFD) { e[D[239][j]] = 61184 + j; d[61184 + j] = D[239][j];}\nD[240] = \"\".split(\"\");\nfor(j = 0; j != D[240].length; ++j) if(D[240][j].charCodeAt(0) !== 0xFFFD) { e[D[240][j]] = 61440 + j; d[61440 + j] = D[240][j];}\nD[241] = \"\".split(\"\");\nfor(j = 0; j != D[241].length; ++j) if(D[241][j].charCodeAt(0) !== 0xFFFD) { e[D[241][j]] = 61696 + j; d[61696 + j] = D[241][j];}\nD[242] = \"\".split(\"\");\nfor(j = 0; j != D[242].length; ++j) if(D[242][j].charCodeAt(0) !== 0xFFFD) { e[D[242][j]] = 61952 + j; d[61952 + j] = D[242][j];}\nD[243] = \"\".split(\"\");\nfor(j = 0; j != D[243].length; ++j) if(D[243][j].charCodeAt(0) !== 0xFFFD) { e[D[243][j]] = 62208 + j; d[62208 + j] = D[243][j];}\nD[244] = \"\".split(\"\");\nfor(j = 0; j != D[244].length; ++j) if(D[244][j].charCodeAt(0) !== 0xFFFD) { e[D[244][j]] = 62464 + j; d[62464 + j] = D[244][j];}\nD[245] = \"\".split(\"\");\nfor(j = 0; j != D[245].length; ++j) if(D[245][j].charCodeAt(0) !== 0xFFFD) { e[D[245][j]] = 62720 + j; d[62720 + j] = D[245][j];}\nD[246] = \"\".split(\"\");\nfor(j = 0; j != D[246].length; ++j) if(D[246][j].charCodeAt(0) !== 0xFFFD) { e[D[246][j]] = 62976 + j; d[62976 + j] = D[246][j];}\nD[247] = \"\".split(\"\");\nfor(j = 0; j != D[247].length; ++j) if(D[247][j].charCodeAt(0) !== 0xFFFD) { e[D[247][j]] = 63232 + j; d[63232 + j] = D[247][j];}\nD[248] = \"\".split(\"\");\nfor(j = 0; j != D[248].length; ++j) if(D[248][j].charCodeAt(0) !== 0xFFFD) { e[D[248][j]] = 63488 + j; d[63488 + j] = D[248][j];}\nD[249] = \"\".split(\"\");\nfor(j = 0; j != D[249].length; ++j) if(D[249][j].charCodeAt(0) !== 0xFFFD) { e[D[249][j]] = 63744 + j; d[63744 + j] = D[249][j];}\nD[250] = \"\".split(\"\");\nfor(j = 0; j != D[250].length; ++j) if(D[250][j].charCodeAt(0) !== 0xFFFD) { e[D[250][j]] = 64000 + j; d[64000 + j] = D[250][j];}\nD[251] = \"\".split(\"\");\nfor(j = 0; j != D[251].length; ++j) if(D[251][j].charCodeAt(0) !== 0xFFFD) { e[D[251][j]] = 64256 + j; d[64256 + j] = D[251][j];}\nD[252] = \"\".split(\"\");\nfor(j = 0; j != D[252].length; ++j) if(D[252][j].charCodeAt(0) !== 0xFFFD) { e[D[252][j]] = 64512 + j; d[64512 + j] = D[252][j];}\nD[253] = \"\".split(\"\");\nfor(j = 0; j != D[253].length; ++j) if(D[253][j].charCodeAt(0) !== 0xFFFD) { e[D[253][j]] = 64768 + j; d[64768 + j] = D[253][j];}\nreturn {\"enc\": e, \"dec\": d }; })();\ncptable[950] = (function(){ var d = [], e = {}, D = [], j;\nD[0] = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");\nfor(j = 0; j != D[0].length; ++j) if(D[0][j].charCodeAt(0) !== 0xFFFD) { e[D[0][j]] = 0 + j; d[0 + j] = D[0][j];}\nD[161] = \"\".split(\"\");\nfor(j = 0; j != D[161].length; ++j) if(D[161][j].charCodeAt(0) !== 0xFFFD) { e[D[161][j]] = 41216 + j; d[41216 + j] = D[161][j];}\nD[162] = \"\".split(\"\");\nfor(j = 0; j != D[162].length; ++j) if(D[162][j].charCodeAt(0) !== 0xFFFD) { e[D[162][j]] = 41472 + j; d[41472 + j] = D[162][j];}\nD[163] = \"\".split(\"\");\nfor(j = 0; j != D[163].length; ++j) if(D[163][j].charCodeAt(0) !== 0xFFFD) { e[D[163][j]] = 41728 + j; d[41728 + j] = D[163][j];}\nD[164] = \"\".split(\"\");\nfor(j = 0; j != D[164].length; ++j) if(D[164][j].charCodeAt(0) !== 0xFFFD) { e[D[164][j]] = 41984 + j; d[41984 + j] = D[164][j];}\nD[165] = \"\".split(\"\");\nfor(j = 0; j != D[165].length; ++j) if(D[165][j].charCodeAt(0) !== 0xFFFD) { e[D[165][j]] = 42240 + j; d[42240 + j] = D[165][j];}\nD[166] = \"\".split(\"\");\nfor(j = 0; j != D[166].length; ++j) if(D[166][j].charCodeAt(0) !== 0xFFFD) { e[D[166][j]] = 42496 + j; d[42496 + j] = D[166][j];}\nD[167] = \"\".split(\"\");\nfor(j = 0; j != D[167].length; ++j) if(D[167][j].charCodeAt(0) !== 0xFFFD) { e[D[167][j]] = 42752 + j; d[42752 + j] = D[167][j];}\nD[168] = \"\".split(\"\");\nfor(j = 0; j != D[168].length; ++j) if(D[168][j].charCodeAt(0) !== 0xFFFD) { e[D[168][j]] = 43008 + j; d[43008 + j] = D[168][j];}\nD[169] = \"\".split(\"\");\nfor(j = 0; j != D[169].length; ++j) if(D[169][j].charCodeAt(0) !== 0xFFFD) { e[D[169][j]] = 43264 + j; d[43264 + j] = D[169][j];}\nD[170] = \"\".split(\"\");\nfor(j = 0; j != D[170].length; ++j) if(D[170][j].charCodeAt(0) !== 0xFFFD) { e[D[170][j]] = 43520 + j; d[43520 + j] = D[170][j];}\nD[171] = \"\".split(\"\");\nfor(j = 0; j != D[171].length; ++j) if(D[171][j].charCodeAt(0) !== 0xFFFD) { e[D[171][j]] = 43776 + j; d[43776 + j] = D[171][j];}\nD[172] = \"\".split(\"\");\nfor(j = 0; j != D[172].length; ++j) if(D[172][j].charCodeAt(0) !== 0xFFFD) { e[D[172][j]] = 44032 + j; d[44032 + j] = D[172][j];}\nD[173] = \"\".split(\"\");\nfor(j = 0; j != D[173].length; ++j) if(D[173][j].charCodeAt(0) !== 0xFFFD) { e[D[173][j]] = 44288 + j; d[44288 + j] = D[173][j];}\nD[174] = \"\".split(\"\");\nfor(j = 0; j != D[174].length; ++j) if(D[174][j].charCodeAt(0) !== 0xFFFD) { e[D[174][j]] = 44544 + j; d[44544 + j] = D[174][j];}\nD[175] = \"\".split(\"\");\nfor(j = 0; j != D[175].length; ++j) if(D[175][j].charCodeAt(0) !== 0xFFFD) { e[D[175][j]] = 44800 + j; d[44800 + j] = D[175][j];}\nD[176] = \"\".split(\"\");\nfor(j = 0; j != D[176].length; ++j) if(D[176][j].charCodeAt(0) !== 0xFFFD) { e[D[176][j]] = 45056 + j; d[45056 + j] = D[176][j];}\nD[177] = \"\".split(\"\");\nfor(j = 0; j != D[177].length; ++j) if(D[177][j].charCodeAt(0) !== 0xFFFD) { e[D[177][j]] = 45312 + j; d[45312 + j] = D[177][j];}\nD[178] = \"\".split(\"\");\nfor(j = 0; j != D[178].length; ++j) if(D[178][j].charCodeAt(0) !== 0xFFFD) { e[D[178][j]] = 45568 + j; d[45568 + j] = D[178][j];}\nD[179] = \"\".split(\"\");\nfor(j = 0; j != D[179].length; ++j) if(D[179][j].charCodeAt(0) !== 0xFFFD) { e[D[179][j]] = 45824 + j; d[45824 + j] = D[179][j];}\nD[180] = \"\".split(\"\");\nfor(j = 0; j != D[180].length; ++j) if(D[180][j].charCodeAt(0) !== 0xFFFD) { e[D[180][j]] = 46080 + j; d[46080 + j] = D[180][j];}\nD[181] = \"\".split(\"\");\nfor(j = 0; j != D[181].length; ++j) if(D[181][j].charCodeAt(0) !== 0xFFFD) { e[D[181][j]] = 46336 + j; d[46336 + j] = D[181][j];}\nD[182] = \"\".split(\"\");\nfor(j = 0; j != D[182].length; ++j) if(D[182][j].charCodeAt(0) !== 0xFFFD) { e[D[182][j]] = 46592 + j; d[46592 + j] = D[182][j];}\nD[183] = \"\".split(\"\");\nfor(j = 0; j != D[183].length; ++j) if(D[183][j].charCodeAt(0) !== 0xFFFD) { e[D[183][j]] = 46848 + j; d[46848 + j] = D[183][j];}\nD[184] = \"\".split(\"\");\nfor(j = 0; j != D[184].length; ++j) if(D[184][j].charCodeAt(0) !== 0xFFFD) { e[D[184][j]] = 47104 + j; d[47104 + j] = D[184][j];}\nD[185] = \"\".split(\"\");\nfor(j = 0; j != D[185].length; ++j) if(D[185][j].charCodeAt(0) !== 0xFFFD) { e[D[185][j]] = 47360 + j; d[47360 + j] = D[185][j];}\nD[186] = \"\".split(\"\");\nfor(j = 0; j != D[186].length; ++j) if(D[186][j].charCodeAt(0) !== 0xFFFD) { e[D[186][j]] = 47616 + j; d[47616 + j] = D[186][j];}\nD[187] = \"\".split(\"\");\nfor(j = 0; j != D[187].length; ++j) if(D[187][j].charCodeAt(0) !== 0xFFFD) { e[D[187][j]] = 47872 + j; d[47872 + j] = D[187][j];}\nD[188] = \"\".split(\"\");\nfor(j = 0; j != D[188].length; ++j) if(D[188][j].charCodeAt(0) !== 0xFFFD) { e[D[188][j]] = 48128 + j; d[48128 + j] = D[188][j];}\nD[189] = \"\".split(\"\");\nfor(j = 0; j != D[189].length; ++j) if(D[189][j].charCodeAt(0) !== 0xFFFD) { e[D[189][j]] = 48384 + j; d[48384 + j] = D[189][j];}\nD[190] = \"\".split(\"\");\nfor(j = 0; j != D[190].length; ++j) if(D[190][j].charCodeAt(0) !== 0xFFFD) { e[D[190][j]] = 48640 + j; d[48640 + j] = D[190][j];}\nD[191] = \"\".split(\"\");\nfor(j = 0; j != D[191].length; ++j) if(D[191][j].charCodeAt(0) !== 0xFFFD) { e[D[191][j]] = 48896 + j; d[48896 + j] = D[191][j];}\nD[192] = \"\".split(\"\");\nfor(j = 0; j != D[192].length; ++j) if(D[192][j].charCodeAt(0) !== 0xFFFD) { e[D[192][j]] = 49152 + j; d[49152 + j] = D[192][j];}\nD[193] = \"\".split(\"\");\nfor(j = 0; j != D[193].length; ++j) if(D[193][j].charCodeAt(0) !== 0xFFFD) { e[D[193][j]] = 49408 + j; d[49408 + j] = D[193][j];}\nD[194] = \"\".split(\"\");\nfor(j = 0; j != D[194].length; ++j) if(D[194][j].charCodeAt(0) !== 0xFFFD) { e[D[194][j]] = 49664 + j; d[49664 + j] = D[194][j];}\nD[195] = \"\".split(\"\");\nfor(j = 0; j != D[195].length; ++j) if(D[195][j].charCodeAt(0) !== 0xFFFD) { e[D[195][j]] = 49920 + j; d[49920 + j] = D[195][j];}\nD[196] = \"\".split(\"\");\nfor(j = 0; j != D[196].length; ++j) if(D[196][j].charCodeAt(0) !== 0xFFFD) { e[D[196][j]] = 50176 + j; d[50176 + j] = D[196][j];}\nD[197] = \"\".split(\"\");\nfor(j = 0; j != D[197].length; ++j) if(D[197][j].charCodeAt(0) !== 0xFFFD) { e[D[197][j]] = 50432 + j; d[50432 + j] = D[197][j];}\nD[198] = \"\".split(\"\");\nfor(j = 0; j != D[198].length; ++j) if(D[198][j].charCodeAt(0) !== 0xFFFD) { e[D[198][j]] = 50688 + j; d[50688 + j] = D[198][j];}\nD[201] = \"\".split(\"\");\nfor(j = 0; j != D[201].length; ++j) if(D[201][j].charCodeAt(0) !== 0xFFFD) { e[D[201][j]] = 51456 + j; d[51456 + j] = D[201][j];}\nD[202] = \"\".split(\"\");\nfor(j = 0; j != D[202].length; ++j) if(D[202][j].charCodeAt(0) !== 0xFFFD) { e[D[202][j]] = 51712 + j; d[51712 + j] = D[202][j];}\nD[203] = \"\".split(\"\");\nfor(j = 0; j != D[203].length; ++j) if(D[203][j].charCodeAt(0) !== 0xFFFD) { e[D[203][j]] = 51968 + j; d[51968 + j] = D[203][j];}\nD[204] = \"\".split(\"\");\nfor(j = 0; j != D[204].length; ++j) if(D[204][j].charCodeAt(0) !== 0xFFFD) { e[D[204][j]] = 52224 + j; d[52224 + j] = D[204][j];}\nD[205] = \"\".split(\"\");\nfor(j = 0; j != D[205].length; ++j) if(D[205][j].charCodeAt(0) !== 0xFFFD) { e[D[205][j]] = 52480 + j; d[52480 + j] = D[205][j];}\nD[206] = \"\".split(\"\");\nfor(j = 0; j != D[206].length; ++j) if(D[206][j].charCodeAt(0) !== 0xFFFD) { e[D[206][j]] = 52736 + j; d[52736 + j] = D[206][j];}\nD[207] = \"\".split(\"\");\nfor(j = 0; j != D[207].length; ++j) if(D[207][j].charCodeAt(0) !== 0xFFFD) { e[D[207][j]] = 52992 + j; d[52992 + j] = D[207][j];}\nD[208] = \"\".split(\"\");\nfor(j = 0; j != D[208].length; ++j) if(D[208][j].charCodeAt(0) !== 0xFFFD) { e[D[208][j]] = 53248 + j; d[53248 + j] = D[208][j];}\nD[209] = \"\".split(\"\");\nfor(j = 0; j != D[209].length; ++j) if(D[209][j].charCodeAt(0) !== 0xFFFD) { e[D[209][j]] = 53504 + j; d[53504 + j] = D[209][j];}\nD[210] = \"\".split(\"\");\nfor(j = 0; j != D[210].length; ++j) if(D[210][j].charCodeAt(0) !== 0xFFFD) { e[D[210][j]] = 53760 + j; d[53760 + j] = D[210][j];}\nD[211] = \"\".split(\"\");\nfor(j = 0; j != D[211].length; ++j) if(D[211][j].charCodeAt(0) !== 0xFFFD) { e[D[211][j]] = 54016 + j; d[54016 + j] = D[211][j];}\nD[212] = \"\".split(\"\");\nfor(j = 0; j != D[212].length; ++j) if(D[212][j].charCodeAt(0) !== 0xFFFD) { e[D[212][j]] = 54272 + j; d[54272 + j] = D[212][j];}\nD[213] = \"\".split(\"\");\nfor(j = 0; j != D[213].length; ++j) if(D[213][j].charCodeAt(0) !== 0xFFFD) { e[D[213][j]] = 54528 + j; d[54528 + j] = D[213][j];}\nD[214] = \"\".split(\"\");\nfor(j = 0; j != D[214].length; ++j) if(D[214][j].charCodeAt(0) !== 0xFFFD) { e[D[214][j]] = 54784 + j; d[54784 + j] = D[214][j];}\nD[215] = \"\".split(\"\");\nfor(j = 0; j != D[215].length; ++j) if(D[215][j].charCodeAt(0) !== 0xFFFD) { e[D[215][j]] = 55040 + j; d[55040 + j] = D[215][j];}\nD[216] = \"\".split(\"\");\nfor(j = 0; j != D[216].length; ++j) if(D[216][j].charCodeAt(0) !== 0xFFFD) { e[D[216][j]] = 55296 + j; d[55296 + j] = D[216][j];}\nD[217] = \"\".split(\"\");\nfor(j = 0; j != D[217].length; ++j) if(D[217][j].charCodeAt(0) !== 0xFFFD) { e[D[217][j]] = 55552 + j; d[55552 + j] = D[217][j];}\nD[218] = \"\".split(\"\");\nfor(j = 0; j != D[218].length; ++j) if(D[218][j].charCodeAt(0) !== 0xFFFD) { e[D[218][j]] = 55808 + j; d[55808 + j] = D[218][j];}\nD[219] = \"\".split(\"\");\nfor(j = 0; j != D[219].length; ++j) if(D[219][j].charCodeAt(0) !== 0xFFFD) { e[D[219][j]] = 56064 + j; d[56064 + j] = D[219][j];}\nD[220] = \"\".split(\"\");\nfor(j = 0; j != D[220].length; ++j) if(D[220][j].charCodeAt(0) !== 0xFFFD) { e[D[220][j]] = 56320 + j; d[56320 + j] = D[220][j];}\nD[221] = \"\".split(\"\");\nfor(j = 0; j != D[221].length; ++j) if(D[221][j].charCodeAt(0) !== 0xFFFD) { e[D[221][j]] = 56576 + j; d[56576 + j] = D[221][j];}\nD[222] = \"\".split(\"\");\nfor(j = 0; j != D[222].length; ++j) if(D[222][j].charCodeAt(0) !== 0xFFFD) { e[D[222][j]] = 56832 + j; d[56832 + j] = D[222][j];}\nD[223] = \"\".split(\"\");\nfor(j = 0; j != D[223].length; ++j) if(D[223][j].charCodeAt(0) !== 0xFFFD) { e[D[223][j]] = 57088 + j; d[57088 + j] = D[223][j];}\nD[224] = \"\".split(\"\");\nfor(j = 0; j != D[224].length; ++j) if(D[224][j].charCodeAt(0) !== 0xFFFD) { e[D[224][j]] = 57344 + j; d[57344 + j] = D[224][j];}\nD[225] = \"\".split(\"\");\nfor(j = 0; j != D[225].length; ++j) if(D[225][j].charCodeAt(0) !== 0xFFFD) { e[D[225][j]] = 57600 + j; d[57600 + j] = D[225][j];}\nD[226] = \"\".split(\"\");\nfor(j = 0; j != D[226].length; ++j) if(D[226][j].charCodeAt(0) !== 0xFFFD) { e[D[226][j]] = 57856 + j; d[57856 + j] = D[226][j];}\nD[227] = \"\".split(\"\");\nfor(j = 0; j != D[227].length; ++j) if(D[227][j].charCodeAt(0) !== 0xFFFD) { e[D[227][j]] = 58112 + j; d[58112 + j] = D[227][j];}\nD[228] = \"\".split(\"\");\nfor(j = 0; j != D[228].length; ++j) if(D[228][j].charCodeAt(0) !== 0xFFFD) { e[D[228][j]] = 58368 + j; d[58368 + j] = D[228][j];}\nD[229] = \"\".split(\"\");\nfor(j = 0; j != D[229].length; ++j) if(D[229][j].charCodeAt(0) !== 0xFFFD) { e[D[229][j]] = 58624 + j; d[58624 + j] = D[229][j];}\nD[230] = \"\".split(\"\");\nfor(j = 0; j != D[230].length; ++j) if(D[230][j].charCodeAt(0) !== 0xFFFD) { e[D[230][j]] = 58880 + j; d[58880 + j] = D[230][j];}\nD[231] = \"\".split(\"\");\nfor(j = 0; j != D[231].length; ++j) if(D[231][j].charCodeAt(0) !== 0xFFFD) { e[D[231][j]] = 59136 + j; d[59136 + j] = D[231][j];}\nD[232] = \"\".split(\"\");\nfor(j = 0; j != D[232].length; ++j) if(D[232][j].charCodeAt(0) !== 0xFFFD) { e[D[232][j]] = 59392 + j; d[59392 + j] = D[232][j];}\nD[233] = \"\".split(\"\");\nfor(j = 0; j != D[233].length; ++j) if(D[233][j].charCodeAt(0) !== 0xFFFD) { e[D[233][j]] = 59648 + j; d[59648 + j] = D[233][j];}\nD[234] = \"\".split(\"\");\nfor(j = 0; j != D[234].length; ++j) if(D[234][j].charCodeAt(0) !== 0xFFFD) { e[D[234][j]] = 59904 + j; d[59904 + j] = D[234][j];}\nD[235] = \"\".split(\"\");\nfor(j = 0; j != D[235].length; ++j) if(D[235][j].charCodeAt(0) !== 0xFFFD) { e[D[235][j]] = 60160 + j; d[60160 + j] = D[235][j];}\nD[236] = \"\".split(\"\");\nfor(j = 0; j != D[236].length; ++j) if(D[236][j].charCodeAt(0) !== 0xFFFD) { e[D[236][j]] = 60416 + j; d[60416 + j] = D[236][j];}\nD[237] = \"\".split(\"\");\nfor(j = 0; j != D[237].length; ++j) if(D[237][j].charCodeAt(0) !== 0xFFFD) { e[D[237][j]] = 60672 + j; d[60672 + j] = D[237][j];}\nD[238] = \"\".split(\"\");\nfor(j = 0; j != D[238].length; ++j) if(D[238][j].charCodeAt(0) !== 0xFFFD) { e[D[238][j]] = 60928 + j; d[60928 + j] = D[238][j];}\nD[239] = \"\".split(\"\");\nfor(j = 0; j != D[239].length; ++j) if(D[239][j].charCodeAt(0) !== 0xFFFD) { e[D[239][j]] = 61184 + j; d[61184 + j] = D[239][j];}\nD[240] = \"\".split(\"\");\nfor(j = 0; j != D[240].length; ++j) if(D[240][j].charCodeAt(0) !== 0xFFFD) { e[D[240][j]] = 61440 + j; d[61440 + j] = D[240][j];}\nD[241] = \"\".split(\"\");\nfor(j = 0; j != D[241].length; ++j) if(D[241][j].charCodeAt(0) !== 0xFFFD) { e[D[241][j]] = 61696 + j; d[61696 + j] = D[241][j];}\nD[242] = \"\".split(\"\");\nfor(j = 0; j != D[242].length; ++j) if(D[242][j].charCodeAt(0) !== 0xFFFD) { e[D[242][j]] = 61952 + j; d[61952 + j] = D[242][j];}\nD[243] = \"\".split(\"\");\nfor(j = 0; j != D[243].length; ++j) if(D[243][j].charCodeAt(0) !== 0xFFFD) { e[D[243][j]] = 62208 + j; d[62208 + j] = D[243][j];}\nD[244] = \"\".split(\"\");\nfor(j = 0; j != D[244].length; ++j) if(D[244][j].charCodeAt(0) !== 0xFFFD) { e[D[244][j]] = 62464 + j; d[62464 + j] = D[244][j];}\nD[245] = \"\".split(\"\");\nfor(j = 0; j != D[245].length; ++j) if(D[245][j].charCodeAt(0) !== 0xFFFD) { e[D[245][j]] = 62720 + j; d[62720 + j] = D[245][j];}\nD[246] = \"\".split(\"\");\nfor(j = 0; j != D[246].length; ++j) if(D[246][j].charCodeAt(0) !== 0xFFFD) { e[D[246][j]] = 62976 + j; d[62976 + j] = D[246][j];}\nD[247] = \"\".split(\"\");\nfor(j = 0; j != D[247].length; ++j) if(D[247][j].charCodeAt(0) !== 0xFFFD) { e[D[247][j]] = 63232 + j; d[63232 + j] = D[247][j];}\nD[248] = \"\".split(\"\");\nfor(j = 0; j != D[248].length; ++j) if(D[248][j].charCodeAt(0) !== 0xFFFD) { e[D[248][j]] = 63488 + j; d[63488 + j] = D[248][j];}\nD[249] = \"\".split(\"\");\nfor(j = 0; j != D[249].length; ++j) if(D[249][j].charCodeAt(0) !== 0xFFFD) { e[D[249][j]] = 63744 + j; d[63744 + j] = D[249][j];}\nreturn {\"enc\": e, \"dec\": d }; })();\ncptable[1250] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1251] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1252] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1253] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1254] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1255] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1256] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1257] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[1258] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[10000] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[10006] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[10007] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[10008] = (function(){ var d = [], e = {}, D = [], j;\nD[0] = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\".split(\"\");\nfor(j = 0; j != D[0].length; ++j) if(D[0][j].charCodeAt(0) !== 0xFFFD) { e[D[0][j]] = 0 + j; d[0 + j] = D[0][j];}\nD[161] = \"\".split(\"\");\nfor(j = 0; j != D[161].length; ++j) if(D[161][j].charCodeAt(0) !== 0xFFFD) { e[D[161][j]] = 41216 + j; d[41216 + j] = D[161][j];}\nD[162] = \"\".split(\"\");\nfor(j = 0; j != D[162].length; ++j) if(D[162][j].charCodeAt(0) !== 0xFFFD) { e[D[162][j]] = 41472 + j; d[41472 + j] = D[162][j];}\nD[163] = \"\".split(\"\");\nfor(j = 0; j != D[163].length; ++j) if(D[163][j].charCodeAt(0) !== 0xFFFD) { e[D[163][j]] = 41728 + j; d[41728 + j] = D[163][j];}\nD[164] = \"\".split(\"\");\nfor(j = 0; j != D[164].length; ++j) if(D[164][j].charCodeAt(0) !== 0xFFFD) { e[D[164][j]] = 41984 + j; d[41984 + j] = D[164][j];}\nD[165] = \"\".split(\"\");\nfor(j = 0; j != D[165].length; ++j) if(D[165][j].charCodeAt(0) !== 0xFFFD) { e[D[165][j]] = 42240 + j; d[42240 + j] = D[165][j];}\nD[166] = \"\".split(\"\");\nfor(j = 0; j != D[166].length; ++j) if(D[166][j].charCodeAt(0) !== 0xFFFD) { e[D[166][j]] = 42496 + j; d[42496 + j] = D[166][j];}\nD[167] = \"\".split(\"\");\nfor(j = 0; j != D[167].length; ++j) if(D[167][j].charCodeAt(0) !== 0xFFFD) { e[D[167][j]] = 42752 + j; d[42752 + j] = D[167][j];}\nD[168] = \"\".split(\"\");\nfor(j = 0; j != D[168].length; ++j) if(D[168][j].charCodeAt(0) !== 0xFFFD) { e[D[168][j]] = 43008 + j; d[43008 + j] = D[168][j];}\nD[169] = \"\".split(\"\");\nfor(j = 0; j != D[169].length; ++j) if(D[169][j].charCodeAt(0) !== 0xFFFD) { e[D[169][j]] = 43264 + j; d[43264 + j] = D[169][j];}\nD[176] = \"\".split(\"\");\nfor(j = 0; j != D[176].length; ++j) if(D[176][j].charCodeAt(0) !== 0xFFFD) { e[D[176][j]] = 45056 + j; d[45056 + j] = D[176][j];}\nD[177] = \"\".split(\"\");\nfor(j = 0; j != D[177].length; ++j) if(D[177][j].charCodeAt(0) !== 0xFFFD) { e[D[177][j]] = 45312 + j; d[45312 + j] = D[177][j];}\nD[178] = \"\".split(\"\");\nfor(j = 0; j != D[178].length; ++j) if(D[178][j].charCodeAt(0) !== 0xFFFD) { e[D[178][j]] = 45568 + j; d[45568 + j] = D[178][j];}\nD[179] = \"\".split(\"\");\nfor(j = 0; j != D[179].length; ++j) if(D[179][j].charCodeAt(0) !== 0xFFFD) { e[D[179][j]] = 45824 + j; d[45824 + j] = D[179][j];}\nD[180] = \"\".split(\"\");\nfor(j = 0; j != D[180].length; ++j) if(D[180][j].charCodeAt(0) !== 0xFFFD) { e[D[180][j]] = 46080 + j; d[46080 + j] = D[180][j];}\nD[181] = \"\".split(\"\");\nfor(j = 0; j != D[181].length; ++j) if(D[181][j].charCodeAt(0) !== 0xFFFD) { e[D[181][j]] = 46336 + j; d[46336 + j] = D[181][j];}\nD[182] = \"\".split(\"\");\nfor(j = 0; j != D[182].length; ++j) if(D[182][j].charCodeAt(0) !== 0xFFFD) { e[D[182][j]] = 46592 + j; d[46592 + j] = D[182][j];}\nD[183] = \"\".split(\"\");\nfor(j = 0; j != D[183].length; ++j) if(D[183][j].charCodeAt(0) !== 0xFFFD) { e[D[183][j]] = 46848 + j; d[46848 + j] = D[183][j];}\nD[184] = \"\".split(\"\");\nfor(j = 0; j != D[184].length; ++j) if(D[184][j].charCodeAt(0) !== 0xFFFD) { e[D[184][j]] = 47104 + j; d[47104 + j] = D[184][j];}\nD[185] = \"\".split(\"\");\nfor(j = 0; j != D[185].length; ++j) if(D[185][j].charCodeAt(0) !== 0xFFFD) { e[D[185][j]] = 47360 + j; d[47360 + j] = D[185][j];}\nD[186] = \"\".split(\"\");\nfor(j = 0; j != D[186].length; ++j) if(D[186][j].charCodeAt(0) !== 0xFFFD) { e[D[186][j]] = 47616 + j; d[47616 + j] = D[186][j];}\nD[187] = \"\".split(\"\");\nfor(j = 0; j != D[187].length; ++j) if(D[187][j].charCodeAt(0) !== 0xFFFD) { e[D[187][j]] = 47872 + j; d[47872 + j] = D[187][j];}\nD[188] = \"\".split(\"\");\nfor(j = 0; j != D[188].length; ++j) if(D[188][j].charCodeAt(0) !== 0xFFFD) { e[D[188][j]] = 48128 + j; d[48128 + j] = D[188][j];}\nD[189] = \"\".split(\"\");\nfor(j = 0; j != D[189].length; ++j) if(D[189][j].charCodeAt(0) !== 0xFFFD) { e[D[189][j]] = 48384 + j; d[48384 + j] = D[189][j];}\nD[190] = \"\".split(\"\");\nfor(j = 0; j != D[190].length; ++j) if(D[190][j].charCodeAt(0) !== 0xFFFD) { e[D[190][j]] = 48640 + j; d[48640 + j] = D[190][j];}\nD[191] = \"\".split(\"\");\nfor(j = 0; j != D[191].length; ++j) if(D[191][j].charCodeAt(0) !== 0xFFFD) { e[D[191][j]] = 48896 + j; d[48896 + j] = D[191][j];}\nD[192] = \"\".split(\"\");\nfor(j = 0; j != D[192].length; ++j) if(D[192][j].charCodeAt(0) !== 0xFFFD) { e[D[192][j]] = 49152 + j; d[49152 + j] = D[192][j];}\nD[193] = \"\".split(\"\");\nfor(j = 0; j != D[193].length; ++j) if(D[193][j].charCodeAt(0) !== 0xFFFD) { e[D[193][j]] = 49408 + j; d[49408 + j] = D[193][j];}\nD[194] = \"\".split(\"\");\nfor(j = 0; j != D[194].length; ++j) if(D[194][j].charCodeAt(0) !== 0xFFFD) { e[D[194][j]] = 49664 + j; d[49664 + j] = D[194][j];}\nD[195] = \"\".split(\"\");\nfor(j = 0; j != D[195].length; ++j) if(D[195][j].charCodeAt(0) !== 0xFFFD) { e[D[195][j]] = 49920 + j; d[49920 + j] = D[195][j];}\nD[196] = \"\".split(\"\");\nfor(j = 0; j != D[196].length; ++j) if(D[196][j].charCodeAt(0) !== 0xFFFD) { e[D[196][j]] = 50176 + j; d[50176 + j] = D[196][j];}\nD[197] = \"\".split(\"\");\nfor(j = 0; j != D[197].length; ++j) if(D[197][j].charCodeAt(0) !== 0xFFFD) { e[D[197][j]] = 50432 + j; d[50432 + j] = D[197][j];}\nD[198] = \"\".split(\"\");\nfor(j = 0; j != D[198].length; ++j) if(D[198][j].charCodeAt(0) !== 0xFFFD) { e[D[198][j]] = 50688 + j; d[50688 + j] = D[198][j];}\nD[199] = \"\".split(\"\");\nfor(j = 0; j != D[199].length; ++j) if(D[199][j].charCodeAt(0) !== 0xFFFD) { e[D[199][j]] = 50944 + j; d[50944 + j] = D[199][j];}\nD[200] = \"\".split(\"\");\nfor(j = 0; j != D[200].length; ++j) if(D[200][j].charCodeAt(0) !== 0xFFFD) { e[D[200][j]] = 51200 + j; d[51200 + j] = D[200][j];}\nD[201] = \"\".split(\"\");\nfor(j = 0; j != D[201].length; ++j) if(D[201][j].charCodeAt(0) !== 0xFFFD) { e[D[201][j]] = 51456 + j; d[51456 + j] = D[201][j];}\nD[202] = \"\".split(\"\");\nfor(j = 0; j != D[202].length; ++j) if(D[202][j].charCodeAt(0) !== 0xFFFD) { e[D[202][j]] = 51712 + j; d[51712 + j] = D[202][j];}\nD[203] = \"\".split(\"\");\nfor(j = 0; j != D[203].length; ++j) if(D[203][j].charCodeAt(0) !== 0xFFFD) { e[D[203][j]] = 51968 + j; d[51968 + j] = D[203][j];}\nD[204] = \"\".split(\"\");\nfor(j = 0; j != D[204].length; ++j) if(D[204][j].charCodeAt(0) !== 0xFFFD) { e[D[204][j]] = 52224 + j; d[52224 + j] = D[204][j];}\nD[205] = \"\".split(\"\");\nfor(j = 0; j != D[205].length; ++j) if(D[205][j].charCodeAt(0) !== 0xFFFD) { e[D[205][j]] = 52480 + j; d[52480 + j] = D[205][j];}\nD[206] = \"\".split(\"\");\nfor(j = 0; j != D[206].length; ++j) if(D[206][j].charCodeAt(0) !== 0xFFFD) { e[D[206][j]] = 52736 + j; d[52736 + j] = D[206][j];}\nD[207] = \"\".split(\"\");\nfor(j = 0; j != D[207].length; ++j) if(D[207][j].charCodeAt(0) !== 0xFFFD) { e[D[207][j]] = 52992 + j; d[52992 + j] = D[207][j];}\nD[208] = \"\".split(\"\");\nfor(j = 0; j != D[208].length; ++j) if(D[208][j].charCodeAt(0) !== 0xFFFD) { e[D[208][j]] = 53248 + j; d[53248 + j] = D[208][j];}\nD[209] = \"\".split(\"\");\nfor(j = 0; j != D[209].length; ++j) if(D[209][j].charCodeAt(0) !== 0xFFFD) { e[D[209][j]] = 53504 + j; d[53504 + j] = D[209][j];}\nD[210] = \"\".split(\"\");\nfor(j = 0; j != D[210].length; ++j) if(D[210][j].charCodeAt(0) !== 0xFFFD) { e[D[210][j]] = 53760 + j; d[53760 + j] = D[210][j];}\nD[211] = \"\".split(\"\");\nfor(j = 0; j != D[211].length; ++j) if(D[211][j].charCodeAt(0) !== 0xFFFD) { e[D[211][j]] = 54016 + j; d[54016 + j] = D[211][j];}\nD[212] = \"\".split(\"\");\nfor(j = 0; j != D[212].length; ++j) if(D[212][j].charCodeAt(0) !== 0xFFFD) { e[D[212][j]] = 54272 + j; d[54272 + j] = D[212][j];}\nD[213] = \"\".split(\"\");\nfor(j = 0; j != D[213].length; ++j) if(D[213][j].charCodeAt(0) !== 0xFFFD) { e[D[213][j]] = 54528 + j; d[54528 + j] = D[213][j];}\nD[214] = \"\".split(\"\");\nfor(j = 0; j != D[214].length; ++j) if(D[214][j].charCodeAt(0) !== 0xFFFD) { e[D[214][j]] = 54784 + j; d[54784 + j] = D[214][j];}\nD[215] = \"\".split(\"\");\nfor(j = 0; j != D[215].length; ++j) if(D[215][j].charCodeAt(0) !== 0xFFFD) { e[D[215][j]] = 55040 + j; d[55040 + j] = D[215][j];}\nD[216] = \"\".split(\"\");\nfor(j = 0; j != D[216].length; ++j) if(D[216][j].charCodeAt(0) !== 0xFFFD) { e[D[216][j]] = 55296 + j; d[55296 + j] = D[216][j];}\nD[217] = \"\".split(\"\");\nfor(j = 0; j != D[217].length; ++j) if(D[217][j].charCodeAt(0) !== 0xFFFD) { e[D[217][j]] = 55552 + j; d[55552 + j] = D[217][j];}\nD[218] = \"\".split(\"\");\nfor(j = 0; j != D[218].length; ++j) if(D[218][j].charCodeAt(0) !== 0xFFFD) { e[D[218][j]] = 55808 + j; d[55808 + j] = D[218][j];}\nD[219] = \"\".split(\"\");\nfor(j = 0; j != D[219].length; ++j) if(D[219][j].charCodeAt(0) !== 0xFFFD) { e[D[219][j]] = 56064 + j; d[56064 + j] = D[219][j];}\nD[220] = \"\".split(\"\");\nfor(j = 0; j != D[220].length; ++j) if(D[220][j].charCodeAt(0) !== 0xFFFD) { e[D[220][j]] = 56320 + j; d[56320 + j] = D[220][j];}\nD[221] = \"\".split(\"\");\nfor(j = 0; j != D[221].length; ++j) if(D[221][j].charCodeAt(0) !== 0xFFFD) { e[D[221][j]] = 56576 + j; d[56576 + j] = D[221][j];}\nD[222] = \"\".split(\"\");\nfor(j = 0; j != D[222].length; ++j) if(D[222][j].charCodeAt(0) !== 0xFFFD) { e[D[222][j]] = 56832 + j; d[56832 + j] = D[222][j];}\nD[223] = \"\".split(\"\");\nfor(j = 0; j != D[223].length; ++j) if(D[223][j].charCodeAt(0) !== 0xFFFD) { e[D[223][j]] = 57088 + j; d[57088 + j] = D[223][j];}\nD[224] = \"\".split(\"\");\nfor(j = 0; j != D[224].length; ++j) if(D[224][j].charCodeAt(0) !== 0xFFFD) { e[D[224][j]] = 57344 + j; d[57344 + j] = D[224][j];}\nD[225] = \"\".split(\"\");\nfor(j = 0; j != D[225].length; ++j) if(D[225][j].charCodeAt(0) !== 0xFFFD) { e[D[225][j]] = 57600 + j; d[57600 + j] = D[225][j];}\nD[226] = \"\".split(\"\");\nfor(j = 0; j != D[226].length; ++j) if(D[226][j].charCodeAt(0) !== 0xFFFD) { e[D[226][j]] = 57856 + j; d[57856 + j] = D[226][j];}\nD[227] = \"\".split(\"\");\nfor(j = 0; j != D[227].length; ++j) if(D[227][j].charCodeAt(0) !== 0xFFFD) { e[D[227][j]] = 58112 + j; d[58112 + j] = D[227][j];}\nD[228] = \"\".split(\"\");\nfor(j = 0; j != D[228].length; ++j) if(D[228][j].charCodeAt(0) !== 0xFFFD) { e[D[228][j]] = 58368 + j; d[58368 + j] = D[228][j];}\nD[229] = \"\".split(\"\");\nfor(j = 0; j != D[229].length; ++j) if(D[229][j].charCodeAt(0) !== 0xFFFD) { e[D[229][j]] = 58624 + j; d[58624 + j] = D[229][j];}\nD[230] = \"\".split(\"\");\nfor(j = 0; j != D[230].length; ++j) if(D[230][j].charCodeAt(0) !== 0xFFFD) { e[D[230][j]] = 58880 + j; d[58880 + j] = D[230][j];}\nD[231] = \"\".split(\"\");\nfor(j = 0; j != D[231].length; ++j) if(D[231][j].charCodeAt(0) !== 0xFFFD) { e[D[231][j]] = 59136 + j; d[59136 + j] = D[231][j];}\nD[232] = \"\".split(\"\");\nfor(j = 0; j != D[232].length; ++j) if(D[232][j].charCodeAt(0) !== 0xFFFD) { e[D[232][j]] = 59392 + j; d[59392 + j] = D[232][j];}\nD[233] = \"\".split(\"\");\nfor(j = 0; j != D[233].length; ++j) if(D[233][j].charCodeAt(0) !== 0xFFFD) { e[D[233][j]] = 59648 + j; d[59648 + j] = D[233][j];}\nD[234] = \"\".split(\"\");\nfor(j = 0; j != D[234].length; ++j) if(D[234][j].charCodeAt(0) !== 0xFFFD) { e[D[234][j]] = 59904 + j; d[59904 + j] = D[234][j];}\nD[235] = \"\".split(\"\");\nfor(j = 0; j != D[235].length; ++j) if(D[235][j].charCodeAt(0) !== 0xFFFD) { e[D[235][j]] = 60160 + j; d[60160 + j] = D[235][j];}\nD[236] = \"\".split(\"\");\nfor(j = 0; j != D[236].length; ++j) if(D[236][j].charCodeAt(0) !== 0xFFFD) { e[D[236][j]] = 60416 + j; d[60416 + j] = D[236][j];}\nD[237] = \"\".split(\"\");\nfor(j = 0; j != D[237].length; ++j) if(D[237][j].charCodeAt(0) !== 0xFFFD) { e[D[237][j]] = 60672 + j; d[60672 + j] = D[237][j];}\nD[238] = \"\".split(\"\");\nfor(j = 0; j != D[238].length; ++j) if(D[238][j].charCodeAt(0) !== 0xFFFD) { e[D[238][j]] = 60928 + j; d[60928 + j] = D[238][j];}\nD[239] = \"\".split(\"\");\nfor(j = 0; j != D[239].length; ++j) if(D[239][j].charCodeAt(0) !== 0xFFFD) { e[D[239][j]] = 61184 + j; d[61184 + j] = D[239][j];}\nD[240] = \"\".split(\"\");\nfor(j = 0; j != D[240].length; ++j) if(D[240][j].charCodeAt(0) !== 0xFFFD) { e[D[240][j]] = 61440 + j; d[61440 + j] = D[240][j];}\nD[241] = \"\".split(\"\");\nfor(j = 0; j != D[241].length; ++j) if(D[241][j].charCodeAt(0) !== 0xFFFD) { e[D[241][j]] = 61696 + j; d[61696 + j] = D[241][j];}\nD[242] = \"\".split(\"\");\nfor(j = 0; j != D[242].length; ++j) if(D[242][j].charCodeAt(0) !== 0xFFFD) { e[D[242][j]] = 61952 + j; d[61952 + j] = D[242][j];}\nD[243] = \"\".split(\"\");\nfor(j = 0; j != D[243].length; ++j) if(D[243][j].charCodeAt(0) !== 0xFFFD) { e[D[243][j]] = 62208 + j; d[62208 + j] = D[243][j];}\nD[244] = \"\".split(\"\");\nfor(j = 0; j != D[244].length; ++j) if(D[244][j].charCodeAt(0) !== 0xFFFD) { e[D[244][j]] = 62464 + j; d[62464 + j] = D[244][j];}\nD[245] = \"\".split(\"\");\nfor(j = 0; j != D[245].length; ++j) if(D[245][j].charCodeAt(0) !== 0xFFFD) { e[D[245][j]] = 62720 + j; d[62720 + j] = D[245][j];}\nD[246] = \"\".split(\"\");\nfor(j = 0; j != D[246].length; ++j) if(D[246][j].charCodeAt(0) !== 0xFFFD) { e[D[246][j]] = 62976 + j; d[62976 + j] = D[246][j];}\nD[247] = \"\".split(\"\");\nfor(j = 0; j != D[247].length; ++j) if(D[247][j].charCodeAt(0) !== 0xFFFD) { e[D[247][j]] = 63232 + j; d[63232 + j] = D[247][j];}\nreturn {\"enc\": e, \"dec\": d }; })();\ncptable[10029] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[10079] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[10081] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\ncptable[28591] = (function(){ var d = \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\", D = [], e = {}; for(var i=0;i!=d.length;++i) { if(d.charCodeAt(i) !== 0xFFFD) e[d.charAt(i)] = i; D[i] = d.charAt(i); } return {\"enc\": e, \"dec\": D }; })();\n// eslint-disable-next-line no-undef\nif (typeof module !== 'undefined' && module.exports && typeof DO_NOT_EXPORT_CODEPAGE === 'undefined') module.exports = cptable;\n/*! cputils.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ft=javascript: */\n/*jshint newcap: false */\n(function(root, factory) {\n  /*jshint ignore:start */\n  /*eslint-disable */\n  \"use strict\";\n  if(typeof cptable === \"undefined\") {\n    if(typeof require !== \"undefined\"){\n      var cpt = cptable;\n      if (typeof module !== 'undefined' && module.exports && typeof DO_NOT_EXPORT_CODEPAGE === 'undefined') module.exports = factory(cpt);\n      else root.cptable = factory(cpt);\n    } else throw new Error(\"cptable not found\");\n  } else cptable = factory(cptable);\n  /*eslint-enable */\n  /*jshint ignore:end */\n}(this, function(cpt){\n  \"use strict\";\n  /*global module, Buffer */\n  var magic = {\n    \"1200\":\"utf16le\",\n    \"1201\":\"utf16be\",\n    \"12000\":\"utf32le\",\n    \"12001\":\"utf32be\",\n    \"16969\":\"utf64le\",\n    \"20127\":\"ascii\",\n    \"65000\":\"utf7\",\n    \"65001\":\"utf8\"\n  };\n\n  var sbcs_cache = [874,1250,1251,1252,1253,1254,1255,1256,10000];\n  var dbcs_cache = [932,936,949,950];\n  var magic_cache = [65001];\n  var magic_decode = {};\n  var magic_encode = {};\n  var cpdcache = {};\n  var cpecache = {};\n\n  var sfcc = function sfcc(x) { return String.fromCharCode(x); };\n  var cca = function cca(x) { return x.charCodeAt(0); };\n\n  var has_buf = (typeof Buffer !== 'undefined');\n  var Buffer_from = function(){};\n  if(has_buf) {\n    var nbfs = !Buffer.from;\n    if(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\n    Buffer_from = nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\n    // $FlowIgnore\n    if(!Buffer.allocUnsafe) Buffer.allocUnsafe = function(n) { return new Buffer(n); };\n\n    var mdl = 1024, mdb = Buffer.allocUnsafe(mdl);\n    var make_EE = function make_EE(E){\n      var EE = Buffer.allocUnsafe(65536);\n      for(var i = 0; i < 65536;++i) EE[i] = 0;\n      var keys = Object.keys(E), len = keys.length;\n      for(var ee = 0, e = keys[ee]; ee < len; ++ee) {\n        if(!(e = keys[ee])) continue;\n        EE[e.charCodeAt(0)] = E[e];\n      }\n      return EE;\n    };\n    var sbcs_encode = function make_sbcs_encode(cp) {\n      var EE = make_EE(cpt[cp].enc);\n      return function sbcs_e(data, ofmt) {\n        var len = data.length;\n        var out, i=0, j=0, D=0, w=0;\n        if(typeof data === 'string') {\n          out = Buffer.allocUnsafe(len);\n          for(i = 0; i < len; ++i) out[i] = EE[data.charCodeAt(i)];\n        } else if(Buffer.isBuffer(data)) {\n          out = Buffer.allocUnsafe(2*len);\n          j = 0;\n          for(i = 0; i < len; ++i) {\n            D = data[i];\n            if(D < 128) out[j++] = EE[D];\n            else if(D < 224) { out[j++] = EE[((D&31)<<6)+(data[i+1]&63)]; ++i; }\n            else if(D < 240) { out[j++] = EE[((D&15)<<12)+((data[i+1]&63)<<6)+(data[i+2]&63)]; i+=2; }\n            else {\n              w = ((D&7)<<18)+((data[i+1]&63)<<12)+((data[i+2]&63)<<6)+(data[i+3]&63); i+=3;\n              if(w < 65536) out[j++] = EE[w];\n              else { w -= 65536; out[j++] = EE[0xD800 + ((w>>10)&1023)]; out[j++] = EE[0xDC00 + (w&1023)]; }\n            }\n          }\n          out = out.slice(0,j);\n        } else {\n          out = Buffer.allocUnsafe(len);\n          for(i = 0; i < len; ++i) out[i] = EE[data[i].charCodeAt(0)];\n        }\n        if(!ofmt || ofmt === 'buf') return out;\n        if(ofmt !== 'arr') return out.toString('binary');\n        return [].slice.call(out);\n      };\n    };\n    var sbcs_decode = function make_sbcs_decode(cp) {\n      var D = cpt[cp].dec;\n      var DD = Buffer.allocUnsafe(131072), d=0, c=\"\";\n      for(d=0;d<D.length;++d) {\n        if(!(c=D[d])) continue;\n        var w = c.charCodeAt(0);\n        DD[2*d] = w&255; DD[2*d+1] = w>>8;\n      }\n      return function sbcs_d(data) {\n        var len = data.length, i=0, j=0;\n        if(2 * len > mdl) { mdl = 2 * len; mdb = Buffer.allocUnsafe(mdl); }\n        if(Buffer.isBuffer(data)) {\n          for(i = 0; i < len; i++) {\n            j = 2*data[i];\n            mdb[2*i] = DD[j]; mdb[2*i+1] = DD[j+1];\n          }\n        } else if(typeof data === \"string\") {\n          for(i = 0; i < len; i++) {\n            j = 2*data.charCodeAt(i);\n            mdb[2*i] = DD[j]; mdb[2*i+1] = DD[j+1];\n          }\n        } else {\n          for(i = 0; i < len; i++) {\n            j = 2*data[i];\n            mdb[2*i] = DD[j]; mdb[2*i+1] = DD[j+1];\n          }\n        }\n        return mdb.slice(0, 2 * len).toString('ucs2');\n      };\n    };\n    var dbcs_encode = function make_dbcs_encode(cp) {\n      var E = cpt[cp].enc;\n      var EE = Buffer.allocUnsafe(131072);\n      for(var i = 0; i < 131072; ++i) EE[i] = 0;\n      var keys = Object.keys(E);\n      for(var ee = 0, e = keys[ee]; ee < keys.length; ++ee) {\n        if(!(e = keys[ee])) continue;\n        var f = e.charCodeAt(0);\n        EE[2*f] = E[e] & 255; EE[2*f+1] = E[e]>>8;\n      }\n      return function dbcs_e(data, ofmt) {\n        var len = data.length, out = Buffer.allocUnsafe(2*len), i=0, j=0, jj=0, k=0, D=0;\n        if(typeof data === 'string') {\n          for(i = k = 0; i < len; ++i) {\n            j = data.charCodeAt(i)*2;\n            out[k++] = EE[j+1] || EE[j]; if(EE[j+1] > 0) out[k++] = EE[j];\n          }\n          out = out.slice(0,k);\n        } else if(Buffer.isBuffer(data)) {\n          for(i = k = 0; i < len; ++i) {\n            D = data[i];\n            if(D < 128) j = D;\n            else if(D < 224) { j = ((D&31)<<6)+(data[i+1]&63); ++i; }\n            else if(D < 240) { j = ((D&15)<<12)+((data[i+1]&63)<<6)+(data[i+2]&63); i+=2; }\n            else { j = ((D&7)<<18)+((data[i+1]&63)<<12)+((data[i+2]&63)<<6)+(data[i+3]&63); i+=3; }\n            if(j<65536) { j*=2; out[k++] = EE[j+1] || EE[j]; if(EE[j+1] > 0) out[k++] = EE[j]; }\n            else { jj = j-65536;\n              j=2*(0xD800 + ((jj>>10)&1023)); out[k++] = EE[j+1] || EE[j]; if(EE[j+1] > 0) out[k++] = EE[j];\n              j=2*(0xDC00 + (jj&1023)); out[k++] = EE[j+1] || EE[j]; if(EE[j+1] > 0) out[k++] = EE[j];\n            }\n          }\n          out = out.slice(0,k);\n        } else {\n          for(i = k = 0; i < len; i++) {\n            j = data[i].charCodeAt(0)*2;\n            out[k++] = EE[j+1] || EE[j]; if(EE[j+1] > 0) out[k++] = EE[j];\n          }\n        }\n        if(!ofmt || ofmt === 'buf') return out;\n        if(ofmt !== 'arr') return out.toString('binary');\n        return [].slice.call(out);\n      };\n    };\n    var dbcs_decode = function make_dbcs_decode(cp) {\n      var D = cpt[cp].dec;\n      var DD = Buffer.allocUnsafe(131072), d=0, c, w=0, j=0, i=0;\n      for(i = 0; i < 65536; ++i) { DD[2*i] = 0xFF; DD[2*i+1] = 0xFD;}\n      for(d = 0; d < D.length; ++d) {\n        if(!(c=D[d])) continue;\n        w = c.charCodeAt(0);\n        j = 2*d;\n        DD[j] = w&255; DD[j+1] = w>>8;\n      }\n      return function dbcs_d(data) {\n        var len = data.length, out = Buffer.allocUnsafe(2*len), i=0, j=0, k=0;\n        if(Buffer.isBuffer(data)) {\n          for(i = 0; i < len; i++) {\n            j = 2*data[i];\n            if(DD[j]===0xFF && DD[j+1]===0xFD) { j=2*((data[i]<<8)+data[i+1]); ++i; }\n            out[k++] = DD[j]; out[k++] = DD[j+1];\n          }\n        } else if(typeof data === \"string\") {\n          for(i = 0; i < len; i++) {\n            j = 2*data.charCodeAt(i);\n            if(DD[j]===0xFF && DD[j+1]===0xFD) { j=2*((data.charCodeAt(i)<<8)+data.charCodeAt(i+1)); ++i; }\n            out[k++] = DD[j]; out[k++] = DD[j+1];\n          }\n        } else {\n          for(i = 0; i < len; i++) {\n            j = 2*data[i];\n            if(DD[j]===0xFF && DD[j+1]===0xFD) { j=2*((data[i]<<8)+data[i+1]); ++i; }\n            out[k++] = DD[j]; out[k++] = DD[j+1];\n          }\n        }\n        return out.slice(0,k).toString('ucs2');\n      };\n    };\n    magic_decode[65001] = function utf8_d(data) {\n      if(typeof data === \"string\") return utf8_d(data.split(\"\").map(cca));\n      var len = data.length, w = 0, ww = 0;\n      if(4 * len > mdl) { mdl = 4 * len; mdb = Buffer.allocUnsafe(mdl); }\n      var i = 0;\n      if(len >= 3 && data[0] == 0xEF) if(data[1] == 0xBB && data[2] == 0xBF) i = 3;\n      for(var j = 1, k = 0, D = 0; i < len; i+=j) {\n        j = 1; D = data[i];\n        if(D < 128) w = D;\n        else if(D < 224) { w=(D&31)*64+(data[i+1]&63); j=2; }\n        else if(D < 240) { w=((D&15)<<12)+(data[i+1]&63)*64+(data[i+2]&63); j=3; }\n        else { w=(D&7)*262144+((data[i+1]&63)<<12)+(data[i+2]&63)*64+(data[i+3]&63); j=4; }\n        if(w < 65536) { mdb[k++] = w&255; mdb[k++] = w>>8; }\n        else {\n          w -= 65536; ww = 0xD800 + ((w>>10)&1023); w = 0xDC00 + (w&1023);\n          mdb[k++] = ww&255; mdb[k++] = ww>>>8; mdb[k++] = w&255; mdb[k++] = (w>>>8)&255;\n        }\n      }\n      return mdb.slice(0,k).toString('ucs2');\n    };\n    magic_encode[65001] = function utf8_e(data, ofmt) {\n      if(has_buf && Buffer.isBuffer(data)) {\n        if(!ofmt || ofmt === 'buf') return data;\n        if(ofmt !== 'arr') return data.toString('binary');\n        return [].slice.call(data);\n      }\n      var len = data.length, w = 0, ww = 0, j = 0;\n      var direct = typeof data === \"string\";\n      if(4 * len > mdl) { mdl = 4 * len; mdb = Buffer.allocUnsafe(mdl); }\n      for(var i = 0; i < len; ++i) {\n        w = direct ? data.charCodeAt(i) : data[i].charCodeAt(0);\n        if(w <= 0x007F) mdb[j++] = w;\n        else if(w <= 0x07FF) {\n          mdb[j++] = 192 + (w >> 6);\n          mdb[j++] = 128 + (w&63);\n        } else if(w >= 0xD800 && w <= 0xDFFF) {\n          w -= 0xD800; ++i;\n          ww = (direct ? data.charCodeAt(i) : data[i].charCodeAt(0)) - 0xDC00 + (w << 10);\n          mdb[j++] = 240 + ((ww>>>18) & 0x07);\n          mdb[j++] = 144 + ((ww>>>12) & 0x3F);\n          mdb[j++] = 128 + ((ww>>>6) & 0x3F);\n          mdb[j++] = 128 + (ww & 0x3F);\n        } else {\n          mdb[j++] = 224 + (w >> 12);\n          mdb[j++] = 128 + ((w >> 6)&63);\n          mdb[j++] = 128 + (w&63);\n        }\n      }\n      if(!ofmt || ofmt === 'buf') return mdb.slice(0,j);\n      if(ofmt !== 'arr') return mdb.slice(0,j).toString('binary');\n      return [].slice.call(mdb, 0, j);\n    };\n  }\n\n  var encache = function encache() {\n    if(has_buf) {\n      if(cpdcache[sbcs_cache[0]]) return;\n      var i=0, s=0;\n      for(i = 0; i < sbcs_cache.length; ++i) {\n        s = sbcs_cache[i];\n        if(cpt[s]) {\n          cpdcache[s] = sbcs_decode(s);\n          cpecache[s] = sbcs_encode(s);\n        }\n      }\n      for(i = 0; i < dbcs_cache.length; ++i) {\n        s = dbcs_cache[i];\n        if(cpt[s]) {\n          cpdcache[s] = dbcs_decode(s);\n          cpecache[s] = dbcs_encode(s);\n        }\n      }\n      for(i = 0; i < magic_cache.length; ++i) {\n        s = magic_cache[i];\n        if(magic_decode[s]) cpdcache[s] = magic_decode[s];\n        if(magic_encode[s]) cpecache[s] = magic_encode[s];\n      }\n    }\n  };\n  var null_enc = function(data, ofmt) { void ofmt; return \"\"; };\n  var cp_decache = function cp_decache(cp) { delete cpdcache[cp]; delete cpecache[cp]; };\n  var decache = function decache() {\n    if(has_buf) {\n      if(!cpdcache[sbcs_cache[0]]) return;\n      sbcs_cache.forEach(cp_decache);\n      dbcs_cache.forEach(cp_decache);\n      magic_cache.forEach(cp_decache);\n    }\n    last_enc = null_enc; last_cp = 0;\n  };\n  var cache = {\n    encache: encache,\n    decache: decache,\n    sbcs: sbcs_cache,\n    dbcs: dbcs_cache\n  };\n\n  encache();\n\n  var BM = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n  var SetD = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?\";\n  var last_enc = null_enc, last_cp = 0;\n  var encode = function encode(cp, data, ofmt) {\n    if(cp === last_cp && last_enc) { return last_enc(data, ofmt); }\n    if(cpecache[cp]) { last_enc = cpecache[last_cp=cp]; return last_enc(data, ofmt); }\n    if(has_buf && Buffer.isBuffer(data)) data = data.toString('utf8');\n    var len = data.length;\n    var out = has_buf ? Buffer.allocUnsafe(4*len) : [], w=0, i=0, j = 0, ww=0;\n    var C = cpt[cp], E, M = \"\";\n    var isstr = typeof data === 'string';\n    if(C && (E=C.enc)) for(i = 0; i < len; ++i, ++j) {\n      w = E[isstr? data.charAt(i) : data[i]];\n      if(w > 255) {\n        out[j] = w>>8;\n        out[++j] = w&255;\n      } else out[j] = w&255;\n    }\n    else if((M=magic[cp])) switch(M) {\n      case \"utf8\":\n        if(has_buf && isstr) { out = Buffer_from(data, M); j = out.length; break; }\n        for(i = 0; i < len; ++i, ++j) {\n          w = isstr ? data.charCodeAt(i) : data[i].charCodeAt(0);\n          if(w <= 0x007F) out[j] = w;\n          else if(w <= 0x07FF) {\n            out[j]   = 192 + (w >> 6);\n            out[++j] = 128 + (w&63);\n          } else if(w >= 0xD800 && w <= 0xDFFF) {\n            w -= 0xD800;\n            ww = (isstr ? data.charCodeAt(++i) : data[++i].charCodeAt(0)) - 0xDC00 + (w << 10);\n            out[j]   = 240 + ((ww>>>18) & 0x07);\n            out[++j] = 144 + ((ww>>>12) & 0x3F);\n            out[++j] = 128 + ((ww>>>6) & 0x3F);\n            out[++j] = 128 + (ww & 0x3F);\n          } else {\n            out[j]   = 224 + (w >> 12);\n            out[++j] = 128 + ((w >> 6)&63);\n            out[++j] = 128 + (w&63);\n          }\n        }\n        break;\n      case \"ascii\":\n        if(has_buf && typeof data === \"string\") { out = Buffer_from(data, M); j = out.length; break; }\n        for(i = 0; i < len; ++i, ++j) {\n          w = isstr ? data.charCodeAt(i) : data[i].charCodeAt(0);\n          if(w <= 0x007F) out[j] = w;\n          else throw new Error(\"bad ascii \" + w);\n        }\n        break;\n      case \"utf16le\":\n        if(has_buf && typeof data === \"string\") { out = Buffer_from(data, M); j = out.length; break; }\n        for(i = 0; i < len; ++i) {\n          w = isstr ? data.charCodeAt(i) : data[i].charCodeAt(0);\n          out[j++] = w&255;\n          out[j++] = w>>8;\n        }\n        break;\n      case \"utf16be\":\n        for(i = 0; i < len; ++i) {\n          w = isstr ? data.charCodeAt(i) : data[i].charCodeAt(0);\n          out[j++] = w>>8;\n          out[j++] = w&255;\n        }\n        break;\n      case \"utf32le\":\n        for(i = 0; i < len; ++i) {\n          w = isstr ? data.charCodeAt(i) : data[i].charCodeAt(0);\n          if(w >= 0xD800 && w <= 0xDFFF) w = 0x10000 + ((w - 0xD800) << 10) + (data[++i].charCodeAt(0) - 0xDC00);\n          out[j++] = w&255; w >>= 8;\n          out[j++] = w&255; w >>= 8;\n          out[j++] = w&255; w >>= 8;\n          out[j++] = w&255;\n        }\n        break;\n      case \"utf32be\":\n        for(i = 0; i < len; ++i) {\n          w = isstr ? data.charCodeAt(i) : data[i].charCodeAt(0);\n          if(w >= 0xD800 && w <= 0xDFFF) w = 0x10000 + ((w - 0xD800) << 10) + (data[++i].charCodeAt(0) - 0xDC00);\n          out[j+3] = w&255; w >>= 8;\n          out[j+2] = w&255; w >>= 8;\n          out[j+1] = w&255; w >>= 8;\n          out[j] = w&255;\n          j+=4;\n        }\n        break;\n      case \"utf7\":\n        for(i = 0; i < len; i++) {\n          var c = isstr ? data.charAt(i) : data[i].charAt(0);\n          if(c === \"+\") { out[j++] = 0x2b; out[j++] = 0x2d; continue; }\n          if(SetD.indexOf(c) > -1) { out[j++] = c.charCodeAt(0); continue; }\n          var tt = encode(1201, c);\n          out[j++] = 0x2b;\n          out[j++] = BM.charCodeAt(tt[0]>>2);\n          out[j++] = BM.charCodeAt(((tt[0]&0x03)<<4) + ((tt[1]||0)>>4));\n          out[j++] = BM.charCodeAt(((tt[1]&0x0F)<<2) + ((tt[2]||0)>>6));\n          out[j++] = 0x2d;\n        }\n        break;\n      default: throw new Error(\"Unsupported magic: \" + cp + \" \" + magic[cp]);\n    }\n    else throw new Error(\"Unrecognized CP: \" + cp);\n    out = out.slice(0,j);\n    if(!has_buf) return (ofmt == 'str') ? (out).map(sfcc).join(\"\") : out;\n    if(!ofmt || ofmt === 'buf') return out;\n    if(ofmt !== 'arr') return out.toString('binary');\n    return [].slice.call(out);\n  };\n  var decode = function decode(cp, data) {\n    var F; if((F=cpdcache[cp])) return F(data);\n    if(typeof data === \"string\") return decode(cp, data.split(\"\").map(cca));\n    var len = data.length, out = new Array(len), s=\"\", w=0, i=0, j=1, k=0, ww=0;\n    var C = cpt[cp], D, M=\"\";\n    if(C && (D=C.dec)) {\n      for(i = 0; i < len; i+=j) {\n        j = 2;\n        s = D[(data[i]<<8)+ data[i+1]];\n        if(!s) {\n          j = 1;\n          s = D[data[i]];\n        }\n        if(!s) throw new Error('Unrecognized code: ' + data[i] + ' ' + data[i+j-1] + ' ' + i + ' ' + j + ' ' + D[data[i]]);\n        out[k++] = s;\n      }\n    }\n    else if((M=magic[cp])) switch(M) {\n      case \"utf8\":\n        if(len >= 3 && data[0] == 0xEF) if(data[1] == 0xBB && data[2] == 0xBF) i = 3;\n        for(; i < len; i+=j) {\n          j = 1;\n          if(data[i] < 128) w = data[i];\n          else if(data[i] < 224) { w=(data[i]&31)*64+(data[i+1]&63); j=2; }\n          else if(data[i] < 240) { w=((data[i]&15)<<12)+(data[i+1]&63)*64+(data[i+2]&63); j=3; }\n          else { w=(data[i]&7)*262144+((data[i+1]&63)<<12)+(data[i+2]&63)*64+(data[i+3]&63); j=4; }\n          if(w < 65536) { out[k++] = String.fromCharCode(w); }\n          else {\n            w -= 65536; ww = 0xD800 + ((w>>10)&1023); w = 0xDC00 + (w&1023);\n            out[k++] = String.fromCharCode(ww); out[k++] = String.fromCharCode(w);\n          }\n        }\n        break;\n      case \"ascii\":\n        if(has_buf && Buffer.isBuffer(data)) return data.toString(M);\n        for(i = 0; i < len; i++) out[i] = String.fromCharCode(data[i]);\n        k = len; break;\n      case \"utf16le\":\n        if(len >= 2 && data[0] == 0xFF) if(data[1] == 0xFE) i = 2;\n        if(has_buf && Buffer.isBuffer(data)) return data.toString(M);\n        j = 2;\n        for(; i+1 < len; i+=j) {\n          out[k++] = String.fromCharCode((data[i+1]<<8) + data[i]);\n        }\n        break;\n      case \"utf16be\":\n        if(len >= 2 && data[0] == 0xFE) if(data[1] == 0xFF) i = 2;\n        j = 2;\n        for(; i+1 < len; i+=j) {\n          out[k++] = String.fromCharCode((data[i]<<8) + data[i+1]);\n        }\n        break;\n      case \"utf32le\":\n        if(len >= 4 && data[0] == 0xFF) if(data[1] == 0xFE && data[2] === 0 && data[3] === 0) i = 4;\n        j = 4;\n        for(; i < len; i+=j) {\n          w = (data[i+3]<<24) + (data[i+2]<<16) + (data[i+1]<<8) + (data[i]);\n          if(w > 0xFFFF) {\n            w -= 0x10000;\n            out[k++] = String.fromCharCode(0xD800 + ((w >> 10) & 0x3FF));\n            out[k++] = String.fromCharCode(0xDC00 + (w & 0x3FF));\n          }\n          else out[k++] = String.fromCharCode(w);\n        }\n        break;\n      case \"utf32be\":\n        if(len >= 4 && data[3] == 0xFF) if(data[2] == 0xFE && data[1] === 0 && data[0] === 0) i = 4;\n        j = 4;\n        for(; i < len; i+=j) {\n          w = (data[i]<<24) + (data[i+1]<<16) + (data[i+2]<<8) + (data[i+3]);\n          if(w > 0xFFFF) {\n            w -= 0x10000;\n            out[k++] = String.fromCharCode(0xD800 + ((w >> 10) & 0x3FF));\n            out[k++] = String.fromCharCode(0xDC00 + (w & 0x3FF));\n          }\n          else out[k++] = String.fromCharCode(w);\n        }\n        break;\n      case \"utf7\":\n        if(len >= 4 && data[0] == 0x2B && data[1] == 0x2F && data[2] == 0x76) {\n          if(len >= 5 && data[3] == 0x38 && data[4] == 0x2D) i = 5;\n          else if(data[3] == 0x38 || data[3] == 0x39 || data[3] == 0x2B || data[3] == 0x2F) i = 4;\n        }\n        for(; i < len; i+=j) {\n          if(data[i] !== 0x2b) { j=1; out[k++] = String.fromCharCode(data[i]); continue; }\n          j=1;\n          if(data[i+1] === 0x2d) { j = 2; out[k++] = \"+\"; continue; }\n          // eslint-disable-next-line no-useless-escape\n          while(String.fromCharCode(data[i+j]).match(/[A-Za-z0-9+\\/]/)) j++;\n          var dash = 0;\n          if(data[i+j] === 0x2d) { ++j; dash=1; }\n          var tt = [];\n          var o64 = \"\";\n          var c1=0, c2=0, c3=0;\n          var e1=0, e2=0, e3=0, e4=0;\n          for(var l = 1; l < j - dash;) {\n            e1 = BM.indexOf(String.fromCharCode(data[i+l++]));\n            e2 = BM.indexOf(String.fromCharCode(data[i+l++]));\n            c1 = e1 << 2 | e2 >> 4;\n            tt.push(c1);\n            e3 = BM.indexOf(String.fromCharCode(data[i+l++]));\n            if(e3 === -1) break;\n            c2 = (e2 & 15) << 4 | e3 >> 2;\n            tt.push(c2);\n            e4 = BM.indexOf(String.fromCharCode(data[i+l++]));\n            if(e4 === -1) break;\n            c3 = (e3 & 3) << 6 | e4;\n            if(e4 < 64) tt.push(c3);\n          }\n          o64 = decode(1201, tt);\n          for(l = 0; l < o64.length; ++l) out[k++] = o64.charAt(l);\n        }\n        break;\n      default: throw new Error(\"Unsupported magic: \" + cp + \" \" + magic[cp]);\n    }\n    else throw new Error(\"Unrecognized CP: \" + cp);\n    return out.slice(0,k).join(\"\");\n  };\n  var hascp = function hascp(cp) { return !!(cpt[cp] || magic[cp]); };\n  cpt.utils = { decode: decode, encode: encode, hascp: hascp, magic: magic, cache:cache };\n  return cpt;\n}));\n","/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported XLSX */\n/*global global, exports, module, require:false, process:false, Buffer:false, ArrayBuffer:false, DataView:false, Deno:false, Float32Array:false */\nvar XLSX = {};\nfunction make_xlsx_lib(XLSX){\nXLSX.version = '0.20.0';\nvar current_codepage = 1200, current_ansi = 1252;\n/*global cptable:true, window */\nvar $cptable;\n\nvar VALID_ANSI = [ 874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000 ];\n/* ECMA-376 Part I 18.4.1 charset to codepage mapping */\nvar CS2CP = ({\n0:    1252, /* ANSI */\n1:   65001, /* DEFAULT */\n2:   65001, /* SYMBOL */\n77:  10000, /* MAC */\n128:   932, /* SHIFTJIS */\n129:   949, /* HANGUL */\n130:  1361, /* JOHAB */\n134:   936, /* GB2312 */\n136:   950, /* CHINESEBIG5 */\n161:  1253, /* GREEK */\n162:  1254, /* TURKISH */\n163:  1258, /* VIETNAMESE */\n177:  1255, /* HEBREW */\n178:  1256, /* ARABIC */\n186:  1257, /* BALTIC */\n204:  1251, /* RUSSIAN */\n222:   874, /* THAI */\n238:  1250, /* EASTEUROPE */\n255:  1252, /* OEM */\n69:   6969  /* MISC */\n});\n\nvar set_ansi = function(cp) { if(VALID_ANSI.indexOf(cp) == -1) return; current_ansi = CS2CP[0] = cp; };\nfunction reset_ansi() { set_ansi(1252); }\n\nvar set_cp = function(cp) { current_codepage = cp; set_ansi(cp); };\nfunction reset_cp() { set_cp(1200); reset_ansi(); }\n\nfunction char_codes(data) { var o = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\n\nfunction utf16leread(data) {\n\tvar o = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i) + (data.charCodeAt(2*i+1)<<8));\n\treturn o.join(\"\");\n}\nfunction utf16lereadu(data) {\n\tvar o = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data[2*i] + (data[2*i+1]<<8));\n\treturn o.join(\"\");\n}\nfunction utf16beread(data) {\n\tvar o = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i+1) + (data.charCodeAt(2*i)<<8));\n\treturn o.join(\"\");\n}\n\nvar debom = function(data) {\n\tvar c1 = data.charCodeAt(0), c2 = data.charCodeAt(1);\n\tif(c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n\tif(c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n\tif(c1 == 0xFEFF) return data.slice(1);\n\treturn data;\n};\n\nvar _getchar = function _gc1(x) { return String.fromCharCode(x); };\nvar _getansi = function _ga1(x) { return String.fromCharCode(x); };\n\nfunction set_cptable(cptable) {\n\t$cptable = cptable;\n\tset_cp = function(cp) { current_codepage = cp; set_ansi(cp); };\n\tdebom = function(data) {\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return $cptable.utils.decode(1200, char_codes(data.slice(2))); }\n\t\treturn data;\n\t};\n\t_getchar = function _gc2(x) {\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\n\t\treturn $cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\n\t};\n\t_getansi = function _ga2(x) {\n\t\treturn $cptable.utils.decode(current_ansi, [x])[0];\n\t};\n\tcpdoit();\n}\nvar DENSE = null;\nvar DIF_XL = true;\nvar Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nfunction Base64_encode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input.charCodeAt(i++);\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_encode_pass(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input.charCodeAt(i++);\n    if (c1 > 255)\n      c1 = 95;\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    if (c2 > 255)\n      c2 = 95;\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    if (c3 > 255)\n      c3 = 95;\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_encode_arr(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input[i++];\n    e1 = c1 >> 2;\n    c2 = input[i++];\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input[i++];\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_decode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  input = input.replace(/^data:([^\\/]+\\/[^\\/]+)?;base64\\,/, \"\").replace(/[^\\w\\+\\/\\=]/g, \"\");\n  for (var i = 0; i < input.length; ) {\n    e1 = Base64_map.indexOf(input.charAt(i++));\n    e2 = Base64_map.indexOf(input.charAt(i++));\n    c1 = e1 << 2 | e2 >> 4;\n    o += String.fromCharCode(c1);\n    e3 = Base64_map.indexOf(input.charAt(i++));\n    c2 = (e2 & 15) << 4 | e3 >> 2;\n    if (e3 !== 64) {\n      o += String.fromCharCode(c2);\n    }\n    e4 = Base64_map.indexOf(input.charAt(i++));\n    c3 = (e3 & 3) << 6 | e4;\n    if (e4 !== 64) {\n      o += String.fromCharCode(c3);\n    }\n  }\n  return o;\n}\nvar has_buf = (function() { return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node; })();\n\nvar Buffer_from = (function() {\n\tif(typeof Buffer !== 'undefined') {\n\t\tvar nbfs = !Buffer.from;\n\t\tif(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\n\t\treturn nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\n\t}\n\treturn function() {};\n})();\nvar buf_utf16le = (function() {\n\tif(typeof Buffer === 'undefined') return false;\n\tvar x = Buffer_from([65,0]);\n\tif(!x) return false;\n\tvar o = x.toString(\"utf16le\");\n\treturn o.length == 1;\n})();\n\n\nfunction new_raw_buf(len) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nfunction new_unsafe_buf(len) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nvar s2a = function s2a(s) {\n\tif(has_buf) return Buffer_from(s, \"binary\");\n\treturn s.split(\"\").map(function(x){ return x.charCodeAt(0) & 0xff; });\n};\n\nfunction s2ab(s) {\n\tif(typeof ArrayBuffer === 'undefined') return s2a(s);\n\tvar buf = new ArrayBuffer(s.length), view = new Uint8Array(buf);\n\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\treturn buf;\n}\n\nfunction a2s(data) {\n\tif(Array.isArray(data)) return data.map(function(c) { return String.fromCharCode(c); }).join(\"\");\n\tvar o = []; for(var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]); return o.join(\"\");\n}\n\nfunction a2u(data) {\n\tif(typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\n\treturn new Uint8Array(data);\n}\n\nfunction ab2a(data) {\n\tif(typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n\tif(data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\nvar o = new Array(data.length);\n\tfor(var i = 0; i < data.length; ++i) o[i] = data[i];\n\treturn o;\n}\n\nvar bconcat = has_buf ? function(bufs) { return Buffer.concat(bufs.map(function(buf) { return Buffer.isBuffer(buf) ? buf : Buffer_from(buf); })); } : function(bufs) {\n\tif(typeof Uint8Array !== \"undefined\") {\n\t\tvar i = 0, maxlen = 0;\n\t\tfor(i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n\t\tvar o = new Uint8Array(maxlen);\n\t\tvar len = 0;\n\t\tfor(i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n\t\t\tlen = bufs[i].length;\n\t\t\tif(bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);\n\t\t\telse if(typeof bufs[i] == \"string\") o.set(new Uint8Array(s2a(bufs[i])), maxlen);\n\t\t\telse o.set(new Uint8Array(bufs[i]), maxlen);\n\t\t}\n\t\treturn o;\n\t}\n\treturn [].concat.apply([], bufs.map(function(buf) { return Array.isArray(buf) ? buf : [].slice.call(buf); }));\n};\n\nfunction utf8decode(content) {\n\tvar out = [], widx = 0, L = content.length + 250;\n\tvar o = new_raw_buf(content.length + 255);\n\tfor(var ridx = 0; ridx < content.length; ++ridx) {\n\t\tvar c = content.charCodeAt(ridx);\n\t\tif(c < 0x80) o[widx++] = c;\n\t\telse if(c < 0x800) {\n\t\t\to[widx++] = (192|((c>>6)&31));\n\t\t\to[widx++] = (128|(c&63));\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64;\n\t\t\tvar d = content.charCodeAt(++ridx)&1023;\n\t\t\to[widx++] = (240|((c>>8)&7));\n\t\t\to[widx++] = (128|((c>>2)&63));\n\t\t\to[widx++] = (128|((d>>6)&15)|((c&3)<<4));\n\t\t\to[widx++] = (128|(d&63));\n\t\t} else {\n\t\t\to[widx++] = (224|((c>>12)&15));\n\t\t\to[widx++] = (128|((c>>6)&63));\n\t\t\to[widx++] = (128|(c&63));\n\t\t}\n\t\tif(widx > L) {\n\t\t\tout.push(o.slice(0, widx));\n\t\t\twidx = 0;\n\t\t\to = new_raw_buf(65535);\n\t\t\tL = 65530;\n\t\t}\n\t}\n\tout.push(o.slice(0, widx));\n\treturn bconcat(out);\n}\n\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/g;\n/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/*jshint -W041 */\nfunction _strrev(x) { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\nfunction pad0(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad_(v,d){var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\nfunction rpad_(v,d){var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\nfunction pad0r1(v,d){var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad0r2(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nvar p2_32 = Math.pow(2,32);\nfunction pad0r(v,d){if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\n/* yes, in 2022 this is still faster than string compare */\nfunction SSF_isgeneral(s, i) { i = i || 0; return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\nvar days = [\n\t['Sun', 'Sunday'],\n\t['Mon', 'Monday'],\n\t['Tue', 'Tuesday'],\n\t['Wed', 'Wednesday'],\n\t['Thu', 'Thursday'],\n\t['Fri', 'Friday'],\n\t['Sat', 'Saturday']\n];\nvar months = [\n\t['J', 'Jan', 'January'],\n\t['F', 'Feb', 'February'],\n\t['M', 'Mar', 'March'],\n\t['A', 'Apr', 'April'],\n\t['M', 'May', 'May'],\n\t['J', 'Jun', 'June'],\n\t['J', 'Jul', 'July'],\n\t['A', 'Aug', 'August'],\n\t['S', 'Sep', 'September'],\n\t['O', 'Oct', 'October'],\n\t['N', 'Nov', 'November'],\n\t['D', 'Dec', 'December']\n];\nfunction SSF_init_table(t) {\n\tif(!t) t = {};\n\tt[0]=  'General';\n\tt[1]=  '0';\n\tt[2]=  '0.00';\n\tt[3]=  '#,##0';\n\tt[4]=  '#,##0.00';\n\tt[9]=  '0%';\n\tt[10]= '0.00%';\n\tt[11]= '0.00E+00';\n\tt[12]= '# ?/?';\n\tt[13]= '# ??/??';\n\tt[14]= 'm/d/yy';\n\tt[15]= 'd-mmm-yy';\n\tt[16]= 'd-mmm';\n\tt[17]= 'mmm-yy';\n\tt[18]= 'h:mm AM/PM';\n\tt[19]= 'h:mm:ss AM/PM';\n\tt[20]= 'h:mm';\n\tt[21]= 'h:mm:ss';\n\tt[22]= 'm/d/yy h:mm';\n\tt[37]= '#,##0 ;(#,##0)';\n\tt[38]= '#,##0 ;[Red](#,##0)';\n\tt[39]= '#,##0.00;(#,##0.00)';\n\tt[40]= '#,##0.00;[Red](#,##0.00)';\n\tt[45]= 'mm:ss';\n\tt[46]= '[h]:mm:ss';\n\tt[47]= 'mmss.0';\n\tt[48]= '##0.0E+0';\n\tt[49]= '@';\n\tt[56]= '\"/ \"hh\"\"mm\"\"ss\" \"';\n\treturn t;\n}\n/* repeated to satiate webpack */\nvar table_fmt = {\n\t0:  'General',\n\t1:  '0',\n\t2:  '0.00',\n\t3:  '#,##0',\n\t4:  '#,##0.00',\n\t9:  '0%',\n\t10: '0.00%',\n\t11: '0.00E+00',\n\t12: '# ?/?',\n\t13: '# ??/??',\n\t14: 'm/d/yy',\n\t15: 'd-mmm-yy',\n\t16: 'd-mmm',\n\t17: 'mmm-yy',\n\t18: 'h:mm AM/PM',\n\t19: 'h:mm:ss AM/PM',\n\t20: 'h:mm',\n\t21: 'h:mm:ss',\n\t22: 'm/d/yy h:mm',\n\t37: '#,##0 ;(#,##0)',\n\t38: '#,##0 ;[Red](#,##0)',\n\t39: '#,##0.00;(#,##0.00)',\n\t40: '#,##0.00;[Red](#,##0.00)',\n\t45: 'mm:ss',\n\t46: '[h]:mm:ss',\n\t47: 'mmss.0',\n\t48: '##0.0E+0',\n\t49: '@',\n\t56: '\"/ \"hh\"\"mm\"\"ss\" \"'\n};\n\n/* Defaults determined by systematically testing in Excel 2019 */\n\n/* These formats appear to default to other formats in the table */\nvar SSF_default_map = {\n\t5:  37, 6:  38, 7:  39, 8:  40,         //  5 -> 37 ...  8 -> 40\n\n\t23:  0, 24:  0, 25:  0, 26:  0,         // 23 ->  0 ... 26 ->  0\n\n\t27: 14, 28: 14, 29: 14, 30: 14, 31: 14, // 27 -> 14 ... 31 -> 14\n\n\t50: 14, 51: 14, 52: 14, 53: 14, 54: 14, // 50 -> 14 ... 58 -> 14\n\t55: 14, 56: 14, 57: 14, 58: 14,\n\t59:  1, 60:  2, 61:  3, 62:  4,         // 59 ->  1 ... 62 ->  4\n\n\t67:  9, 68: 10,                         // 67 ->  9 ... 68 -> 10\n\t69: 12, 70: 13, 71: 14,                 // 69 -> 12 ... 71 -> 14\n\t72: 14, 73: 15, 74: 16, 75: 17,         // 72 -> 14 ... 75 -> 17\n\t76: 20, 77: 21, 78: 22,                 // 76 -> 20 ... 78 -> 22\n\t79: 45, 80: 46, 81: 47,                 // 79 -> 45 ... 81 -> 47\n\t82: 0                                   // 82 ->  0 ... 65536 -> 0 (omitted)\n};\n\n\n/* These formats technically refer to Accounting formats with no equivalent */\nvar SSF_default_str = {\n\t//  5 -- Currency,   0 decimal, black negative\n\t5:  '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\n\t//  6 -- Currency,   0 decimal, red   negative\n\t6:  '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\n\t//  7 -- Currency,   2 decimal, black negative\n\t7:  '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\n\t//  8 -- Currency,   2 decimal, red   negative\n\t8:  '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\n\t// 41 -- Accounting, 0 decimal, No Symbol\n\t41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n\n\t// 42 -- Accounting, 0 decimal, $  Symbol\n\t42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n\n\t// 43 -- Accounting, 2 decimal, No Symbol\n\t43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n\n\t// 44 -- Accounting, 2 decimal, $  Symbol\n\t44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n};\n\nfunction SSF_frac(x, D, mixed) {\n\tvar sgn = x < 0 ? -1 : 1;\n\tvar B = x * sgn;\n\tvar P_2 = 0, P_1 = 1, P = 0;\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\n\tvar A = Math.floor(B);\n\twhile(Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif((B - A) < 0.00000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1; P_1 = P;\n\t\tQ_2 = Q_1; Q_1 = Q;\n\t}\n\tif(Q > D) { if(Q_1 > D) { Q = Q_2; P = P_2; } else { Q = Q_1; P = P_1; } }\n\tif(!mixed) return [0, sgn * P, Q];\n\tvar q = Math.floor(sgn * P/Q);\n\treturn [q, sgn*P - q*Q, Q];\n}\nfunction SSF_parse_date_code(v,opts,b2) {\n\tif(v > 2958465 || v < 0) return null;\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\n\tvar dout=[];\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\n\tif(opts && opts.date1904) date += 1462;\n\tif(out.u > 0.9999) {\n\t\tout.u = 0;\n\t\tif(++time == 86400) { out.T = time = 0; ++date; ++out.D; }\n\t}\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\n\telse {\n\t\tif(date > 60) --date;\n\t\t/* 1 = Jan 1 1900 in Gregorian */\n\t\tvar d = new Date(1900, 0, 1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\n\t\tdow = d.getDay();\n\t\tif(date < 60) dow = (dow + 6) % 7;\n\t\tif(b2) dow = SSF_fix_hijri(d, dout);\n\t}\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\n\tout.S = time % 60; time = Math.floor(time / 60);\n\tout.M = time % 60; time = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\n/* ECMA-376 18.8.30 numFmt*/\n/* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n/* exponent >= -9 and <= 9 */\nfunction SSF_strip_decimal(o) {\n\treturn (o.indexOf(\".\") == -1) ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n\n/* General Exponential always shows 2 digits exp and trims the mantissa */\nfunction SSF_normalize_exp(o) {\n\tif(o.indexOf(\"E\") == -1) return o;\n\treturn o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/,\"$1E\").replace(/(E[+-])(\\d)$/,\"$10$2\");\n}\n\n/* exponent >= -9 and <= 9 */\nfunction SSF_small_exp(v) {\n\tvar w = (v<0?12:11);\n\tvar o = SSF_strip_decimal(v.toFixed(12)); if(o.length <= w) return o;\n\to = v.toPrecision(10); if(o.length <= w) return o;\n\treturn v.toExponential(5);\n}\n\n/* exponent >= 11 or <= -10 likely exponential */\nfunction SSF_large_exp(v) {\n\tvar o = SSF_strip_decimal(v.toFixed(11));\n\treturn (o.length > (v<0?12:11) || o === \"0\" || o === \"-0\") ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v) {\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\n\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\n\telse if(Math.abs(V) <= 9) o = SSF_small_exp(v);\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\n\telse o = SSF_large_exp(v);\n\n\treturn SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n\n\n/*\n\t\"General\" rules:\n\t- text is passed through (\"@\")\n\t- booleans are rendered as TRUE/FALSE\n\t- \"up to 11 characters\" displayed for numbers\n\t- Default date format (code 14) used for Dates\n\n\tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n\tTODO: technically the display depends on the width of the cell\n*/\nfunction SSF_general(v, opts) {\n\tswitch(typeof v) {\n\t\tcase 'string': return v;\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\n\t\tcase 'number': return (v|0) === v ? v.toString(10) : SSF_general_num(v);\n\t\tcase 'undefined': return \"\";\n\t\tcase 'object':\n\t\t\tif(v == null) return \"\";\n\t\t\tif(v instanceof Date) return SSF_format(14, datenum(v, opts && opts.date1904), opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_fix_hijri(date, o) {\n  /* TODO: properly adjust y/m/d and  */\n  o[0] -= 581;\n  var dow = date.getDay();\n  if(date < 60) dow = (dow + 6) % 7;\n  return dow;\n}\n//var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\nfunction SSF_write_date(type, fmt, val, ss0) {\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\n\tswitch(type) {\n\t\tcase 98: /* 'b' buddhist year */\n\t\t\ty = val.y + 543;\n\t\t\t/* falls through */\n\t\tcase 121: /* 'y' year */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\n\t\t\tdefault: out = y % 10000; outl = 4; break;\n\t\t} break;\n\t\tcase 109: /* 'm' month */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\n\t\t\tcase 3: return months[val.m-1][1];\n\t\t\tcase 5: return months[val.m-1][0];\n\t\t\tdefault: return months[val.m-1][2];\n\t\t} break;\n\t\tcase 100: /* 'd' day */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\n\t\t\tcase 3: return days[val.q][0];\n\t\t\tdefault: return days[val.q][1];\n\t\t} break;\n\t\tcase 104: /* 'h' 12-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 72: /* 'H' 24-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 77: /* 'M' minutes */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\n\t\t} break;\n\t\tcase 115: /* 's' seconds */\n\t\t\tif(fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n\t\t\tif(val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\nif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\tss = Math.round((tt)*(val.S + val.u));\n\t\t\tif(ss >= 60*tt) ss = 0;\n\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\n\t\t\to = pad0(ss,2 + ss0);\n\t\t\tif(fmt === 'ss') return o.substr(0,2);\n\t\t\treturn \".\" + o.substr(2,fmt.length-1);\n\t\tcase 90: /* 'Z' absolute time */\n\t\tswitch(fmt) {\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\n\t\tcase 101: /* 'e' era */\n\t\t\tout = y; outl = 1; break;\n\t}\n\tvar outstr = outl > 0 ? pad0(out, outl) : \"\";\n\treturn outstr;\n}\n\n\n/*jshint -W086 */\n/*jshint +W086 */\nfunction commaify(s) {\n\tvar w = 3;\n\tif(s.length <= w) return s;\n\tvar j = (s.length % w), o = s.substr(0,j);\n\tfor(; j!=s.length; j+=w) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,w);\n\treturn o;\n}\nvar pct1 = /%/g;\nfunction write_num_pct(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\n\nfunction write_num_cm(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\n\nfunction write_num_exp(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(o.indexOf(\"e\") === -1) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile(o.substr(0,2) === \"0.\") {\n\t\t\t\to = o.charAt(0) + o.substr(2,period) + \".\" + o.substr(2+period);\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r, aval, sign) {\n\tvar den = parseInt(r[4],10), rr = Math.round(aval * den), base = Math.floor(rr/den);\n\tvar myn = (rr - base*den), myd = den;\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\n}\nfunction write_num_f2(r, aval, sign) {\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\nvar dec1 = /^#*0*\\.([0#]+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\nfunction hashq(str) {\n\tvar o = \"\", cc;\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\n\t\tcase 35: break;\n\t\tcase 63: o+= \" \"; break;\n\t\tcase 48: o+= \"0\"; break;\n\t\tdefault: o+= String.fromCharCode(cc);\n\t}\n\treturn o;\n}\nfunction rnd(val, d) { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\nfunction dec(val, d) {\n\tvar _frac = val - Math.floor(val), dd = Math.pow(10,d);\n\tif (d < ('' + Math.round(_frac * dd)).length) return 0;\n\treturn Math.round(_frac * dd);\n}\nfunction carry(val, d) {\n\tif (d < ('' + Math.round((val-Math.floor(val))*Math.pow(10,d))).length) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nfunction flr(val) {\n\tif(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0));\n\treturn \"\"+Math.floor(val);\n}\nfunction write_num_flt(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f1(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1])).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify(pad0r(aval,0));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = pad0r(val, 0);\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0?]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,##0.00\": return write_num_flt(type, \"#,##0.00\", val);\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\n\t\tcase \"###,###.00\": return write_num_flt(type, \"###,##0.00\",val).replace(/^0\\./,\".\");\n\t\tcase \"#,###.00\": return write_num_flt(type, \"#,##0.00\",val).replace(/^0\\./,\".\");\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num_cm2(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_pct2(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_exp2(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp2(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(!o.match(/[Ee]/)) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nfunction write_num_int(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = (\"\"+val); if(val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f2(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\no = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1]));\n\t\to = o.replace(/\\.(\\d*)$/,function($$, $1) {\nreturn \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify((\"\"+aval));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = \"\" + val;\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t\t\tif(fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0,fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num(type, fmt, val) {\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\nfunction SSF_split_fmt(fmt) {\n\tvar out = [];\n\tvar in_str = false/*, cc*/;\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((/*cc=*/fmt.charCodeAt(i))) {\n\t\tcase 34: /* '\"' */\n\t\t\tin_str = !in_str; break;\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\n\t\t\t++i; break;\n\t\tcase 59: /* ';' */\n\t\t\tout[out.length] = fmt.substr(j,i-j);\n\t\t\tj = i+1;\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\n\nvar SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\nfunction fmt_is_date(fmt) {\n\tvar i = 0, /*cc = 0,*/ c = \"\", o = \"\";\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': if(SSF_isgeneral(fmt, i)) i+= 6; i++; break;\n\t\t\tcase '\"': for(;(/*cc=*/fmt.charCodeAt(++i)) !== 34 && i < fmt.length;){/*empty*/} ++i; break;\n\t\t\tcase '\\\\': i+=2; break;\n\t\t\tcase '_': i+=2; break;\n\t\t\tcase '@': ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") return true;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g': return true;\n\t\t\tcase 'A': case 'a': case '':\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"/\") return true;\n\t\t\t\t++i; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.match(SSF_abstime)) return true;\n\t\t\t\tbreak;\n\t\t\tcase '.':\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\twhile(i < fmt.length && (\"0#?.,E+-%\".indexOf(c=fmt.charAt(++i)) > -1 || (c=='\\\\' && fmt.charAt(i+1) == \"-\" && \"0#\".indexOf(fmt.charAt(i+2))>-1))){/* empty */}\n\t\t\t\tbreak;\n\t\t\tcase '?': while(fmt.charAt(++i) === c){/* empty */} break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break;\n\t\t\tcase '(': case ')': ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\twhile(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1){/* empty */} break;\n\t\t\tcase ' ': ++i; break;\n\t\t\tdefault: ++i; break;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction eval_fmt(fmt, v, opts, flen) {\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', dt, j, cc;\n\tvar hr='H';\n\t/* Tokenize */\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': /* General */\n\t\t\t\tif(!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\n\t\t\tcase '\"': /* Literal text */\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\n\t\t\tcase '\\\\': var w = fmt.charAt(++i), t = (w === \"(\" || w === \")\") ? w : 't';\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\n\t\t\tcase '@': /* Text Placeholder */\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts, fmt.charAt(i+1) === \"2\"); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\tc = c.toLowerCase();\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\n\t\t\t\tif(v < 0) return \"\";\n\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\to = c; while(++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o+=c;\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n\t\t\t\tif(c === 'h') c = hr;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase 'A': case 'a': case '':\n\t\t\t\tvar q={t:c, v:c};\n\t\t\t\tif(dt==null) dt=SSF_parse_date_code(v, opts);\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? fmt.charAt(i+2) : c; q.t = 'T'; hr='h';i+=3;}\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"/\") { if(dt!=null) q.v = dt.H >= 12 ? \"\" : \"\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse { q.t = \"t\"; ++i; }\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\n\t\t\t\tout[out.length] = q; lst = c; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\t\t\t\tif(o.match(SSF_abstime)) {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\n\t\t\t\t\tlst = o.charAt(1);\n\t\t\t\t} else if(o.indexOf(\"$\") > -1) {\n\t\t\t\t\to = (o.match(/\\$([^-\\[\\]]*)/)||[])[1]||\"$\";\n\t\t\t\t\tif(!fmt_is_date(fmt)) out[out.length] = {t:'t',v:o};\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t/* Numbers */\n\t\t\tcase '.':\n\t\t\t\tif(dt != null) {\n\t\t\t\t\to = c; while(++i < fmt.length && (c=fmt.charAt(i)) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\to = c; while(++i < fmt.length && \"0#?.,E+-%\".indexOf(c=fmt.charAt(i)) > -1) o += c;\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\n\t\t\tcase '?':\n\t\t\t\to = c; while(fmt.charAt(++i) === c) o+=c;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break; // **\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\to = c; while(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o+=fmt.charAt(i);\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\n\t\t\tcase '$': out[out.length] = {t:'t', v:'$'}; ++i; break;\n\t\t\tdefault:\n\t\t\t\tif(\",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\n\t\t}\n\t}\n\n\t/* Scan for date/time parts */\n\tvar bt = 0, ss0 = 0, ssm;\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\n\t\t\tcase 's':\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\n\t\t\t\tif(bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\n\t\t\tcase 'X': /*if(out[i].v === \"B2\");*/\n\t\t\t\tbreak;\n\t\t\tcase 'Z':\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\t/* time rounding depends on presence of minute / second / usec fields */\n\tswitch(bt) {\n\t\tcase 0: break;\n\t\tcase 1:\nif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tbreak;\n\t\tcase 2:\nif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tbreak;\n\t}\n\n\t/* replace fields */\n\tvar nstr = \"\", jj;\n\tfor(i=0; i < out.length; ++i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\n\t\t\tcase 'X': out[i].v = \"\"; out[i].t = \";\"; break;\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\nout[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n\t\t\t\tout[i].t = 't'; break;\n\t\t\tcase 'n': case '?':\n\t\t\t\tjj = i+1;\n\t\t\t\twhile(out[jj] != null && (\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t((c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/')) ||\n\t\t\t\t\t(out[i].t === '(' && (c === ' ' || c === 'n' || c === ')')) ||\n\t\t\t\t\t(c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?'))\n\t\t\t\t)) {\n\t\t\t\t\tout[i].v += out[jj].v;\n\t\t\t\t\tout[jj] = {v:\"\", t:\";\"}; ++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i].v;\n\t\t\t\ti = jj-1; break;\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = SSF_general(v,opts); break;\n\t\t}\n\t}\n\tvar vv = \"\", myv, ostr;\n\tif(nstr.length > 0) {\n\t\tif(nstr.charCodeAt(0) == 40) /* '(' */ {\n\t\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t} else {\n\t\t\tmyv = (v<0 && flen > 1 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t\tif(myv < 0 && out[0] && out[0].t == 't') {\n\t\t\t\tostr = ostr.substr(1);\n\t\t\t\tout[0].v = \"-\" + out[0].v;\n\t\t\t}\n\t\t}\n\t\tjj=ostr.length-1;\n\t\tvar decpt = out.length;\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\n\t\tvar lasti=out.length;\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t}\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\")-1;\n\t\t\tfor(i=decpt; i>= 0; --i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\n\t\t\t\tvv = out[i].v.substr(j+1);\n\t\t\t\tfor(; j>=0; --j) {\n\t\t\t\t\tif(jj>=0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t\tjj = ostr.indexOf(\".\")+1;\n\t\t\tfor(i=decpt; i<out.length; ++i) {\n\t\t\t\tif(out[i] == null || ('n?('.indexOf(out[i].t) === -1 && i !== decpt)) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\n\t\t\t\tvv = out[i].v.substr(0,j);\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\n\t\t\t\t\tif(jj<ostr.length) vv += ostr.charAt(jj++);\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n?'.indexOf(out[i].t)>-1) {\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\n\t\tout[i].t = 't';\n\t}\n\tvar retval = \"\";\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\n\treturn retval;\n}\n\nvar cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\nfunction chkcond(v, rr) {\n\tif(rr == null) return false;\n\tvar thresh = parseFloat(rr[2]);\n\tswitch(rr[1]) {\n\t\tcase \"=\":  if(v == thresh) return true; break;\n\t\tcase \">\":  if(v >  thresh) return true; break;\n\t\tcase \"<\":  if(v <  thresh) return true; break;\n\t\tcase \"<>\": if(v != thresh) return true; break;\n\t\tcase \">=\": if(v >= thresh) return true; break;\n\t\tcase \"<=\": if(v <= thresh) return true; break;\n\t}\n\treturn false;\n}\nfunction choose_fmt(f, v) {\n\tvar fmt = SSF_split_fmt(f);\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\n\tif(l<4 && lat>-1) --l;\n\tif(fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\n\tswitch(fmt.length) {\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\n\t\tcase 4: break;\n\t}\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\tif(fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n\t\tvar m1 = fmt[0].match(cfregex2);\n\t\tvar m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [l, ff];\n}\nfunction SSF_format(fmt,v,o) {\n\tif(o == null) o = {};\n\tvar sfmt = \"\";\n\tswitch(typeof fmt) {\n\t\tcase \"string\":\n\t\t\tif(fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = fmt;\n\t\t\tbreak;\n\t\tcase \"number\":\n\t\t\tif(fmt == 14 && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = (o.table != null ? (o.table) : table_fmt)[fmt];\n\t\t\tif(sfmt == null) sfmt = (o.table && o.table[SSF_default_map[fmt]]) || table_fmt[SSF_default_map[fmt]];\n\t\t\tif(sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n\t\t\tbreak;\n\t}\n\tif(SSF_isgeneral(sfmt,0)) return SSF_general(v, o);\n\tif(v instanceof Date) v = datenum(v, o.date1904);\n\tvar f = choose_fmt(sfmt, v);\n\tif(SSF_isgeneral(f[1])) return SSF_general(v, o);\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\n\telse if(v === \"\" || v == null) return \"\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\nfunction SSF_load(fmt, idx) {\n\tif(typeof idx != 'number') {\n\t\tidx = +idx || -1;\nfor(var i = 0; i < 0x0188; ++i) {\nif(table_fmt[i] == undefined) { if(idx < 0) idx = i; continue; }\n\t\t\tif(table_fmt[i] == fmt) { idx = i; break; }\n\t\t}\nif(idx < 0) idx = 0x187;\n\t}\ntable_fmt[idx] = fmt;\n\treturn idx;\n}\nfunction SSF_load_table(tbl) {\n\tfor(var i=0; i!=0x0188; ++i)\n\t\tif(tbl[i] !== undefined) SSF_load(tbl[i], i);\n}\n\nfunction make_ssf() {\n\ttable_fmt = SSF_init_table();\n}\n\nvar SSF = {\n\tformat: SSF_format,\n\tload: SSF_load,\n\t_table: table_fmt,\n\tload_table: SSF_load_table,\n\tparse_date_code: SSF_parse_date_code,\n\tis_date: fmt_is_date,\n\tget_table: function get_table() { return SSF._table = table_fmt; }\n};\n\nvar SSFImplicit/*{[number]:string}*/ = ({\n\t\"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"23\": 'General', \"24\": 'General', \"25\": 'General', \"26\": 'General',\n\t\"27\": 'm/d/yy', \"28\": 'm/d/yy', \"29\": 'm/d/yy', \"30\": 'm/d/yy', \"31\": 'm/d/yy',\n\t\"32\": 'h:mm:ss', \"33\": 'h:mm:ss', \"34\": 'h:mm:ss', \"35\": 'h:mm:ss',\n\t\"36\": 'm/d/yy',\n\t\"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n\t\"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n\t\"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n\t\"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n\t\"50\": 'm/d/yy', \"51\": 'm/d/yy', \"52\": 'm/d/yy', \"53\": 'm/d/yy', \"54\": 'm/d/yy',\n\t\"55\": 'm/d/yy', \"56\": 'm/d/yy', \"57\": 'm/d/yy', \"58\": 'm/d/yy',\n\t\"59\": '0',\n\t\"60\": '0.00',\n\t\"61\": '#,##0',\n\t\"62\": '#,##0.00',\n\t\"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"67\": '0%',\n\t\"68\": '0.00%',\n\t\"69\": '# ?/?',\n\t\"70\": '# ??/??',\n\t\"71\": 'm/d/yy',\n\t\"72\": 'm/d/yy',\n\t\"73\": 'd-mmm-yy',\n\t\"74\": 'd-mmm',\n\t\"75\": 'mmm-yy',\n\t\"76\": 'h:mm',\n\t\"77\": 'h:mm:ss',\n\t\"78\": 'm/d/yy h:mm',\n\t\"79\": 'mm:ss',\n\t\"80\": '[h]:mm:ss',\n\t\"81\": 'mmss.0'\n});\n\n/* dateNF parse TODO: move to SSF */\nvar dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\nfunction dateNF_regex(dateNF) {\n\tvar fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n\tfmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n\tdateNFregex.lastIndex = 0;\n\treturn new RegExp(\"^\" + fmt + \"$\");\n}\nfunction dateNF_fix(str, dateNF, match) {\n\tvar Y = -1, m = -1, d = -1, H = -1, M = -1, S = -1;\n\t(dateNF.match(dateNFregex)||[]).forEach(function(n, i) {\n\t\tvar v = parseInt(match[i+1], 10);\n\t\tswitch(n.toLowerCase().charAt(0)) {\n\t\t\tcase 'y': Y = v; break; case 'd': d = v; break;\n\t\t\tcase 'h': H = v; break; case 's': S = v; break;\n\t\t\tcase 'm': if(H >= 0) M = v; else m = v; break;\n\t\t}\n\t});\n\tdateNFregex.lastIndex = 0;\n\tif(S >= 0 && M == -1 && m >= 0) { M = m; m = -1; }\n\tvar datestr = ((\"\" + (Y>=0?Y: new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m>=1?m:1)).slice(-2) + \"-\" + (\"00\" + (d>=1?d:1)).slice(-2));\n\tif(datestr.length == 7) datestr = \"0\" + datestr;\n\tif(datestr.length == 8) datestr = \"20\" + datestr;\n\tvar timestr = ((\"00\" + (H>=0?H:0)).slice(-2) + \":\" + (\"00\" + (M>=0?M:0)).slice(-2) + \":\" + (\"00\" + (S>=0?S:0)).slice(-2));\n\tif(H == -1 && M == -1 && S == -1) return datestr;\n\tif(Y == -1 && m == -1 && d == -1) return timestr;\n\treturn datestr + \"T\" + timestr;\n}\n\n/* table of bad formats written by third-party tools */\nvar bad_formats = {\n\t\"d.m\": \"d\\\\.m\" // Issue #2571 Google Sheets writes invalid format 'd.m', correct format is 'd\".\"m' or 'd\\\\.m'\n};\n\nfunction SSF__load(fmt, idx) {\n\treturn SSF_load(bad_formats[fmt] || fmt, idx);\n}\n\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint eqnull:true */\n/*exported CFB */\n/*global Uint8Array:false, Uint16Array:false */\n\n/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported CRC32 */\nvar CRC32 = (function() {\nvar CRC32 = {};\nCRC32.version = '1.2.0';\n/* see perf/crc32table.js */\n/*global Int32Array */\nfunction signed_crc_table() {\n\tvar c = 0, table = new Array(256);\n\n\tfor(var n =0; n != 256; ++n){\n\t\tc = n;\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\ttable[n] = c;\n\t}\n\n\treturn typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n}\n\nvar T0 = signed_crc_table();\nfunction slice_by_16_tables(T) {\n\tvar c = 0, v = 0, n = 0, table = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096) ;\n\n\tfor(n = 0; n != 256; ++n) table[n] = T[n];\n\tfor(n = 0; n != 256; ++n) {\n\t\tv = T[n];\n\t\tfor(c = 256 + n; c < 4096; c += 256) v = table[c] = (v >>> 8) ^ T[v & 0xFF];\n\t}\n\tvar out = [];\n\tfor(n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== 'undefined' && typeof table.subarray == \"function\" ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n\treturn out;\n}\nvar TT = slice_by_16_tables(T0);\nvar T1 = TT[0],  T2 = TT[1],  T3 = TT[2],  T4 = TT[3],  T5 = TT[4];\nvar T6 = TT[5],  T7 = TT[6],  T8 = TT[7],  T9 = TT[8],  Ta = TT[9];\nvar Tb = TT[10], Tc = TT[11], Td = TT[12], Te = TT[13], Tf = TT[14];\nfunction crc32_bstr(bstr, seed) {\n\tvar C = seed ^ -1;\n\tfor(var i = 0, L = bstr.length; i < L;) C = (C>>>8) ^ T0[(C^bstr.charCodeAt(i++))&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_buf(B, seed) {\n\tvar C = seed ^ -1, L = B.length - 15, i = 0;\n\tfor(; i < L;) C =\n\t\tTf[B[i++] ^ (C & 255)] ^\n\t\tTe[B[i++] ^ ((C >> 8) & 255)] ^\n\t\tTd[B[i++] ^ ((C >> 16) & 255)] ^\n\t\tTc[B[i++] ^ (C >>> 24)] ^\n\t\tTb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^\n\t\tT7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^\n\t\tT3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n\tL += 15;\n\twhile(i < L) C = (C>>>8) ^ T0[(C^B[i++])&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_str(str, seed) {\n\tvar C = seed ^ -1;\n\tfor(var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n\t\tc = str.charCodeAt(i++);\n\t\tif(c < 0x80) {\n\t\t\tC = (C>>>8) ^ T0[(C^c)&0xFF];\n\t\t} else if(c < 0x800) {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (192|((c>>6)&31)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64; d = str.charCodeAt(i++)&1023;\n\t\t\tC = (C>>>8) ^ T0[(C ^ (240|((c>>8)&7)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>2)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((d>>6)&15)|((c&3)<<4)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(d&63)))&0xFF];\n\t\t} else {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (224|((c>>12)&15)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>6)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t}\n\t}\n\treturn ~C;\n}\nCRC32.table = T0;\nCRC32.bstr = crc32_bstr;\nCRC32.buf = crc32_buf;\nCRC32.str = crc32_str;\nreturn CRC32;\n})();\n/* [MS-CFB] v20171201 */\nvar CFB = (function _CFB(){\nvar exports = {};\nexports.version = '1.2.2';\n/* [MS-CFB] 2.6.4 */\nfunction namecmp(l, r) {\n\tvar L = l.split(\"/\"), R = r.split(\"/\");\n\tfor(var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n\t\tif((c = L[i].length - R[i].length)) return c;\n\t\tif(L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n\t}\n\treturn L.length - R.length;\n}\nfunction dirname(p) {\n\tif(p.charAt(p.length - 1) == \"/\") return (p.slice(0,-1).indexOf(\"/\") === -1) ? p : dirname(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(0, c+1);\n}\n\nfunction filename(p) {\n\tif(p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(c+1);\n}\n/* -------------------------------------------------------------------------- */\n/* DOS Date format:\n   high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n   add 1980 to stored year\n   stored second should be doubled\n*/\n\n/* write JS date to buf as a DOS date */\nfunction write_dos_date(buf, date) {\n\tif(typeof date === \"string\") date = new Date(date);\n\tvar hms = date.getHours();\n\thms = hms << 6 | date.getMinutes();\n\thms = hms << 5 | (date.getSeconds()>>>1);\n\tbuf.write_shift(2, hms);\n\tvar ymd = (date.getFullYear() - 1980);\n\tymd = ymd << 4 | (date.getMonth()+1);\n\tymd = ymd << 5 | date.getDate();\n\tbuf.write_shift(2, ymd);\n}\n\n/* read four bytes from buf and interpret as a DOS date */\nfunction parse_dos_date(buf) {\n\tvar hms = buf.read_shift(2) & 0xFFFF;\n\tvar ymd = buf.read_shift(2) & 0xFFFF;\n\tvar val = new Date();\n\tvar d = ymd & 0x1F; ymd >>>= 5;\n\tvar m = ymd & 0x0F; ymd >>>= 4;\n\tval.setMilliseconds(0);\n\tval.setFullYear(ymd + 1980);\n\tval.setMonth(m-1);\n\tval.setDate(d);\n\tvar S = hms & 0x1F; hms >>>= 5;\n\tvar M = hms & 0x3F; hms >>>= 6;\n\tval.setHours(hms);\n\tval.setMinutes(M);\n\tval.setSeconds(S<<1);\n\treturn val;\n}\nfunction parse_extra_field(blob) {\n\tprep_blob(blob, 0);\n\tvar o = {};\n\tvar flags = 0;\n\twhile(blob.l <= blob.length - 4) {\n\t\tvar type = blob.read_shift(2);\n\t\tvar sz = blob.read_shift(2), tgt = blob.l + sz;\n\t\tvar p = {};\n\t\tswitch(type) {\n\t\t\t/* UNIX-style Timestamps */\n\t\t\tcase 0x5455: {\n\t\t\t\tflags = blob.read_shift(1);\n\t\t\t\tif(flags & 1) p.mtime = blob.read_shift(4);\n\t\t\t\t/* for some reason, CD flag corresponds to LFH */\n\t\t\t\tif(sz > 5) {\n\t\t\t\t\tif(flags & 2) p.atime = blob.read_shift(4);\n\t\t\t\t\tif(flags & 4) p.ctime = blob.read_shift(4);\n\t\t\t\t}\n\t\t\t\tif(p.mtime) p.mt = new Date(p.mtime*1000);\n\t\t\t} break;\n\t\t\t/* ZIP64 Extended Information Field */\n\t\t\tcase 0x0001: {\n\t\t\t\tvar sz1 = blob.read_shift(4), sz2 = blob.read_shift(4);\n\t\t\t\tp.usz = (sz2 * Math.pow(2,32) + sz1);\n\t\t\t\tsz1 = blob.read_shift(4); sz2 = blob.read_shift(4);\n\t\t\t\tp.csz = (sz2 * Math.pow(2,32) + sz1);\n\t\t\t\t// NOTE: volume fields are skipped\n\t\t\t} break;\n\t\t}\n\t\tblob.l = tgt;\n\t\to[type] = p;\n\t}\n\treturn o;\n}\nvar fs;\nfunction get_fs() { return fs || (fs = _fs); }\nfunction parse(file, options) {\nif(file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\nif((file[0] | 0x20) == 0x6d && (file[1]|0x20) == 0x69) return parse_mad(file, options);\nif(file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\nvar mver = 3;\nvar ssz = 512;\nvar nmfs = 0; // number of mini FAT sectors\nvar difat_sec_cnt = 0;\nvar dir_start = 0;\nvar minifat_start = 0;\nvar difat_start = 0;\n\nvar fat_addrs = []; // locations of FAT sectors\n\n/* [MS-CFB] 2.2 Compound File Header */\nvar blob = file.slice(0,512);\nprep_blob(blob, 0);\n\n/* major version */\nvar mv = check_get_mver(blob);\nmver = mv[0];\nswitch(mver) {\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\n\tcase 0: if(mv[1] == 0) return parse_zip(file, options);\n\t/* falls through */\n\tdefault: throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n}\n\n/* reprocess header */\nif(ssz !== 512) { blob = file.slice(0,ssz); prep_blob(blob, 28 /* blob.l */); }\n/* Save header for final object */\nvar header = file.slice(0,ssz);\n\ncheck_shifts(blob, mver);\n\n// Number of Directory Sectors\nvar dir_cnt = blob.read_shift(4, 'i');\nif(mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt);\n\n// Number of FAT Sectors\nblob.l += 4;\n\n// First Directory Sector Location\ndir_start = blob.read_shift(4, 'i');\n\n// Transaction Signature\nblob.l += 4;\n\n// Mini Stream Cutoff Size\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n// First Mini FAT Sector Location\nminifat_start = blob.read_shift(4, 'i');\n\n// Number of Mini FAT Sectors\nnmfs = blob.read_shift(4, 'i');\n\n// First DIFAT sector location\ndifat_start = blob.read_shift(4, 'i');\n\n// Number of DIFAT Sectors\ndifat_sec_cnt = blob.read_shift(4, 'i');\n\n// Grab FAT Sector Locations\nfor(var q = -1, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\n\tq = blob.read_shift(4, 'i');\n\tif(q<0) break;\n\tfat_addrs[j] = q;\n}\n\n/** Break the file up into sectors */\nvar sectors = sectorify(file, ssz);\n\nsleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n\n/** Chains */\nvar sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n\nif(dir_start < sector_list.length) sector_list[dir_start].name = \"!Directory\";\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\nsector_list[fat_addrs[0]].name = \"!FAT\";\nsector_list.fat_addrs = fat_addrs;\nsector_list.ssz = ssz;\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nvar files = {}, Paths = [], FileIndex = [], FullPaths = [];\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n\nbuild_full_paths(FileIndex, FullPaths, Paths);\nPaths.shift();\n\nvar o = {\n\tFileIndex: FileIndex,\n\tFullPaths: FullPaths\n};\n\n// $FlowIgnore\nif(options && options.raw) o.raw = {header: header, sectors: sectors};\nreturn o;\n} // parse\n\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\nfunction check_get_mver(blob) {\n\tif(blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0];\n\t// header signature 8\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n\t// clsid 16\n\t//blob.chk(HEADER_CLSID, 'CLSID: ');\n\tblob.l += 16;\n\n\t// minor version 2\n\tvar mver = blob.read_shift(2, 'u');\n\n\treturn [blob.read_shift(2,'u'), mver];\n}\nfunction check_shifts(blob, mver) {\n\tvar shift = 0x09;\n\n\t// Byte Order\n\t//blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n\tblob.l += 2;\n\n\t// Sector Shift\n\tswitch((shift = blob.read_shift(2))) {\n\t\tcase 0x09: if(mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift); break;\n\t\tcase 0x0c: if(mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift); break;\n\t\tdefault: throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n\t}\n\n\t// Mini Sector Shift\n\tblob.chk('0600', 'Mini Sector Shift: ');\n\n\t// Reserved\n\tblob.chk('000000000000', 'Reserved: ');\n}\n\n/** Break the file up into sectors */\nfunction sectorify(file, ssz) {\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\n\tvar sectors = [];\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\n\treturn sectors;\n}\n\n/* [MS-CFB] 2.6.4 Red-Black Tree */\nfunction build_full_paths(FI, FP, Paths) {\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\n\tvar dad = [], q = [];\n\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\n\n\tfor(; j < q.length; ++j) {\n\t\ti = q[j];\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\n\t\tif(dad[i] === i) {\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\n\t\t}\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\n\t\tif(L !== -1 && i != dad[i]) { dad[L] = dad[i]; if(q.lastIndexOf(L) < j) q.push(L); }\n\t\tif(R !== -1 && i != dad[i]) { dad[R] = dad[i]; if(q.lastIndexOf(R) < j) q.push(R); }\n\t}\n\tfor(i=1; i < pl; ++i) if(dad[i] === i) {\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\n\t}\n\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type === 0 /* unknown */) continue;\n\t\tj = i;\n\t\tif(j != dad[j]) do {\n\t\t\tj = dad[j];\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\n\t\t} while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n\t\tdad[i] = -1;\n\t}\n\n\tFP[0] += \"/\";\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n\t}\n}\n\nfunction get_mfat_entry(entry, payload, mini) {\n\tvar start = entry.start, size = entry.size;\n\t//return (payload.slice(start*MSSZ, start*MSSZ + size));\n\tvar o = [];\n\tvar idx = start;\n\twhile(mini && size > 0 && idx >= 0) {\n\t\to.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n\t\tsize -= MSSZ;\n\t\tidx = __readInt32LE(mini, idx * 4);\n\t}\n\tif(o.length === 0) return (new_buf(0));\n\treturn (bconcat(o).slice(0, entry.size));\n}\n\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\n    DIFAT chains by storing the next sector number as the last 32 bits */\nfunction sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n\tvar q = ENDOFCHAIN;\n\tif(idx === ENDOFCHAIN) {\n\t\tif(cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n\t} else if(idx !== -1 /*FREESECT*/) {\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\n\t\tif(!sector) return;\n\t\tfor(var i = 0; i < m; ++i) {\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\n\t\t\tfat_addrs.push(q);\n\t\t}\n\t\tif(cnt >= 1) sleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\n\t}\n}\n\n/** Follow the linked list of sectors for a given starting point */\nfunction get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n\tvar buf = [], buf_chain = [];\n\tif(!chkd) chkd = [];\n\tvar modulus = ssz - 1, j = 0, jj = 0;\n\tfor(j=start; j>=0;) {\n\t\tchkd[j] = true;\n\t\tbuf[buf.length] = j;\n\t\tbuf_chain.push(sectors[j]);\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\tjj = ((j*4) & modulus);\n\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\tif(!sectors[addr]) break;\n\t\tj = __readInt32LE(sectors[addr], jj);\n\t}\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\n}\n\n/** Chase down the sector linked lists */\nfunction make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n\tvar sl = sectors.length, sector_list = ([]);\n\tvar chkd = [], buf = [], buf_chain = [];\n\tvar modulus = ssz - 1, i=0, j=0, k=0, jj=0;\n\tfor(i=0; i < sl; ++i) {\n\t\tbuf = ([]);\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\n\t\tif(chkd[k]) continue;\n\t\tbuf_chain = [];\n\t\tvar seen = [];\n\t\tfor(j=k; j>=0;) {\n\t\t\tseen[j] = true;\n\t\t\tchkd[j] = true;\n\t\t\tbuf[buf.length] = j;\n\t\t\tbuf_chain.push(sectors[j]);\n\t\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\t\tjj = ((j*4) & modulus);\n\t\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\t\tif(!sectors[addr]) break;\n\t\t\tj = __readInt32LE(sectors[addr], jj);\n\t\t\tif(seen[j]) break;\n\t\t}\n\t\tsector_list[k] = ({nodes: buf, data:__toBuffer([buf_chain])});\n\t}\n\treturn sector_list;\n}\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nfunction read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, mini) {\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\n\tvar sector = sector_list[dir_start].data;\n\tvar i = 0, namelen = 0, name;\n\tfor(; i < sector.length; i+= 128) {\n\t\tvar blob = sector.slice(i, i+128);\n\t\tprep_blob(blob, 64);\n\t\tnamelen = blob.read_shift(2);\n\t\tname = __utf16le(blob,0,namelen-pl);\n\t\tPaths.push(name);\n\t\tvar o = ({\n\t\t\tname:  name,\n\t\t\ttype:  blob.read_shift(1),\n\t\t\tcolor: blob.read_shift(1),\n\t\t\tL:     blob.read_shift(4, 'i'),\n\t\t\tR:     blob.read_shift(4, 'i'),\n\t\t\tC:     blob.read_shift(4, 'i'),\n\t\t\tclsid: blob.read_shift(16),\n\t\t\tstate: blob.read_shift(4, 'i'),\n\t\t\tstart: 0,\n\t\t\tsize: 0\n\t\t});\n\t\tvar ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(ctime !== 0) o.ct = read_date(blob, blob.l-8);\n\t\tvar mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(mtime !== 0) o.mt = read_date(blob, blob.l-8);\n\t\to.start = blob.read_shift(4, 'i');\n\t\to.size = blob.read_shift(4, 'i');\n\t\tif(o.size < 0 && o.start < 0) { o.size = o.type = 0; o.start = ENDOFCHAIN; o.name = \"\"; }\n\t\tif(o.type === 5) { /* root */\n\t\t\tminifat_store = o.start;\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n\t\t\t/*minifat_size = o.size;*/\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\n\t\t\to.storage = 'fat';\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n\t\t\tsector_list[o.start].name = o.name;\n\t\t\to.content = (sector_list[o.start].data.slice(0,o.size));\n\t\t} else {\n\t\t\to.storage = 'minifat';\n\t\t\tif(o.size < 0) o.size = 0;\n\t\t\telse if(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n\t\t\t\to.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini]||{}).data);\n\t\t\t}\n\t\t}\n\t\tif(o.content) prep_blob(o.content, 0);\n\t\tfiles[name] = o;\n\t\tFileIndex.push(o);\n\t}\n}\n\nfunction read_date(blob, offset) {\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\n}\n\nfunction read_file(filename, options) {\n\tget_fs();\n\treturn parse(fs.readFileSync(filename), options);\n}\n\nfunction read(blob, options) {\n\tvar type = options && options.type;\n\tif(!type) {\n\t\tif(has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n\t}\n\tswitch(type || \"base64\") {\n\t\tcase \"file\": return read_file(blob, options);\n\t\tcase \"base64\": return parse(s2a(Base64_decode(blob)), options);\n\t\tcase \"binary\": return parse(s2a(blob), options);\n\t}\n\treturn parse(blob, options);\n}\n\nfunction init_cfb(cfb, opts) {\n\tvar o = opts || {}, root = o.root || \"Root Entry\";\n\tif(!cfb.FullPaths) cfb.FullPaths = [];\n\tif(!cfb.FileIndex) cfb.FileIndex = [];\n\tif(cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n\tif(cfb.FullPaths.length === 0) {\n\t\tcfb.FullPaths[0] = root + \"/\";\n\t\tcfb.FileIndex[0] = ({ name: root, type: 5 });\n\t}\n\tif(o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n\tseed_cfb(cfb);\n}\nfunction seed_cfb(cfb) {\n\tvar nm = \"\\u0001Sh33tJ5\";\n\tif(CFB.find(cfb, \"/\" + nm)) return;\n\tvar p = new_buf(4); p[0] = 55; p[1] = p[3] = 50; p[2] = 54;\n\tcfb.FileIndex.push(({ name: nm, type: 2, content:p, size:4, L:69, R:69, C:69 }));\n\tcfb.FullPaths.push(cfb.FullPaths[0] + nm);\n\trebuild_cfb(cfb);\n}\nfunction rebuild_cfb(cfb, f) {\n\tinit_cfb(cfb);\n\tvar gc = false, s = false;\n\tfor(var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n\t\tvar _file = cfb.FileIndex[i];\n\t\tswitch(_file.type) {\n\t\t\tcase 0:\n\t\t\t\tif(s) gc = true;\n\t\t\t\telse { cfb.FileIndex.pop(); cfb.FullPaths.pop(); }\n\t\t\t\tbreak;\n\t\t\tcase 1: case 2: case 5:\n\t\t\t\ts = true;\n\t\t\t\tif(isNaN(_file.R * _file.L * _file.C)) gc = true;\n\t\t\t\tif(_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n\t\t\t\tbreak;\n\t\t\tdefault: gc = true; break;\n\t\t}\n\t}\n\tif(!gc && !f) return;\n\n\tvar now = new Date(1987, 1, 19), j = 0;\n\t// Track which names exist\n\tvar fullPaths = Object.create ? Object.create(null) : {};\n\tvar data = [];\n\tfor(i = 0; i < cfb.FullPaths.length; ++i) {\n\t\tfullPaths[cfb.FullPaths[i]] = true;\n\t\tif(cfb.FileIndex[i].type === 0) continue;\n\t\tdata.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n\t}\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar dad = dirname(data[i][0]);\n\t\ts = fullPaths[dad];\n\t\twhile(!s) {\n\t\t\twhile(dirname(dad) && !fullPaths[dirname(dad)]) dad = dirname(dad);\n\n\t\t\tdata.push([dad, ({\n\t\t\t\tname: filename(dad).replace(\"/\",\"\"),\n\t\t\t\ttype: 1,\n\t\t\t\tclsid: HEADER_CLSID,\n\t\t\t\tct: now, mt: now,\n\t\t\t\tcontent: null\n\t\t\t})]);\n\n\t\t\t// Add name to set\n\t\t\tfullPaths[dad] = true;\n\n\t\t\tdad = dirname(data[i][0]);\n\t\t\ts = fullPaths[dad];\n\t\t}\n\t}\n\n\tdata.sort(function(x,y) { return namecmp(x[0], y[0]); });\n\tcfb.FullPaths = []; cfb.FileIndex = [];\n\tfor(i = 0; i < data.length; ++i) { cfb.FullPaths[i] = data[i][0]; cfb.FileIndex[i] = data[i][1]; }\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar elt = cfb.FileIndex[i];\n\t\tvar nm = cfb.FullPaths[i];\n\n\t\telt.name =  filename(nm).replace(\"/\",\"\");\n\t\telt.L = elt.R = elt.C = -(elt.color = 1);\n\t\telt.size = elt.content ? elt.content.length : 0;\n\t\telt.start = 0;\n\t\telt.clsid = (elt.clsid || HEADER_CLSID);\n\t\tif(i === 0) {\n\t\t\telt.C = data.length > 1 ? 1 : -1;\n\t\t\telt.size = 0;\n\t\t\telt.type = 5;\n\t\t} else if(nm.slice(-1) == \"/\") {\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==nm) break;\n\t\t\telt.C = j >= data.length ? -1 : j;\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==dirname(nm)) break;\n\t\t\telt.R = j >= data.length ? -1 : j;\n\t\t\telt.type = 1;\n\t\t} else {\n\t\t\tif(dirname(cfb.FullPaths[i+1]||\"\") == dirname(nm)) elt.R = i + 1;\n\t\t\telt.type = 2;\n\t\t}\n\t}\n\n}\n\nfunction _write(cfb, options) {\n\tvar _opts = options || {};\n\t/* MAD is order-sensitive, skip rebuild and sort */\n\tif(_opts.fileType == 'mad') return write_mad(cfb, _opts);\n\trebuild_cfb(cfb);\n\tswitch(_opts.fileType) {\n\t\tcase 'zip': return write_zip(cfb, _opts);\n\t\t//case 'mad': return write_mad(cfb, _opts);\n\t}\n\tvar L = (function(cfb){\n\t\tvar mini_size = 0, fat_size = 0;\n\t\tfor(var i = 0; i < cfb.FileIndex.length; ++i) {\n\t\t\tvar file = cfb.FileIndex[i];\n\t\t\tif(!file.content) continue;\n\t\t\tvar flen = file.content.length;\n\t\t\tif(flen > 0){\n\t\t\t\tif(flen < 0x1000) mini_size += (flen + 0x3F) >> 6;\n\t\t\t\telse fat_size += (flen + 0x01FF) >> 9;\n\t\t\t}\n\t\t}\n\t\tvar dir_cnt = (cfb.FullPaths.length +3) >> 2;\n\t\tvar mini_cnt = (mini_size + 7) >> 3;\n\t\tvar mfat_cnt = (mini_size + 0x7F) >> 7;\n\t\tvar fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n\t\tvar fat_cnt = (fat_base + 0x7F) >> 7;\n\t\tvar difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\twhile(((fat_base + fat_cnt + difat_cnt + 0x7F) >> 7) > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\tvar L =  [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n\t\tcfb.FileIndex[0].size = mini_size << 6;\n\t\tL[7] = (cfb.FileIndex[0].start=L[0]+L[1]+L[2]+L[3]+L[4]+L[5])+((L[6]+7) >> 3);\n\t\treturn L;\n\t})(cfb);\n\tvar o = new_buf(L[7] << 9);\n\tvar i = 0, T = 0;\n\t{\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(2, 0);\n\t\to.write_shift(2, 0x003E);\n\t\to.write_shift(2, 0x0003);\n\t\to.write_shift(2, 0xFFFE);\n\t\to.write_shift(2, 0x0009);\n\t\to.write_shift(2, 0x0006);\n\t\tfor(i = 0; i < 3; ++i) o.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, L[2]);\n\t\to.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, 1<<12);\n\t\to.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[3]);\n\t\to.write_shift(-4, L[1] ? L[0] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[1]);\n\t\tfor(i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t}\n\tif(L[1]) {\n\t\tfor(T = 0; T < L[1]; ++T) {\n\t\t\tfor(; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t\t\to.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n\t\t}\n\t}\n\tvar chainit = function(w) {\n\t\tfor(T += w; i<T-1; ++i) o.write_shift(-4, i+1);\n\t\tif(w) { ++i; o.write_shift(-4, ENDOFCHAIN); }\n\t};\n\tT = i = 0;\n\tfor(T+=L[1]; i<T; ++i) o.write_shift(-4, consts.DIFSECT);\n\tfor(T+=L[2]; i<T; ++i) o.write_shift(-4, consts.FATSECT);\n\tchainit(L[3]);\n\tchainit(L[4]);\n\tvar j = 0, flen = 0;\n\tvar file = cfb.FileIndex[0];\n\tfor(; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\nflen = file.content.length;\n\t\tif(flen < 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x01FF) >> 9);\n\t}\n\tchainit((L[6] + 7) >> 3);\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tT = i = 0;\n\tfor(j = 0; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\nflen = file.content.length;\n\t\tif(!flen || flen >= 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x3F) >> 6);\n\t}\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tfor(i = 0; i < L[4]<<2; ++i) {\n\t\tvar nm = cfb.FullPaths[i];\n\t\tif(!nm || nm.length === 0) {\n\t\t\tfor(j = 0; j < 17; ++j) o.write_shift(4, 0);\n\t\t\tfor(j = 0; j < 3; ++j) o.write_shift(4, -1);\n\t\t\tfor(j = 0; j < 12; ++j) o.write_shift(4, 0);\n\t\t\tcontinue;\n\t\t}\n\t\tfile = cfb.FileIndex[i];\n\t\tif(i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n\t\tvar _nm = (i === 0 && _opts.root) || file.name;\n\t\tif(_nm.length > 32) {\n\t\t\tconsole.error(\"Name \" + _nm + \" will be truncated to \" + _nm.slice(0,32));\n\t\t\t_nm = _nm.slice(0, 32);\n\t\t}\n\t\tflen = 2*(_nm.length+1);\n\t\to.write_shift(64, _nm, \"utf16le\");\n\t\to.write_shift(2, flen);\n\t\to.write_shift(1, file.type);\n\t\to.write_shift(1, file.color);\n\t\to.write_shift(-4, file.L);\n\t\to.write_shift(-4, file.R);\n\t\to.write_shift(-4, file.C);\n\t\tif(!file.clsid) for(j = 0; j < 4; ++j) o.write_shift(4, 0);\n\t\telse o.write_shift(16, file.clsid, \"hex\");\n\t\to.write_shift(4, file.state || 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, file.start);\n\t\to.write_shift(4, file.size); o.write_shift(4, 0);\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\nif(file.size >= 0x1000) {\n\t\t\to.l = (file.start+1) << 9;\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 511) & -512;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x1FF; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\nif(file.size > 0 && file.size < 0x1000) {\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 63) & -64;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x3F; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tif (has_buf) {\n\t\to.l = o.length;\n\t} else {\n\t\t// When using Buffer, already 0-filled\n\t\twhile(o.l < o.length) o.write_shift(1, 0);\n\t}\n\treturn o;\n}\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\nfunction find(cfb, path) {\n\tvar UCFullPaths = cfb.FullPaths.map(function(x) { return x.toUpperCase(); });\n\tvar UCPaths = UCFullPaths.map(function(x) { var y = x.split(\"/\"); return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)]; });\n\tvar k = false;\n\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k = true; path = UCFullPaths[0].slice(0, -1) + path; }\n\telse k = path.indexOf(\"/\") !== -1;\n\tvar UCPath = path.toUpperCase();\n\tvar w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n\tif(w !== -1) return cfb.FileIndex[w];\n\n\tvar m = !UCPath.match(chr1);\n\tUCPath = UCPath.replace(chr0,'');\n\tif(m) UCPath = UCPath.replace(chr1,'!');\n\tfor(w = 0; w < UCFullPaths.length; ++w) {\n\t\tif((m ? UCFullPaths[w].replace(chr1,'!') : UCFullPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t\tif((m ? UCPaths[w].replace(chr1,'!') : UCPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t}\n\treturn null;\n}\n/** CFB Constants */\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n/* 2.1 Compound File Sector Numbers and Types */\nvar ENDOFCHAIN = -2;\n/* 2.2 Compound File Header */\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\nvar HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\nvar HEADER_CLSID = '00000000000000000000000000000000';\nvar consts = {\n\t/* 2.1 Compund File Sector Numbers and Types */\n\tMAXREGSECT: -6,\n\tDIFSECT: -4,\n\tFATSECT: -3,\n\tENDOFCHAIN: ENDOFCHAIN,\n\tFREESECT: -1,\n\t/* 2.2 Compound File Header */\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\n\tHEADER_MINOR_VERSION: '3e00',\n\tMAXREGSID: -6,\n\tNOSTREAM: -1,\n\tHEADER_CLSID: HEADER_CLSID,\n\t/* 2.6.1 Compound File Directory Entry */\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\n};\n\nfunction write_file(cfb, filename, options) {\n\tget_fs();\n\tvar o = _write(cfb, options);\nfs.writeFileSync(filename, o);\n}\n\nfunction a2s(o) {\n\tvar out = new Array(o.length);\n\tfor(var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\n\treturn out.join(\"\");\n}\n\nfunction write(cfb, options) {\n\tvar o = _write(cfb, options);\n\tswitch(options && options.type || \"buffer\") {\n\t\tcase \"file\": get_fs(); fs.writeFileSync(options.filename, (o)); return o;\n\t\tcase \"binary\": return typeof o == \"string\" ? o : a2s(o);\n\t\tcase \"base64\": return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n\t\tcase \"buffer\": if(has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n\t\t\t/* falls through */\n\t\tcase \"array\": return typeof o == \"string\" ? s2a(o) : o;\n\t}\n\treturn o;\n}\n/* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\nvar _zlib;\nfunction use_zlib(zlib) { try {\n\tvar InflateRaw = zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tInflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n\tif(InflRaw.bytesRead) _zlib = zlib;\n\telse throw new Error(\"zlib does not expose bytesRead\");\n} catch(e) {console.error(\"cannot use native zlib: \" + (e.message || e)); } }\n\nfunction _inflateRawSync(payload, usz) {\n\tif(!_zlib) return _inflate(payload, usz);\n\tvar InflateRaw = _zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tvar out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n\tpayload.l += InflRaw.bytesRead;\n\treturn out;\n}\n\nfunction _deflateRawSync(payload) {\n\treturn _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n}\nvar CLEN_ORDER = [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ];\n\n/*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\nvar LEN_LN = [   3,   4,   5,   6,   7,   8,   9,  10,  11,  13 , 15,  17,  19,  23,  27,  31,  35,  43,  51,  59,  67,  83,  99, 115, 131, 163, 195, 227, 258 ];\n\n/*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\nvar DST_LN = [  1,  2,  3,  4,  5,  7,  9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577 ];\n\nfunction bit_swap_8(n) { var t = (((((n<<1)|(n<<11)) & 0x22110) | (((n<<5)|(n<<15)) & 0x88440))); return ((t>>16) | (t>>8) |t)&0xFF; }\n\nvar use_typed_arrays = typeof Uint8Array !== 'undefined';\n\nvar bitswap8 = use_typed_arrays ? new Uint8Array(1<<8) : [];\nfor(var q = 0; q < (1<<8); ++q) bitswap8[q] = bit_swap_8(q);\n\nfunction bit_swap_n(n, b) {\n\tvar rev = bitswap8[n & 0xFF];\n\tif(b <= 8) return rev >>> (8-b);\n\trev = (rev << 8) | bitswap8[(n>>8)&0xFF];\n\tif(b <= 16) return rev >>> (16-b);\n\trev = (rev << 8) | bitswap8[(n>>16)&0xFF];\n\treturn rev >>> (24-b);\n}\n\n/* helpers for unaligned bit reads */\nfunction read_bits_2(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 6 ? 0 : buf[h+1]<<8))>>>w)& 0x03; }\nfunction read_bits_3(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 5 ? 0 : buf[h+1]<<8))>>>w)& 0x07; }\nfunction read_bits_4(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 4 ? 0 : buf[h+1]<<8))>>>w)& 0x0F; }\nfunction read_bits_5(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 3 ? 0 : buf[h+1]<<8))>>>w)& 0x1F; }\nfunction read_bits_7(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 1 ? 0 : buf[h+1]<<8))>>>w)& 0x7F; }\n\n/* works up to n = 3 * 8 + 1 = 25 */\nfunction read_bits_n(buf, bl, n) {\n\tvar w = (bl&7), h = (bl>>>3), f = ((1<<n)-1);\n\tvar v = buf[h] >>> w;\n\tif(n < 8 - w) return v & f;\n\tv |= buf[h+1]<<(8-w);\n\tif(n < 16 - w) return v & f;\n\tv |= buf[h+2]<<(16-w);\n\tif(n < 24 - w) return v & f;\n\tv |= buf[h+3]<<(24-w);\n\treturn v & f;\n}\n\n/* helpers for unaligned bit writes */\nfunction write_bits_3(buf, bl, v) { var w = bl & 7, h = bl >>> 3;\n\tif(w <= 5) buf[h] |= (v & 7) << w;\n\telse {\n\t\tbuf[h] |= (v << w) & 0xFF;\n\t\tbuf[h+1] = (v&7) >> (8-w);\n\t}\n\treturn bl + 3;\n}\n\nfunction write_bits_1(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv = (v&1) << w;\n\tbuf[h] |= v;\n\treturn bl + 1;\n}\nfunction write_bits_8(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v;\n\treturn bl + 8;\n}\nfunction write_bits_16(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v & 0xFF;\n\tbuf[h+2] = v >>> 8;\n\treturn bl + 16;\n}\n\n/* until ArrayBuffer#realloc is a thing, fake a realloc */\nfunction realloc(b, sz) {\n\tvar L = b.length, M = 2*L > sz ? 2*L : sz + 5, i = 0;\n\tif(L >= sz) return b;\n\tif(has_buf) {\n\t\tvar o = new_unsafe_buf(M);\n\t\t// $FlowIgnore\n\t\tif(b.copy) b.copy(o);\n\t\telse for(; i < b.length; ++i) o[i] = b[i];\n\t\treturn o;\n\t} else if(use_typed_arrays) {\n\t\tvar a = new Uint8Array(M);\n\t\tif(a.set) a.set(b);\n\t\telse for(; i < L; ++i) a[i] = b[i];\n\t\treturn a;\n\t}\n\tb.length = M;\n\treturn b;\n}\n\n/* zero-filled arrays for older browsers */\nfunction zero_fill_array(n) {\n\tvar o = new Array(n);\n\tfor(var i = 0; i < n; ++i) o[i] = 0;\n\treturn o;\n}\n\n/* build tree (used for literals and lengths) */\nfunction build_tree(clens, cmap, MAX) {\n\tvar maxlen = 1, w = 0, i = 0, j = 0, ccode = 0, L = clens.length;\n\n\tvar bl_count  = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\tfor(i = 0; i < 32; ++i) bl_count[i] = 0;\n\n\tfor(i = L; i < MAX; ++i) clens[i] = 0;\n\tL = clens.length;\n\n\tvar ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n\t/* build code tree */\n\tfor(i = 0; i < L; ++i) {\n\t\tbl_count[(w = clens[i])]++;\n\t\tif(maxlen < w) maxlen = w;\n\t\tctree[i] = 0;\n\t}\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) bl_count[i+16] = (ccode = (ccode + bl_count[i-1])<<1);\n\tfor(i = 0; i < L; ++i) {\n\t\tccode = clens[i];\n\t\tif(ccode != 0) ctree[i] = bl_count[ccode+16]++;\n\t}\n\n\t/* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bit_swap_n(ctree[i], maxlen)>>(maxlen-cleni);\n\t\t\tfor(j = (1<<(maxlen + 4 - cleni)) - 1; j>=0; --j)\n\t\t\t\tcmap[ccode|(j<<cleni)] = (cleni&15) | (i<<4);\n\t\t}\n\t}\n\treturn maxlen;\n}\n\n/* Fixed Huffman */\nvar fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\nvar fix_dmap = use_typed_arrays ? new Uint16Array(32)  : zero_fill_array(32);\nif(!use_typed_arrays) {\n\tfor(var i = 0; i < 512; ++i) fix_lmap[i] = 0;\n\tfor(i = 0; i < 32; ++i) fix_dmap[i] = 0;\n}\n(function() {\n\tvar dlens = [];\n\tvar i = 0;\n\tfor(;i<32; i++) dlens.push(5);\n\tbuild_tree(dlens, fix_dmap, 32);\n\n\tvar clens = [];\n\ti = 0;\n\tfor(; i<=143; i++) clens.push(8);\n\tfor(; i<=255; i++) clens.push(9);\n\tfor(; i<=279; i++) clens.push(7);\n\tfor(; i<=287; i++) clens.push(8);\n\tbuild_tree(clens, fix_lmap, 288);\n})();var _deflateRaw = (function _deflateRawIIFE() {\n\tvar DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n\tvar j = 0, k = 0;\n\tfor(; j < DST_LN.length - 1; ++j) {\n\t\tfor(; k < DST_LN[j+1]; ++k) DST_LN_RE[k] = j;\n\t}\n\tfor(;k < 32768; ++k) DST_LN_RE[k] = 29;\n\n\tvar LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n\tfor(j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n\t\tfor(; k < LEN_LN[j+1]; ++k) LEN_LN_RE[k] = j;\n\t}\n\n\tfunction write_stored(data, out) {\n\t\tvar boff = 0;\n\t\twhile(boff < data.length) {\n\t\t\tvar L = Math.min(0xFFFF, data.length - boff);\n\t\t\tvar h = boff + L == data.length;\n\t\t\tout.write_shift(1, +h);\n\t\t\tout.write_shift(2, L);\n\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t}\n\t\treturn out.l;\n\t}\n\n\t/* Fixed Huffman */\n\tfunction write_huff_fixed(data, out) {\n\t\tvar bl = 0;\n\t\tvar boff = 0;\n\t\tvar addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n\t\twhile(boff < data.length) {\n\t\t\tvar L = /* data.length - boff; */ Math.min(0xFFFF, data.length - boff);\n\n\t\t\t/* write a stored block for short data */\n\t\t\tif(L < 10) {\n\t\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n\t\t\t\tif(bl & 7) bl += 8 - (bl & 7);\n\t\t\t\tout.l = (bl / 8) | 0;\n\t\t\t\tout.write_shift(2, L);\n\t\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t\t\tbl = out.l * 8;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n\t\t\tvar hash = 0;\n\t\t\twhile(L-- > 0) {\n\t\t\t\tvar d = data[boff];\n\t\t\t\thash = ((hash << 5) ^ d) & 0x7FFF;\n\n\t\t\t\tvar match = -1, mlen = 0;\n\n\t\t\t\tif((match = addrs[hash])) {\n\t\t\t\t\tmatch |= boff & ~0x7FFF;\n\t\t\t\t\tif(match > boff) match -= 0x8000;\n\t\t\t\t\tif(match < boff) while(data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;\n\t\t\t\t}\n\n\t\t\t\tif(mlen > 2) {\n\t\t\t\t\t/* Copy Token  */\n\t\t\t\t\td = LEN_LN_RE[mlen];\n\t\t\t\t\tif(d <= 22) bl = write_bits_8(out, bl, bitswap8[d+1]>>1) - 1;\n\t\t\t\t\telse {\n\t\t\t\t\t\twrite_bits_8(out, bl, 3);\n\t\t\t\t\t\tbl += 5;\n\t\t\t\t\t\twrite_bits_8(out, bl, bitswap8[d-23]>>5);\n\t\t\t\t\t\tbl += 3;\n\t\t\t\t\t}\n\t\t\t\t\tvar len_eb = (d < 8) ? 0 : ((d - 4)>>2);\n\t\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, mlen - LEN_LN[d]);\n\t\t\t\t\t\tbl += len_eb;\n\t\t\t\t\t}\n\n\t\t\t\t\td = DST_LN_RE[boff - match];\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]>>3);\n\t\t\t\t\tbl -= 3;\n\n\t\t\t\t\tvar dst_eb = d < 4 ? 0 : (d-2)>>1;\n\t\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, boff - match - DST_LN[d]);\n\t\t\t\t\t\tbl += dst_eb;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var q = 0; q < mlen; ++q) {\n\t\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t\thash = ((hash << 5) ^ data[boff]) & 0x7FFF;\n\t\t\t\t\t\t++boff;\n\t\t\t\t\t}\n\t\t\t\t\tL-= mlen - 1;\n\t\t\t\t} else {\n\t\t\t\t\t/* Literal Token */\n\t\t\t\t\tif(d <= 143) d = d + 48;\n\t\t\t\t\telse bl = write_bits_1(out, bl, 1);\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]);\n\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t++boff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbl = write_bits_8(out, bl, 0) - 1;\n\t\t}\n\t\tout.l = ((bl + 7)/8)|0;\n\t\treturn out.l;\n\t}\n\treturn function _deflateRaw(data, out) {\n\t\tif(data.length < 8) return write_stored(data, out);\n\t\treturn write_huff_fixed(data, out);\n\t};\n})();\n\nfunction _deflate(data) {\n\tvar buf = new_buf(50+Math.floor(data.length*1.1));\n\tvar off = _deflateRaw(data, buf);\n\treturn buf.slice(0, off);\n}\n/* modified inflate function also moves original read head */\n\nvar dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_cmap = use_typed_arrays ? new Uint16Array(128)   : zero_fill_array(128);\nvar dyn_len_1 = 1, dyn_len_2 = 1;\n\n/* 5.5.3 Expanding Huffman Codes */\nfunction dyn(data, boff) {\n\t/* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n\tvar _HLIT = read_bits_5(data, boff) + 257; boff += 5;\n\tvar _HDIST = read_bits_5(data, boff) + 1; boff += 5;\n\tvar _HCLEN = read_bits_4(data, boff) + 4; boff += 4;\n\tvar w = 0;\n\n\t/* grab and store code lengths */\n\tvar clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n\tvar ctree = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\n\tvar maxlen = 1;\n\tvar bl_count =  use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar L = clens.length; /* 19 */\n\tfor(var i = 0; i < _HCLEN; ++i) {\n\t\tclens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n\t\tif(maxlen < w) maxlen = w;\n\t\tbl_count[w]++;\n\t\tboff += 3;\n\t}\n\n\t/* build code tree */\n\tvar ccode = 0;\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) next_code[i] = ccode = (ccode + bl_count[i-1])<<1;\n\tfor(i = 0; i < L; ++i) if((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n\t/* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bitswap8[ctree[i]]>>(8-cleni);\n\t\t\tfor(var j = (1<<(7-cleni))-1; j>=0; --j) dyn_cmap[ccode|(j<<cleni)] = (cleni&7) | (i<<3);\n\t\t}\n\t}\n\n\t/* read literal and dist codes at once */\n\tvar hcodes = [];\n\tmaxlen = 1;\n\tfor(; hcodes.length < _HLIT + _HDIST;) {\n\t\tccode = dyn_cmap[read_bits_7(data, boff)];\n\t\tboff += ccode & 7;\n\t\tswitch((ccode >>>= 3)) {\n\t\t\tcase 16:\n\t\t\t\tw = 3 + read_bits_2(data, boff); boff += 2;\n\t\t\t\tccode = hcodes[hcodes.length - 1];\n\t\t\t\twhile(w-- > 0) hcodes.push(ccode);\n\t\t\t\tbreak;\n\t\t\tcase 17:\n\t\t\t\tw = 3 + read_bits_3(data, boff); boff += 3;\n\t\t\t\twhile(w-- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tcase 18:\n\t\t\t\tw = 11 + read_bits_7(data, boff); boff += 7;\n\t\t\t\twhile(w -- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\thcodes.push(ccode);\n\t\t\t\tif(maxlen < ccode) maxlen = ccode;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* build literal / length trees */\n\tvar h1 = hcodes.slice(0, _HLIT), h2 = hcodes.slice(_HLIT);\n\tfor(i = _HLIT; i < 286; ++i) h1[i] = 0;\n\tfor(i = _HDIST; i < 30; ++i) h2[i] = 0;\n\tdyn_len_1 = build_tree(h1, dyn_lmap, 286);\n\tdyn_len_2 = build_tree(h2, dyn_dmap, 30);\n\treturn boff;\n}\n\n/* return [ data, bytesRead ] */\nfunction inflate(data, usz) {\n\t/* shortcircuit for empty buffer [0x03, 0x00] */\n\tif(data[0] == 3 && !(data[1] & 0x3)) { return [new_raw_buf(usz), 2]; }\n\n\t/* bit offset */\n\tvar boff = 0;\n\n\t/* header includes final bit and type bits */\n\tvar header = 0;\n\n\tvar outbuf = new_unsafe_buf(usz ? usz : (1<<18));\n\tvar woff = 0;\n\tvar OL = outbuf.length>>>0;\n\tvar max_len_1 = 0, max_len_2 = 0;\n\n\twhile((header&1) == 0) {\n\t\theader = read_bits_3(data, boff); boff += 3;\n\t\tif((header >>> 1) == 0) {\n\t\t\t/* Stored block */\n\t\t\tif(boff & 7) boff += 8 - (boff&7);\n\t\t\t/* 2 bytes sz, 2 bytes bit inverse */\n\t\t\tvar sz = data[boff>>>3] | data[(boff>>>3)+1]<<8;\n\t\t\tboff += 32;\n\t\t\t/* push sz bytes */\n\t\t\tif(sz > 0) {\n\t\t\t\tif(!usz && OL < woff + sz) { outbuf = realloc(outbuf, woff + sz); OL = outbuf.length; }\n\t\t\t\twhile(sz-- > 0) { outbuf[woff++] = data[boff>>>3]; boff += 8; }\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else if((header >> 1) == 1) {\n\t\t\t/* Fixed Huffman */\n\t\t\tmax_len_1 = 9; max_len_2 = 5;\n\t\t} else {\n\t\t\t/* Dynamic Huffman */\n\t\t\tboff = dyn(data, boff);\n\t\t\tmax_len_1 = dyn_len_1; max_len_2 = dyn_len_2;\n\t\t}\n\t\tfor(;;) { // while(true) is apparently out of vogue in modern JS circles\n\t\t\tif(!usz && (OL < woff + 32767)) { outbuf = realloc(outbuf, woff + 32767); OL = outbuf.length; }\n\t\t\t/* ingest code and move read head */\n\t\t\tvar bits = read_bits_n(data, boff, max_len_1);\n\t\t\tvar code = (header>>>1) == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t/* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n\t\t\tif(((code>>>8)&0xFF) === 0) outbuf[woff++] = code;\n\t\t\telse if(code == 256) break;\n\t\t\telse {\n\t\t\t\tcode -= 257;\n\t\t\t\tvar len_eb = (code < 8) ? 0 : ((code-4)>>2); if(len_eb > 5) len_eb = 0;\n\t\t\t\tvar tgt = woff + LEN_LN[code];\n\t\t\t\t/* length extra bits */\n\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\ttgt += read_bits_n(data, boff, len_eb);\n\t\t\t\t\tboff += len_eb;\n\t\t\t\t}\n\n\t\t\t\t/* dist code */\n\t\t\t\tbits = read_bits_n(data, boff, max_len_2);\n\t\t\t\tcode = (header>>>1) == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n\t\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t\tvar dst_eb = (code < 4 ? 0 : (code-2)>>1);\n\t\t\t\tvar dst = DST_LN[code];\n\t\t\t\t/* dist extra bits */\n\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\tdst += read_bits_n(data, boff, dst_eb);\n\t\t\t\t\tboff += dst_eb;\n\t\t\t\t}\n\n\t\t\t\t/* in the common case, manual byte copy is faster than TA set / Buffer copy */\n\t\t\t\tif(!usz && OL < tgt) { outbuf = realloc(outbuf, tgt + 100); OL = outbuf.length; }\n\t\t\t\twhile(woff < tgt) { outbuf[woff] = outbuf[woff - dst]; ++woff; }\n\t\t\t}\n\t\t}\n\t}\n\tif(usz) return [outbuf, (boff+7)>>>3];\n\treturn [outbuf.slice(0, woff), (boff+7)>>>3];\n}\n\nfunction _inflate(payload, usz) {\n\tvar data = payload.slice(payload.l||0);\n\tvar out = inflate(data, usz);\n\tpayload.l += out[1];\n\treturn out[0];\n}\n\nfunction warn_or_throw(wrn, msg) {\n\tif(wrn) { if(typeof console !== 'undefined') console.error(msg); }\n\telse throw new Error(msg);\n}\n\nfunction parse_zip(file, options) {\n\tvar blob = file;\n\tprep_blob(blob, 0);\n\n\tvar FileIndex = [], FullPaths = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o, { root: options.root });\n\n\t/* find end of central directory, start just after signature */\n\tvar i = blob.length - 4;\n\twhile((blob[i] != 0x50 || blob[i+1] != 0x4b || blob[i+2] != 0x05 || blob[i+3] != 0x06) && i >= 0) --i;\n\tblob.l = i + 4;\n\n\t/* parse end of central directory */\n\tblob.l += 4;\n\tvar fcnt = blob.read_shift(2);\n\tblob.l += 6;\n\tvar start_cd = blob.read_shift(4);\n\n\t/* parse central directory */\n\tblob.l = start_cd;\n\n\tfor(i = 0; i < fcnt; ++i) {\n\t\t/* trust local file header instead of CD entry */\n\t\tblob.l += 20;\n\t\tvar csz = blob.read_shift(4);\n\t\tvar usz = blob.read_shift(4);\n\t\tvar namelen = blob.read_shift(2);\n\t\tvar efsz = blob.read_shift(2);\n\t\tvar fcsz = blob.read_shift(2);\n\t\tblob.l += 8;\n\t\tvar offset = blob.read_shift(4);\n\t\tvar EF = parse_extra_field(blob.slice(blob.l+namelen, blob.l+namelen+efsz));\n\t\tblob.l += namelen + efsz + fcsz;\n\n\t\tvar L = blob.l;\n\t\tblob.l = offset + 4;\n\t\t/* ZIP64 lengths */\n\t\tif(EF && EF[0x0001]) {\n\t\t\tif((EF[0x0001]||{}).usz) usz = EF[0x0001].usz;\n\t\t\tif((EF[0x0001]||{}).csz) csz = EF[0x0001].csz;\n\t\t}\n\t\tparse_local_file(blob, csz, usz, o, EF);\n\t\tblob.l = L;\n\t}\n\n\treturn o;\n}\n\n\n/* head starts just after local file header signature */\nfunction parse_local_file(blob, csz, usz, o, EF) {\n\t/* [local file header] */\n\tblob.l += 2;\n\tvar flags = blob.read_shift(2);\n\tvar meth = blob.read_shift(2);\n\tvar date = parse_dos_date(blob);\n\n\tif(flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n\tvar crc32 = blob.read_shift(4);\n\tvar _csz = blob.read_shift(4);\n\tvar _usz = blob.read_shift(4);\n\n\tvar namelen = blob.read_shift(2);\n\tvar efsz = blob.read_shift(2);\n\n\t// TODO: flags & (1<<11) // UTF8\n\tvar name = \"\"; for(var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\n\tif(efsz) {\n\t\tvar ef = parse_extra_field(blob.slice(blob.l, blob.l + efsz));\n\t\tif((ef[0x5455]||{}).mt) date = ef[0x5455].mt;\n\t\tif((ef[0x0001]||{}).usz) _usz = ef[0x0001].usz;\n\t\tif((ef[0x0001]||{}).csz) _csz = ef[0x0001].csz;\n\t\tif(EF) {\n\t\t\tif((EF[0x5455]||{}).mt) date = EF[0x5455].mt;\n\t\t\tif((EF[0x0001]||{}).usz) _usz = ef[0x0001].usz;\n\t\t\tif((EF[0x0001]||{}).csz) _csz = ef[0x0001].csz;\n\t\t}\n\t}\n\tblob.l += efsz;\n\n\t/* [encryption header] */\n\n\t/* [file data] */\n\tvar data = blob.slice(blob.l, blob.l + _csz);\n\tswitch(meth) {\n\t\tcase 8: data = _inflateRawSync(blob, _usz); break;\n\t\tcase 0: break; // TODO: scan for magic number\n\t\tdefault: throw new Error(\"Unsupported ZIP Compression method \" + meth);\n\t}\n\n\t/* [data descriptor] */\n\tvar wrn = false;\n\tif(flags & 8) {\n\t\tcrc32 = blob.read_shift(4);\n\t\tif(crc32 == 0x08074b50) { crc32 = blob.read_shift(4); wrn = true; }\n\t\t_csz = blob.read_shift(4);\n\t\t_usz = blob.read_shift(4);\n\t}\n\n\tif(_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n\tif(_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz);\n\t//var _crc32 = CRC32.buf(data, 0);\n\t//if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n\tcfb_add(o, name, data, {unsafe: true, mt: date});\n}\nfunction write_zip(cfb, options) {\n\tvar _opts = options || {};\n\tvar out = [], cdirs = [];\n\tvar o = new_buf(1);\n\tvar method = (_opts.compression ? 8 : 0), flags = 0;\n\tvar desc = false;\n\tif(desc) flags |= 8;\n\tvar i = 0, j = 0;\n\n\tvar start_cd = 0, fcnt = 0;\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tvar crcs = [];\n\tvar sz_cd = 0;\n\n\tfor(i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length); fi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\t\tvar start = start_cd;\n\n\t\t/* TODO: CP437 filename */\n\t\tvar namebuf = new_buf(fp.length);\n\t\tfor(j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n\t\tnamebuf = namebuf.slice(0, namebuf.l);\n\t\tcrcs[fcnt] = typeof fi.content == \"string\" ? CRC32.bstr(fi.content, 0) : CRC32.buf(fi.content, 0);\n\n\t\tvar outbuf = typeof fi.content == \"string\" ? s2a(fi.content) : fi.content;\n\t\tif(method == 8) outbuf = _deflateRawSync(outbuf);\n\n\t\t/* local file header */\n\t\to = new_buf(30);\n\t\to.write_shift(4, 0x04034b50);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\t/* TODO: last mod file time/date */\n\t\tif(fi.mt) write_dos_date(o, fi.mt);\n\t\telse o.write_shift(4, 0);\n\t\to.write_shift(-4, (flags & 8) ? 0 : crcs[fcnt]);\n\t\to.write_shift(4,  (flags & 8) ? 0 : outbuf.length);\n\t\to.write_shift(4,  (flags & 8) ? 0 : fi.content.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\n\t\tstart_cd += o.length;\n\t\tout.push(o);\n\t\tstart_cd += namebuf.length;\n\t\tout.push(namebuf);\n\n\t\t/* TODO: extra fields? */\n\n\t\t/* TODO: encryption header ? */\n\n\t\tstart_cd += outbuf.length;\n\t\tout.push(outbuf);\n\n\t\t/* data descriptor */\n\t\tif(flags & 8) {\n\t\t\to = new_buf(12);\n\t\t\to.write_shift(-4, crcs[fcnt]);\n\t\t\to.write_shift(4, outbuf.length);\n\t\t\to.write_shift(4, fi.content.length);\n\t\t\tstart_cd += o.l;\n\t\t\tout.push(o);\n\t\t}\n\n\t\t/* central directory */\n\t\to = new_buf(46);\n\t\to.write_shift(4, 0x02014b50);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\to.write_shift(4, 0); /* TODO: last mod file time/date */\n\t\to.write_shift(-4, crcs[fcnt]);\n\n\t\to.write_shift(4, outbuf.length);\n\t\to.write_shift(4, fi.content.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, start);\n\n\t\tsz_cd += o.l;\n\t\tcdirs.push(o);\n\t\tsz_cd += namebuf.length;\n\t\tcdirs.push(namebuf);\n\t\t++fcnt;\n\t}\n\n\t/* end of central directory */\n\to = new_buf(22);\n\to.write_shift(4, 0x06054b50);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, fcnt);\n\to.write_shift(2, fcnt);\n\to.write_shift(4, sz_cd);\n\to.write_shift(4, start_cd);\n\to.write_shift(2, 0);\n\n\treturn bconcat(([bconcat((out)), bconcat(cdirs), o]));\n}\nvar ContentTypeMap = ({\n\t\"htm\": \"text/html\",\n\t\"xml\": \"text/xml\",\n\n\t\"gif\": \"image/gif\",\n\t\"jpg\": \"image/jpeg\",\n\t\"png\": \"image/png\",\n\n\t\"mso\": \"application/x-mso\",\n\t\"thmx\": \"application/vnd.ms-officetheme\",\n\t\"sh33tj5\": \"application/octet-stream\"\n});\n\nfunction get_content_type(fi, fp) {\n\tif(fi.ctype) return fi.ctype;\n\n\tvar ext = fi.name || \"\", m = ext.match(/\\.([^\\.]+)$/);\n\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\n\tif(fp) {\n\t\tm = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n\t\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\t}\n\n\treturn \"application/octet-stream\";\n}\n\n/* 76 character chunks TODO: intertwine encoding */\nfunction write_base64_76(bstr) {\n\tvar data = Base64_encode(bstr);\n\tvar o = [];\n\tfor(var i = 0; i < data.length; i+= 76) o.push(data.slice(i, i+76));\n\treturn o.join(\"\\r\\n\") + \"\\r\\n\";\n}\n\n/*\nRules for QP:\n\t- escape =## applies for all non-display characters and literal \"=\"\n\t- space or tab at end of line must be encoded\n\t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n\t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n\nTODO: Some files from word appear to write line extensions with bare equals:\n\n```\n<table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n=\"70%\"\n```\n*/\nfunction write_quoted_printable(text) {\n\tvar encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function(c) {\n\t\tvar w = c.charCodeAt(0).toString(16).toUpperCase();\n\t\treturn \"=\" + (w.length == 1 ? \"0\" + w : w);\n\t});\n\n\tencoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n\n\tif(encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n\tencoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n\n\tvar o = [], split = encoded.split(\"\\r\\n\");\n\tfor(var si = 0; si < split.length; ++si) {\n\t\tvar str = split[si];\n\t\tif(str.length == 0) { o.push(\"\"); continue; }\n\t\tfor(var i = 0; i < str.length;) {\n\t\t\tvar end = 76;\n\t\t\tvar tmp = str.slice(i, i + end);\n\t\t\tif(tmp.charAt(end - 1) == \"=\") end --;\n\t\t\telse if(tmp.charAt(end - 2) == \"=\") end -= 2;\n\t\t\telse if(tmp.charAt(end - 3) == \"=\") end -= 3;\n\t\t\ttmp = str.slice(i, i + end);\n\t\t\ti += end;\n\t\t\tif(i < str.length) tmp += \"=\";\n\t\t\to.push(tmp);\n\t\t}\n\t}\n\n\treturn o.join(\"\\r\\n\");\n}\nfunction parse_quoted_printable(data) {\n\tvar o = [];\n\n\t/* unify long lines */\n\tfor(var di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\twhile(di <= data.length && line.charAt(line.length - 1) == \"=\") line = line.slice(0, line.length - 1) + data[++di];\n\t\to.push(line);\n\t}\n\n\t/* decode */\n\tfor(var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function($$) { return String.fromCharCode(parseInt($$.slice(1), 16)); });\n\treturn s2a(o.join(\"\\r\\n\"));\n}\n\n\nfunction parse_mime(cfb, data, root) {\n\tvar fname = \"\", cte = \"\", ctype = \"\", fdata;\n\tvar di = 0;\n\tfor(;di < 10; ++di) {\n\t\tvar line = data[di];\n\t\tif(!line || line.match(/^\\s*$/)) break;\n\t\tvar m = line.match(/^(.*?):\\s*([^\\s].*)$/);\n\t\tif(m) switch(m[1].toLowerCase()) {\n\t\t\tcase \"content-location\": fname = m[2].trim(); break;\n\t\t\tcase \"content-type\": ctype = m[2].trim(); break;\n\t\t\tcase \"content-transfer-encoding\": cte = m[2].trim(); break;\n\t\t}\n\t}\n\t++di;\n\tswitch(cte.toLowerCase()) {\n\t\tcase 'base64': fdata = s2a(Base64_decode(data.slice(di).join(\"\"))); break;\n\t\tcase 'quoted-printable': fdata = parse_quoted_printable(data.slice(di)); break;\n\t\tdefault: throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n\t}\n\tvar file = cfb_add(cfb, fname.slice(root.length), fdata, {unsafe: true});\n\tif(ctype) file.ctype = ctype;\n}\n\nfunction parse_mad(file, options) {\n\tif(a2s(file.slice(0,13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n\tvar root = (options && options.root || \"\");\n\t// $FlowIgnore\n\tvar data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n\tvar di = 0, row = \"\";\n\n\t/* if root is not specified, scan for the common prefix */\n\tfor(di = 0; di < data.length; ++di) {\n\t\trow = data[di];\n\t\tif(!/^Content-Location:/i.test(row)) continue;\n\t\trow = row.slice(row.indexOf(\"file\"));\n\t\tif(!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n\t\tif(row.slice(0, root.length) == root) continue;\n\t\twhile(root.length > 0) {\n\t\t\troot = root.slice(0, root.length - 1);\n\t\t\troot = root.slice(0, root.lastIndexOf(\"/\") + 1);\n\t\t\tif(row.slice(0,root.length) == root) break;\n\t\t}\n\t}\n\n\tvar mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n\tif(!mboundary) throw new Error(\"MAD cannot find boundary\");\n\tvar boundary = \"--\" + (mboundary[1] || \"\");\n\n\tvar FileIndex = [], FullPaths = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o);\n\tvar start_di, fcnt = 0;\n\tfor(di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\tif(line !== boundary && line !== boundary + \"--\") continue;\n\t\tif(fcnt++) parse_mime(o, data.slice(start_di, di), root);\n\t\tstart_di = di;\n\t}\n\treturn o;\n}\n\nfunction write_mad(cfb, options) {\n\tvar opts = options || {};\n\tvar boundary = opts.boundary || \"SheetJS\";\n\tboundary = '------=' + boundary;\n\n\tvar out = [\n\t\t'MIME-Version: 1.0',\n\t\t'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"',\n\t\t'',\n\t\t'',\n\t\t''\n\t];\n\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tfor(var i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length);\n\t\tfi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\n\t\t/* Normalize filename */\n\t\tfp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function(c) {\n\t\t\treturn \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n\t\t}).replace(/[\\u0080-\\uFFFF]/g, function(u) {\n\t\t\treturn \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n\t\t});\n\n\t\t/* Extract content as binary string */\n\t\tvar ca = fi.content;\n\t\t// $FlowIgnore\n\t\tvar cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n\n\t\t/* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n\t\tvar dispcnt = 0, L = Math.min(1024, cstr.length), cc = 0;\n\t\tfor(var csl = 0; csl <= L; ++csl) if((cc=cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n\t\tvar qp = dispcnt >= L * 4 / 5;\n\n\t\tout.push(boundary);\n\t\tout.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n\t\tout.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n\t\tout.push('Content-Type: ' + get_content_type(fi, fp));\n\t\tout.push('');\n\n\t\tout.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n\t}\n\tout.push(boundary + '--\\r\\n');\n\treturn out.join(\"\\r\\n\");\n}\nfunction cfb_new(opts) {\n\tvar o = ({});\n\tinit_cfb(o, opts);\n\treturn o;\n}\n\nfunction cfb_add(cfb, name, content, opts) {\n\tvar unsafe = opts && opts.unsafe;\n\tif(!unsafe) init_cfb(cfb);\n\tvar file = !unsafe && CFB.find(cfb, name);\n\tif(!file) {\n\t\tvar fpath = cfb.FullPaths[0];\n\t\tif(name.slice(0, fpath.length) == fpath) fpath = name;\n\t\telse {\n\t\t\tif(fpath.slice(-1) != \"/\") fpath += \"/\";\n\t\t\tfpath = (fpath + name).replace(\"//\",\"/\");\n\t\t}\n\t\tfile = ({name: filename(name), type: 2});\n\t\tcfb.FileIndex.push(file);\n\t\tcfb.FullPaths.push(fpath);\n\t\tif(!unsafe) CFB.utils.cfb_gc(cfb);\n\t}\nfile.content = (content);\n\tfile.size = content ? content.length : 0;\n\tif(opts) {\n\t\tif(opts.CLSID) file.clsid = opts.CLSID;\n\t\tif(opts.mt) file.mt = opts.mt;\n\t\tif(opts.ct) file.ct = opts.ct;\n\t}\n\treturn file;\n}\n\nfunction cfb_del(cfb, name) {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex.splice(j, 1);\n\t\tcfb.FullPaths.splice(j, 1);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_mov(cfb, old_name, new_name) {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, old_name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex[j].name = filename(new_name);\n\t\tcfb.FullPaths[j] = new_name;\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_gc(cfb) { rebuild_cfb(cfb, true); }\n\nexports.find = find;\nexports.read = read;\nexports.parse = parse;\nexports.write = write;\nexports.writeFile = write_file;\nexports.utils = {\n\tcfb_new: cfb_new,\n\tcfb_add: cfb_add,\n\tcfb_del: cfb_del,\n\tcfb_mov: cfb_mov,\n\tcfb_gc: cfb_gc,\n\tReadShift: ReadShift,\n\tCheckField: CheckField,\n\tprep_blob: prep_blob,\n\tbconcat: bconcat,\n\tuse_zlib: use_zlib,\n\t_deflateRaw: _deflate,\n\t_inflateRaw: _inflate,\n\tconsts: consts\n};\n\nreturn exports;\n})();\n\nvar _fs;\nfunction set_fs(fs) { _fs = fs; }\n\n/* normalize data for blob ctor */\nfunction blobify(data) {\n\tif(typeof data === \"string\") return s2ab(data);\n\tif(Array.isArray(data)) return a2u(data);\n\treturn data;\n}\n/* write or download file */\nfunction write_dl(fname, payload, enc) {\n\t/*global IE_SaveFile, Blob, navigator, saveAs, document, File, chrome */\n\tif(typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\n\tif(typeof Deno !== 'undefined') {\n\t\t/* in this spot, it's safe to assume typed arrays and TextEncoder/TextDecoder exist */\n\t\tif(enc && typeof payload == \"string\") switch(enc) {\n\t\t\tcase \"utf8\": payload = new TextEncoder(enc).encode(payload); break;\n\t\t\tcase \"binary\": payload = s2ab(payload); break;\n\t\t\t/* TODO: binary equivalent */\n\t\t\tdefault: throw new Error(\"Unsupported encoding \" + enc);\n\t\t}\n\t\treturn Deno.writeFileSync(fname, payload);\n\t}\n\tvar data = (enc == \"utf8\") ? utf8write(payload) : payload;\nif(typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\n\tif(typeof Blob !== 'undefined') {\n\t\tvar blob = new Blob([blobify(data)], {type:\"application/octet-stream\"});\nif(typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\nif(typeof saveAs !== 'undefined') return saveAs(blob, fname);\n\t\tif(typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\n\t\t\tvar url = URL.createObjectURL(blob);\nif(typeof chrome === 'object' && typeof (chrome.downloads||{}).download == \"function\") {\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn chrome.downloads.download({ url: url, filename: fname, saveAs: true });\n\t\t\t}\n\t\t\tvar a = document.createElement(\"a\");\n\t\t\tif(a.download != null) {\na.download = fname; a.href = url; document.body.appendChild(a); a.click();\ndocument.body.removeChild(a);\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn url;\n\t\t\t}\n\t\t} else if(typeof URL !== 'undefined' && !URL.createObjectURL && typeof chrome === 'object') {\n\t\t\t/* manifest v3 extensions -- no URL.createObjectURL */\n\t\t\tvar b64 = \"data:application/octet-stream;base64,\" + Base64_encode_arr(new Uint8Array(blobify(data)));\n\t\t\treturn chrome.downloads.download({ url: b64, filename: fname, saveAs: true });\n\t\t}\n\t}\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar out = File(fname); out.open(\"w\"); out.encoding = \"binary\";\n\t\tif(Array.isArray(payload)) payload = a2s(payload);\n\t\tout.write(payload); out.close(); return payload;\n\t} catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\n\tthrow new Error(\"cannot save file \" + fname);\n}\n\n/* read binary data from file */\nfunction read_binary(path) {\n\tif(typeof _fs !== 'undefined') return _fs.readFileSync(path);\n\tif(typeof Deno !== 'undefined') return Deno.readFileSync(path);\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar infile = File(path); infile.open(\"r\"); infile.encoding = \"binary\";\n\t\tvar data = infile.read(); infile.close();\n\t\treturn data;\n\t} catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\n\tthrow new Error(\"Cannot access file \" + path);\n}\nfunction keys(o) {\n\tvar ks = Object.keys(o), o2 = [];\n\tfor(var i = 0; i < ks.length; ++i) if(Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n\treturn o2;\n}\n\nfunction evert_key(obj, key) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) if(o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\n\treturn o;\n}\n\nfunction evert(obj) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\treturn o;\n}\n\nfunction evert_num(obj) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\n\treturn o;\n}\n\nfunction evert_arr(obj) {\n\tvar o = ([]), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) {\n\t\tif(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n\t\to[obj[K[i]]].push(K[i]);\n\t}\n\treturn o;\n}\n\nvar dnthresh  = Date.UTC(1899, 11, 30, 0, 0, 0); // -2209161600000\nvar dnthresh1 = Date.UTC(1899, 11, 31, 0, 0, 0); // -2209075200000\nvar dnthresh2 = Date.UTC(1904, 0, 1, 0, 0, 0); // -2209075200000\nfunction datenum(v, date1904) {\n\tvar epoch = v.getTime();\n\tvar res = (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n\tif(date1904) { res -= 1462; return res < -1402 ? res - 1 : res; }\n\treturn res < 60 ? res - 1 : res;\n}\nfunction numdate(v) {\n\tif(v >= 60 && v < 61) return v;\n\tvar out = new Date();\n\tout.setTime((v>60 ? v : (v+1)) * 24 * 60 * 60 * 1000 + dnthresh);\n\treturn out;\n}\n\n/* ISO 8601 Duration */\nfunction parse_isodur(s) {\n\tvar sec = 0, mt = 0, time = false;\n\tvar m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n\tif(!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\tfor(var i = 1; i != m.length; ++i) {\n\t\tif(!m[i]) continue;\n\t\tmt = 1;\n\t\tif(i > 3) time = true;\n\t\tswitch(m[i].slice(m[i].length-1)) {\n\t\t\tcase 'Y':\n\t\t\t\tthrow new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length-1));\n\t\t\tcase 'D': mt *= 24;\n\t\t\t\t/* falls through */\n\t\t\tcase 'H': mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M':\n\t\t\t\tif(!time) throw new Error(\"Unsupported ISO Duration Field: M\");\n\t\t\t\telse mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'S': break;\n\t\t}\n\t\tsec += mt * parseInt(m[i], 10);\n\t}\n\treturn sec;\n}\n\n/* Blame https://bugs.chromium.org/p/v8/issues/detail?id=7863 for the regexide */\nvar pdre1 = /^(\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // HH:MM[:SS[.UUU]]\nvar pdre2 = /^(\\d+)-(\\d+)-(\\d+)$/; // YYYY-mm-dd\nvar pdre3 = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // YYYY-mm-dd(T or space)HH:MM[:SS[.UUU]], sans \"Z\"\n/* parses a date string as a UTC date */\nfunction parseDate(str, date1904) {\n\tif(str instanceof Date) return str;\n\tvar m = str.match(pdre1);\n\tif(m) return new Date((date1904 ? dnthresh2 : dnthresh1) + ((parseInt(m[1], 10)*60 + parseInt(m[2], 10))*60 + (m[3] ? parseInt(m[3].slice(1), 10) : 0))*1000 + (m[4] ? parseInt((m[4]+\"000\").slice(1,4), 10) : 0));\n\tm = str.match(pdre2);\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], 0, 0, 0, 0));\n\t/* TODO: 1900-02-29T00:00:00.000 should return a flag to treat as a date code (affects xlml) */\n\tm = str.match(pdre3);\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], +m[4], +m[5], ((m[6] && parseInt(m[6].slice(1), 10))|| 0), ((m[7] && parseInt(m[7].slice(1), 10))||0)));\n\tvar d = new Date(str);\n\treturn d;\n}\n\nfunction cc2str(arr, debomit) {\n\tif(has_buf && Buffer.isBuffer(arr)) {\n\t\tif(debomit && buf_utf16le) {\n\t\t\t// TODO: temporary patch\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n\t\t\tif(arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n\t\t}\n\t\treturn arr.toString(\"binary\");\n\t}\n\n\tif(typeof TextDecoder !== \"undefined\") try {\n\t\tif(debomit) {\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n\t\t\tif(arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n\t\t}\n\t\tvar rev = {\n\t\t\t\"\\u20ac\": \"\\x80\", \"\\u201a\": \"\\x82\", \"\\u0192\": \"\\x83\", \"\\u201e\": \"\\x84\",\n\t\t\t\"\\u2026\": \"\\x85\", \"\\u2020\": \"\\x86\", \"\\u2021\": \"\\x87\", \"\\u02c6\": \"\\x88\",\n\t\t\t\"\\u2030\": \"\\x89\", \"\\u0160\": \"\\x8a\", \"\\u2039\": \"\\x8b\", \"\\u0152\": \"\\x8c\",\n\t\t\t\"\\u017d\": \"\\x8e\", \"\\u2018\": \"\\x91\", \"\\u2019\": \"\\x92\", \"\\u201c\": \"\\x93\",\n\t\t\t\"\\u201d\": \"\\x94\", \"\\u2022\": \"\\x95\", \"\\u2013\": \"\\x96\", \"\\u2014\": \"\\x97\",\n\t\t\t\"\\u02dc\": \"\\x98\", \"\\u2122\": \"\\x99\", \"\\u0161\": \"\\x9a\", \"\\u203a\": \"\\x9b\",\n\t\t\t\"\\u0153\": \"\\x9c\", \"\\u017e\": \"\\x9e\", \"\\u0178\": \"\\x9f\"\n\t\t};\n\t\tif(Array.isArray(arr)) arr = new Uint8Array(arr);\n\t\treturn new TextDecoder(\"latin1\").decode(arr).replace(/[]/g, function(c) { return rev[c] || c; });\n\t} catch(e) {}\n\n\tvar o = [], i = 0;\n\t// this cascade is for the browsers and runtimes of antiquity (and for modern runtimes that lack TextEncoder)\n\ttry {\n\t\tfor(i = 0; i < arr.length - 65536; i+=65536) o.push(String.fromCharCode.apply(0, arr.slice(i, i + 65536)));\n\t\to.push(String.fromCharCode.apply(0, arr.slice(i)));\n\t} catch(e) { try {\n\t\t\tfor(; i < arr.length - 16384; i+=16384) o.push(String.fromCharCode.apply(0, arr.slice(i, i + 16384)));\n\t\t\to.push(String.fromCharCode.apply(0, arr.slice(i)));\n\t\t} catch(e) {\n\t\t\tfor(; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));\n\t\t}\n\t}\n\treturn o.join(\"\");\n}\n\nfunction dup(o) {\n\tif(typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n\tif(typeof o != 'object' || o == null) return o;\n\tif(o instanceof Date) return new Date(o.getTime());\n\tvar out = {};\n\tfor(var k in o) if(Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n\treturn out;\n}\n\nfunction fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\n\n/* TODO: stress test */\nfunction fuzzynum(s) {\n\tvar v = Number(s);\n\tif(!isNaN(v)) return isFinite(v) ? v : NaN;\n\tif(!/\\d/.test(s)) return v;\n\tvar wt = 1;\n\tvar ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\tss = ss.replace(/[(](.*)[)]/,function($$, $1) { wt = -wt; return $1;});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\treturn v;\n}\n\n/* NOTE: Chrome rejects bare times like 1:23 PM */\nvar FDRE1 = /^(0?\\d|1[0-2])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))\\s+([ap])m?$/;\nvar FDRE2 = /^([01]?\\d|2[0-3])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))$/;\nvar FDISO = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)(\\.\\d+)?[Z]?$/; // YYYY-mm-dd(T or space)HH:MM:SS[.UUU][Z]\n\n/* TODO: 1904 adjustment */\nvar utc_append_works = new Date(\"6/9/69 00:00 UTC\").valueOf() == -17798400000;\nfunction fuzzytime1(M)  {\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), 0, 0, 0));\n\tif(M[3]) {\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[4], parseFloat(M[3])*1000));\n\t\t\telse return new Date(Date.UTC(1899,11,31,(M[7] == \"p\" ? 12 : 0), +M[1], +M[2], parseFloat(M[3])*1000));\n\t}\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, (+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\n\telse return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], 0, 0));\n}\nfunction fuzzytime2(M)  {\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,+M[1], 0, 0, 0));\n\tif(M[3]) {\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,+M[1], +M[2], +M[4], parseFloat(M[3])*1000));\n\t\t\telse return new Date(Date.UTC(1899,11,31,0, +M[1], +M[2], parseFloat(M[3])*1000));\n\t}\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, +M[1], +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\n\telse return new Date(Date.UTC(1899,11,31,+M[1], +M[2], 0, 0));\n}\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\nfunction fuzzydate(s) {\n\t// See issue 2863 -- this is technically not supported in Excel but is otherwise useful\n\tif(FDISO.test(s)) return s.indexOf(\"Z\") == -1 ? local_to_utc(new Date(s)) : new Date(s);\n\tvar lower = s.toLowerCase();\n\tvar lnos = lower.replace(/\\s+/g, \" \").trim();\n\tvar M = lnos.match(FDRE1);\n\tif(M) return fuzzytime1(M);\n\tM = lnos.match(FDRE2);\n\tif(M) return fuzzytime2(M);\n\tM = lnos.match(pdre3);\n\tif(M) return new Date(Date.UTC(+M[1], +M[2]-1, +M[3], +M[4], +M[5], ((M[6] && parseInt(M[6].slice(1), 10))|| 0), ((M[7] && parseInt(M[7].slice(1), 10))||0)));\n\tvar o = new Date(utc_append_works && s.indexOf(\"UTC\") == -1 ? s + \" UTC\": s), n = new Date(NaN);\n\tvar y = o.getYear(), m = o.getMonth(), d = o.getDate();\n\tif(isNaN(d)) return n;\n\tif(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n\t\tlower = lower.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");\n\t\tif(lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n\t} else if(lower.replace(/[ap]m?/, \"\").match(/[a-z]/)) return n;\n\tif(y < 0 || y > 8099 || s.match(/[^-0-9:,\\/\\\\\\ ]/)) return n;\n\treturn o;\n}\n\nvar split_regex = (function() {\n\tvar safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n\treturn function split_regex(str, re, def) {\n\t\tif(safe_split_regex || typeof re == \"string\") return str.split(re);\n\t\tvar p = str.split(re), o = [p[0]];\n\t\tfor(var i = 1; i < p.length; ++i) { o.push(def); o.push(p[i]); }\n\t\treturn o;\n\t};\n})();\n\nfunction utc_to_local(utc) {\n\treturn new Date(utc.getUTCFullYear(), utc.getUTCMonth(), utc.getUTCDate(), utc.getUTCHours(), utc.getUTCMinutes(), utc.getUTCSeconds(), utc.getUTCMilliseconds());\n}\nfunction local_to_utc(local) {\n\treturn new Date(Date.UTC(local.getFullYear(), local.getMonth(), local.getDate(), local.getHours(), local.getMinutes(), local.getSeconds(), local.getMilliseconds()));\n}\nfunction getdatastr(data) {\n\tif(!data) return null;\n\tif(data.content && data.type) return cc2str(data.content, true);\n\tif(data.data) return debom(data.data);\n\tif(data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n\tif(data.asBinary) return debom(data.asBinary());\n\tif(data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\n\treturn null;\n}\n\nfunction getdatabin(data) {\n\tif(!data) return null;\n\tif(data.data) return char_codes(data.data);\n\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\tif(data._data && data._data.getContent) {\n\t\tvar o = data._data.getContent();\n\t\tif(typeof o == \"string\") return char_codes(o);\n\t\treturn Array.prototype.slice.call(o);\n\t}\n\tif(data.content && data.type) return data.content;\n\treturn null;\n}\n\nfunction getdata(data) { return (data && data.name.slice(-4) === \".bin\") ? getdatabin(data) : getdatastr(data); }\n\n/* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n/* OASIS does not comment on filename case sensitivity */\nfunction safegetzipfile(zip, file) {\n\tvar k = zip.FullPaths || keys(zip.files);\n\tvar f = file.toLowerCase().replace(/[\\/]/g, '\\\\'), g = f.replace(/\\\\/g,'\\/');\n\tfor(var i=0; i<k.length; ++i) {\n\t\tvar n = k[i].replace(/^Root Entry[\\/]/,\"\").toLowerCase();\n\t\tif(f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n\t}\n\treturn null;\n}\n\nfunction getzipfile(zip, file) {\n\tvar o = safegetzipfile(zip, file);\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n\treturn o;\n}\n\nfunction getzipdata(zip, file, safe) {\n\tif(!safe) return getdata(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipstr(zip, file, safe) {\n\tif(!safe) return getdatastr(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipstr(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipbin(zip, file, safe) {\n\tif(!safe) return getdatabin(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipbin(zip, file); } catch(e) { return null; }\n}\n\nfunction zipentries(zip) {\n\tvar k = zip.FullPaths || keys(zip.files), o = [];\n\tfor(var i = 0; i < k.length; ++i) if(k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n\treturn o.sort();\n}\n\nfunction zip_add_file(zip, path, content) {\n\tif(zip.FullPaths) {\n\t\tif(typeof content == \"string\") {\n\t\t\tvar res;\n\t\t\tif(has_buf) res = Buffer_from(content);\n\t\t\t/* TODO: investigate performance in Edge 13 */\n\t\t\t//else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n\t\t\telse res = utf8decode(content);\n\t\t\treturn CFB.utils.cfb_add(zip, path, res);\n\t\t}\n\t\tCFB.utils.cfb_add(zip, path, content);\n\t}\n\telse zip.file(path, content);\n}\n\nfunction zip_new() { return CFB.utils.cfb_new(); }\n\nfunction zip_read(d, o) {\n\tswitch(o.type) {\n\t\tcase \"base64\": return CFB.read(d, { type: \"base64\" });\n\t\tcase \"binary\": return CFB.read(d, { type: \"binary\" });\n\t\tcase \"buffer\": case \"array\": return CFB.read(d, { type: \"buffer\" });\n\t}\n\tthrow new Error(\"Unrecognized type \" + o.type);\n}\n\nfunction resolve_path(path, base) {\n\tif(path.charAt(0) == \"/\") return path.slice(1);\n\tvar result = base.split('/');\n\tif(base.slice(-1) != \"/\") result.pop(); // folder path\n\tvar target = path.split('/');\n\twhile (target.length !== 0) {\n\t\tvar step = target.shift();\n\t\tif (step === '..') result.pop();\n\t\telse if (step !== '.') result.push(step);\n\t}\n\treturn result.join('/');\n}\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar attregexg=/([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nvar tagregex1=/<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/mg, tagregex2 = /<[^>]*>/g;\nvar tagregex = XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\nfunction parsexmltag(tag, skip_root, skip_LC) {\n\tvar z = ({});\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.slice(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\", quot = 1;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i];\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.slice(0,c).trim();\n\t\twhile(cc.charCodeAt(c+1) == 32) ++c;\n\t\tquot = ((eq=cc.charCodeAt(c+1)) == 34 || eq == 39) ? 1 : 0;\n\t\tv = cc.slice(c+1+quot, cc.length-quot);\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\n\t\tif(j===q.length) {\n\t\t\tif(q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\t\t\tz[q] = v;\n\t\t\tif(!skip_LC) z[q.toLowerCase()] = v;\n\t\t}\n\t\telse {\n\t\t\tvar k = (j===5 && q.slice(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.slice(j+1);\n\t\t\tif(z[k] && q.slice(j-3,j) == \"ext\") continue; // from ods\n\t\t\tz[k] = v;\n\t\t\tif(!skip_LC) z[k.toLowerCase()] = v;\n\t\t}\n\t}\n\treturn z;\n}\nfunction strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = evert(encodings);\n//var rencstr = \"&<>'\\\"\".split(\"\");\n\n// TODO: CP remap (need to read file version to determine OS)\nvar unescapexml = (function() {\n\t/* 22.4.2.4 bstr (Basic String) */\n\tvar encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig, coderegex = /_x([\\da-fA-F]{4})_/ig;\n\tfunction raw_unescapexml(text) {\n\t\tvar s = text + '', i = s.indexOf(\"<![CDATA[\");\n\t\tif(i == -1) return s.replace(encregex, function($$, $1) { return encodings[$$]||String.fromCharCode(parseInt($1,$$.indexOf(\"x\")>-1?16:10))||$$; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\n\t\tvar j = s.indexOf(\"]]>\");\n\t\treturn raw_unescapexml(s.slice(0, i)) + s.slice(i+9,j) + raw_unescapexml(s.slice(j+3));\n\t}\n\treturn function unescapexml(text, xlsx) {\n\t\tvar out = raw_unescapexml(text);\n\t\treturn xlsx ? out.replace(/\\r\\n/g, \"\\n\") : out;\n\t};\n})();\n\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f\\uFFFE-\\uFFFF]/g;\nfunction escapexml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \"_\";});\n}\nfunction escapexmltag(text){ return escapexml(text).replace(/ /g,\"_x0020_\"); }\n\nvar htmlcharegex = /[\\u0000-\\u001f]/g;\nfunction escapehtml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex,function(s) { return \"&#x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \";\"; });\n}\n\nfunction escapexlml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(htmlcharegex,function(s) { return \"&#x\" + (s.charCodeAt(0).toString(16)).toUpperCase() + \";\"; });\n}\n\n/* TODO: handle codepages */\nvar xlml_fixstr = (function() {\n\tvar entregex = /&#(\\d+);/g;\n\tfunction entrepl($$,$1) { return String.fromCharCode(parseInt($1,10)); }\n\treturn function xlml_fixstr(str) { return str.replace(entregex,entrepl); };\n})();\nfunction xlml_unfixstr(str) { return str.replace(/(\\r\\n|[\\r\\n])/g,\"\\&#10;\"); }\n\n/* note: xsd:boolean valid values: true / 1 / false / 0 */\nfunction parsexmlbool(value) {\n\tswitch(value) {\n\t\tcase 1: case true:  case '1': case 'true':  return true;\n\t\tcase 0: case false: case '0': case 'false': return false;\n\t\t//default: throw new Error(\"Invalid xsd:boolean \" + value);\n\t}\n\treturn false;\n}\n\nfunction utf8reada(orig) {\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\n\t\td = orig.charCodeAt(i++);\n\t\tif (c>191 && c<224) { f = ((c & 31) << 6); f |= (d & 63); out += String.fromCharCode(f); continue; }\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\n\t}\n\treturn out;\n}\n\nfunction utf8readb(data) {\n\tvar out = new_raw_buf(2*data.length), w, i, j = 1, k = 0, ww=0, c;\n\tfor(i = 0; i < data.length; i+=j) {\n\t\tj = 1;\n\t\tif((c=data.charCodeAt(i)) < 128) w = c;\n\t\telse if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\n\t\telse if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\n\t\telse { j = 4;\n\t\t\tw = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\n\t\t\tw -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\n\t\t}\n\t\tif(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\n\t\tout[k++] = w%256; out[k++] = w>>>8;\n\t}\n\treturn out.slice(0,k).toString('ucs2');\n}\n\nfunction utf8readc(data) { return Buffer_from(data, 'binary').toString('utf8'); }\n\nvar utf8corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\nvar utf8read = has_buf && (utf8readc(utf8corpus) == utf8reada(utf8corpus) && utf8readc || utf8readb(utf8corpus) == utf8reada(utf8corpus) && utf8readb) || utf8reada;\n\nvar utf8write = has_buf ? function(data) { return Buffer_from(data, 'utf8').toString(\"binary\"); } : function(orig) {\n\tvar out = [], i = 0, c = 0, d = 0;\n\twhile(i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tswitch(true) {\n\t\t\tcase c < 128: out.push(String.fromCharCode(c)); break;\n\t\t\tcase c < 2048:\n\t\t\t\tout.push(String.fromCharCode(192 + (c >> 6)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t\t\tbreak;\n\t\t\tcase c >= 55296 && c < 57344:\n\t\t\t\tc -= 55296; d = orig.charCodeAt(i++) - 56320 + (c<<10);\n\t\t\t\tout.push(String.fromCharCode(240 + ((d >>18) & 7)));\n\t\t\t\tout.push(String.fromCharCode(144 + ((d >>12) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((d >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (d & 63)));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tout.push(String.fromCharCode(224 + (c >> 12)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((c >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t}\n\t}\n\treturn out.join(\"\");\n};\n\n// matches <foo>...</foo> extracts content\nvar matchtag = (function() {\n\tvar mtcache = ({});\n\treturn function matchtag(f,g) {\n\t\tvar t = f+\"|\"+(g||\"\");\n\t\tif(mtcache[t]) return mtcache[t];\n\t\treturn (mtcache[t] = new RegExp('<(?:\\\\w+:)?'+f+'(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?'+f+'>',((g||\"\"))));\n\t};\n})();\n\nvar htmldecode = (function() {\n\tvar entities = [\n\t\t['nbsp', ' '], ['middot', ''],\n\t\t['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\n\t].map(function(x) { return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]]; });\n\treturn function htmldecode(str) {\n\t\tvar o = str\n\t\t\t\t// Remove new lines and spaces from start of content\n\t\t\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\n\t\t\t\t// Remove new lines and spaces from end of content\n\t\t\t\t.replace(/[\\t\\n\\r ]+$/,\"\")\n\t\t\t\t// Added line which removes any white space characters after and before html tags\n\t\t\t\t.replace(/>\\s+/g,\">\").replace(/\\s+</g,\"<\")\n\t\t\t\t// Replace remaining new lines and spaces with space\n\t\t\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\n\t\t\t\t// Replace <br> tags with new lines\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\")\n\t\t\t\t// Strip HTML elements\n\t\t\t\t.replace(/<[^>]*>/g,\"\");\n\t\tfor(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n\t\treturn o;\n\t};\n})();\n\nvar vtregex = (function(){ var vt_cache = {};\n\treturn function vt_regex(bt) {\n\t\tif(vt_cache[bt] !== undefined) return vt_cache[bt];\n\t\treturn (vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g') );\n};})();\nvar vtvregex = /<\\/?(?:vt:)?variant>/g, vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\nfunction parseVector(data, opts) {\n\tvar h = parsexmltag(data);\n\n\tvar matches = data.match(vtregex(h.baseType))||[];\n\tvar res = [];\n\tif(matches.length != h.size) {\n\t\tif(opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n\t\treturn res;\n\t}\n\tmatches.forEach(function(x) {\n\t\tvar v = x.replace(vtvregex,\"\").match(vtmregex);\n\t\tif(v) res.push({v:utf8read(v[2]), t:v[1]});\n\t});\n\treturn res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\nfunction writetag(f,g) { return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>'; }\n\nfunction wxt_helper(h) { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\nfunction writextag(f,g,h) { return '<' + f + ((h != null) ? wxt_helper(h) : \"\") + ((g != null) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\n\nfunction write_w3cdtf(d, t) { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } return \"\"; }\n\nfunction write_vt(s, xlsx) {\n\tswitch(typeof s) {\n\t\tcase 'string':\n\t\t\tvar o = writextag('vt:lpwstr', escapexml(s));\n\t\t\tif(xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n\t\t\treturn o;\n\t\tcase 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', escapexml(String(s)));\n\t\tcase 'boolean': return writextag('vt:bool',s?'true':'false');\n\t}\n\tif(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n\tthrow new Error(\"Unable to serialize \" + s);\n}\n\nfunction xlml_normalize(d) {\n\tif(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\t/* duktape */\n\tif(typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n\tthrow new Error(\"Bad input format: expected Buffer or string\");\n}\n/* UOS uses CJK in tags */\nvar xlmlregex = /<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/](?:[^>=]|=\"[^\"]*?\")*)?>/mg;\n//var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\nvar XMLNS = ({\n\tCORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n\tCUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n\tEXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n\tCT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n\tRELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n\tTCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n\t'dc': 'http://purl.org/dc/elements/1.1/',\n\t'dcterms': 'http://purl.org/dc/terms/',\n\t'dcmitype': 'http://purl.org/dc/dcmitype/',\n\t'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n\t'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n\t'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n\t'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n\t'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n\t'xsd': 'http://www.w3.org/2001/XMLSchema'\n});\n\nvar XMLNS_main = [\n\t'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n\t'http://purl.oclc.org/ooxml/spreadsheetml/main',\n\t'http://schemas.microsoft.com/office/excel/2006/main',\n\t'http://schemas.microsoft.com/office/excel/2006/2'\n];\n\nvar XLMLNS = ({\n\t'o':    'urn:schemas-microsoft-com:office:office',\n\t'x':    'urn:schemas-microsoft-com:office:excel',\n\t'ss':   'urn:schemas-microsoft-com:office:spreadsheet',\n\t'dt':   'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\n\t'mv':   'http://macVmlSchemaUri',\n\t'v':    'urn:schemas-microsoft-com:vml',\n\t'html': 'http://www.w3.org/TR/REC-html40'\n});\nfunction read_double_le(b, idx) {\n\tvar s = 1 - 2 * (b[idx + 7] >>> 7);\n\tvar e = ((b[idx + 7] & 0x7f) << 4) + ((b[idx + 6] >>> 4) & 0x0f);\n\tvar m = (b[idx+6]&0x0f);\n\tfor(var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n\tif(e == 0x7ff) return m == 0 ? (s * Infinity) : NaN;\n\tif(e == 0) e = -1022;\n\telse { e -= 1023; m += Math.pow(2,52); }\n\treturn s * Math.pow(2, e - 52) * m;\n}\n\nfunction write_double_le(b, v, idx) {\n\tvar bs = ((((v < 0) || (1/v == -Infinity)) ? 1 : 0) << 7), e = 0, m = 0;\n\tvar av = bs ? (-v) : v;\n\tif(!isFinite(av)) { e = 0x7ff; m = isNaN(v) ? 0x6969 : 0; }\n\telse if(av == 0) e = m = 0;\n\telse {\n\t\te = Math.floor(Math.log(av) / Math.LN2);\n\t\tm = av * Math.pow(2, 52 - e);\n\t\tif((e <= -1023) && (!isFinite(m) || (m < Math.pow(2,52)))) { e = -1022; }\n\t\telse { m -= Math.pow(2,52); e+=1023; }\n\t}\n\tfor(var i = 0; i <= 5; ++i, m/=256) b[idx + i] = m & 0xff;\n\tb[idx + 6] = ((e & 0x0f) << 4) | (m & 0xf);\n\tb[idx + 7] = (e >> 4) | bs;\n}\n\nvar ___toBuffer = function(bufs) { var x=[],w=10240; for(var i=0;i<bufs[0].length;++i) if(bufs[0][i]) for(var j=0,L=bufs[0][i].length;j<L;j+=w) x.push.apply(x, bufs[0][i].slice(j,j+w)); return x; };\nvar __toBuffer = has_buf ? function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0].map(function(x) { return Buffer.isBuffer(x) ? x : Buffer_from(x); })) : ___toBuffer(bufs);} : ___toBuffer;\n\nvar ___utf16le = function(b,s,e) { var ss=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\").replace(chr0,''); };\nvar __utf16le = has_buf ? function(b,s,e) { if(!Buffer.isBuffer(b) || !buf_utf16le) return ___utf16le(b,s,e); return b.toString('utf16le',s,e).replace(chr0,'')/*.replace(chr1,'!')*/; } : ___utf16le;\n\nvar ___hexlify = function(b,s,l) { var ss=[]; for(var i=s; i<s+l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2)); return ss.join(\"\"); };\nvar __hexlify = has_buf ? function(b,s,l) { return Buffer.isBuffer(b) ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); } : ___hexlify;\n\nvar ___utf8 = function(b,s,e) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\nvar __utf8 = has_buf ? function utf8_b(b, s, e) { return (Buffer.isBuffer(b)) ? b.toString('utf8',s,e) : ___utf8(b,s,e); } : ___utf8;\n\nvar ___lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpstr = ___lpstr;\n\nvar ___cpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __cpstr = ___cpstr;\n\nvar ___lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpwstr = ___lpwstr;\n\nvar ___lpp4 = function lpp4_(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf16le(b, i+4,i+4+len) : \"\";};\nvar __lpp4 = ___lpp4;\n\nvar ___8lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len) : \"\";};\nvar __8lpp4 = ___8lpp4;\n\nvar ___double = function(b, idx) { return read_double_le(b, idx);};\nvar __double = ___double;\n\nvar is_buf = function is_buf_a(a) { return Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n\nif(has_buf) {\n\t__lpstr = function lpstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__cpstr = function cpstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___cpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__lpwstr = function lpwstr_b(b, i) { if(!Buffer.isBuffer(b) || !buf_utf16le) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\n\t__lpp4 = function lpp4_b(b, i) { if(!Buffer.isBuffer(b) || !buf_utf16le) return ___lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len);};\n\t__8lpp4 = function lpp4_8b(b, i) { if(!Buffer.isBuffer(b)) return ___8lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf8',i+4,i+4+len);};\n\t__double = function double_(b, i) { if(Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b,i); };\n\tis_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n}\n\n/* from js-xls */\nfunction cpdoit() {\n\t__utf16le = function(b,s,e) { return $cptable.utils.decode(1200, b.slice(s,e)).replace(chr0, ''); };\n\t__utf8 = function(b,s,e) { return $cptable.utils.decode(65001, b.slice(s,e)); };\n\t__lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__cpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\n\t__lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len)) : \"\";};\n\t__8lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(65001, b.slice(i+4,i+4+len)) : \"\";};\n}\nif(typeof $cptable !== 'undefined') cpdoit();\n\nvar __readUInt8 = function(b, idx) { return b[idx]; };\nvar __readUInt16LE = function(b, idx) { return (b[idx+1]*(1<<8))+b[idx]; };\nvar __readInt16LE = function(b, idx) { var u = (b[idx+1]*(1<<8))+b[idx]; return (u < 0x8000) ? u : ((0xffff - u + 1) * -1); };\nvar __readUInt32LE = function(b, idx) { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\nvar __readInt32LE = function(b, idx) { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\nvar __readInt32BE = function(b, idx) { return (b[idx]<<24)|(b[idx+1]<<16)|(b[idx+2]<<8)|b[idx+3]; };\n\nfunction ReadShift(size, t) {\n\tvar o=\"\", oI, oR, oo=[], w, vv, i, loc;\n\tswitch(t) {\n\t\tcase 'dbcs':\n\t\t\tloc = this.l;\n\t\t\tif(has_buf && Buffer.isBuffer(this)  && buf_utf16le) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\n\t\t\telse for(i = 0; i < size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\n\t\t\tsize *= 2;\n\t\t\tbreak;\n\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\n\n\t\tcase 'wstr':\n\t\t\tif(typeof $cptable !== 'undefined') o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l+2*size));\n\t\t\telse return ReadShift.call(this, size, 'dbcs');\n\t\t\tsize = 2 * size; break;\n\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\t\tcase 'lpstr-ansi': o = __lpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\tcase 'lpstr-cp': o = __cpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 4 + 2 * __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n\t\tcase 'lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __lpp4(this, this.l); if(size & 0x02) size += 2; break;\n\t\t/* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n\t\tcase '8lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __8lpp4(this, this.l); if(size & 0x03) size += 4 - (size & 0x03); break;\n\n\t\tcase 'cstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\n\t\t\to = oo.join(\"\"); break;\n\t\tcase '_wstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\n\t\t\tsize+=2; o = oo.join(\"\"); break;\n\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i < size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\n\t\t\t\tloc+=2;\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\n\n\t\tcase 'cpstr':\n\t\t\tif(typeof $cptable !== 'undefined') {\n\t\t\t\to = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t/* falls through */\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\n\t\t\t\tloc+=1;\n\t\t\t} o = oo.join(\"\"); break;\n\n\t\tdefault:\n\tswitch(size) {\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\n\t\tcase 4: case -4:\n\t\t\tif(t === 'i' || ((this[this.l+3] & 0x80)===0)) { oI = ((size > 0) ? __readInt32LE : __readInt32BE)(this, this.l); this.l += 4; return oI; }\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; } return oR;\n\t\tcase 8: case -8:\n\t\t\tif(t === 'f') {\n\t\t\t\tif(size == 8) oR = __double(this, this.l);\n\t\t\t\telse oR = __double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]], 0);\n\t\t\t\tthis.l += 8; return oR;\n\t\t\t} else size = 8;\n\t\t/* falls through */\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\n\t}}\n\tthis.l+=size; return o;\n}\n\nvar __writeUInt32LE = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); b[idx+2] = ((val >>> 16) & 0xFF); b[idx+3] = ((val >>> 24) & 0xFF); };\nvar __writeInt32LE  = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >> 8) & 0xFF); b[idx+2] = ((val >> 16) & 0xFF); b[idx+3] = ((val >> 24) & 0xFF); };\nvar __writeUInt16LE = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); };\n\nfunction WriteShift(t, val, f) {\n\tvar size = 0, i = 0;\n\tif(f === 'dbcs') {\nfor(i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n\t\tsize = 2 * val.length;\n\t} else if(f === 'sbcs' || f == 'cpstr') {\n\t\tif(typeof $cptable !== 'undefined' && current_ansi == 874) {\n\t\t\t/* TODO: use tables directly, don't encode */\nfor(i = 0; i != val.length; ++i) {\n\t\t\t\tvar cpp = $cptable.utils.encode(current_ansi, val.charAt(i));\n\t\t\t\tthis[this.l + i] = cpp[0];\n\t\t\t}\n\t\t\tsize = val.length;\n\t\t} else if(typeof $cptable !== 'undefined' && f == 'cpstr') {\n\t\t\tcpp = $cptable.utils.encode(current_codepage, val);\n\t\t\t/* replace null bytes with _ when relevant */\n      if(cpp.length == val.length) for(i = 0; i < val.length; ++i) if(cpp[i] == 0 && val.charCodeAt(i) != 0) cpp[i] = 0x5F;\n      if(cpp.length == 2 * val.length) for(i = 0; i < val.length; ++i) if(cpp[2*i] == 0 && cpp[2*i+1] == 0 && val.charCodeAt(i) != 0) cpp[2*i] = 0x5F;\n\t\t\tfor(i = 0; i < cpp.length; ++i) this[this.l + i] = cpp[i];\n\t\t\tsize = cpp.length;\n\t\t} else {\nval = val.replace(/[^\\x00-\\x7F]/g, \"_\");\nfor(i = 0; i != val.length; ++i) this[this.l + i] = (val.charCodeAt(i) & 0xFF);\n\t\t\tsize = val.length;\n\t\t}\n\t} else if(f === 'hex') {\n\t\tfor(; i < t; ++i) {\nthis[this.l++] = (parseInt(val.slice(2*i, 2*i+2), 16)||0);\n\t\t} return this;\n\t} else if(f === 'utf16le') {\nvar end = Math.min(this.l + t, this.length);\n\t\t\tfor(i = 0; i < Math.min(val.length, t); ++i) {\n\t\t\t\tvar cc = val.charCodeAt(i);\n\t\t\t\tthis[this.l++] = (cc & 0xff);\n\t\t\t\tthis[this.l++] = (cc >> 8);\n\t\t\t}\n\t\t\twhile(this.l < end) this[this.l++] = 0;\n\t\t\treturn this;\n\t} else  switch(t) {\n\t\tcase  1: size = 1; this[this.l] = val&0xFF; break;\n\t\tcase  2: size = 2; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; break;\n\t\tcase  3: size = 3; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; val >>>= 8; this[this.l+2] = val&0xFF; break;\n\t\tcase  4: size = 4; __writeUInt32LE(this, val, this.l); break;\n\t\tcase  8: size = 8; if(f === 'f') { write_double_le(this, val, this.l); break; }\n\t\t/* falls through */\n\t\tcase 16: break;\n\t\tcase -4: size = 4; __writeInt32LE(this, val, this.l); break;\n\t}\n\tthis.l += size; return this;\n}\n\nfunction CheckField(hexstr, fld) {\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\n\tif(m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n\tthis.l += hexstr.length>>1;\n}\n\nfunction prep_blob(blob, pos) {\n\tblob.l = pos;\n\tblob.read_shift = ReadShift;\n\tblob.chk = CheckField;\n\tblob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length) { blob.l += length; }\n\nfunction new_buf(sz) {\n\tvar o = new_raw_buf(sz);\n\tprep_blob(o, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.4 Record */\nfunction recordhopper(data, cb, opts) {\n\tif(!data) return;\n\tvar tmpbyte, cntbyte, length;\n\tprep_blob(data, data.l || 0);\n\tvar L = data.length, RT = 0, tgt = 0;\n\twhile(data.l < L) {\n\t\tRT = data.read_shift(1);\n\t\tif(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\n\t\tvar R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n\t\ttmpbyte = data.read_shift(1);\n\t\tlength = tmpbyte & 0x7F;\n\t\tfor(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\n\t\ttgt = data.l + length;\n\t\tvar d = R.f && R.f(data, length, opts);\n\t\tdata.l = tgt;\n\t\tif(cb(d, R, RT)) return;\n\t}\n}\n\n/* control buffer usage for fixed-length buffers */\nfunction buf_array() {\n\tvar bufs = [], blksz = has_buf ? 256 : 2048;\n\tvar newblk = function ba_newblk(sz) {\n\t\tvar o = (new_buf(sz));\n\t\tprep_blob(o, 0);\n\t\treturn o;\n\t};\n\n\tvar curbuf = newblk(blksz);\n\n\tvar endbuf = function ba_endbuf() {\n\t\tif(!curbuf) return;\n\t\t// workaround for new Buffer(3).slice(0,0) bug in bun 0.1.3\n\t\tif(curbuf.l) {\n\t\t\tif(curbuf.length > curbuf.l) { curbuf = curbuf.slice(0, curbuf.l); curbuf.l = curbuf.length; }\n\t\t\tif(curbuf.length > 0) bufs.push(curbuf);\n\t\t}\n\t\tcurbuf = null;\n\t};\n\n\tvar next = function ba_next(sz) {\n\t\tif(curbuf && (sz < (curbuf.length - curbuf.l))) return curbuf;\n\t\tendbuf();\n\t\treturn (curbuf = newblk(Math.max(sz+1, blksz)));\n\t};\n\n\tvar end = function ba_end() {\n\t\tendbuf();\n\t\treturn bconcat(bufs);\n\t};\n\n\tvar push = function ba_push(buf) { endbuf(); curbuf = buf; if(curbuf.l == null) curbuf.l = curbuf.length; next(blksz); };\n\n\treturn ({ next:next, push:push, end:end, _bufs:bufs });\n}\n\nfunction write_record(ba, type, payload, length) {\n\tvar t = +type, l;\n\tif(isNaN(t)) return; // TODO: throw something here?\n\tif(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\n\tl = 1 + (t >= 0x80 ? 1 : 0) + 1/* + length*/;\n\tif(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\n\tvar o = ba.next(l);\n\tif(t <= 0x7F) o.write_shift(1, t);\n\telse {\n\t\to.write_shift(1, (t & 0x7F) + 0x80);\n\t\to.write_shift(1, (t >> 7));\n\t}\n\tfor(var i = 0; i != 4; ++i) {\n\t\tif(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\n\t\telse { o.write_shift(1, length); break; }\n\t}\n\tif(length > 0 && is_buf(payload)) ba.push(payload);\n}\n/* XLS ranges enforced */\nfunction shift_cell_xls(cell, tgt, opts) {\n\tvar out = dup(cell);\n\tif(tgt.s) {\n\t\tif(out.cRel) out.c += tgt.s.c;\n\t\tif(out.rRel) out.r += tgt.s.r;\n\t} else {\n\t\tif(out.cRel) out.c += tgt.c;\n\t\tif(out.rRel) out.r += tgt.r;\n\t}\n\tif(!opts || opts.biff < 12) {\n\t\twhile(out.c >= 0x100) out.c -= 0x100;\n\t\twhile(out.r >= 0x10000) out.r -= 0x10000;\n\t}\n\treturn out;\n}\n\nfunction shift_range_xls(cell, range, opts) {\n\tvar out = dup(cell);\n\tout.s = shift_cell_xls(out.s, range.s, opts);\n\tout.e = shift_cell_xls(out.e, range.s, opts);\n\treturn out;\n}\n\nfunction encode_cell_xls(c, biff) {\n\tif(c.cRel && c.c < 0) { c = dup(c); while(c.c < 0) c.c += (biff > 8) ? 0x4000 : 0x100; }\n\tif(c.rRel && c.r < 0) { c = dup(c); while(c.r < 0) c.r += (biff > 8) ? 0x100000 : ((biff > 5) ? 0x10000 : 0x4000); }\n\tvar s = encode_cell(c);\n\tif(!c.cRel && c.cRel != null) s = fix_col(s);\n\tif(!c.rRel && c.rRel != null) s = fix_row(s);\n\treturn s;\n}\n\nfunction encode_range_xls(r, opts) {\n\tif(r.s.r == 0 && !r.s.rRel) {\n\t\tif(r.e.r == (opts.biff >= 12 ? 0xFFFFF : (opts.biff >= 8 ? 0x10000 : 0x4000)) && !r.e.rRel) {\n\t\t\treturn (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n\t\t}\n\t}\n\tif(r.s.c == 0 && !r.s.cRel) {\n\t\tif(r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n\t\t\treturn (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n\t\t}\n\t}\n\treturn encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n}\nif(typeof cptable !== 'undefined') set_cptable(cptable);\nelse if(typeof module !== \"undefined\" && typeof require !== 'undefined') {\n\tset_cptable(require('./dist/cpexcel.js'));\n}\nfunction decode_row(rowstr) { return parseInt(unfix_row(rowstr),10) - 1; }\nfunction encode_row(row) { return \"\" + (row + 1); }\nfunction fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\nfunction unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\n\nfunction decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\nfunction encode_col(col) { if(col < 0) throw new Error(\"invalid column \" + col); var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\nfunction fix_col(cstr) { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\nfunction unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\n\nfunction split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\nfunction decode_cell(cstr) {\n\tvar R = 0, C = 0;\n\tfor(var i = 0; i < cstr.length; ++i) {\n\t\tvar cc = cstr.charCodeAt(i);\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t}\n\treturn { c: C - 1, r:R - 1 };\n}\nfunction encode_cell(cell) {\n\tvar col = cell.c + 1;\n\tvar s=\"\";\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\n\treturn s + (cell.r + 1);\n}\nfunction decode_range(range) {\n\tvar idx = range.indexOf(\":\");\n\tif(idx == -1) return { s: decode_cell(range), e: decode_cell(range) };\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\n}\nfunction encode_range(cs,ce) {\n\tif(typeof ce === 'undefined' || typeof ce === 'number') {\nreturn encode_range(cs.s, cs.e);\n\t}\nif(typeof cs !== 'string') cs = encode_cell((cs));\n\tif(typeof ce !== 'string') ce = encode_cell((ce));\nreturn cs == ce ? cs : cs + \":\" + ce;\n}\nfunction fix_range(a1) {\n\tvar s = decode_range(a1);\n\treturn \"$\" + encode_col(s.s.c) + \"$\" + encode_row(s.s.r) + \":$\" + encode_col(s.e.c) + \"$\" + encode_row(s.e.r);\n}\n\n// List of invalid characters needs to be tested further\nfunction formula_quote_sheet_name(sname, opts) {\n\tif(!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n\tif (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname.replace(/'/g, \"''\") + \"'\";\n\treturn sname;\n}\n\nfunction safe_decode_range(range) {\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\tvar idx = 0, i = 0, cc = 0;\n\tvar len = range.length;\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif(i === len || cc != 10) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\n\t++i;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nfunction safe_format_cell(cell, v) {\n\tvar q = (cell.t == 'd' && v instanceof Date);\n\tif(cell.z != null) try { return (cell.w = SSF_format(cell.z, q ? datenum(v) : v)); } catch(e) { }\n\ttry { return (cell.w = SSF_format((cell.XF||{}).numFmtId||(q ? 14 : 0),  q ? datenum(v) : v)); } catch(e) { return ''+v; }\n}\n\nfunction format_cell(cell, v, o) {\n\tif(cell == null || cell.t == null || cell.t == 'z') return \"\";\n\tif(cell.w !== undefined) return cell.w;\n\tif(cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n\tif(cell.t == \"e\") return BErr[cell.v] || cell.v;\n\tif(v == undefined) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n\nfunction sheet_to_workbook(sheet, opts) {\n\tvar n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n\tvar sheets = {}; sheets[n] = sheet;\n\treturn { SheetNames: [n], Sheets: sheets };\n}\n\nfunction sheet_add_aoa(_ws, data, opts) {\n\tvar o = opts || {};\n\tvar dense = _ws ? (_ws[\"!data\"] != null) : o.dense;\n\tif(DENSE != null && dense == null) dense = DENSE;\n\tvar ws = _ws || ({});\n\tif(dense && !ws[\"!data\"]) ws[\"!data\"] = [];\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t\tif(!ws[\"!ref\"]) ws[\"!ref\"] = \"A1:A1\";\n\t}\n\tvar range = ({s: {c:10000000, r:10000000}, e: {c:0, r:0}});\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.s.c = _range.s.c;\n\t\trange.s.r = _range.s.r;\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) range.e.r = _R = _range.e.r + 1;\n\t}\n\tvar row = [];\n\tfor(var R = 0; R != data.length; ++R) {\n\t\tif(!data[R]) continue;\n\t\tif(!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\t\tvar __R = _R + R, __Rstr = \"\" + (__R + 1);\n\t\tif(dense) {\n\t\t\tif(!ws[\"!data\"][__R]) ws[\"!data\"][__R] = [];\n\t\t\trow = ws[\"!data\"][__R];\n\t\t}\n\t\tfor(var C = 0; C != data[R].length; ++C) {\n\t\t\tif(typeof data[R][C] === 'undefined') continue;\n\t\t\tvar cell = ({v: data[R][C] });\n\t\t\tvar __C = _C + C;\n\t\t\tif(range.s.r > __R) range.s.r = __R;\n\t\t\tif(range.s.c > __C) range.s.c = __C;\n\t\t\tif(range.e.r < __R) range.e.r = __R;\n\t\t\tif(range.e.c < __C) range.e.c = __C;\n\t\t\tif(data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];\n\t\t\telse {\n\t\t\t\tif(Array.isArray(cell.v)) { cell.f = data[R][C][1]; cell.v = cell.v[0]; }\n\t\t\t\tif(cell.v === null) {\n\t\t\t\t\tif(cell.f) cell.t = 'n';\n\t\t\t\t\telse if(o.nullError) { cell.t = 'e'; cell.v = 0; }\n\t\t\t\t\telse if(!o.sheetStubs) continue;\n\t\t\t\t\telse cell.t = 'z';\n\t\t\t\t}\n\t\t\t\telse if(typeof cell.v === 'number') cell.t = 'n';\n\t\t\t\telse if(typeof cell.v === 'boolean') cell.t = 'b';\n\t\t\t\telse if(cell.v instanceof Date) {\n\t\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\t\tif(!o.UTC) cell.v = local_to_utc(cell.v);\n\t\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.w = SSF_format(cell.z, datenum(cell.v, o.date1904)); }\n\t\t\t\t\telse { cell.t = 'n'; cell.v = datenum(cell.v, o.date1904); cell.w = SSF_format(cell.z, cell.v); }\n\t\t\t\t}\n\t\t\t\telse cell.t = 's';\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\tif(row[__C] && row[__C].z) cell.z = row[__C].z;\n\t\t\t\trow[__C] = cell;\n\t\t\t} else {\n\t\t\t\tvar cell_ref = encode_col(__C) + __Rstr;\n\t\t\t\tif(ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n\t\t\t\tws[cell_ref] = cell;\n\t\t\t}\n\t\t}\n\t}\n\tif(range.s.c < 10000000) ws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction aoa_to_sheet(data, opts) { return sheet_add_aoa(null, data, opts); }\n\nfunction parse_Int32LE(data) {\n\treturn data.read_shift(4, 'i');\n}\nfunction write_UInt32LE(x, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(4, x);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.168 */\nfunction parse_XLWideString(data) {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLWideString(data, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(4 + 2 * data.length); }\n\to.write_shift(4, data.length);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.91 */\n//function parse_LPWideString(data) {\n//\tvar cchCharacters = data.read_shift(2);\n//\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n//}\n\n/* [MS-XLSB] 2.5.143 */\nfunction parse_StrRun(data) {\n\treturn { ich: data.read_shift(2), ifnt: data.read_shift(2) };\n}\nfunction write_StrRun(run, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(2, run.ich || 0);\n\to.write_shift(2, run.ifnt || 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.121 */\nfunction parse_RichStr(data, length) {\n\tvar start = data.l;\n\tvar flags = data.read_shift(1);\n\tvar str = parse_XLWideString(data);\n\tvar rgsStrRun = [];\n\tvar z = ({ t: str, h: str });\n\tif ((flags & 1) !== 0) { /* fRichStr */\n\t\t/* TODO: formatted string */\n\t\tvar dwSizeStrRun = data.read_shift(4);\n\t\tfor (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\t\tz.r = rgsStrRun;\n\t}\n\telse z.r = [{ ich: 0, ifnt: 0 }];\n\t//if((flags & 2) !== 0) { /* fExtStr */\n\t//\t/* TODO: phonetic string */\n\t//}\n\tdata.l = start + length;\n\treturn z;\n}\nfunction write_RichStr(str, o) {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(15 + 4 * str.t.length); }\n\to.write_shift(1, 0);\n\twrite_XLWideString(str.t, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\nvar parse_BrtCommentText = parse_RichStr;\nfunction write_BrtCommentText(str, o) {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(23 + 4 * str.t.length); }\n\to.write_shift(1, 1);\n\twrite_XLWideString(str.t, o);\n\to.write_shift(4, 1);\n\twrite_StrRun({ ich: 0, ifnt: 0 }, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.9 */\nfunction parse_XLSBCell(data) {\n\tvar col = data.read_shift(4);\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) << 16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c: col, iStyleRef: iStyleRef };\n}\nfunction write_XLSBCell(cell, o) {\n\tif (o == null) o = new_buf(8);\n\to.write_shift(-4, cell.c);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* Short XLSB Cell does not include column */\nfunction parse_XLSBShortCell(data) {\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) <<16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c:-1, iStyleRef: iStyleRef };\n}\nfunction write_XLSBShortCell(cell, o) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.21 */\nvar parse_XLSBCodeName = parse_XLWideString;\nvar write_XLSBCodeName = write_XLWideString;\n\n/* [MS-XLSB] 2.5.166 */\nfunction parse_XLNullableWideString(data) {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLNullableWideString(data, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(127); }\n\to.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.165 */\nvar parse_XLNameWideString = parse_XLWideString;\n//var write_XLNameWideString = write_XLWideString;\n\n/* [MS-XLSB] 2.5.114 */\nvar parse_RelID = parse_XLNullableWideString;\nvar write_RelID = write_XLNullableWideString;\n\n\n/* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\nfunction parse_RkNumber(data) {\n\tvar b = data.slice(data.l, data.l + 4);\n\tvar fX100 = (b[0] & 1), fInt = (b[0] & 2);\n\tdata.l += 4;\n\tvar RK = fInt === 0 ? __double([0, 0, 0, 0, (b[0] & 0xFC), b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n\treturn fX100 ? (RK / 100) : RK;\n}\nfunction write_RkNumber(data, o) {\n\tif (o == null) o = new_buf(4);\n\tvar fX100 = 0, fInt = 0, d100 = data * 100;\n\tif ((data == (data | 0)) && (data >= -(1 << 29)) && (data < (1 << 29))) { fInt = 1; }\n\telse if ((d100 == (d100 | 0)) && (d100 >= -(1 << 29)) && (d100 < (1 << 29))) { fInt = 1; fX100 = 1; }\n\tif (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));\n\telse throw new Error(\"unsupported RkNumber \" + data); // TODO\n}\n\n\n/* [MS-XLSB] 2.5.117 RfX */\nfunction parse_RfX(data ) {\n\tvar cell = ({ s: {}, e: {} });\n\tcell.s.r = data.read_shift(4);\n\tcell.e.r = data.read_shift(4);\n\tcell.s.c = data.read_shift(4);\n\tcell.e.c = data.read_shift(4);\n\treturn cell;\n}\nfunction write_RfX(r, o) {\n\tif (!o) o = new_buf(16);\n\to.write_shift(4, r.s.r);\n\to.write_shift(4, r.e.r);\n\to.write_shift(4, r.s.c);\n\to.write_shift(4, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.153 UncheckedRfX */\nvar parse_UncheckedRfX = parse_RfX;\nvar write_UncheckedRfX = write_RfX;\n\n/* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n//function parse_UncheckedSqRfX(data) {\n//\tvar cnt = data.read_shift(4);\n//\tvar out = [];\n//\tfor(var i = 0; i < cnt; ++i) {\n//\t\tvar rng = parse_UncheckedRfX(data);\n//\t\tout.push(encode_range(rng));\n//\t}\n//\treturn out.join(\",\");\n//}\n//function write_UncheckedSqRfX(sqrfx) {\n//\tvar parts = sqrfx.split(/\\s*,\\s*/);\n//\tvar o = new_buf(4); o.write_shift(4, parts.length);\n//\tvar out = [o];\n//\tparts.forEach(function(rng) {\n//\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n//\t});\n//\treturn bconcat(out);\n//}\n\n/* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n/* TODO: error checking, NaN and Infinity values are not valid Xnum */\nfunction parse_Xnum(data) {\n\tif(data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n\treturn data.read_shift(8, 'f');\n}\nfunction write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, data, 'f'); }\n\n/* [MS-XLSB] 2.4.324 BrtColor */\nfunction parse_BrtColor(data) {\n\tvar out = {};\n\tvar d = data.read_shift(1);\n\n\t//var fValidRGB = d & 1;\n\tvar xColorType = d >>> 1;\n\n\tvar index = data.read_shift(1);\n\tvar nTS = data.read_shift(2, 'i');\n\tvar bR = data.read_shift(1);\n\tvar bG = data.read_shift(1);\n\tvar bB = data.read_shift(1);\n\tdata.l++; //var bAlpha = data.read_shift(1);\n\n\tswitch (xColorType) {\n\t\tcase 0: out.auto = 1; break;\n\t\tcase 1:\n\t\t\tout.index = index;\n\t\t\tvar icv = XLSIcv[index];\n\t\t\t/* automatic pseudo index 81 */\n\t\t\tif (icv) out.rgb = rgb2Hex(icv);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/* if(!fValidRGB) throw new Error(\"invalid\"); */\n\t\t\tout.rgb = rgb2Hex([bR, bG, bB]);\n\t\t\tbreak;\n\t\tcase 3: out.theme = index; break;\n\t}\n\tif (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n\n\treturn out;\n}\nfunction write_BrtColor(color, o) {\n\tif (!o) o = new_buf(8);\n\tif (!color || color.auto) { o.write_shift(4, 0); o.write_shift(4, 0); return o; }\n\tif (color.index != null) {\n\t\to.write_shift(1, 0x02);\n\t\to.write_shift(1, color.index);\n\t} else if (color.theme != null) {\n\t\to.write_shift(1, 0x06);\n\t\to.write_shift(1, color.theme);\n\t} else {\n\t\to.write_shift(1, 0x05);\n\t\to.write_shift(1, 0);\n\t}\n\tvar nTS = color.tint || 0;\n\tif (nTS > 0) nTS *= 32767;\n\telse if (nTS < 0) nTS *= 32768;\n\to.write_shift(2, nTS);\n\tif (!color.rgb || color.theme != null) {\n\t\to.write_shift(2, 0);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(1, 0);\n\t} else {\n\t\tvar rgb = (color.rgb || 'FFFFFF');\n\t\tif (typeof rgb == 'number') rgb = (\"000000\" + rgb.toString(16)).slice(-6);\n\t\to.write_shift(1, parseInt(rgb.slice(0, 2), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(2, 4), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(4, 6), 16));\n\t\to.write_shift(1, 0xFF);\n\t}\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.52 */\nfunction parse_FontFlags(data) {\n\tvar d = data.read_shift(1);\n\tdata.l++;\n\tvar out = {\n\t\tfBold: d & 0x01,\n\t\tfItalic: d & 0x02,\n\t\tfUnderline: d & 0x04,\n\t\tfStrikeout: d & 0x08,\n\t\tfOutline: d & 0x10,\n\t\tfShadow: d & 0x20,\n\t\tfCondense: d & 0x40,\n\t\tfExtend: d & 0x80\n\t};\n\treturn out;\n}\nfunction write_FontFlags(font, o) {\n\tif (!o) o = new_buf(2);\n\tvar grbit =\n\t\t(font.italic ? 0x02 : 0) |\n\t\t(font.strike ? 0x08 : 0) |\n\t\t(font.outline ? 0x10 : 0) |\n\t\t(font.shadow ? 0x20 : 0) |\n\t\t(font.condense ? 0x40 : 0) |\n\t\t(font.extend ? 0x80 : 0);\n\to.write_shift(1, grbit);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-OLEDS] 2.3.1 and 2.3.2 */\nfunction parse_ClipboardFormatOrString(o, w) {\n\t// $FlowIgnore\n\tvar ClipFmt = { 2: \"BITMAP\", 3: \"METAFILEPICT\", 8: \"DIB\", 14: \"ENHMETAFILE\" };\n\tvar m = o.read_shift(4);\n\tswitch (m) {\n\t\tcase 0x00000000: return \"\";\n\t\tcase 0xffffffff: case 0xfffffffe: return ClipFmt[o.read_shift(4)] || \"\";\n\t}\n\tif (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n\to.l -= 4;\n\treturn o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n}\nfunction parse_ClipboardFormatOrAnsiString(o) { return parse_ClipboardFormatOrString(o, 1); }\nfunction parse_ClipboardFormatOrUnicodeString(o) { return parse_ClipboardFormatOrString(o, 2); }\n\n/* [MS-OLEPS] 2.2 PropertyType */\n// Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n//var VT_EMPTY    = 0x0000;\n//var VT_NULL     = 0x0001;\nvar VT_I2       = 0x0002;\nvar VT_I4       = 0x0003;\n//var VT_R4       = 0x0004;\n//var VT_R8       = 0x0005;\n//var VT_CY       = 0x0006;\n//var VT_DATE     = 0x0007;\n//var VT_BSTR     = 0x0008;\n//var VT_ERROR    = 0x000A;\nvar VT_BOOL     = 0x000B;\nvar VT_VARIANT  = 0x000C;\n//var VT_DECIMAL  = 0x000E;\n//var VT_I1       = 0x0010;\n//var VT_UI1      = 0x0011;\n//var VT_UI2      = 0x0012;\nvar VT_UI4      = 0x0013;\n//var VT_I8       = 0x0014;\n//var VT_UI8      = 0x0015;\n//var VT_INT      = 0x0016;\n//var VT_UINT     = 0x0017;\n//var VT_LPSTR    = 0x001E;\n//var VT_LPWSTR   = 0x001F;\nvar VT_FILETIME = 0x0040;\nvar VT_BLOB     = 0x0041;\n//var VT_STREAM   = 0x0042;\n//var VT_STORAGE  = 0x0043;\n//var VT_STREAMED_Object  = 0x0044;\n//var VT_STORED_Object    = 0x0045;\n//var VT_BLOB_Object      = 0x0046;\nvar VT_CF       = 0x0047;\n//var VT_CLSID    = 0x0048;\n//var VT_VERSIONED_STREAM = 0x0049;\n//var VT_VECTOR   = 0x1000;\nvar VT_VECTOR_VARIANT = 0x100C;\nvar VT_VECTOR_LPSTR   = 0x101E;\n//var VT_ARRAY    = 0x2000;\n\nvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\nvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\nvar VT_CUSTOM   = [VT_STRING, VT_USTR];\n\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\nvar DocSummaryPIDDSI = {\n0x01: { n: 'CodePage', t: VT_I2 },\n0x02: { n: 'Category', t: VT_STRING },\n0x03: { n: 'PresentationFormat', t: VT_STRING },\n0x04: { n: 'ByteCount', t: VT_I4 },\n0x05: { n: 'LineCount', t: VT_I4 },\n0x06: { n: 'ParagraphCount', t: VT_I4 },\n0x07: { n: 'SlideCount', t: VT_I4 },\n0x08: { n: 'NoteCount', t: VT_I4 },\n0x09: { n: 'HiddenCount', t: VT_I4 },\n0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\n0x0b: { n: 'ScaleCrop', t: VT_BOOL },\n0x0c: { n: 'HeadingPairs', t: VT_VECTOR_VARIANT /* VT_VECTOR | VT_VARIANT */ },\n0x0d: { n: 'TitlesOfParts', t: VT_VECTOR_LPSTR /* VT_VECTOR | VT_LPSTR */ },\n0x0e: { n: 'Manager', t: VT_STRING },\n0x0f: { n: 'Company', t: VT_STRING },\n0x10: { n: 'LinksUpToDate', t: VT_BOOL },\n0x11: { n: 'CharacterCount', t: VT_I4 },\n0x13: { n: 'SharedDoc', t: VT_BOOL },\n0x16: { n: 'HyperlinksChanged', t: VT_BOOL },\n0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\n0x18: { n: 'DigSig', t: VT_BLOB },\n0x1A: { n: 'ContentType', t: VT_STRING },\n0x1B: { n: 'ContentStatus', t: VT_STRING },\n0x1C: { n: 'Language', t: VT_STRING },\n0x1D: { n: 'Version', t: VT_STRING },\n0xFF: {},\n\t/* [MS-OLEPS] 2.18 */\n0x80000000: { n: 'Locale', t: VT_UI4 },\n0x80000003: { n: 'Behavior', t: VT_UI4 },\n0x72627262: {}\n};\n\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\nvar SummaryPIDSI = {\n0x01: { n: 'CodePage', t: VT_I2 },\n0x02: { n: 'Title', t: VT_STRING },\n0x03: { n: 'Subject', t: VT_STRING },\n0x04: { n: 'Author', t: VT_STRING },\n0x05: { n: 'Keywords', t: VT_STRING },\n0x06: { n: 'Comments', t: VT_STRING },\n0x07: { n: 'Template', t: VT_STRING },\n0x08: { n: 'LastAuthor', t: VT_STRING },\n0x09: { n: 'RevNumber', t: VT_STRING },\n0x0A: { n: 'EditTime', t: VT_FILETIME },\n0x0B: { n: 'LastPrinted', t: VT_FILETIME },\n0x0C: { n: 'CreatedDate', t: VT_FILETIME },\n0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\n0x0E: { n: 'PageCount', t: VT_I4 },\n0x0F: { n: 'WordCount', t: VT_I4 },\n0x10: { n: 'CharCount', t: VT_I4 },\n0x11: { n: 'Thumbnail', t: VT_CF },\n0x12: { n: 'Application', t: VT_STRING },\n0x13: { n: 'DocSecurity', t: VT_I4 },\n0xFF: {},\n\t/* [MS-OLEPS] 2.18 */\n0x80000000: { n: 'Locale', t: VT_UI4 },\n0x80000003: { n: 'Behavior', t: VT_UI4 },\n0x72627262: {}\n};\n\n/* [MS-XLS] 2.4.63 Country/Region codes */\nvar CountryEnum = {\n0x0001: \"US\", // United States\n0x0002: \"CA\", // Canada\n0x0003: \"\", // Latin America (except Brazil)\n0x0007: \"RU\", // Russia\n0x0014: \"EG\", // Egypt\n0x001E: \"GR\", // Greece\n0x001F: \"NL\", // Netherlands\n0x0020: \"BE\", // Belgium\n0x0021: \"FR\", // France\n0x0022: \"ES\", // Spain\n0x0024: \"HU\", // Hungary\n0x0027: \"IT\", // Italy\n0x0029: \"CH\", // Switzerland\n0x002B: \"AT\", // Austria\n0x002C: \"GB\", // United Kingdom\n0x002D: \"DK\", // Denmark\n0x002E: \"SE\", // Sweden\n0x002F: \"NO\", // Norway\n0x0030: \"PL\", // Poland\n0x0031: \"DE\", // Germany\n0x0034: \"MX\", // Mexico\n0x0037: \"BR\", // Brazil\n0x003d: \"AU\", // Australia\n0x0040: \"NZ\", // New Zealand\n0x0042: \"TH\", // Thailand\n0x0051: \"JP\", // Japan\n0x0052: \"KR\", // Korea\n0x0054: \"VN\", // Viet Nam\n0x0056: \"CN\", // China\n0x005A: \"TR\", // Turkey\n0x0069: \"JS\", // Ramastan\n0x00D5: \"DZ\", // Algeria\n0x00D8: \"MA\", // Morocco\n0x00DA: \"LY\", // Libya\n0x015F: \"PT\", // Portugal\n0x0162: \"IS\", // Iceland\n0x0166: \"FI\", // Finland\n0x01A4: \"CZ\", // Czech Republic\n0x0376: \"TW\", // Taiwan\n0x03C1: \"LB\", // Lebanon\n0x03C2: \"JO\", // Jordan\n0x03C3: \"SY\", // Syria\n0x03C4: \"IQ\", // Iraq\n0x03C5: \"KW\", // Kuwait\n0x03C6: \"SA\", // Saudi Arabia\n0x03CB: \"AE\", // United Arab Emirates\n0x03CC: \"IL\", // Israel\n0x03CE: \"QA\", // Qatar\n0x03D5: \"IR\", // Iran\n0xFFFF: \"US\"  // United States\n};\n\n/* [MS-XLS] 2.5.127 */\nvar XLSFillPattern = [\n\tnull,\n\t'solid',\n\t'mediumGray',\n\t'darkGray',\n\t'lightGray',\n\t'darkHorizontal',\n\t'darkVertical',\n\t'darkDown',\n\t'darkUp',\n\t'darkGrid',\n\t'darkTrellis',\n\t'lightHorizontal',\n\t'lightVertical',\n\t'lightDown',\n\t'lightUp',\n\t'lightGrid',\n\t'lightTrellis',\n\t'gray125',\n\t'gray0625'\n];\n\nfunction rgbify(arr) { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\n\n/* [MS-XLS] 2.5.161 */\n/* [MS-XLSB] 2.5.75 Icv */\nvar _XLSIcv =  rgbify([\n\t/* Color Constants */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t/* Overridable Defaults */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t0x800000,\n\t0x008000,\n\t0x000080,\n\t0x808000,\n\t0x800080,\n\t0x008080,\n\t0xC0C0C0,\n\t0x808080,\n\t0x9999FF,\n\t0x993366,\n\t0xFFFFCC,\n\t0xCCFFFF,\n\t0x660066,\n\t0xFF8080,\n\t0x0066CC,\n\t0xCCCCFF,\n\n\t0x000080,\n\t0xFF00FF,\n\t0xFFFF00,\n\t0x00FFFF,\n\t0x800080,\n\t0x800000,\n\t0x008080,\n\t0x0000FF,\n\t0x00CCFF,\n\t0xCCFFFF,\n\t0xCCFFCC,\n\t0xFFFF99,\n\t0x99CCFF,\n\t0xFF99CC,\n\t0xCC99FF,\n\t0xFFCC99,\n\n\t0x3366FF,\n\t0x33CCCC,\n\t0x99CC00,\n\t0xFFCC00,\n\t0xFF9900,\n\t0xFF6600,\n\t0x666699,\n\t0x969696,\n\t0x003366,\n\t0x339966,\n\t0x003300,\n\t0x333300,\n\t0x993300,\n\t0x993366,\n\t0x333399,\n\t0x333333,\n\n\t/* Other entries to appease BIFF8/12 */\n\t0x000000, /* 0x40 icvForeground ?? */\n\t0xFFFFFF, /* 0x41 icvBackground ?? */\n\t0x000000, /* 0x42 icvFrame ?? */\n\t0x000000, /* 0x43 icv3D ?? */\n\t0x000000, /* 0x44 icv3DText ?? */\n\t0x000000, /* 0x45 icv3DHilite ?? */\n\t0x000000, /* 0x46 icv3DShadow ?? */\n\t0x000000, /* 0x47 icvHilite ?? */\n\t0x000000, /* 0x48 icvCtlText ?? */\n\t0x000000, /* 0x49 icvCtlScrl ?? */\n\t0x000000, /* 0x4A icvCtlInv ?? */\n\t0x000000, /* 0x4B icvCtlBody ?? */\n\t0x000000, /* 0x4C icvCtlFrame ?? */\n\t0x000000, /* 0x4D icvCtlFore ?? */\n\t0x000000, /* 0x4E icvCtlBack ?? */\n\t0x000000, /* 0x4F icvCtlNeutral */\n\t0x000000, /* 0x50 icvInfoBk ?? */\n\t0x000000 /* 0x51 icvInfoText ?? */\n]);\nvar XLSIcv = dup(_XLSIcv);\n\n/* [MS-XLSB] 2.5.97.2 */\nvar BErr = {\n0x00: \"#NULL!\",\n0x07: \"#DIV/0!\",\n0x0F: \"#VALUE!\",\n0x17: \"#REF!\",\n0x1D: \"#NAME?\",\n0x24: \"#NUM!\",\n0x2A: \"#N/A\",\n0x2B: \"#GETTING_DATA\",\n0xFF: \"#WTF?\"\n};\n//var RBErr = evert_num(BErr);\nvar RBErr = {\n\t\"#NULL!\":        0x00,\n\t\"#DIV/0!\":       0x07,\n\t\"#VALUE!\":       0x0F,\n\t\"#REF!\":         0x17,\n\t\"#NAME?\":        0x1D,\n\t\"#NUM!\":         0x24,\n\t\"#N/A\":          0x2A,\n\t\"#GETTING_DATA\": 0x2B,\n\t\"#WTF?\":         0xFF\n};\n\nvar XLSLblBuiltIn = [\n\t\"_xlnm.Consolidate_Area\",\n\t\"_xlnm.Auto_Open\",\n\t\"_xlnm.Auto_Close\",\n\t\"_xlnm.Extract\",\n\t\"_xlnm.Database\",\n\t\"_xlnm.Criteria\",\n\t\"_xlnm.Print_Area\",\n\t\"_xlnm.Print_Titles\",\n\t\"_xlnm.Recorder\",\n\t\"_xlnm.Data_Form\",\n\t\"_xlnm.Auto_Activate\",\n\t\"_xlnm.Auto_Deactivate\",\n\t\"_xlnm.Sheet_Title\",\n\t\"_xlnm._FilterDatabase\"\n];\n\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n/* 12.3 Part Summary <SpreadsheetML> */\n/* 14.2 Part Summary <DrawingML> */\n/* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\nvar ct2type/*{[string]:string}*/ = ({\n\t/* Workbook */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n\t\"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\n\t/* Worksheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n\t\"application/vnd.ms-excel.worksheet\": \"sheets\",\n\t\"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\n\n\t/* Chartsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n\t\"application/vnd.ms-excel.chartsheet\": \"charts\",\n\n\t/* Macrosheet */\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n\t\"application/vnd.ms-excel.macrosheet\": \"macros\",\n\t\"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n\t\"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\n\n\t/* Dialogsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n\t\"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\n\t/* Shared Strings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n\t\"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\n\t/* Styles */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n\t\"application/vnd.ms-excel.styles\": \"styles\",\n\n\t/* File Properties */\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n\t/* Custom Data Properties */\n\t\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n\n\t/* Comments */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\t\"application/vnd.ms-excel.comments\": \"comments\",\n\t\"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n\t\"application/vnd.ms-excel.person+xml\": \"people\",\n\n\t/* Metadata (Stock/Geography and Dynamic Array) */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n\t\"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\n\t/* PivotTable */\n\t\"application/vnd.ms-excel.pivotTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n\t/* Chart Objects */\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\n\t/* Chart Colors */\n\t\"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n\n\t/* Chart Style */\n\t\"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n\n\t/* Chart Advanced */\n\t\"application/vnd.ms-office.chartex+xml\": \"TODO\",\n\n\t/* Calculation Chain */\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n\t/* Printer Settings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n\t/* ActiveX */\n\t\"application/vnd.ms-office.activeX\": \"TODO\",\n\t\"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n\t/* Custom Toolbars */\n\t\"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n\t/* External Data Connections */\n\t\"application/vnd.ms-excel.connections\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n\t/* External Links */\n\t\"application/vnd.ms-excel.externalLink\": \"links\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\n\t/* PivotCache */\n\t\"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n\t\"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n\t/* Query Table */\n\t\"application/vnd.ms-excel.queryTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n\t/* Shared Workbook */\n\t\"application/vnd.ms-excel.userNames\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionLog\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n\t/* Single Cell Table */\n\t\"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n\t/* Slicer */\n\t\"application/vnd.ms-excel.slicer\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache\": \"TODO\",\n\t\"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n\t/* Sort Map */\n\t\"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n\t/* Table */\n\t\"application/vnd.ms-excel.table\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n\t/* Themes */\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n\t/* Theme Override */\n\t\"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n\n\t/* Timeline */\n\t\"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\n\t\"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\n\n\t/* VBA */\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\n\t\"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n\n\t/* Volatile Dependencies */\n\t\"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n\t/* Control Properties */\n\t\"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n\t/* Data Model */\n\t\"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n\t/* Survey */\n\t\"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n\t/* Drawing */\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n\t/* VML */\n\t\"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n\t\"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n\t/* Image */\n\t\"image/png\": \"TODO\",\n\n\t\"sheet\": \"js\"\n});\n\nvar CT_LIST = {\n\tworkbooks: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n\t\txlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n\t\txlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\n\t\txltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n\t},\n\tstrs: { /* Shared Strings */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n\t\txlsb: \"application/vnd.ms-excel.sharedStrings\"\n\t},\n\tcomments: { /* Comments */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n\t\txlsb: \"application/vnd.ms-excel.comments\"\n\t},\n\tsheets: { /* Worksheet */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.worksheet\"\n\t},\n\tcharts: { /* Chartsheet */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.chartsheet\"\n\t},\n\tdialogs: { /* Dialogsheet */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.dialogsheet\"\n\t},\n\tmacros: { /* Macrosheet (Excel 4.0 Macros) */\n\t\txlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.macrosheet\"\n\t},\n\tmetadata: { /* Metadata (Stock/Geography and Dynamic Array) */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n\t\txlsb: \"application/vnd.ms-excel.sheetMetadata\"\n\t},\n\tstyles: { /* Styles */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n\t\txlsb: \"application/vnd.ms-excel.styles\"\n\t}\n};\n\nfunction new_ct() {\n\treturn ({\n\t\tworkbooks:[], sheets:[], charts:[], dialogs:[], macros:[],\n\t\trels:[], strs:[], comments:[], threadedcomments:[], links:[],\n\t\tcoreprops:[], extprops:[], custprops:[], themes:[], styles:[],\n\t\tcalcchains:[], vba: [], drawings: [], metadata: [], people:[],\n\t\tTODO:[], xmlns: \"\" });\n}\n\nfunction parse_ct(data) {\n\tvar ct = new_ct();\n\tif(!data || !data.match) return ct;\n\tvar ctext = {};\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0].replace(nsregex,\"<\")) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\n\t\t\tcase '<Default': ctext[y.Extension.toLowerCase()] = y.ContentType; break;\n\t\t\tcase '<Override':\n\t\t\t\tif(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\tif(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n\tct.defaults = ctext;\n\tdelete ct.calcchains;\n\treturn ct;\n}\n\nfunction write_ct(ct, opts, raw) {\n\tvar type2ct/*{[string]:Array<string>}*/ = evert_arr(ct2type);\n\n\tvar o = [], v;\n\n\tif(!raw) {\n\t\to[o.length] = (XML_HEADER);\n\t\to[o.length] = writextag('Types', null, {\n\t\t\t'xmlns': XMLNS.CT,\n\t\t\t'xmlns:xsd': XMLNS.xsd,\n\t\t\t'xmlns:xsi': XMLNS.xsi\n\t\t});\n\t\to = o.concat([\n\t\t\t['xml', 'application/xml'],\n\t\t\t['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\n\t\t\t['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'],\n\t\t\t['data', 'application/vnd.openxmlformats-officedocument.model+data'],\n\t\t\t/* from test files */\n\t\t\t['bmp', 'image/bmp'],\n\t\t\t['png', 'image/png'],\n\t\t\t['gif', 'image/gif'],\n\t\t\t['emf', 'image/x-emf'],\n\t\t\t['wmf', 'image/x-wmf'],\n\t\t\t['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'],\n\t\t\t['tif', 'image/tiff'], ['tiff', 'image/tiff'],\n\t\t\t['pdf', 'application/pdf'],\n\t\t\t['rels', 'application/vnd.openxmlformats-package.relationships+xml']\n\t\t].map(function(x) {\n\t\t\treturn writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\n\t\t}));\n\t}\n\n\t/* only write first instance */\n\tvar f1 = function(w) {\n\t\tif(ct[w] && ct[w].length > 0) {\n\t\t\tv = ct[w][0];\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t}\n\t};\n\n\t/* book type-specific */\n\tvar f2 = function(w) {\n\t\t(ct[w]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t});\n\t};\n\n\t/* standard type */\n\tvar f3 = function(t) {\n\t\t(ct[t]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': type2ct[t][0]\n\t\t\t}));\n\t\t});\n\t};\n\n\tf1('workbooks');\n\tf2('sheets');\n\tf2('charts');\n\tf3('themes');\n\t['strs', 'styles'].forEach(f1);\n\t['coreprops', 'extprops', 'custprops'].forEach(f3);\n\tf3('vba');\n\tf3('comments');\n\tf3('threadedcomments');\n\tf3('drawings');\n\tf2('metadata');\n\tf3('people');\n\tif(!raw && o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 9.3 Relationships */\nvar RELS = ({\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tSHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tHLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n\tVML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n\tXPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n\tXMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n\tXLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n\tCXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n\tCXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n\tCMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n\tCORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n\tEXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n\tCUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n\tSST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n\tSTY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n\tTHEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n\tCHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n\tCHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n\tCS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n\tWS: [\n\t\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\n\t\t\"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"\n\t],\n\tDS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n\tMS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n\tIMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n\tDRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n\tXLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n\tTCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n\tPEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n\tCONN: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections\",\n\tVBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n});\n\n/* 9.3.3 Representing Relationships */\nfunction get_rels_path(file) {\n\tvar n = file.lastIndexOf(\"/\");\n\treturn file.slice(0,n+1) + '_rels/' + file.slice(n+1) + \".rels\";\n}\n\nfunction parse_rels(data, currentFilePath) {\n\tvar rels = {\"!id\":{}};\n\tif (!data) return rels;\n\tif (currentFilePath.charAt(0) !== '/') {\n\t\tcurrentFilePath = '/'+currentFilePath;\n\t}\n\tvar hash = {};\n\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\t/* 9.3.2.2 OPC_Relationships */\n\t\tif (y[0] === '<Relationship') {\n\t\t\tvar rel = {}; rel.Type = y.Type; rel.Target = unescapexml(y.Target); rel.Id = y.Id; if(y.TargetMode) rel.TargetMode = y.TargetMode;\n\t\t\tvar canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n\t\t\trels[canonictarget] = rel;\n\t\t\thash[y.Id] = rel;\n\t\t}\n\t});\n\trels[\"!id\"] = hash;\n\treturn rels;\n}\n\n\n/* TODO */\nfunction write_rels(rels) {\n\tvar o = [XML_HEADER, writextag('Relationships', null, {\n\t\t//'xmlns:ns0': XMLNS.RELS,\n\t\t'xmlns': XMLNS.RELS\n\t})];\n\tkeys(rels['!id']).forEach(function(rid) {\n\t\to[o.length] = (writextag('Relationship', null, rels['!id'][rid]));\n\t});\n\tif(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\nfunction add_rels(rels, rId, f, type, relobj, targetmode) {\n\tif(!relobj) relobj = {};\n\tif(!rels['!id']) rels['!id'] = {};\n\tif(!rels['!idx']) rels['!idx'] = 1;\n\tif(rId < 0) for(rId = rels['!idx']; rels['!id']['rId' + rId]; ++rId){/* empty */}\n\trels['!idx'] = rId + 1;\n\trelobj.Id = 'rId' + rId;\n\trelobj.Type = type;\n\trelobj.Target = f;\n\tif(targetmode) relobj.TargetMode = targetmode;\n\telse if([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = \"External\";\n\tif(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n\trels['!id'][relobj.Id] = relobj;\n\trels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\n\treturn rId;\n}\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\nfunction parse_manifest(d, opts) {\n  var str = xlml_normalize(d);\n  var Rn;\n  var FEtag;\n  while (Rn = xlmlregex.exec(str))\n    switch (Rn[3]) {\n      case \"manifest\":\n        break;\n      case \"file-entry\":\n        FEtag = parsexmltag(Rn[0], false);\n        if (FEtag.path == \"/\" && FEtag.type !== CT_ODS)\n          throw new Error(\"This OpenDocument is not a spreadsheet\");\n        break;\n      case \"encryption-data\":\n      case \"algorithm\":\n      case \"start-key-generation\":\n      case \"key-derivation\":\n        throw new Error(\"Unsupported ODS Encryption\");\n      default:\n        if (opts && opts.WTF)\n          throw Rn;\n    }\n}\nfunction write_manifest(manifest) {\n  var o = [XML_HEADER];\n  o.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n  o.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n  for (var i = 0; i < manifest.length; ++i)\n    o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n  o.push(\"</manifest:manifest>\");\n  return o.join(\"\");\n}\nfunction write_rdf_type(file, res, tag) {\n  return [\n    '  <rdf:Description rdf:about=\"' + file + '\">\\n',\n    '    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + \"#\" + res + '\"/>\\n',\n    \"  </rdf:Description>\\n\"\n  ].join(\"\");\n}\nfunction write_rdf_has(base, file) {\n  return [\n    '  <rdf:Description rdf:about=\"' + base + '\">\\n',\n    '    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n',\n    \"  </rdf:Description>\\n\"\n  ].join(\"\");\n}\nfunction write_rdf(rdf) {\n  var o = [XML_HEADER];\n  o.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n  for (var i = 0; i != rdf.length; ++i) {\n    o.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n    o.push(write_rdf_has(\"\", rdf[i][0]));\n  }\n  o.push(write_rdf_type(\"\", \"Document\", \"pkg\"));\n  o.push(\"</rdf:RDF>\");\n  return o.join(\"\");\n}\nfunction write_meta_ods(wb, opts) {\n  return '<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>SheetJS ' + XLSX.version + \"</meta:generator></office:meta></office:document-meta>\";\n}\n/* ECMA-376 Part II 11.1 Core Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar CORE_PROPS = [\n\t[\"cp:category\", \"Category\"],\n\t[\"cp:contentStatus\", \"ContentStatus\"],\n\t[\"cp:keywords\", \"Keywords\"],\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\n\t[\"cp:revision\", \"RevNumber\"],\n\t[\"cp:version\", \"Version\"],\n\t[\"dc:creator\", \"Author\"],\n\t[\"dc:description\", \"Comments\"],\n\t[\"dc:identifier\", \"Identifier\"],\n\t[\"dc:language\", \"Language\"],\n\t[\"dc:subject\", \"Subject\"],\n\t[\"dc:title\", \"Title\"],\n\t[\"dcterms:created\", \"CreatedDate\", 'date'],\n\t[\"dcterms:modified\", \"ModifiedDate\", 'date']\n];\n\nvar CORE_PROPS_REGEX = (function() {\n\tvar r = new Array(CORE_PROPS.length);\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar g = \"(?:\"+ f[0].slice(0,f[0].indexOf(\":\")) +\":)\"+ f[0].slice(f[0].indexOf(\":\")+1);\n\t\tr[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\n\t}\n\treturn r;\n})();\n\nfunction parse_core_props(data) {\n\tvar p = {};\n\tdata = utf8read(data);\n\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\n\t\tif(cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n\t\tif(f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n\t}\n\n\treturn p;\n}\n\nfunction cp_doit(f, g, h, o, p) {\n\tif(p[f] != null || g == null || g === \"\") return;\n\tp[f] = g;\n\tg = escapexml(g);\n\to[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\n}\n\nfunction write_core_props(cp, _opts) {\n\tvar opts = _opts || {};\n\tvar o = [XML_HEADER, writextag('cp:coreProperties', null, {\n\t\t//'xmlns': XMLNS.CORE_PROPS,\n\t\t'xmlns:cp': XMLNS.CORE_PROPS,\n\t\t'xmlns:dc': XMLNS.dc,\n\t\t'xmlns:dcterms': XMLNS.dcterms,\n\t\t'xmlns:dcmitype': XMLNS.dcmitype,\n\t\t'xmlns:xsi': XMLNS.xsi\n\t})], p = {};\n\tif(!cp && !opts.Props) return o.join(\"\");\n\n\tif(cp) {\n\t\tif(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t\tif(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t}\n\n\tfor(var i = 0; i != CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\n\t\tif(v === true) v = \"1\";\n\t\telse if(v === false) v = \"0\";\n\t\telse if(typeof v == \"number\") v = String(v);\n\t\tif(v != null) cp_doit(f[0], v, null, o, p);\n\t}\n\tif(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.3 Extended File Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar EXT_PROPS = [\n\t[\"Application\", \"Application\", \"string\"],\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\n\t[\"Company\", \"Company\", \"string\"],\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\n\t[\"Manager\", \"Manager\", \"string\"],\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\n\t[\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\n\t[\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\n];\n\nvar PseudoPropsPairs = [\n\t\"Worksheets\",  \"SheetNames\",\n\t\"NamedRanges\", \"DefinedNames\",\n\t\"Chartsheets\", \"ChartNames\"\n];\nfunction load_props_pairs(HP, TOP, props, opts) {\n\tvar v = [];\n\tif(typeof HP == \"string\") v = parseVector(HP, opts);\n\telse for(var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function(hp) { return {v:hp}; }));\n\tvar parts = (typeof TOP == \"string\") ? parseVector(TOP, opts).map(function (x) { return x.v; }) : TOP;\n\tvar idx = 0, len = 0;\n\tif(parts.length > 0) for(var i = 0; i !== v.length; i += 2) {\n\t\tlen = +(v[i+1].v);\n\t\tswitch(v[i].v) {\n\t\t\tcase \"Worksheets\":\n\t\t\tcase \"\":\n\t\t\tcase \"\":\n\t\t\tcase \" \":\n\t\t\tcase \"\":\n\t\t\tcase \" \":\n\t\t\tcase \"Arbeitsbltter\":\n\t\t\tcase \"alma Sayfalar\":\n\t\t\tcase \"Feuilles de calcul\":\n\t\t\tcase \"Fogli di lavoro\":\n\t\t\tcase \"Folhas de clculo\":\n\t\t\tcase \"Planilhas\":\n\t\t\tcase \"Regneark\":\n\t\t\tcase \"Hojas de clculo\":\n\t\t\tcase \"Werkbladen\":\n\t\t\t\tprops.Worksheets = len;\n\t\t\t\tprops.SheetNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Named Ranges\":\n\t\t\tcase \"Rangos con nombre\":\n\t\t\tcase \"\":\n\t\t\tcase \"Benannte Bereiche\":\n\t\t\tcase \"Navngivne omrder\":\n\t\t\t\tprops.NamedRanges = len;\n\t\t\t\tprops.DefinedNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Charts\":\n\t\t\tcase \"Diagramme\":\n\t\t\t\tprops.Chartsheets = len;\n\t\t\t\tprops.ChartNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\t\t}\n\t\tidx += len;\n\t}\n}\n\nfunction parse_ext_props(data, p, opts) {\n\tvar q = {}; if(!p) p = {};\n\tdata = utf8read(data);\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tvar xml = (data.match(matchtag(f[0]))||[])[1];\n\t\tswitch(f[2]) {\n\t\t\tcase \"string\": if(xml) p[f[1]] = unescapexml(xml); break;\n\t\t\tcase \"bool\": p[f[1]] = xml === \"true\"; break;\n\t\t\tcase \"raw\":\n\t\t\t\tvar cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\n\t\t\t\tif(cur && cur.length > 0) q[f[1]] = cur[1];\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n\n\treturn p;\n}\n\nfunction write_ext_props(cp) {\n\tvar o = [], W = writextag;\n\tif(!cp) cp = {};\n\tcp.Application = \"SheetJS\";\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (writextag('Properties', null, {\n\t\t'xmlns': XMLNS.EXT_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t}));\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tif(cp[f[1]] === undefined) return;\n\t\tvar v;\n\t\tswitch(f[2]) {\n\t\t\tcase 'string': v = escapexml(String(cp[f[1]])); break;\n\t\t\tcase 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\n\t\t}\n\t\tif(v !== undefined) o[o.length] = (W(f[0], v));\n\t});\n\n\t/* TODO: HeadingPairs, TitlesOfParts */\n\to[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\n\to[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\n\tif(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.2 Custom File Properties Part */\nvar custregex = /<[^>]+>[^<]*/g;\nfunction parse_cust_props(data, opts) {\n\tvar p = {}, name = \"\";\n\tvar m = data.match(custregex);\n\tif(m) for(var i = 0; i != m.length; ++i) {\n\t\tvar x = m[i], y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Properties': break;\n\t\t\tcase '<property': name = unescapexml(y.name); break;\n\t\t\tcase '</property>': name = null; break;\n\t\t\tdefault: if (x.indexOf('<vt:') === 0) {\n\t\t\t\tvar toks = x.split('>');\n\t\t\t\tvar type = toks[0].slice(4), text = toks[1];\n\t\t\t\t/* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase 'lpstr': case 'bstr': case 'lpwstr':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bool':\n\t\t\t\t\t\tp[name] = parsexmlbool(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\n\t\t\t\t\t\tp[name] = parseInt(text, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r4': case 'r8': case 'decimal':\n\t\t\t\t\t\tp[name] = parseFloat(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'filetime': case 'date':\n\t\t\t\t\t\tp[name] = parseDate(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cy': case 'error':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(type.slice(-1) == '/') break;\n\t\t\t\t\t\tif(opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n\t\t\t\t}\n\t\t\t} else if(x.slice(0,2) === \"</\") {/* empty */\n\t\t\t} else if(opts.WTF) throw new Error(x);\n\t\t}\n\t}\n\treturn p;\n}\n\nfunction write_cust_props(cp) {\n\tvar o = [XML_HEADER, writextag('Properties', null, {\n\t\t'xmlns': XMLNS.CUST_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t})];\n\tif(!cp) return o.join(\"\");\n\tvar pid = 1;\n\tkeys(cp).forEach(function custprop(k) { ++pid;\n\t\to[o.length] = (writextag('property', write_vt(cp[k], true), {\n\t\t\t'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n\t\t\t'pid': pid,\n\t\t\t'name': escapexml(k)\n\t\t}));\n\t});\n\tif(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* Common Name -> XLML Name */\nvar XLMLDocPropsMap = {\n\tTitle: 'Title',\n\tSubject: 'Subject',\n\tAuthor: 'Author',\n\tKeywords: 'Keywords',\n\tComments: 'Description',\n\tLastAuthor: 'LastAuthor',\n\tRevNumber: 'Revision',\n\tApplication: 'AppName',\n\t/* TotalTime: 'TotalTime', */\n\tLastPrinted: 'LastPrinted',\n\tCreatedDate: 'Created',\n\tModifiedDate: 'LastSaved',\n\t/* Pages */\n\t/* Words */\n\t/* Characters */\n\tCategory: 'Category',\n\t/* PresentationFormat */\n\tManager: 'Manager',\n\tCompany: 'Company',\n\t/* Guid */\n\t/* HyperlinkBase */\n\t/* Bytes */\n\t/* Lines */\n\t/* Paragraphs */\n\t/* CharactersWithSpaces */\n\tAppVersion: 'Version',\n\n\tContentStatus: 'ContentStatus', /* NOTE: missing from schema */\n\tIdentifier: 'Identifier', /* NOTE: missing from schema */\n\tLanguage: 'Language' /* NOTE: missing from schema */\n};\nvar evert_XLMLDPM;\n\nfunction xlml_set_prop(Props, tag, val) {\n\tif(!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n\ttag = evert_XLMLDPM[tag] || tag;\n\tProps[tag] = val;\n}\n\nfunction xlml_write_docprops(Props, opts) {\n\tvar o = [];\n\tkeys(XLMLDocPropsMap).map(function(m) {\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(CORE_PROPS[i][1] == m) return CORE_PROPS[i];\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(EXT_PROPS[i][1] == m) return EXT_PROPS[i];\n\t\tthrow m;\n\t}).forEach(function(p) {\n\t\tif(Props[p[1]] == null) return;\n\t\tvar m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\n\t\tswitch(p[2]) {\n\t\t\tcase 'date': m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"Z\"); break;\n\t\t}\n\t\tif(typeof m == 'number') m = String(m);\n\t\telse if(m === true || m === false) { m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"\");\n\t\to.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\n\t});\n\treturn writextag('DocumentProperties', o.join(\"\"), {xmlns:XLMLNS.o });\n}\nfunction xlml_write_custprops(Props, Custprops) {\n\tvar BLACKLIST = [\"Worksheets\",\"SheetNames\"];\n\tvar T = 'CustomDocumentProperties';\n\tvar o = [];\n\tif(Props) keys(Props).forEach(function(k) {\nif(!Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(k == CORE_PROPS[i][1]) return;\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(k == EXT_PROPS[i][1]) return;\n\t\tfor(i = 0; i < BLACKLIST.length; ++i) if(k == BLACKLIST[i]) return;\n\n\t\tvar m = Props[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\tif(Custprops) keys(Custprops).forEach(function(k) {\nif(!Object.prototype.hasOwnProperty.call(Custprops, k)) return;\n\t\tif(Props && Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tvar m = Custprops[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) { t = \"dateTime.tz\"; m = m.toISOString(); }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\treturn '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\n}\n/* [MS-DTYP] 2.3.3 FILETIME */\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\nfunction parse_FILETIME(blob) {\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\n}\nfunction write_FILETIME(time) {\n\tvar date = (typeof time == \"string\") ? new Date(Date.parse(time)) : time;\n\tvar t = date.getTime() / 1000 + 11644473600;\n\tvar l = t % Math.pow(2,32), h = (t - l) / Math.pow(2,32);\n\tl *= 1e7; h *= 1e7;\n\tvar w = (l / Math.pow(2,32)) | 0;\n\tif(w > 0) { l = l % Math.pow(2,32); h += w; }\n\tvar o = new_buf(8); o.write_shift(4, l); o.write_shift(4, h); return o;\n}\n\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\nfunction parse_lpstr(blob, type, pad) {\n\tvar start = blob.l;\n\tvar str = blob.read_shift(0, 'lpstr-cp');\n\tif(pad) while((blob.l - start) & 3) ++blob.l;\n\treturn str;\n}\n\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\nfunction parse_lpwstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpwstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\nfunction parse_VtStringBase(blob, stringType, pad) {\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n\treturn parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\nfunction parse_VtUnalignedString(blob, t) { if(!t) throw new Error(\"VtUnalignedString must have positive length\"); return parse_VtStringBase(blob, t, 0); }\n\n/* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\nfunction parse_VtVecLpwstrValue(blob) {\n\tvar length = blob.read_shift(4);\n\tvar ret = [];\n\tfor(var i = 0; i != length; ++i) {\n\t\tvar start = blob.l;\n\t\tret[i] = blob.read_shift(0, 'lpwstr').replace(chr0,'');\n\t\tif((blob.l - start) & 0x02) blob.l += 2;\n\t}\n\treturn ret;\n}\n\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\nfunction parse_VtVecUnalignedLpstrValue(blob) {\n\tvar length = blob.read_shift(4);\n\tvar ret = [];\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0,'');\n\treturn ret;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\nfunction parse_VtHeadingPair(blob) {\n\tvar start = blob.l;\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\n\tif(blob[blob.l] == 0x00 && blob[blob.l+1] == 0x00 && ((blob.l - start) & 0x02)) blob.l += 2;\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\n\treturn [headingString, headerParts];\n}\n\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\nfunction parse_VtVecHeadingPairValue(blob) {\n\tvar cElements = blob.read_shift(4);\n\tvar out = [];\n\tfor(var i = 0; i < cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\treturn out;\n}\n\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\nfunction parse_dictionary(blob,CodePage) {\n\tvar cnt = blob.read_shift(4);\n\tvar dict = ({});\n\tfor(var j = 0; j != cnt; ++j) {\n\t\tvar pid = blob.read_shift(4);\n\t\tvar len = blob.read_shift(4);\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\n\t\tif(CodePage === 0x4B0 && (len % 2)) blob.l += 2;\n\t}\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\n\treturn dict;\n}\n\n/* [MS-OLEPS] 2.9 BLOB */\nfunction parse_BLOB(blob) {\n\tvar size = blob.read_shift(4);\n\tvar bytes = blob.slice(blob.l,blob.l+size);\n\tblob.l += size;\n\tif((size & 3) > 0) blob.l += (4 - (size & 3)) & 3;\n\treturn bytes;\n}\n\n/* [MS-OLEPS] 2.11 ClipboardData */\nfunction parse_ClipboardData(blob) {\n\t// TODO\n\tvar o = {};\n\to.Size = blob.read_shift(4);\n\t//o.Format = blob.read_shift(4);\n\tblob.l += o.Size + 3 - (o.Size - 1) % 4;\n\treturn o;\n}\n\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\nfunction parse_TypedPropertyValue(blob, type, _opts) {\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\n\tblob.l += 2;\n\tif(type !== VT_VARIANT)\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n\tswitch(type === VT_VARIANT ? t : type) {\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\n\t\tcase 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\n\t\tcase 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw).replace(chr0,'');\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t/*, 4*/).replace(chr0,'');\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPairValue(blob);\n\t\tcase 0x101E /*VT_VECTOR|VT_LPSTR*/:\n\t\tcase 0x101F /*VT_VECTOR|VT_LPWSTR*/:\n\t\t\treturn t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n\t}\n}\nfunction write_TypedPropertyValue(type, value) {\n\tvar o = new_buf(4), p = new_buf(4);\n\to.write_shift(4, type == 0x50 ? 0x1F : type);\n\tswitch(type) {\n\t\tcase 0x03 /*VT_I4*/: p.write_shift(-4, value); break;\n\t\tcase 0x05 /*VT_I4*/: p = new_buf(8); p.write_shift(8, value, 'f'); break;\n\t\tcase 0x0B /*VT_BOOL*/: p.write_shift(4, value ? 0x01 : 0x00); break;\n\t\tcase 0x40 /*VT_FILETIME*/:  p = write_FILETIME(value); break;\n\t\tcase 0x1F /*VT_LPWSTR*/:\n\t\tcase 0x50 /*VT_STRING*/:\np = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tp.write_shift(4, value.length + 1);\n\t\t\tp.write_shift(0, value, \"dbcs\");\n\t\t\twhile(p.l != p.length) p.write_shift(1, 0);\n\t\t\tbreak;\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\n\t}\n\treturn bconcat([o, p]);\n}\n\n/* [MS-OLEPS] 2.20 PropertySet */\nfunction parse_PropertySet(blob, PIDSI) {\n\tvar start_addr = blob.l;\n\tvar size = blob.read_shift(4);\n\tvar NumProps = blob.read_shift(4);\n\tvar Props = [], i = 0;\n\tvar CodePage = 0;\n\tvar Dictionary = -1, DictObj = ({});\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tvar PropID = blob.read_shift(4);\n\t\tvar Offset = blob.read_shift(4);\n\t\tProps[i] = [PropID, Offset + start_addr];\n\t}\n\tProps.sort(function(x,y) { return x[1] - y[1]; });\n\tvar PropH = {};\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tif(blob.l !== Props[i][1]) {\n\t\t\tvar fail = true;\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l+2 === Props[i][1]) { blob.l+=2; fail = false; } break;\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t}\n\t\t\tif((!PIDSI||i==0) && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n\t\t}\n\t\tif(PIDSI) {\n\t\t\tif(Props[i][0] == 0 && Props.length > i+1 && Props[i][1] == Props[i+1][1]) continue; // R9\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 874:\n\t\t\t\tcase 932:\n\t\t\t\tcase 936:\n\t\t\t\tcase 949:\n\t\t\t\tcase 950:\n\t\t\t\tcase 1250:\n\t\t\t\tcase 1251:\n\t\t\t\tcase 1253:\n\t\t\t\tcase 1254:\n\t\t\t\tcase 1255:\n\t\t\t\tcase 1256:\n\t\t\t\tcase 1257:\n\t\t\t\tcase 1258:\n\t\t\t\tcase 10000:\n\t\t\t\tcase 1200:\n\t\t\t\tcase 1201:\n\t\t\t\tcase 1252:\n\t\t\t\tcase 65000: case -536:\n\t\t\t\tcase 65001: case -535:\n\t\t\t\t\tset_cp(CodePage = (PropH[piddsi.n]>>>0) & 0xFFFF); break;\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n\t\t\t}\n\t\t} else {\n\t\t\tif(Props[i][0] === 0x1) {\n\t\t\t\tCodePage = PropH.CodePage = (parse_TypedPropertyValue(blob, VT_I2));\n\t\t\t\tset_cp(CodePage);\n\t\t\t\tif(Dictionary !== -1) {\n\t\t\t\t\tvar oldpos = blob.l;\n\t\t\t\t\tblob.l = Props[Dictionary][1];\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t\t\tblob.l = oldpos;\n\t\t\t\t}\n\t\t\t} else if(Props[i][0] === 0) {\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t} else {\n\t\t\t\tvar name = DictObj[Props[i][0]];\n\t\t\t\tvar val;\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\t\t\t\tswitch(blob[blob.l]) {\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = parseDate(parse_FILETIME(blob)); break;\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\n\t\t\t\t}\n\t\t\t\tPropH[name] = val;\n\t\t\t}\n\t\t}\n\t}\n\tblob.l = start_addr + size; /* step ahead to skip padding */\n\treturn PropH;\n}\nvar XLSPSSkip = [ \"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\" ];\nfunction guess_property_type(val) {\n\tswitch(typeof val) {\n\t\tcase \"boolean\": return 0x0B;\n\t\tcase \"number\": return ((val|0)==val) ? 0x03 : 0x05;\n\t\tcase \"string\": return 0x1F;\n\t\tcase \"object\": if(val instanceof Date) return 0x40; break;\n\t}\n\treturn -1;\n}\nfunction write_PropertySet(entries, RE, PIDSI) {\n\tvar hdr = new_buf(8), piao = [], prop = [];\n\tvar sz = 8, i = 0;\n\n\tvar pr = new_buf(8), pio = new_buf(8);\n\tpr.write_shift(4, 0x0002);\n\tpr.write_shift(4, 0x04B0);\n\tpio.write_shift(4, 0x0001);\n\tprop.push(pr); piao.push(pio);\n\tsz += 8 + pr.length;\n\n\tif(!RE) {\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, 0);\n\t\tpiao.unshift(pio);\n\n\t\tvar bufs = [new_buf(4)];\n\t\tbufs[0].write_shift(4, entries.length);\n\t\tfor(i = 0; i < entries.length; ++i) {\n\t\t\tvar value = entries[i][0];\n\t\t\tpr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tpr.write_shift(4, i+2);\n\t\t\tpr.write_shift(4, value.length + 1);\n\t\t\tpr.write_shift(0, value, \"dbcs\");\n\t\t\twhile(pr.l != pr.length) pr.write_shift(1, 0);\n\t\t\tbufs.push(pr);\n\t\t}\n\t\tpr = bconcat(bufs);\n\t\tprop.unshift(pr);\n\t\tsz += 8 + pr.length;\n\t}\n\n\tfor(i = 0; i < entries.length; ++i) {\n\t\tif(RE && !RE[entries[i][0]]) continue;\n\t\tif(XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;\n\t\tif(entries[i][1] == null) continue;\n\n\t\tvar val = entries[i][1], idx = 0;\n\t\tif(RE) {\n\t\t\tidx = +RE[entries[i][0]];\n\t\t\tvar pinfo = (PIDSI)[idx];\n\t\t\tif(pinfo.p == \"version\" && typeof val == \"string\") {\nvar arr = val.split(\".\");\n\t\t\t\tval = ((+arr[0])<<16) + ((+arr[1])||0);\n\t\t\t}\n\t\t\tpr = write_TypedPropertyValue(pinfo.t, val);\n\t\t} else {\n\t\t\tvar T = guess_property_type(val);\n\t\t\tif(T == -1) { T = 0x1F; val = String(val); }\n\t\t\tpr = write_TypedPropertyValue(T, val);\n\t\t}\n\t\tprop.push(pr);\n\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, !RE ? 2+i : idx);\n\t\tpiao.push(pio);\n\n\t\tsz += 8 + pr.length;\n\t}\n\n\tvar w = 8 * (prop.length + 1);\n\tfor(i = 0; i < prop.length; ++i) { piao[i].write_shift(4, w); w += prop[i].length; }\n\thdr.write_shift(4, sz);\n\thdr.write_shift(4, prop.length);\n\treturn bconcat([hdr].concat(piao).concat(prop));\n}\n\n/* [MS-OLEPS] 2.21 PropertySetStream */\nfunction parse_PropertySetStream(file, PIDSI, clsid) {\n\tvar blob = file.content;\n\tif(!blob) return ({});\n\tprep_blob(blob, 0);\n\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1 = 0;\n\tblob.chk('feff', 'Byte Order: ');\n\n\t/*var vers = */blob.read_shift(2); // TODO: check version\n\tvar SystemIdentifier = blob.read_shift(4);\n\tvar CLSID = blob.read_shift(16);\n\tif(CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n\tNumSets = blob.read_shift(4);\n\tif(NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\n\n\tif(NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\n\n\tvar rval = ({ SystemIdentifier: SystemIdentifier });\n\tfor(var y in PSet0) rval[y] = PSet0[y];\n\t//rval.blob = blob;\n\trval.FMTID = FMTID0;\n\t//rval.PSet0 = PSet0;\n\tif(NumSets === 1) return rval;\n\tif(Offset1 - blob.l == 2) blob.l += 2;\n\tif(blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n\tvar PSet1;\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) {/* empty */}\n\tfor(y in PSet1) rval[y] = PSet1[y];\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\treturn rval;\n}\nfunction write_PropertySetStream(entries, clsid, RE, PIDSI, entries2, clsid2) {\n\tvar hdr = new_buf(entries2 ? 68 : 48);\n\tvar bufs = [hdr];\n\thdr.write_shift(2, 0xFFFE);\n\thdr.write_shift(2, 0x0000); /* TODO: type 1 props */\n\thdr.write_shift(4, 0x32363237);\n\thdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\n\thdr.write_shift(4, (entries2 ? 2 : 1));\n\thdr.write_shift(16, clsid, \"hex\");\n\thdr.write_shift(4, (entries2 ? 68 : 48));\n\tvar ps0 = write_PropertySet(entries, RE, PIDSI);\n\tbufs.push(ps0);\n\n\tif(entries2) {\n\t\tvar ps1 = write_PropertySet(entries2, null, null);\n\t\thdr.write_shift(16, clsid2, \"hex\");\n\t\thdr.write_shift(4, 68 + ps0.length);\n\t\tbufs.push(ps1);\n\t}\n\treturn bconcat(bufs);\n}\n\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\nfunction writezeroes(n, o) { if(!o) o=new_buf(n); for(var j=0; j<n; ++j) o.write_shift(1, 0); return o; }\n\nfunction parslurp(blob, length, cb) {\n\tvar arr = [], target = blob.l + length;\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\nfunction writebool(v, o) { if(!o) o=new_buf(2); o.write_shift(2, +!!v); return o; }\n\nfunction parseuint16(blob) { return blob.read_shift(2, 'u'); }\nfunction writeuint16(v, o) { if(!o) o=new_buf(2); o.write_shift(2, v); return o; }\nfunction parseuint16a(blob, length) { return parslurp(blob,length,parseuint16);}\n\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\nfunction parse_Bes(blob) {\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\n\treturn t === 0x01 ? v : v === 0x01;\n}\nfunction write_Bes(v, t, o) {\n\tif(!o) o = new_buf(2);\n\to.write_shift(1, ((t == 'e') ? +v : +!!v));\n\to.write_shift(1, ((t == 'e') ? 1 : 0));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n\tvar encoding = 'sbcs-cont';\n\tvar cp = current_codepage;\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\n\tif(!opts || opts.biff == 8 ) {\n\t\tvar fHighByte = blob.read_shift(1);\n\t\tif(fHighByte) { encoding = 'dbcs-cont'; }\n\t} else if(opts.biff == 12) {\n\t\tencoding = 'wstr';\n\t}\n\tif(opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\n\tcurrent_codepage = cp;\n\treturn o;\n}\n\n/* 2.5.293 XLUnicodeRichExtendedString */\nfunction parse_XLUnicodeRichExtendedString(blob) {\n\tvar cp = current_codepage;\n\tcurrent_codepage = 1200;\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\n\tvar /*fHighByte = flags & 0x1,*/ fExtSt = flags & 0x4, fRichSt = flags & 0x8;\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\tvar cRun = 0, cbExtRst;\n\tvar z = {};\n\tif(fRichSt) cRun = blob.read_shift(2);\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\n\tvar encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\n\tz.t = msg;\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\n\tcurrent_codepage = cp;\n\treturn z;\n}\nfunction write_XLUnicodeRichExtendedString(xlstr) {\n\tvar str = (xlstr.t||\"\"), nfmts = 1;\n\n\tvar hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));\n\thdr.write_shift(2, str.length);\n\thdr.write_shift(1, (nfmts > 1 ? 0x08 : 0x00) | 0x01);\n\tif(nfmts > 1) hdr.write_shift(2, nfmts);\n\n\tvar otext = new_buf(2 * str.length);\n\totext.write_shift(2 * str.length, str, 'utf16le');\n\n\tvar out = [hdr, otext];\n\n\treturn bconcat(out);\n}\n\n/* 2.5.296 XLUnicodeStringNoCch */\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n\tvar retval;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n\t\tif(opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n\t}\n\tvar fHighByte = blob.read_shift(1);\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\n\treturn retval;\n}\n\n/* 2.5.294 XLUnicodeString */\nfunction parse_XLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\nfunction parse_XLUnicodeString2(blob, length, opts) {\n\tif(opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, (opts.biff <= 4 || !blob.lens ) ? 'cpstr' : 'sbcs-cont');\n}\n/* TODO: BIFF5 and lower, codepage awareness */\nfunction write_XLUnicodeString(str, opts, o) {\n\tif(!o) o = new_buf(3 + 2 * str.length);\n\to.write_shift(2, str.length);\n\to.write_shift(1, 1);\n\to.write_shift(31, str, 'utf16le');\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.61 ControlInfo */\nfunction parse_ControlInfo(blob) {\n\tvar flags = blob.read_shift(1);\n\tblob.l++;\n\tvar accel = blob.read_shift(2);\n\tblob.l += 2;\n\treturn [flags, accel];\n}\n\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\nfunction parse_URLMoniker(blob) {\n\tvar len = blob.read_shift(4), start = blob.l;\n\tvar extra = false;\n\tif(len > 24) {\n\t\t/* look ahead */\n\t\tblob.l += len - 24;\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n\t\tblob.l = start;\n\t}\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\n\tif(extra) blob.l += 24;\n\treturn url;\n}\n\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\nfunction parse_FileMoniker(blob) {\n\tvar cAnti = blob.read_shift(2);\n\tvar preamble = \"\"; while(cAnti-- > 0) preamble += \"../\";\n\tvar ansiPath = blob.read_shift(0, 'lpstr-ansi');\n\tblob.l += 2; //var endServer = blob.read_shift(2);\n\tif(blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n\tvar sz = blob.read_shift(4);\n\tif(sz === 0) return preamble + ansiPath.replace(/\\\\/g,\"/\");\n\tvar bytes = blob.read_shift(4);\n\tif(blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n\tvar unicodePath = blob.read_shift(bytes>>1, 'utf16le').replace(chr0,\"\");\n\treturn preamble + unicodePath;\n}\n\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\nfunction parse_HyperlinkMoniker(blob, length) {\n\tvar clsid = blob.read_shift(16); length -= 16;\n\tswitch(clsid) {\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\n\t\tdefault: throw new Error(\"Unsupported Moniker \" + clsid);\n\t}\n}\n\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\nfunction parse_HyperlinkString(blob) {\n\tvar len = blob.read_shift(4);\n\tvar o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n\treturn o;\n}\nfunction write_HyperlinkString(str, o) {\n\tif(!o) o = new_buf(6 + str.length * 2);\n\to.write_shift(4, 1 + str.length);\n\tfor(var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\nfunction parse_Hyperlink(blob, length) {\n\tvar end = blob.l + length;\n\tvar sVer = blob.read_shift(4);\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n\tvar flags = blob.read_shift(2);\n\tblob.l += 2;\n\tvar displayName, targetFrameName, moniker, oleMoniker, Loc=\"\", guid, fileTime;\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n\tif(flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0020) guid = blob.read_shift(16);\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob/*, 8*/);\n\tblob.l = end;\n\tvar target = targetFrameName||moniker||oleMoniker||\"\";\n\tif(target && Loc) target+=\"#\"+Loc;\n\tif(!target) target = \"#\" + Loc;\n\tif((flags & 0x0002) && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n\tvar out = ({Target:target});\n\tif(guid) out.guid = guid;\n\tif(fileTime) out.time = fileTime;\n\tif(displayName) out.Tooltip = displayName;\n\treturn out;\n}\nfunction write_Hyperlink(hl) {\n\tvar out = new_buf(512), i = 0;\n\tvar Target = hl.Target;\n\tif(Target.slice(0,7) == \"file://\") Target = Target.slice(7);\n\tvar hashidx = Target.indexOf(\"#\");\n\tvar F = hashidx > -1 ? 0x1f : 0x17;\n\tswitch(Target.charAt(0)) { case \"#\": F=0x1c; break; case \".\": F&=~2; break; }\n\tout.write_shift(4,2); out.write_shift(4, F);\n\tvar data = [8,6815827,6619237,4849780,83]; for(i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\n\tif(F == 0x1C) {\n\t\tTarget = Target.slice(1);\n\t\twrite_HyperlinkString(Target, out);\n\t} else if(F & 0x02) {\n\t\tdata = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;\n\t\tout.write_shift(4, 2*(Pretarget.length + 1));\n\t\tfor(i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));\n\t\tout.write_shift(2, 0);\n\t\tif(F & 0x08) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx+1): \"\", out);\n\t} else {\n\t\tdata = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar P = 0;\n\t\twhile(Target.slice(P*3,P*3+3)==\"../\"||Target.slice(P*3,P*3+3)==\"..\\\\\") ++P;\n\t\tout.write_shift(2, P);\n\t\tout.write_shift(4, Target.length - 3 * P + 1);\n\t\tfor(i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 0xFF);\n\t\tout.write_shift(1, 0);\n\t\tout.write_shift(2, 0xFFFF);\n\t\tout.write_shift(2, 0xDEAD);\n\t\tfor(i = 0; i < 6; ++i) out.write_shift(4, 0);\n\t}\n\treturn out.slice(0, out.l);\n}\n\n/* 2.5.178 LongRGBA */\nfunction parse_LongRGBA(blob) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\n\n/* 2.5.177 LongRGB */\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\n\n\n/* [MS-XLS] 2.5.19 */\nfunction parse_XLSCell(blob, length, opts) {\n\tvar rw = blob.read_shift(2); // 0-indexed\n\tvar col = blob.read_shift(2);\n\tvar ret = ({r:rw, c:col, ixfe:0});\n\tif(opts && opts.biff == 2 || length == 7) {\n\t\t/* TODO: pass back flags */\n\t\tvar flags = blob.read_shift(1);\n\t\tret.ixfe = flags & 0x3F;\n\t\tblob.l += 2;\n\t\t/*\n\t\tvar ifntifmt = blob.read_shift(1);\n\t\tvar ifmt = ifntifmt & 0x3f, ifnt = ifntifmt >> 6;\n\t\tvar flags3 = blob.read_shift(1);\n\t\t*/\n\t} else ret.ixfe = blob.read_shift(2);\n\treturn ret;\n}\nfunction write_XLSCell(R, C, ixfe, o) {\n\tif(!o) o = new_buf(6);\n\to.write_shift(2, R);\n\to.write_shift(2, C);\n\to.write_shift(2, ixfe||0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.134 */\nfunction parse_frtHeader(blob) {\n\tvar rt = blob.read_shift(2);\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\n\tblob.l += 8;\n\treturn {type: rt, flags: flags};\n}\n\n\n\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\n\n/* [MS-XLS] 2.5.344 */\nfunction parse_XTI(blob, length, opts) {\n\tvar w = opts.biff > 8 ? 4 : 2;\n\tvar iSupBook = blob.read_shift(w), itabFirst = blob.read_shift(w,'i'), itabLast = blob.read_shift(w,'i');\n\treturn [iSupBook, itabFirst, itabLast];\n}\n\n/* [MS-XLS] 2.5.218 */\nfunction parse_RkRec(blob) {\n\tvar ixfe = blob.read_shift(2);\n\tvar RK = parse_RkNumber(blob);\n\treturn [ixfe, RK];\n}\n\n/* [MS-XLS] 2.5.1 */\nfunction parse_AddinUdf(blob, length, opts) {\n\tblob.l += 4; length -= 4;\n\tvar l = blob.l + length;\n\tvar udfName = parse_ShortXLUnicodeString(blob, length, opts);\n\tvar cb = blob.read_shift(2);\n\tl -= blob.l;\n\tif(cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n\tblob.l += cb;\n\treturn udfName;\n}\n\n/* [MS-XLS] 2.5.209 TODO: Check sizes */\nfunction parse_Ref8U(blob) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(2);\n\tvar colLast = blob.read_shift(2);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\nfunction write_Ref8U(r, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(2, r.s.r);\n\to.write_shift(2, r.e.r);\n\to.write_shift(2, r.s.c);\n\to.write_shift(2, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.211 */\nfunction parse_RefU(blob) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(1);\n\tvar colLast = blob.read_shift(1);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* [MS-XLS] 2.5.207 */\nvar parse_Ref = parse_RefU;\n\n/* [MS-XLS] 2.5.143 */\nfunction parse_FtCmo(blob) {\n\tblob.l += 4;\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tblob.l+=12;\n\treturn [id, ot, flags];\n}\n\n/* [MS-XLS] 2.5.149 */\nfunction parse_FtNts(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.l += 16; // GUID TODO\n\tout.fSharedNote = blob.read_shift(2);\n\tblob.l += 4;\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.142 */\nfunction parse_FtCf(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.cf = blob.read_shift(2);\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.140 - 2.5.154 and friends */\nfunction parse_FtSkip(blob) { blob.l += 2; blob.l += blob.read_shift(2); }\nvar FtTab = {\n0x00: parse_FtSkip,      /* FtEnd */\n0x04: parse_FtSkip,      /* FtMacro */\n0x05: parse_FtSkip,      /* FtButton */\n0x06: parse_FtSkip,      /* FtGmo */\n0x07: parse_FtCf,        /* FtCf */\n0x08: parse_FtSkip,      /* FtPioGrbit */\n0x09: parse_FtSkip,      /* FtPictFmla */\n0x0A: parse_FtSkip,      /* FtCbls */\n0x0B: parse_FtSkip,      /* FtRbo */\n0x0C: parse_FtSkip,      /* FtSbs */\n0x0D: parse_FtNts,       /* FtNts */\n0x0E: parse_FtSkip,      /* FtSbsFmla */\n0x0F: parse_FtSkip,      /* FtGboData */\n0x10: parse_FtSkip,      /* FtEdoData */\n0x11: parse_FtSkip,      /* FtRboData */\n0x12: parse_FtSkip,      /* FtCblsData */\n0x13: parse_FtSkip,      /* FtLbsData */\n0x14: parse_FtSkip,      /* FtCblsFmla */\n0x15: parse_FtCmo\n};\nfunction parse_FtArray(blob, length) {\n\tvar tgt = blob.l + length;\n\tvar fts = [];\n\twhile(blob.l < tgt) {\n\t\tvar ft = blob.read_shift(2);\n\t\tblob.l-=2;\n\t\ttry {\n\t\t\tfts[ft] = FtTab[ft](blob, tgt - blob.l);\n\t\t} catch(e) { blob.l = tgt; return fts; }\n\t}\n\tif(blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n\treturn fts;\n}\n\n/* --- 2.4 Records --- */\n\n/* [MS-XLS] 2.4.21 */\nfunction parse_BOF(blob, length) {\n\tvar o = {BIFFVer:0, dt:0};\n\to.BIFFVer = blob.read_shift(2); length -= 2;\n\tif(length >= 2) { o.dt = blob.read_shift(2); blob.l -= 2; }\n\tswitch(o.BIFFVer) {\n\t\tcase 0x0600: /* BIFF8 */\n\t\tcase 0x0500: /* BIFF5 */\n\t\tcase 0x0400: /* BIFF4 */\n\t\tcase 0x0300: /* BIFF3 */\n\t\tcase 0x0200: /* BIFF2 */\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\n\t\t\tbreak;\n\t\tdefault: if(length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n\t}\n\n\tblob.read_shift(length);\n\treturn o;\n}\nfunction write_BOF(wb, t, o) {\n\tvar h = 0x0600, w = 16;\n\tswitch(o.bookType) {\n\t\tcase 'biff8': break;\n\t\tcase 'biff5': h = 0x0500; w = 8; break;\n\t\tcase 'biff4': h = 0x0004; w = 6; break;\n\t\tcase 'biff3': h = 0x0003; w = 6; break;\n\t\tcase 'biff2': h = 0x0002; w = 4; break;\n\t\tcase 'xla': break;\n\t\tdefault: throw new Error(\"unsupported BIFF version\");\n\t}\n\tvar out = new_buf(w);\n\tout.write_shift(2, h);\n\tout.write_shift(2, t);\n\tif(w > 4) out.write_shift(2, 0x7262);\n\tif(w > 6) out.write_shift(2, 0x07CD);\n\tif(w > 8) {\n\t\tout.write_shift(2, 0xC009);\n\t\tout.write_shift(2, 0x0001);\n\t\tout.write_shift(2, 0x0706);\n\t\tout.write_shift(2, 0x0000);\n\t}\n\treturn out;\n}\n\n\n/* [MS-XLS] 2.4.146 */\nfunction parse_InterfaceHdr(blob, length) {\n\tif(length === 0) return 0x04b0;\n\tif((blob.read_shift(2))!==0x04b0){/* empty */}\n\treturn 0x04b0;\n}\n\n\n/* [MS-XLS] 2.4.349 */\nfunction parse_WriteAccess(blob, length, opts) {\n\tif(opts.enc) { blob.l += length; return \"\"; }\n\tvar l = blob.l;\n\t// TODO: make sure XLUnicodeString doesnt overrun\n\tvar UserName = parse_XLUnicodeString2(blob, 0, opts);\n\tblob.read_shift(length + l - blob.l);\n\treturn UserName;\n}\nfunction write_WriteAccess(s, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(b8 ? 112 : 54);\n\to.write_shift(opts.biff == 8 ? 2 : 1, 7);\n\tif(b8) o.write_shift(1, 0);\n\to.write_shift(4, 0x33336853);\n\to.write_shift(4, (0x00534A74 | (b8 ? 0 : 0x20000000)));\n\twhile(o.l < o.length) o.write_shift(1, (b8 ? 0 : 32));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.351 */\nfunction parse_WsBool(blob, length, opts) {\n\tvar flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n\treturn { fDialog: flags & 0x10, fBelow: flags & 0x40, fRight: flags & 0x80 };\n}\n\n/* [MS-XLS] 2.4.28 */\nfunction parse_BoundSheet8(blob, length, opts) {\n\tvar name = \"\";\n\tif(opts.biff == 4) {\n\t\tname = parse_ShortXLUnicodeString(blob, 0, opts);\n\t\tif(name.length === 0) name = \"Sheet1\";\n\t\treturn { name:name };\n\t}\n\tvar pos = blob.read_shift(4);\n\tvar hidden = blob.read_shift(1) & 0x03;\n\tvar dt = blob.read_shift(1);\n\tswitch(dt) {\n\t\tcase 0: dt = 'Worksheet'; break;\n\t\tcase 1: dt = 'Macrosheet'; break;\n\t\tcase 2: dt = 'Chartsheet'; break;\n\t\tcase 6: dt = 'VBAModule'; break;\n\t}\n\tname = parse_ShortXLUnicodeString(blob, 0, opts);\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\n}\nfunction write_BoundSheet8(data, opts) {\n\tvar w = (!opts || opts.biff >= 8 ? 2 : 1);\n\tvar o = new_buf(8 + w * data.name.length);\n\to.write_shift(4, data.pos);\n\to.write_shift(1, data.hs || 0);\n\to.write_shift(1, data.dt);\n\to.write_shift(1, data.name.length);\n\tif(opts.biff >= 8) o.write_shift(1, 1);\n\to.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\n\tvar out = o.slice(0, o.l);\n\tout.l = o.l; return out;\n}\n\n/* [MS-XLS] 2.4.265 TODO */\nfunction parse_SST(blob, length) {\n\tvar end = blob.l + length;\n\tvar cnt = blob.read_shift(4);\n\tvar ucnt = blob.read_shift(4);\n\tvar strs = ([]);\n\tfor(var i = 0; i != ucnt && blob.l < end; ++i) {\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\n\t}\n\tstrs.Count = cnt; strs.Unique = ucnt;\n\treturn strs;\n}\nfunction write_SST(sst, opts) {\n\tvar header = new_buf(8);\n\theader.write_shift(4, sst.Count);\n\theader.write_shift(4, sst.Unique);\n\tvar strs = [];\n\tfor(var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);\n\tvar o = bconcat([header].concat(strs));\no.parts = [header.length].concat(strs.map(function(str) { return str.length; }));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.107 */\nfunction parse_ExtSST(blob, length) {\n\tvar extsst = {};\n\textsst.dsst = blob.read_shift(2);\n\tblob.l += length-2;\n\treturn extsst;\n}\n\n\n/* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\nfunction parse_Row(blob) {\n\tvar z = ({});\n\tz.r = blob.read_shift(2);\n\tz.c = blob.read_shift(2);\n\tz.cnt = blob.read_shift(2) - z.c;\n\tvar miyRw = blob.read_shift(2);\n\tblob.l += 4; // reserved(2), unused(2)\n\tvar flags = blob.read_shift(1); // various flags\n\tblob.l += 3; // reserved(8), ixfe(12), flags(4)\n\tif(flags & 0x07) z.level = flags & 0x07;\n\t// collapsed: flags & 0x10\n\tif(flags & 0x20) z.hidden = true;\n\tif(flags & 0x40) z.hpt = miyRw / 20;\n\treturn z;\n}\n\n\n/* [MS-XLS] 2.4.125 */\nfunction parse_ForceFullCalculation(blob) {\n\tvar header = parse_frtHeader(blob);\n\tif(header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n\tvar fullcalc = blob.read_shift(4);\n\treturn fullcalc !== 0x0;\n}\n\n\n\n\n\n/* [MS-XLS] 2.4.215 rt */\nfunction parse_RecalcId(blob) {\n\tblob.read_shift(2);\n\treturn blob.read_shift(4);\n}\n\n/* [MS-XLS] 2.4.87 */\nfunction parse_DefaultRowHeight(blob, length, opts) {\n\tvar f = 0;\n\tif(!(opts && opts.biff == 2)) {\n\t\tf = blob.read_shift(2);\n\t}\n\tvar miyRw = blob.read_shift(2);\n\tif((opts && opts.biff == 2)) {\n\t\tf = 1 - (miyRw >> 15); miyRw &= 0x7fff;\n\t}\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\n\treturn [fl, miyRw];\n}\n\n/* [MS-XLS] 2.4.345 TODO */\nfunction parse_Window1(blob) {\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\n}\nfunction write_Window1() {\n\tvar o = new_buf(18);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0x7260);\n\to.write_shift(2, 0x44c0);\n\to.write_shift(2, 0x38);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 1);\n\to.write_shift(2, 0x01f4);\n\treturn o;\n}\n/* [MS-XLS] 2.4.346 TODO */\nfunction parse_Window2(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff < 5) return {};\n\tvar f = blob.read_shift(2);\n\treturn { RTL: f & 0x40 };\n}\nfunction write_Window2(view) {\n\tvar o = new_buf(18), f = 0x6b6;\n\tif(view && view.RTL) f |= 0x40;\n\to.write_shift(2, f);\n\to.write_shift(4, 0);\n\to.write_shift(4, 64);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.189 TODO */\nfunction parse_Pane(/*blob, length, opts*/) {\n}\n\n/* [MS-XLS] 2.4.122 TODO */\nfunction parse_Font(blob, length, opts) {\n\tvar o = {\n\t\tdyHeight: blob.read_shift(2),\n\t\tfl: blob.read_shift(2)\n\t};\n\tswitch((opts && opts.biff) || 8) {\n\t\tcase 2: break;\n\t\tcase 3: case 4: blob.l += 2; break;\n\t\tdefault: blob.l += 10; break;\n\t}\n\to.name = parse_ShortXLUnicodeString(blob, 0, opts);\n\treturn o;\n}\nfunction write_Font(data, opts) {\n\tvar name = data.name || \"Arial\";\n\tvar b5 = (opts && (opts.biff == 5)), w = (b5 ? (15 + name.length) : (16 + 2 * name.length));\n\tvar o = new_buf(w);\n\to.write_shift(2, (data.sz || 12) * 20);\n\to.write_shift(4, 0);\n\to.write_shift(2, 400);\n\to.write_shift(4, 0);\n\to.write_shift(2, 0);\n\to.write_shift(1, name.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * name.length, name, (b5 ? \"sbcs\" : \"utf16le\"));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.149 */\nfunction parse_LabelSst(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, length, opts);\n\tcell.isst = blob.read_shift(4);\n\treturn cell;\n}\nfunction write_LabelSst(R, C, v, os ) {\n\tvar o = new_buf(10);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(4, v);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.148 */\nfunction parse_Label(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar target = blob.l + length;\n\tvar cell = parse_XLSCell(blob, length, opts);\n\tvar str = parse_XLUnicodeString(blob, target - blob.l, opts);\n\tcell.val = str;\n\treturn cell;\n}\nfunction write_Label(R, C, v, os, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(6 + 2 + (+b8) + (1 + b8) * v.length);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(2, v.length);\n\tif(b8) o.write_shift(1, 1);\n\to.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\n\treturn o;\n}\n\n\n/* [MS-XLS] 2.4.126 Number Formats */\nfunction parse_Format(blob, length, opts) {\n\tvar numFmtId = blob.read_shift(2);\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [numFmtId, fmtstr];\n}\nfunction write_Format(i, f, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? (3 + f.length) : (5 + 2 * f.length));\n\to.write_shift(2, i);\n\to.write_shift((b5 ? 1 : 2), f.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * f.length, f, (b5 ? 'sbcs' : 'utf16le'));\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(out.l == null) out.l = out.length;\n\treturn out;\n}\nvar parse_BIFF2Format = parse_XLUnicodeString2;\nfunction write_BIFF2Format(f) {\n\tvar o = new_buf(1 + f.length);\n\to.write_shift(1, f.length);\n\to.write_shift(f.length, f, \"sbcs\");\n\treturn o;\n}\nfunction write_BIFF4Format(f) {\n\tvar o = new_buf(3 + f.length);\n\to.l += 2;\n\to.write_shift(1, f.length);\n\to.write_shift(f.length, f, \"sbcs\");\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.90 */\nfunction parse_Dimensions(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar r = blob.read_shift(w), R = blob.read_shift(w);\n\tvar c = blob.read_shift(2), C = blob.read_shift(2);\n\tblob.l = end;\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\n}\nfunction write_Dimensions(range, opts) {\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar o = new_buf(2*w + 6);\n\to.write_shift(w, range.s.r);\n\to.write_shift(w, range.e.r + 1);\n\to.write_shift(2, range.s.c);\n\to.write_shift(2, range.e.c + 1);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.220 */\nfunction parse_RK(blob) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrec = parse_RkRec(blob);\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\n}\n\n/* [MS-XLS] 2.4.175 */\nfunction parse_MulRk(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrecs = [];\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\n\tif(blob.l !== target) throw new Error(\"MulRK read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\n}\n/* [MS-XLS] 2.4.174 */\nfunction parse_MulBlank(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar ixfes = [];\n\twhile(blob.l < target) ixfes.push(blob.read_shift(2));\n\tif(blob.l !== target) throw new Error(\"MulBlank read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, ixfe:ixfes};\n}\n\n/* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\nfunction parse_CellStyleXF(blob, length, style, opts) {\n\tvar o = {};\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\n\to.patternType = XLSFillPattern[c >> 26];\n\n\tif(!opts.cellStyles) return o;\n\to.alc = a & 0x07;\n\to.fWrap = (a >> 3) & 0x01;\n\to.alcV = (a >> 4) & 0x07;\n\to.fJustLast = (a >> 7) & 0x01;\n\to.trot = (a >> 8) & 0xFF;\n\to.cIndent = (a >> 16) & 0x0F;\n\to.fShrinkToFit = (a >> 20) & 0x01;\n\to.iReadOrder = (a >> 22) & 0x02;\n\to.fAtrNum = (a >> 26) & 0x01;\n\to.fAtrFnt = (a >> 27) & 0x01;\n\to.fAtrAlc = (a >> 28) & 0x01;\n\to.fAtrBdr = (a >> 29) & 0x01;\n\to.fAtrPat = (a >> 30) & 0x01;\n\to.fAtrProt = (a >> 31) & 0x01;\n\n\to.dgLeft = b & 0x0F;\n\to.dgRight = (b >> 4) & 0x0F;\n\to.dgTop = (b >> 8) & 0x0F;\n\to.dgBottom = (b >> 12) & 0x0F;\n\to.icvLeft = (b >> 16) & 0x7F;\n\to.icvRight = (b >> 23) & 0x7F;\n\to.grbitDiag = (b >> 30) & 0x03;\n\n\to.icvTop = c & 0x7F;\n\to.icvBottom = (c >> 7) & 0x7F;\n\to.icvDiag = (c >> 14) & 0x7F;\n\to.dgDiag = (c >> 21) & 0x0F;\n\n\to.icvFore = d & 0x7F;\n\to.icvBack = (d >> 7) & 0x7F;\n\to.fsxButton = (d >> 14) & 0x01;\n\treturn o;\n}\n//function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n/* [MS-XLS] 2.4.353 TODO: actually do this right */\nfunction parse_XF(blob, length, opts) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(2); o.numFmtId = blob.read_shift(2); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\tlength -= 6;\n\to.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n\treturn o;\n}\nfunction write_XF(data, ixfeP, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? 16 : 20);\n\to.write_shift(2, 0);\n\tif(data.style) {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, 0xFFF4);\n\t} else {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, (ixfeP<<4));\n\t}\n\tvar f = 0;\n\tif(data.numFmtId > 0 && b5) f |= 0x0400;\n\to.write_shift(4, f);\n\to.write_shift(4, 0);\n\tif(!b5) o.write_shift(4, 0);\n\to.write_shift(2, 0);\n\treturn o;\n}\nfunction parse_BIFF2XF(blob) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(1); blob.l++; o.flags = blob.read_shift(1);\n\to.numFmtId = o.flags & 0x3F; o.flags>>=6;\n\to.fStyle = 0;\n\to.data = {}; // TODO\n\treturn o;\n}\nfunction write_BIFF2XF(xf) {\n\tvar o = new_buf(4);\n\to.l+=2;\n\to.write_shift(1, xf.numFmtId);\n\to.l++;\n\treturn o;\n}\nfunction write_BIFF3XF(xf) {\n\tvar o = new_buf(12);\n\to.l++;\n\to.write_shift(1, xf.numFmtId);\n\to.l += 10;\n\treturn o;\n}\n/* TODO: check other fields */\nvar write_BIFF4XF = write_BIFF3XF;\nfunction parse_BIFF3XF(blob) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(1); o.numFmtId = blob.read_shift(1); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\to.data = {}; // TODO\n\treturn o;\n}\nfunction parse_BIFF4XF(blob) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(1); o.numFmtId = blob.read_shift(1); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\to.data = {}; // TODO\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.134 */\nfunction parse_Guts(blob) {\n\tblob.l += 4;\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\n\tif(out[0] !== 0) out[0]--;\n\tif(out[1] !== 0) out[1]--;\n\tif(out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n\treturn out;\n}\nfunction write_Guts(guts) {\n\tvar o = new_buf(8);\n\to.write_shift(4, 0);\n\to.write_shift(2, guts[0] ? guts[0] + 1 : 0);\n\to.write_shift(2, guts[1] ? guts[1] + 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.24 */\nfunction parse_BoolErr(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\nfunction write_BoolErr(R, C, v, os, opts, t) {\n\tvar o = new_buf(8);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Bes(v, t, o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.180 Number */\nfunction parse_Number(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar xnum = parse_Xnum(blob, 8);\n\tcell.val = xnum;\n\treturn cell;\n}\nfunction write_Number(R, C, v, os) {\n\tvar o = new_buf(14);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Xnum(v, o);\n\treturn o;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* [MS-XLS] 2.4.271 */\nfunction parse_SupBook(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar ctab = blob.read_shift(2);\n\tvar cch = blob.read_shift(2);\n\topts.sbcch = cch;\n\tif(cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n\tif(cch < 0x01 || cch >0xff) throw new Error(\"Unexpected SupBook type: \"+cch);\n\tvar virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n\t/* TODO: 2.5.277 Virtual Path */\n\tvar rgst = [];\n\twhile(end > blob.l) rgst.push(parse_XLUnicodeString(blob));\n\treturn [cch, ctab, virtPath, rgst];\n}\n\n/* [MS-XLS] 2.4.105 TODO */\nfunction parse_ExternName(blob, length, opts) {\n\tvar flags = blob.read_shift(2);\n\tvar body;\n\tvar o = ({\n\t\tfBuiltIn: flags & 0x01,\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\n\t\tfWantPict: (flags >>> 2) & 0x01,\n\t\tfOle: (flags >>> 3) & 0x01,\n\t\tfOleLink: (flags >>> 4) & 0x01,\n\t\tcf: (flags >>> 5) & 0x3FF,\n\t\tfIcon: flags >>> 15 & 0x01\n\t});\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2, opts);\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\to.body = body || blob.read_shift(length-2);\n\tif(typeof body === \"string\") o.Name = body;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.150 TODO */\nfunction parse_Lbl(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar flags = blob.read_shift(2);\n\tvar chKey = blob.read_shift(1);\n\tvar cch = blob.read_shift(1);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar itab = 0;\n\tif(!opts || opts.biff >= 5) {\n\t\tif(opts.biff != 5) blob.l += 2;\n\t\titab = blob.read_shift(2);\n\t\tif(opts.biff == 5) blob.l += 2;\n\t\tblob.l += 4;\n\t}\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tif(flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n\tvar npflen = target - blob.l; if(opts && opts.biff == 2) --npflen;\n\t/*jshint -W018 */\n\tvar rgce = (target == blob.l || cce === 0 || !(npflen > 0)) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n\t/*jshint +W018 */\n\treturn {\n\t\tchKey: chKey,\n\t\tName: name,\n\t\titab: itab,\n\t\trgce: rgce\n\t};\n}\n\n/* [MS-XLS] 2.4.106 TODO: legacy record filename encoding */\nfunction parse_ExternSheet(blob, length, opts) {\n\tif(opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n\t/* see issue 2907 */\n\tif(!(opts.biff > 8) && (length == blob[blob.l] + (blob[blob.l+1] == 0x03 ? 1 : 0) + 1)) return parse_BIFF5ExternSheet(blob, length, opts);\n\tvar o = [], target = blob.l + length, len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n\twhile(len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\n\t\t// [iSupBook, itabFirst, itabLast];\n\tif(blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n\treturn o;\n}\nfunction parse_BIFF5ExternSheet(blob, length, opts) {\n\tif(blob[blob.l + 1] == 0x03) blob[blob.l]++;\n\tvar o = parse_ShortXLUnicodeString(blob, length, opts);\n\treturn o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n}\n\n/* [MS-XLS] 2.4.176 TODO: check older biff */\nfunction parse_NameCmt(blob, length, opts) {\n\tif(opts.biff < 8) { blob.l += length; return; }\n\tvar cchName = blob.read_shift(2);\n\tvar cchComment = blob.read_shift(2);\n\tvar name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n\tvar comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n\treturn [name, comment];\n}\n\n/* [MS-XLS] 2.4.260 */\nfunction parse_ShrFmla(blob, length, opts) {\n\tvar ref = parse_RefU(blob, 6);\n\tblob.l++;\n\tvar cUse = blob.read_shift(1);\n\tlength -= 8;\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n}\n\n/* [MS-XLS] 2.4.4 TODO */\nfunction parse_Array(blob, length, opts) {\n\tvar ref = parse_Ref(blob, 6);\n\t/* TODO: fAlwaysCalc */\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l ++; length -= 7; break;\n\t\tcase 3: case 4: blob.l += 2; length -= 8; break;\n\t\tdefault: blob.l += 6; length -= 12;\n\t}\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n\n/* [MS-XLS] 2.4.173 */\nfunction parse_MTRSettings(blob) {\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n\tvar cUserThreadCount = blob.read_shift(4);\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n\n/* [MS-XLS] 2.5.186 */\nfunction parse_NoteSh(blob, length, opts) {\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\n}\n\n/* [MS-XLS] 2.4.179 */\nfunction parse_Note(blob, length, opts) {\n\tif(opts && (opts.biff < 8)) {\n\t\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\t\tif(row == 0xFFFF || row == -1) return; // TODO: test continuation\n\t\tvar cch = blob.read_shift(2);\n\t\tvar cmnt = blob.read_shift(Math.min(cch,2048), 'cpstr');\n\t\treturn [{r:row, c:col}, cmnt];\n\t}\n\t/* TODO: Support revisions */\n\treturn parse_NoteSh(blob, length, opts);\n}\nfunction write_NOTE_BIFF2(text, R, C, len/*?:number*/) {\n\tvar o = new_buf(6 + (len || text.length));\n\to.write_shift(2, R);\n\to.write_shift(2, C);\n\to.write_shift(2, len || text.length);\n\to.write_shift(text.length, text, \"sbcs\");\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.168 */\nfunction parse_MergeCells(blob, length) {\n\tvar merges = [];\n\tvar cmcs = blob.read_shift(2);\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\n\treturn merges;\n}\nfunction write_MergeCells(merges) {\n\tvar o = new_buf(2 + merges.length * 8);\n\to.write_shift(2, merges.length);\n\tfor(var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.181 TODO: parse all the things! */\nfunction parse_Obj(blob, length, opts) {\n\tif(opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\n\treturn { cmo: cmo, ft:fts };\n}\n/* from older spec */\nvar parse_BIFF5OT = {\n0x08: function(blob, length) {\n\tvar tgt = blob.l + length;\n\tblob.l += 10; // todo\n\tvar cf = blob.read_shift(2);\n\tblob.l += 4;\n\tblob.l += 2; //var cbPictFmla = blob.read_shift(2);\n\tblob.l += 2;\n\tblob.l += 2; //var grbit = blob.read_shift(2);\n\tblob.l += 4;\n\tvar cchName = blob.read_shift(1);\n\tblob.l += cchName; // TODO: stName\n\tblob.l = tgt; // TODO: fmla\n\treturn { fmt:cf };\n}\n};\n\nfunction parse_BIFF5Obj(blob, length, opts) {\n\tblob.l += 4; //var cnt = blob.read_shift(4);\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar grbit = blob.read_shift(2);\n\tblob.l += 2; //var colL = blob.read_shift(2);\n\tblob.l += 2; //var dxL = blob.read_shift(2);\n\tblob.l += 2; //var rwT = blob.read_shift(2);\n\tblob.l += 2; //var dyT = blob.read_shift(2);\n\tblob.l += 2; //var colR = blob.read_shift(2);\n\tblob.l += 2; //var dxR = blob.read_shift(2);\n\tblob.l += 2; //var rwB = blob.read_shift(2);\n\tblob.l += 2; //var dyB = blob.read_shift(2);\n\tblob.l += 2; //var cbMacro = blob.read_shift(2);\n\tblob.l += 6;\n\tlength -= 36;\n\tvar fts = [];\n\tfts.push((parse_BIFF5OT[ot]||parsenoop)(blob, length, opts));\n\treturn { cmo: [id, ot, grbit], ft:fts };\n}\n\n/* [MS-XLS] 2.4.329 TODO: parse properly */\nfunction parse_TxO(blob, length, opts) {\n\tvar s = blob.l;\n\tvar texts = \"\";\ntry {\n\tblob.l += 4;\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\n\tvar controlInfo; // eslint-disable-line no-unused-vars\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\n\telse controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n\tvar cchText = blob.read_shift(2);\n\t/*var cbRuns = */blob.read_shift(2);\n\t/*var ifntEmpty = */parseuint16(blob, 2);\n\tvar len = blob.read_shift(2);\n\tblob.l += len;\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\n\t\tif(blob.l-s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n\t\tvar hdr = blob[blob.l];\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\n\t\ttexts += t;\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\n\t}\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\n\t\tthrow new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n\t}\n\n\tblob.l = s + length;\n\t/* [MS-XLS] 2.5.272 TxORuns */\n//\tvar rgTxoRuns = [];\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n//\tvar cchText2 = blob.read_shift(2);\n//\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n//\tblob.l += 6;\n//\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n\treturn { t: texts };\n} catch(e) { blob.l = s + length; return { t: texts }; }\n}\n\n/* [MS-XLS] 2.4.140 */\nfunction parse_HLink(blob, length) {\n\tvar ref = parse_Ref8U(blob, 8);\n\tblob.l += 16; /* CLSID */\n\tvar hlink = parse_Hyperlink(blob, length-24);\n\treturn [ref, hlink];\n}\nfunction write_HLink(hl) {\n\tvar O = new_buf(24);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tvar clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\tfor(var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\n\treturn bconcat([O, write_Hyperlink(hl[1])]);\n}\n\n\n/* [MS-XLS] 2.4.141 */\nfunction parse_HLinkTooltip(blob, length) {\n\tblob.read_shift(2);\n\tvar ref = parse_Ref8U(blob, 8);\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\n\twzTooltip = wzTooltip.replace(chr0,\"\");\n\treturn [ref, wzTooltip];\n}\nfunction write_HLinkTooltip(hl) {\n\tvar TT = hl[1].Tooltip;\n\tvar O = new_buf(10 + 2 * (TT.length + 1));\n\tO.write_shift(2, 0x0800);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tfor(var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\n\tO.write_shift(2, 0);\n\treturn O;\n}\n\n/* [MS-XLS] 2.4.63 */\nfunction parse_Country(blob) {\n\tvar o = [0,0], d;\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\n\treturn o;\n}\nfunction write_Country(o) {\n\tif(!o) o = new_buf(4);\n\to.write_shift(2, 0x01);\n\to.write_shift(2, 0x01);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.50 ClrtClient */\nfunction parse_ClrtClient(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.188 */\nfunction parse_Palette(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.354 */\nfunction parse_XFCRC(blob) {\n\tblob.l += 2;\n\tvar o = {cxfs:0, crc:0};\n\to.cxfs = blob.read_shift(2);\n\to.crc = blob.read_shift(4);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.53 TODO: parse flags */\n/* [MS-XLSB] 2.4.323 TODO: parse flags */\nfunction parse_ColInfo(blob, length, opts) {\n\tif(!opts.cellStyles) return parsenoop(blob, length);\n\tvar w = opts && opts.biff >= 12 ? 4 : 2;\n\tvar colFirst = blob.read_shift(w);\n\tvar colLast = blob.read_shift(w);\n\tvar coldx = blob.read_shift(w);\n\tvar ixfe = blob.read_shift(w);\n\tvar flags = blob.read_shift(2);\n\tif(w == 2) blob.l += 2;\n\tvar o = ({s:colFirst, e:colLast, w:coldx, ixfe:ixfe, flags:flags});\n\tif(opts.biff >= 5 || !opts.biff) o.level = (flags >> 8) & 0x7;\n\treturn o;\n}\nfunction write_ColInfo(col, idx) {\n\tvar o = new_buf(12);\n\to.write_shift(2, idx);\n\to.write_shift(2, idx);\n\to.write_shift(2, col.width * 256);\n\to.write_shift(2, 0);\n\tvar f = 0;\n\tif(col.hidden) f |= 1;\n\to.write_shift(1, f);\n\tf = col.level || 0;\n\to.write_shift(1, f);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.257 */\nfunction parse_Setup(blob, length) {\n\tvar o = {};\n\tif(length < 32) return o;\n\tblob.l += 16;\n\to.header = parse_Xnum(blob, 8);\n\to.footer = parse_Xnum(blob, 8);\n\tblob.l += 2;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.261 */\nfunction parse_ShtProps(blob, length, opts) {\n\tvar def = {area:false};\n\tif(opts.biff != 5) { blob.l += length; return def; }\n\tvar d = blob.read_shift(1); blob.l += 3;\n\tif((d & 0x10)) def.area = true;\n\treturn def;\n}\n\n/* [MS-XLS] 2.4.241 */\nfunction write_RRTabId(n) {\n\tvar out = new_buf(2 * n);\n\tfor(var i = 0; i < n; ++i) out.write_shift(2, i+1);\n\treturn out;\n}\n\nvar parse_Blank = parse_XLSCell; /* [MS-XLS] 2.4.20 Just the cell */\nvar parse_Scl = parseuint16a; /* [MS-XLS] 2.4.247 num, den */\nvar parse_String = parse_XLUnicodeString; /* [MS-XLS] 2.4.268 */\n\n/* --- Specific to versions before BIFF8 --- */\nfunction parse_ImData(blob) {\n\tvar cf = blob.read_shift(2);\n\tvar env = blob.read_shift(2);\n\tvar lcb = blob.read_shift(4);\n\tvar o = {fmt:cf, env:env, len:lcb, data:blob.slice(blob.l,blob.l+lcb)};\n\tblob.l += lcb;\n\treturn o;\n}\n\nfunction write_BIFF2Cell(out, r, c, ixfe, ifmt) {\n\tif(!out) out = new_buf(7);\n\tout.write_shift(2, r);\n\tout.write_shift(2, c);\n\tout.write_shift(1, ixfe||0/* & 0x3F */);\n\tout.write_shift(1, ifmt||0/* & 0x3F */);\n\tout.write_shift(1, 0);\n\treturn out;\n}\n\n/* BIFF2_??? where ??? is the name from [XLS] */\nfunction parse_BIFF2STR(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 5) opts.biff = 2;\n\tvar cell = parse_XLSCell(blob, 7, opts);\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF2NUM(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 7, opts);\n\tvar num = parse_Xnum(blob, 8);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2NUM(r, c, val, ixfe, ifmt) {\n\tvar out = new_buf(15);\n\twrite_BIFF2Cell(out, r, c, ixfe||0, ifmt||0);\n\tout.write_shift(8, val, 'f');\n\treturn out;\n}\n\nfunction parse_BIFF2INT(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 7, opts);\n\tvar num = blob.read_shift(2);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2INT(r, c, val, ixfe, ifmt) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c, ixfe||0, ifmt||0);\n\tout.write_shift(2, val);\n\treturn out;\n}\n\nfunction parse_BIFF2STRING(blob) {\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\nfunction parse_BIFF2BOOLERR(blob, length, opts) {\n\tvar bestart = blob.l + 7;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tblob.l = bestart;\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\n\n/* TODO: convert to BIFF8 font struct */\nfunction parse_BIFF2FONTXTRA(blob, length) {\n\tblob.l += 6; // unknown\n\tblob.l += 2; // font weight \"bls\"\n\tblob.l += 1; // charset\n\tblob.l += 3; // unknown\n\tblob.l += 1; // font family\n\tblob.l += length - 13;\n}\n\n/* TODO: parse rich text runs */\nfunction parse_RString(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar cch = blob.read_shift(2);\n\tvar str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tblob.l = end;\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF4SheetInfo(blob) {\n\tvar flags = blob.read_shift(4);\n\tvar cch = blob.read_shift(1), name = blob.read_shift(cch, \"sbcs\");\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { flags: flags, name:name };\n}var DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\nvar DBF = (function() {\nvar dbf_codepage_map = {\n\t/* Code Pages Supported by Visual FoxPro */\n0x01:   437,           0x02:   850,\n0x03:  1252,           0x04: 10000,\n0x64:   852,           0x65:   866,\n0x66:   865,           0x67:   861,\n0x68:   895,           0x69:   620,\n0x6A:   737,           0x6B:   857,\n0x78:   950,           0x79:   949,\n0x7A:   936,           0x7B:   932,\n0x7C:   874,           0x7D:  1255,\n0x7E:  1256,           0x96: 10007,\n0x97: 10029,           0x98: 10006,\n0xC8:  1250,           0xC9:  1251,\n0xCA:  1254,           0xCB:  1253,\n\n\t/* shapefile DBF extension */\n0x00: 20127,           0x08:   865,\n0x09:   437,           0x0A:   850,\n0x0B:   437,           0x0D:   437,\n0x0E:   850,           0x0F:   437,\n0x10:   850,           0x11:   437,\n0x12:   850,           0x13:   932,\n0x14:   850,           0x15:   437,\n0x16:   850,           0x17:   865,\n0x18:   437,           0x19:   437,\n0x1A:   850,           0x1B:   437,\n0x1C:   863,           0x1D:   850,\n0x1F:   852,           0x22:   852,\n0x23:   852,           0x24:   860,\n0x25:   850,           0x26:   866,\n0x37:   850,           0x40:   852,\n0x4D:   936,           0x4E:   949,\n0x4F:   950,           0x50:   874,\n0x57:  1252,           0x58:  1252,\n0x59:  1252,           0x6C:   863,\n0x86:   737,           0x87:   852,\n0x88:   857,           0xCC:  1257,\n\n0xFF: 16969\n};\nvar dbf_reverse_map = evert({\n0x01:   437,           0x02:   850,\n0x03:  1252,           0x04: 10000,\n0x64:   852,           0x65:   866,\n0x66:   865,           0x67:   861,\n0x68:   895,           0x69:   620,\n0x6A:   737,           0x6B:   857,\n0x78:   950,           0x79:   949,\n0x7A:   936,           0x7B:   932,\n0x7C:   874,           0x7D:  1255,\n0x7E:  1256,           0x96: 10007,\n0x97: 10029,           0x98: 10006,\n0xC8:  1250,           0xC9:  1251,\n0xCA:  1254,           0xCB:  1253,\n0x00: 20127\n});\n/* TODO: find an actual specification */\nfunction dbf_to_aoa(buf, opts) {\n\tvar out = [];\n\tvar d = (new_raw_buf(1));\n\tswitch(opts.type) {\n\t\tcase 'base64': d = s2a(Base64_decode(buf)); break;\n\t\tcase 'binary': d = s2a(buf); break;\n\t\tcase 'buffer':\n\t\tcase 'array': d = buf; break;\n\t}\n\tprep_blob(d, 0);\n\n\t/* header */\n\tvar ft = d.read_shift(1);\n\tvar memo = !!(ft & 0x88);\n\tvar vfp = false, l7 = false;\n\tswitch(ft) {\n\t\tcase 0x02: break; // dBASE II\n\t\tcase 0x03: break; // dBASE III\n\t\tcase 0x30: vfp = true; memo = true; break; // VFP\n\t\tcase 0x31: vfp = true; memo = true; break; // VFP with autoincrement\n\t\t// 0x43 dBASE IV SQL table files\n\t\t// 0x63 dBASE IV SQL system files\n\t\tcase 0x83: break; // dBASE III with memo\n\t\tcase 0x8B: break; // dBASE IV with memo\n\t\tcase 0x8C: l7 = true; break; // dBASE Level 7 with memo\n\t\t// case 0xCB dBASE IV SQL table files with memo\n\t\tcase 0xF5: break; // FoxPro 2.x with memo\n\t\t// case 0xFB FoxBASE\n\t\tdefault: throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n\t}\n\n\tvar nrow = 0, fpos = 0x0209;\n\tif(ft == 0x02) nrow = d.read_shift(2);\n\td.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n\tif(ft != 0x02) nrow = d.read_shift(4);\n\tif(nrow > 1048576) nrow = 1e6;\n\n\tif(ft != 0x02) fpos = d.read_shift(2); // header length\n\tvar rlen = d.read_shift(2); // record length\n\n\tvar /*flags = 0,*/ current_cp = opts.codepage || 1252;\n\tif(ft != 0x02) { // 20 reserved bytes\n\t\td.l+=16;\n\t\t/*flags = */d.read_shift(1);\n\t\t//if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n\t\t/* codepage present in FoxPro and dBASE Level 7 */\n\t\tif(d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n\t\td.l+=1;\n\n\t\td.l+=2;\n\t}\n\tif(l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\nvar fields = [], field = ({});\n\tvar hend = Math.min(d.length, (ft == 0x02 ? 0x209 : (fpos - 10 - (vfp ? 264 : 0))));\n\tvar ww = l7 ? 32 : 11;\n\twhile(d.l < hend && d[d.l] != 0x0d) {\n\t\tfield = ({});\n\t\tfield.name = (typeof $cptable !== \"undefined\" ? $cptable.utils.decode(current_cp, d.slice(d.l, d.l+ww)) : a2s(d.slice(d.l, d.l + ww))).replace(/[\\u0000\\r\\n].*$/g,\"\");\n\t\td.l += ww;\n\t\tfield.type = String.fromCharCode(d.read_shift(1));\n\t\tif(ft != 0x02 && !l7) field.offset = d.read_shift(4);\n\t\tfield.len = d.read_shift(1);\n\t\tif(ft == 0x02) field.offset = d.read_shift(2);\n\t\tfield.dec = d.read_shift(1);\n\t\tif(field.name.length) fields.push(field);\n\t\tif(ft != 0x02) d.l += l7 ? 13 : 14;\n\t\tswitch(field.type) {\n\t\t\tcase 'B': // Double (VFP) / Binary (dBASE L7)\n\t\t\t\tif((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase 'G': // General (FoxPro and dBASE L7)\n\t\t\tcase 'P': // Picture (FoxPro and dBASE L7)\n\t\t\t\tif(opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase '+': // Autoincrement (dBASE L7 only)\n\t\t\tcase '0': // _NullFlags (VFP only)\n\t\t\tcase '@': // Timestamp (dBASE L7 only)\n\t\t\tcase 'C': // Character (dBASE II)\n\t\t\tcase 'D': // Date (dBASE III)\n\t\t\tcase 'F': // Float (dBASE IV)\n\t\t\tcase 'I': // Long (VFP and dBASE L7)\n\t\t\tcase 'L': // Logical (dBASE II)\n\t\t\tcase 'M': // Memo (dBASE III)\n\t\t\tcase 'N': // Number (dBASE II)\n\t\t\tcase 'O': // Double (dBASE L7 only)\n\t\t\tcase 'T': // Datetime (VFP only)\n\t\t\tcase 'Y': // Currency (VFP only)\n\t\t\t\tbreak;\n\t\t\tdefault: throw new Error('Unknown Field Type: ' + field.type);\n\t\t}\n\t}\n\n\tif(d[d.l] !== 0x0D) d.l = fpos-1;\n\tif(d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n\td.l = fpos;\n\n\t/* data */\n\tvar R = 0, C = 0;\n\tout[0] = [];\n\tfor(C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\n\twhile(nrow-- > 0) {\n\t\tif(d[d.l] === 0x2A) {\n\t\t\t// TODO: record marked as deleted -- create a hidden row?\n\t\t\td.l+=rlen;\n\t\t\tcontinue;\n\t\t}\n\t\t++d.l;\n\t\tout[++R] = []; C = 0;\n\t\tfor(C = 0; C != fields.length; ++C) {\n\t\t\tvar dd = d.slice(d.l, d.l+fields[C].len); d.l+=fields[C].len;\n\t\t\tprep_blob(dd, 0);\n\t\t\tvar s = typeof $cptable !== \"undefined\" ? $cptable.utils.decode(current_cp, dd) : a2s(dd);\n\t\t\tswitch(fields[C].type) {\n\t\t\t\tcase 'C':\n\t\t\t\t\t// NOTE: it is conventional to write '  /  /  ' for empty dates\n\t\t\t\t\tif(s.trim().length) out[R][C] = s.replace(/\\s+$/,\"\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(s.length === 8) {\n\t\t\t\t\t\tout[R][C] = new Date(Date.UTC(+s.slice(0,4), +s.slice(4,6)-1, +s.slice(6,8), 0, 0, 0, 0));\n\t\t\t\t\t\tif(!(opts && opts.UTC)) { out[R][C] = utc_to_local(out[R][C]); }\n\t\t\t\t\t}\n\t\t\t\t\telse out[R][C] = s;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'F': out[R][C] = parseFloat(s.trim()); break;\n\t\t\t\tcase '+': case 'I': out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i'); break;\n\t\t\t\tcase 'L': switch(s.trim().toUpperCase()) {\n\t\t\t\t\tcase 'Y': case 'T': out[R][C] = true; break;\n\t\t\t\t\tcase 'N': case 'F': out[R][C] = false; break;\n\t\t\t\t\tcase '': case '?': break;\n\t\t\t\t\tdefault: throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'M': /* TODO: handle memo files */\n\t\t\t\t\tif(!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n\t\t\t\t\tout[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10): dd.read_shift(4));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'N':\n\t\t\t\t\ts = s.replace(/\\u0000/g,\"\").trim();\n\t\t\t\t\t// NOTE: dBASE II interprets \"  .  \" as 0\n\t\t\t\t\tif(s && s != \".\") out[R][C] = +s || 0; break;\n\t\t\t\tcase '@':\n\t\t\t\t\t// NOTE: dBASE specs appear to be incorrect\n\t\t\t\t\tout[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'T': {\n\t\t\t\t\tvar hi = dd.read_shift(4), lo = dd.read_shift(4);\n\t\t\t\t\tif(hi == 0 && lo == 0) break;\n\t\t\t\t\tout[R][C] = new Date((hi - 0x253D8C) * 0x5265C00 + lo);\n\t\t\t\t\tif(!(opts && opts.UTC)) out[R][C] = utc_to_local(out[R][C]);\n\t\t\t\t} break;\n\t\t\t\tcase 'Y': out[R][C] = dd.read_shift(4,'i')/1e4 + (dd.read_shift(4, 'i')/1e4)*Math.pow(2,32); break;\n\t\t\t\tcase 'O': out[R][C] = -dd.read_shift(-8, 'f'); break;\n\t\t\t\tcase 'B': if(vfp && fields[C].len == 8) { out[R][C] = dd.read_shift(8,'f'); break; }\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'G': case 'P': dd.l += fields[C].len; break;\n\t\t\t\tcase '0':\n\t\t\t\t\tif(fields[C].name === '_NullFlags') break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault: throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n\t\t\t}\n\t\t}\n\t}\n\tif(ft != 0x02) if(d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l-1) + \" of \" + d.length + \" \" + d[d.l-1].toString(16));\n\tif(opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n\topts.DBF = fields;\n\treturn out;\n}\n\nfunction dbf_to_sheet(buf, opts) {\n\tvar o = opts || {};\n\tif(!o.dateNF) o.dateNF = \"yyyymmdd\";\n\tvar ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n\tws[\"!cols\"] = o.DBF.map(function(field) { return {\n\t\twch: field.len,\n\t\tDBF: field\n\t};});\n\tdelete o.DBF;\n\treturn ws;\n}\n\nfunction dbf_to_workbook(buf, opts) {\n\ttry {\n\t\tvar o = sheet_to_workbook(dbf_to_sheet(buf, opts), opts);\n\t\to.bookType = \"dbf\";\n\t\treturn o;\n\t} catch(e) { if(opts && opts.WTF) throw e; }\n\treturn ({SheetNames:[],Sheets:{}});\n}\n\nvar _RLEN = { 'B': 8, 'C': 250, 'L': 1, 'D': 8, '?': 0, '': 0 };\nfunction sheet_to_dbf(ws, opts) {\n\tvar o = opts || {};\n\tvar old_cp = current_codepage;\n\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\tif(o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n\tvar ba = buf_array();\n\tvar aoa = sheet_to_json(ws, {header:1, raw:true, cellDates:true});\n\tvar headers = aoa[0], data = aoa.slice(1), cols = ws[\"!cols\"] || [];\n\tvar i = 0, j = 0, hcnt = 0, rlen = 1;\n\tfor(i = 0; i < headers.length; ++i) {\n\t\tif(((cols[i]||{}).DBF||{}).name) { headers[i] = cols[i].DBF.name; ++hcnt; continue; }\n\t\tif(headers[i] == null) continue;\n\t\t++hcnt;\n\t\tif(typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n\t\tif(typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + (typeof headers[i]) + \"|\");\n\t\tif(headers.indexOf(headers[i]) !== i) for(j=0; j<1024;++j)\n\t\t\tif(headers.indexOf(headers[i] + \"_\" + j) == -1) { headers[i] += \"_\" + j; break; }\n\t}\n\tvar range = safe_decode_range(ws['!ref']);\n\tvar coltypes = [];\n\tvar colwidths = [];\n\tvar coldecimals = [];\n\tfor(i = 0; i <= range.e.c - range.s.c; ++i) {\n\t\tvar guess = '', _guess = '', maxlen = 0;\n\t\tvar col = [];\n\t\tfor(j=0; j < data.length; ++j) {\n\t\t\tif(data[j][i] != null) col.push(data[j][i]);\n\t\t}\n\t\tif(col.length == 0 || headers[i] == null) { coltypes[i] = '?'; continue; }\n\t\tfor(j = 0; j < col.length; ++j) {\n\t\t\tswitch(typeof col[j]) {\n\t\t\t\t/* TODO: check if L2 compat is desired */\n\t\t\t\tcase 'number': _guess = 'B'; break;\n\t\t\t\tcase 'string': _guess = 'C'; break;\n\t\t\t\tcase 'boolean': _guess = 'L'; break;\n\t\t\t\tcase 'object': _guess = col[j] instanceof Date ? 'D' : 'C'; break;\n\t\t\t\tdefault: _guess = 'C';\n\t\t\t}\n\t\t\t/* TODO: cache the values instead of encoding twice */\n\t\t\tmaxlen = Math.max(maxlen, (typeof $cptable !== \"undefined\" && typeof col[j] == \"string\" ? $cptable.utils.encode(current_ansi, col[j]): String(col[j])).length);\n\t\t\tguess = guess && guess != _guess ? 'C' : _guess;\n\t\t\t//if(guess == 'C') break;\n\t\t}\n\t\tif(maxlen > 250) maxlen = 250;\n\t\t_guess = ((cols[i]||{}).DBF||{}).type;\n\t\t/* TODO: more fine grained control over DBF type resolution */\n\t\tif(_guess == 'C') {\n\t\t\tif(cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n\t\t}\n\t\tif(guess == 'B' && _guess == 'N') {\n\t\t\tguess = 'N';\n\t\t\tcoldecimals[i] = cols[i].DBF.dec;\n\t\t\tmaxlen = cols[i].DBF.len;\n\t\t}\n\t\tcolwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : (_RLEN[guess] || 0);\n\t\trlen += colwidths[i];\n\t\tcoltypes[i] = guess;\n\t}\n\n\tvar h = ba.next(32);\n\th.write_shift(4, 0x13021130);\n\th.write_shift(4, data.length);\n\th.write_shift(2, 296 + 32 * hcnt);\n\th.write_shift(2, rlen);\n\tfor(i=0; i < 4; ++i) h.write_shift(4, 0);\n\tvar cp = +dbf_reverse_map[current_codepage] || 0x03;\n\th.write_shift(4, 0x00000000 | (cp<<8));\n\tif(dbf_codepage_map[cp] != +o.codepage) {\n\t\tif(o.codepage) console.error(\"DBF Unsupported codepage \" + current_codepage + \", using 1252\");\n\t\tcurrent_codepage = 1252;\n\t}\n\n\tfor(i = 0, j = 0; i < headers.length; ++i) {\n\t\tif(headers[i] == null) continue;\n\t\tvar hf = ba.next(32);\n\t\t/* TODO: test how applications handle non-ASCII field names */\n\t\tvar _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n\t\thf.write_shift(1, _f, \"sbcs\");\n\t\thf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n\t\thf.write_shift(4, j);\n\t\thf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t\thf.write_shift(1, coldecimals[i] || 0);\n\t\thf.write_shift(1, 0x02);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(1, 0);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(4, 0);\n\t\tj += (colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t}\n\n\tvar hb = ba.next(264);\n\thb.write_shift(4, 0x0000000D);\n\tfor(i=0; i < 65;++i) hb.write_shift(4, 0x00000000);\n\tfor(i=0; i < data.length; ++i) {\n\t\tvar rout = ba.next(rlen);\n\t\trout.write_shift(1, 0);\n\t\tfor(j=0; j<headers.length; ++j) {\n\t\t\tif(headers[j] == null) continue;\n\t\t\tswitch(coltypes[j]) {\n\t\t\t\tcase 'L': rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46); break;\n\t\t\t\tcase 'B': rout.write_shift(8, data[i][j]||0, 'f'); break;\n\t\t\t\tcase 'N':\n\t\t\t\t\tvar _n = \"0\";\n\t\t\t\t\tif(typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j]||0);\n\t\t\t\t\tif(_n.length > colwidths[j]) _n = _n.slice(0, colwidths[j]); // addresses decimal > width\n\t\t\t\t\tfor(hcnt=0; hcnt < colwidths[j]-_n.length; ++hcnt) rout.write_shift(1, 0x20);\n\t\t\t\t\trout.write_shift(1, _n, \"sbcs\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");\n\t\t\t\t\telse {\n\t\t\t\t\t\trout.write_shift(4, (\"0000\"+data[i][j].getFullYear()).slice(-4), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+(data[i][j].getMonth()+1)).slice(-2), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+data[i][j].getDate()).slice(-2), \"sbcs\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C':\n\t\t\t\t\tvar _l = rout.l;\n\t\t\t\t\tvar _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n\t\t\t\t\trout.write_shift(1, _s, \"cpstr\");\n\t\t\t\t\t_l += colwidths[j] - rout.l;\n\t\t\t\t\tfor(hcnt=0; hcnt < _l; ++hcnt) rout.write_shift(1, 0x20); break;\n\t\t\t}\n\t\t}\n\t\t// data\n\t}\n\tcurrent_codepage = old_cp;\n\tba.next(1).write_shift(1, 0x1A);\n\treturn ba.end();\n}\n\treturn {\n\t\tto_workbook: dbf_to_workbook,\n\t\tto_sheet: dbf_to_sheet,\n\t\tfrom_sheet: sheet_to_dbf\n\t};\n})();\n\nvar SYLK = (function() {\n\t/* TODO: stress test sequences */\n\tvar sylk_escapes = ({\n\t\tAA:'', BA:'', CA:'', DA:195, HA:'', JA:197,\n\t\tAE:'', BE:'', CE:'',         HE:'',\n\t\tAI:'', BI:'', CI:'',         HI:'',\n\t\tAO:'', BO:'', CO:'', DO:213, HO:'',\n\t\tAU:'', BU:'', CU:'',         HU:'',\n\t\tAa:'', Ba:'', Ca:'', Da:227, Ha:'', Ja:229,\n\t\tAe:'', Be:'', Ce:'',         He:'',\n\t\tAi:'', Bi:'', Ci:'',         Hi:'',\n\t\tAo:'', Bo:'', Co:'', Do:245, Ho:'',\n\t\tAu:'', Bu:'', Cu:'',         Hu:'',\n\t\tKC:'', Kc:'', q:'',  z:'',  a:'',  j:'',\n\t\tDN:209, Dn:241, Hy:255,\n\t\tS:169,  c:170,  R:174,  \"B \":180,\n0:176,    1:177,  2:178,\n3:179,    5:181,  6:182,\n7:183,    Q:185,  k:186,  b:208,  i:216,  l:222,  s:240,  y:248,\n\t\t\"!\":161, '\"':162, \"#\":163, \"(\":164, \"%\":165, \"'\":167, \"H \":168,\n\t\t\"+\":171, \";\":187, \"<\":188, \"=\":189, \">\":190, \"?\":191, \"{\":223\n\t});\n\tvar sylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g,\"\\\\$1\") + \"|\\\\|)\", \"gm\");\n\tvar sylk_char_fn = function(_, $1){ var o = sylk_escapes[$1]; return typeof o == \"number\" ? _getansi(o) : o; };\n\tvar decode_sylk_char = function($$, $1, $2) { var newcc = (($1.charCodeAt(0) - 0x20)<<4) | ($2.charCodeAt(0) - 0x30); return newcc == 59 ? $$ : _getansi(newcc); };\n\tsylk_escapes[\"|\"] = 254;\n\t/* TODO: evert the escape map */\n\tvar encode_sylk_str = function($$) { return $$.replace(/\\n/g, \"\\x1b :\").replace(/\\r/g, \"\\x1b =\"); };\n\t/* https://oss.sheetjs.com/notes/sylk/ for more details */\n\tfunction sylk_to_aoa(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return sylk_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return sylk_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return sylk_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction sylk_to_aoa_str(str, opts) {\n\t\tvar records = str.split(/[\\n\\r]+/), R = -1, C = -1, ri = 0, rj = 0, arr = [];\n\t\tvar formats = [];\n\t\tvar next_cell_format = null;\n\t\tvar sht = {}, rowinfo = [], colinfo = [], cw = [];\n\t\tvar Mval = 0, j;\n\t\tvar wb = { Workbook: { WBProps: {}, Names: [] } };\n\t\tif(+opts.codepage >= 0) set_cp(+opts.codepage);\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tMval = 0;\n\t\t\tvar rstr=records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n\t\t\tvar record=rstr.replace(/;;/g, \"\\u0000\").split(\";\").map(function(x) { return x.replace(/\\u0000/g, \";\"); });\n\t\t\tvar RT=record[0], val;\n\t\t\tif(rstr.length > 0) switch(RT) {\n\t\t\tcase 'ID': break; /* header */\n\t\t\tcase 'E': break; /* EOF */\n\t\t\tcase 'B': break; /* dimensions */\n\t\t\tcase 'O': /* workbook options */\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'V': {\n\t\t\t\t\tvar d1904 = parseInt(record[rj].slice(1), 10);\n\t\t\t\t\t// NOTE: it is technically an error if d1904 >= 5 or < 0\n\t\t\t\t\tif(d1904 >= 1 && d1904 <= 4) wb.Workbook.WBProps.date1904 = true;\n\t\t\t\t} break;\n\t\t\t} break;\n\t\t\tcase 'W': break; /* window */\n\t\t\tcase 'P':\n\t\t\t\tswitch(record[1].charAt(0)){\n\t\t\t\t\tcase 'P': formats.push(rstr.slice(3).replace(/;;/g, \";\")); break;\n\t\t\t\t} break;\n\t\t\tcase 'NN': { /* defined name */\n\t\t\t\tvar nn = {Sheet: 0};\n\t\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\t\tcase 'N': nn.Name = record[rj].slice(1); break;\n\t\t\t\t\tcase 'E': nn.Ref = (opts && opts.sheet || \"Sheet1\") + \"!\" + rc_to_a1(record[rj].slice(1)); break;\n\t\t\t\t}\n\t\t\t\twb.Workbook.Names.push(nn);\n\t\t\t} break;\n\t\t\t// case 'NE': // ??\n\t\t\t// case 'NU': // ??\n\t\t\tcase 'C': /* cell */\n\t\t\tvar C_seen_K = false, C_seen_X = false, C_seen_S = false, C_seen_E = false, _R = -1, _C = -1, formula = \"\", cell_t = \"z\";\n\t\t\tvar cmnt = \"\";\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'A': cmnt = record[rj].slice(1); break; // TODO: comment\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1), 10)-1; C_seen_X = true; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1), 10)-1; if(!C_seen_X) C = 0;\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'K':\n\t\t\t\t\tval = record[rj].slice(1);\n\t\t\t\t\tif(val.charAt(0) === '\"') { val = val.slice(1,val.length - 1); cell_t = \"s\"; }\n\t\t\t\t\telse if(val === 'TRUE' || val === 'FALSE') { val = val === 'TRUE'; cell_t = \"b\"; }\n\t\t\t\t\telse if(!isNaN(fuzzynum(val))) {\n\t\t\t\t\t\tval = fuzzynum(val); cell_t = \"n\";\n\t\t\t\t\t\tif(next_cell_format !== null && fmt_is_date(next_cell_format) && opts.cellDates) {\n\t\t\t\t\t\t\tval = numdate(wb.Workbook.WBProps.date1904 ? val + 1462 : val); cell_t = typeof val == \"number\" ? \"n\" : \"d\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof $cptable !== 'undefined' && typeof val == \"string\" && ((opts||{}).type != \"string\") && (opts||{}).codepage) val = $cptable.utils.decode(opts.codepage, val);\n\t\t\t\t\tC_seen_K = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\t\tC_seen_E = true;\n\t\t\t\t\tformula = rc_to_a1(record[rj].slice(1), {r:R,c:C});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S':\n\t\t\t\t\tC_seen_S = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'G': break; // unknown\n\t\t\t\tcase 'R': _R = parseInt(record[rj].slice(1), 10)-1; break;\n\t\t\t\tcase 'C': _C = parseInt(record[rj].slice(1), 10)-1; break;\n\t\t\t\t// case 'P': // ??\n\t\t\t\t// case 'D': // ??\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(C_seen_K) {\n\t\t\t\tif(!arr[R][C]) arr[R][C] = { t: cell_t, v: val };\n\t\t\t\telse { arr[R][C].t = cell_t; arr[R][C].v = val; }\n\t\t\t\tif(next_cell_format) arr[R][C].z = next_cell_format;\n\t\t\t\tif(opts.cellText !== false && next_cell_format) arr[R][C].w = SSF_format(arr[R][C].z, arr[R][C].v, { date1904: wb.Workbook.WBProps.date1904 });\n\t\t\t\tnext_cell_format = null;\n\t\t\t}\n\t\t\tif(C_seen_S) {\n\t\t\t\tif(C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n\t\t\t\tvar shrbase = _R > -1 && arr[_R][_C];\n\t\t\t\tif(!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n\t\t\t\tformula = shift_formula_str(shrbase[1], {r: R - _R, c: C - _C});\n\t\t\t}\n\t\t\tif(formula) {\n\t\t\t\tif(!arr[R][C]) arr[R][C] = { t: 'n', f: formula };\n\t\t\t\telse arr[R][C].f = formula;\n\t\t\t}\n\t\t\tif(cmnt) {\n\t\t\t\tif(!arr[R][C]) arr[R][C] = { t: 'z' };\n\t\t\t\tarr[R][C].c = [{a:\"SheetJSYLK\", t: cmnt}];\n\t\t\t}\n\t\t\tbreak;\n\t\t\tcase 'F': /* Format */\n\t\t\tvar F_seen = 0;\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1), 10)-1; ++F_seen; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1), 10)-1; /*C = 0;*/\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M': Mval = parseInt(record[rj].slice(1), 10) / 20; break;\n\t\t\t\tcase 'F': break; /* ??? */\n\t\t\t\tcase 'G': break; /* hide grid */\n\t\t\t\tcase 'P':\n\t\t\t\t\tnext_cell_format = formats[parseInt(record[rj].slice(1), 10)];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S': break; /* cell style */\n\t\t\t\tcase 'D': break; /* column */\n\t\t\t\tcase 'N': break; /* font */\n\t\t\t\tcase 'W':\n\t\t\t\t\tcw = record[rj].slice(1).split(\" \");\n\t\t\t\t\tfor(j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n\t\t\t\t\t\tMval = parseInt(cw[2], 10);\n\t\t\t\t\t\tcolinfo[j-1] = Mval === 0 ? {hidden:true}: {wch:Mval};\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C': /* default column format */\n\t\t\t\t\tC = parseInt(record[rj].slice(1), 10)-1;\n\t\t\t\t\tif(!colinfo[C]) colinfo[C] = {};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'R': /* row properties */\n\t\t\t\t\tR = parseInt(record[rj].slice(1), 10)-1;\n\t\t\t\t\tif(!rowinfo[R]) rowinfo[R] = {};\n\t\t\t\t\tif(Mval > 0) { rowinfo[R].hpt = Mval; rowinfo[R].hpx = pt2px(Mval); }\n\t\t\t\t\telse if(Mval === 0) rowinfo[R].hidden = true;\n\t\t\t\t\tbreak;\n\t\t\t\t// case 'K': // ??\n\t\t\t\t// case 'E': // ??\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(F_seen < 1) next_cell_format = null; break;\n\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t}\n\t\tif(rowinfo.length > 0) sht['!rows'] = rowinfo;\n\t\tif(colinfo.length > 0) sht['!cols'] = colinfo;\n\t\tcolinfo.forEach(function(col) { process_col(col); });\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn [arr, sht, wb];\n\t}\n\n\tfunction sylk_to_workbook(d, opts) {\n\t\tvar aoasht = sylk_to_aoa(d, opts);\n\t\tvar aoa = aoasht[0], ws = aoasht[1], wb = aoasht[2];\n\t\tvar _opts = dup(opts); _opts.date1904 = (((wb||{}).Workbook || {}).WBProps || {}).date1904;\n\t\tvar o = aoa_to_sheet(aoa, _opts);\n\t\tkeys(ws).forEach(function(k) { o[k] = ws[k]; });\n\t\tvar outwb = sheet_to_workbook(o, opts);\n\t\tkeys(wb).forEach(function(k) { outwb[k] = wb[k]; });\n\t\toutwb.bookType = \"sylk\";\n\t\treturn outwb;\n\t}\n\n\tfunction write_ws_cell_sylk(cell, ws, R, C, opts, date1904) {\n\t\tvar o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";K\";\n\t\tswitch(cell.t) {\n\t\t\tcase 'n':\n\t\t\t\to += (cell.v||0);\n\t\t\t\tif(cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {r:R, c:C}); break;\n\t\t\tcase 'b': o += cell.v ? \"TRUE\" : \"FALSE\"; break;\n\t\t\tcase 'e': o += cell.w || cell.v; break;\n\t\t\tcase 'd': o += datenum(parseDate(cell.v, date1904), date1904); break;\n\t\t\tcase 's': o += '\"' + (cell.v == null ? \"\" : String(cell.v)).replace(/\"/g,\"\").replace(/;/g, \";;\") + '\"'; break;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction write_ws_cmnt_sylk(cmnt, R, C) {\n\t\tvar o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";A\";\n\t\t/* TODO: max length? */\n\t\to += encode_sylk_str(cmnt.map(function(c) { return c.t; }).join(\"\"));\n\t\treturn o;\n\t}\n\n\tfunction write_ws_cols_sylk(out, cols) {\n\t\tcols.forEach(function(col, i) {\n\t\t\tvar rec = \"F;W\" + (i+1) + \" \" + (i+1) + \" \";\n\t\t\tif(col.hidden) rec += \"0\";\n\t\t\telse {\n\t\t\t\tif(typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n\t\t\t\tif(typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n\t\t\t\tif(typeof col.wch == 'number') rec += Math.round(col.wch);\n\t\t\t}\n\t\t\tif(rec.charAt(rec.length - 1) != \" \") out.push(rec);\n\t\t});\n\t}\n\n\tfunction write_ws_rows_sylk(out, rows) {\n\t\trows.forEach(function(row, i) {\n\t\t\tvar rec = \"F;\";\n\t\t\tif(row.hidden) rec += \"M0;\";\n\t\t\telse if(row.hpt) rec += \"M\" + 20 * row.hpt + \";\";\n\t\t\telse if(row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n\t\t\tif(rec.length > 2) out.push(rec + \"R\" + (i+1));\n\t\t});\n\t}\n\n\tfunction sheet_to_sylk(ws, opts, wb) {\n\t\tif(!opts) opts = {}; opts._formats = [\"General\"];\n\t\t/* TODO: codepage */\n\t\tvar preamble = [\"ID;PSheetJS;N;E\"], o = [];\n\t\tvar r = safe_decode_range(ws['!ref']), cell;\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar RS = \"\\r\\n\";\n\t\tvar d1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\n\t\tvar _lastfmt = \"General\";\n\t\tpreamble.push(\"P;PGeneral\");\n\t\t/* Excel has been inconsistent in comment placement */\n\t\tvar R = r.s.r, C = r.s.c, p = [];\n\t\tfor(R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tif(dense && !ws[\"!data\"][R]) continue;\n\t\t\tp = [];\n\t\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcell = dense ? ws[\"!data\"][R][C] : ws[encode_col(C) + encode_row(R)];\n\t\t\t\tif(!cell || !cell.c) continue;\n\t\t\t\tp.push(write_ws_cmnt_sylk(cell.c, R, C));\n\t\t\t}\n\t\t\tif(p.length) o.push(p.join(RS));\n\t\t}\n\t\tfor(R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tif(dense && !ws[\"!data\"][R]) continue;\n\t\t\tp = [];\n\t\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcell = dense ? ws[\"!data\"][R][C] : ws[encode_col(C) + encode_row(R)];\n\t\t\t\tif(!cell || (cell.v == null && (!cell.f || cell.F))) continue;\n\t\t\t\tif((cell.z||(cell.t == \"d\" ? table_fmt[14] : \"General\")) != _lastfmt) {\n\t\t\t\t\tvar ifmt = opts._formats.indexOf(cell.z);\n\t\t\t\t\tif(ifmt == -1) { opts._formats.push(cell.z); ifmt = opts._formats.length - 1; preamble.push(\"P;P\" + cell.z.replace(/;/g, \";;\")); }\n\t\t\t\t\tp.push(\"F;P\" + ifmt + \";Y\" + (R+1) + \";X\" + (C+1));\n\t\t\t\t}\n\t\t\t\tp.push(write_ws_cell_sylk(cell, ws, R, C, opts, d1904));\n\t\t\t}\n\t\t\to.push(p.join(RS));\n\t\t}\n\n\t\tpreamble.push(\"F;P0;DG0G8;M255\");\n\t\tif(ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n\t\tif(ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n\n\t\tpreamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c,r.s.r,r.e.c,r.e.r].join(\" \"));\n\t\tpreamble.push(\"O;L;D;B\" + (d1904 ? \";V4\" : \"\") + \";K47;G100 0.001\");\n\n\t\tdelete opts._formats;\n\t\treturn preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n\t}\n\n\treturn {\n\t\tto_workbook: sylk_to_workbook,\n\t\tfrom_sheet: sheet_to_sylk\n\t};\n})();\n\nvar DIF = (function() {\n\tfunction dif_to_aoa(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return dif_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return dif_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return dif_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction dif_to_aoa_str(str, opts) {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tif (records[ri].trim() === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\tif (R < 0) continue;\n\t\t\tvar metadata = records[ri].trim().split(\",\");\n\t\t\tvar type = metadata[0], value = metadata[1];\n\t\t\t++ri;\n\t\t\tvar data = records[ri] || \"\";\n\t\t\twhile(((data.match(/[\"]/g)||[]).length & 1) && ri < records.length - 1) data += \"\\n\" + records[++ri];\n\t\t\tdata = data.trim();\n\t\t\tswitch (+type) {\n\t\t\t\tcase -1:\n\t\t\t\t\tif (data === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\t\t\telse if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tif(data === 'TRUE') arr[R][C] = true;\n\t\t\t\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\t\t\t\telse if(!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);\n\t\t\t\t\telse if(!isNaN(fuzzydate(value).getDate())) {\n\t\t\t\t\t\tarr[R][C] = parseDate(value);\n\t\t\t\t\t\tif(!(opts && opts.UTC)) { arr[R][C] = utc_to_local(arr[R][C]); }\n\t\t\t\t\t}\n\t\t\t\t\telse arr[R][C] = value;\n\t\t\t\t\t++C; break;\n\t\t\t\tcase 1:\n\t\t\t\t\tdata = data.slice(1,data.length-1);\n\t\t\t\t\tdata = data.replace(/\"\"/g, '\"');\n\t\t\t\t\tif(DIF_XL && data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n\t\t\t\t\tarr[R][C++] = data !== '' ? data : null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (data === 'EOD') break;\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction dif_to_sheet(str, opts) { return aoa_to_sheet(dif_to_aoa(str, opts), opts); }\n\tfunction dif_to_workbook(str, opts) {\n\t\tvar o = sheet_to_workbook(dif_to_sheet(str, opts), opts);\n\t\to.bookType = \"dif\";\n\t\treturn o;\n\t}\n\n\tfunction make_value(v, s) { return \"0,\" + String(v) + \"\\r\\n\" + s; }\n\tfunction make_value_str(s) { return \"1,0\\r\\n\\\"\" + s.replace(/\"/g,'\"\"') + '\"'; }\n\tfunction sheet_to_dif(ws) {\n\t\tvar _DIF_XL = DIF_XL;\n\t\tvar r = safe_decode_range(ws['!ref']);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar o = [\n\t\t\t\"TABLE\\r\\n0,1\\r\\n\\\"sheetjs\\\"\\r\\n\",\n\t\t\t\"VECTORS\\r\\n0,\" + (r.e.r - r.s.r + 1) + \"\\r\\n\\\"\\\"\\r\\n\",\n\t\t\t\"TUPLES\\r\\n0,\" + (r.e.c - r.s.c + 1) + \"\\r\\n\\\"\\\"\\r\\n\",\n\t\t\t\"DATA\\r\\n0,0\\r\\n\\\"\\\"\\r\\n\"\n\t\t];\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tvar row = dense ? ws[\"!data\"][R] : [];\n\t\t\tvar p = \"-1,0\\r\\nBOT\\r\\n\";\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar cell = dense ? (row && row[C]) : ws[encode_cell({r:R,c:C})];\n\t\t\t\tif(cell == null) { p +=(\"1,0\\r\\n\\\"\\\"\\r\\n\"); continue;}\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(_DIF_XL) {\n\t\t\t\t\t\t\tif(cell.w != null) p +=(\"0,\" + cell.w + \"\\r\\nV\");\n\t\t\t\t\t\t\telse if(cell.v != null) p +=(make_value(cell.v, \"V\")); // TODO: should this call SSF_format?\n\t\t\t\t\t\t\telse if(cell.f != null && !cell.F) p +=(make_value_str(\"=\" + cell.f));\n\t\t\t\t\t\t\telse p +=(\"1,0\\r\\n\\\"\\\"\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(cell.v == null) p +=(\"1,0\\r\\n\\\"\\\"\");\n\t\t\t\t\t\t\telse p +=(make_value(cell.v, \"V\"));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tp +=(cell.v ? make_value(1, \"TRUE\") : make_value(0, \"FALSE\"));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's':\n\t\t\t\t\t\tp +=(make_value_str((!_DIF_XL || isNaN(+cell.v)) ? cell.v : '=\"' + cell.v + '\"'));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\tif(!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n\t\t\t\t\t\tif(_DIF_XL) p +=(make_value(cell.w, \"V\"));\n\t\t\t\t\t\telse p +=(make_value_str(cell.w));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault: p +=(\"1,0\\r\\n\\\"\\\"\");\n\t\t\t\t}\n\t\t\t\tp += \"\\r\\n\";\n\t\t\t}\n\t\t\to.push(p);\n\t\t}\n\t\treturn o.join(\"\") + \"-1,0\\r\\nEOD\";\n\t}\n\treturn {\n\t\tto_workbook: dif_to_workbook,\n\t\tto_sheet: dif_to_sheet,\n\t\tfrom_sheet: sheet_to_dif\n\t};\n})();\n\nvar ETH = (function() {\n\tfunction decode(s) { return s.replace(/\\\\b/g,\"\\\\\").replace(/\\\\c/g,\":\").replace(/\\\\n/g,\"\\n\"); }\n\tfunction encode(s) { return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g,\"\\\\n\"); }\n\n\tfunction eth_to_aoa(str, opts) {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tvar record = records[ri].trim().split(\":\");\n\t\t\tif(record[0] !== 'cell') continue;\n\t\t\tvar addr = decode_cell(record[1]);\n\t\t\tif(arr.length <= addr.r) for(R = arr.length; R <= addr.r; ++R) if(!arr[R]) arr[R] = [];\n\t\t\tR = addr.r; C = addr.c;\n\t\t\tswitch(record[2]) {\n\t\t\t\tcase 't': arr[R][C] = decode(record[3]); break;\n\t\t\t\tcase 'v': arr[R][C] = +record[3]; break;\n\t\t\t\tcase 'vtf': var _f = record[record.length - 1];\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'vtc':\n\t\t\t\t\tswitch(record[3]) {\n\t\t\t\t\t\tcase 'nl': arr[R][C] = +record[4] ? true : false; break;\n\t\t\t\t\t\tdefault: arr[R][C] = +record[4]; break;\n\t\t\t\t\t}\n\t\t\t\t\tif(record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n\t\t\t}\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction eth_to_sheet(d, opts) { return aoa_to_sheet(eth_to_aoa(d, opts), opts); }\n\tfunction eth_to_workbook(d, opts) { return sheet_to_workbook(eth_to_sheet(d, opts), opts); }\n\n\tvar header = [\n\t\t\"socialcalc:version:1.5\",\n\t\t\"MIME-Version: 1.0\",\n\t\t\"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"\n\t].join(\"\\n\");\n\n\tvar sep = [\n\t\t\"--SocialCalcSpreadsheetControlSave\",\n\t\t\"Content-type: text/plain; charset=UTF-8\"\n\t].join(\"\\n\") + \"\\n\";\n\n\t/* TODO: the other parts */\n\tvar meta = [\n\t\t\"# SocialCalc Spreadsheet Control Save\",\n\t\t\"part:sheet\"\n\t].join(\"\\n\");\n\n\tvar end = \"--SocialCalcSpreadsheetControlSave--\";\n\n\tfunction sheet_to_eth_data(ws) {\n\t\tif(!ws || !ws['!ref']) return \"\";\n\t\tvar o = [], oo = [], cell, coord = \"\";\n\t\tvar r = decode_range(ws['!ref']);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcoord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[\"!data\"][R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null || cell.t === 'z') continue;\n\t\t\t\too = [\"cell\", coord, 't'];\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 's': case 'str': oo.push(encode(cell.v)); break;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(!cell.f) { oo[2]='v'; oo[3]=cell.v; }\n\t\t\t\t\t\telse { oo[2]='vtf'; oo[3]='n'; oo[4]=cell.v; oo[5]=encode(cell.f); }\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\too[2] = 'vt'+(cell.f?'f':'c'); oo[3]='nl'; oo[4]=cell.v?\"1\":\"0\";\n\t\t\t\t\t\too[5] = encode(cell.f||(cell.v?'TRUE':'FALSE'));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\tvar t = datenum(parseDate(cell.v));\n\t\t\t\t\t\too[2] = 'vtc'; oo[3] = 'nd'; oo[4] = \"\"+t;\n\t\t\t\t\t\too[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'e': continue;\n\t\t\t\t}\n\t\t\t\to.push(oo.join(\":\"));\n\t\t\t}\n\t\t}\n\t\to.push(\"sheet:c:\" + (r.e.c-r.s.c+1) + \":r:\" + (r.e.r-r.s.r+1) + \":tvf:1\");\n\t\to.push(\"valueformat:1:text-wiki\");\n\t\t//o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n\t\treturn o.join(\"\\n\");\n\t}\n\n\tfunction sheet_to_eth(ws) {\n\t\treturn [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\");\n\t\t// return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n\t}\n\n\treturn {\n\t\tto_workbook: eth_to_workbook,\n\t\tto_sheet: eth_to_sheet,\n\t\tfrom_sheet: sheet_to_eth\n\t};\n})();\n\nvar PRN = (function() {\n\tfunction set_text_arr(data, arr, R, C, o) {\n\t\tif(o.raw) arr[R][C] = data;\n\t\telse if(data === \"\"){/* empty */}\n\t\telse if(data === 'TRUE') arr[R][C] = true;\n\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\telse if(!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);\n\t\telse if(!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);\n\t\telse arr[R][C] = data;\n\t}\n\n\tfunction prn_to_aoa_str(f, opts) {\n\t\tvar o = opts || {};\n\t\tvar arr = ([]);\n\t\tif(!f || f.length === 0) return arr;\n\t\tvar lines = f.split(/[\\r\\n]/);\n\t\tvar L = lines.length - 1;\n\t\twhile(L >= 0 && lines[L].length === 0) --L;\n\t\tvar start = 10, idx = 0;\n\t\tvar R = 0;\n\t\tfor(; R <= L; ++R) {\n\t\t\tidx = lines[R].indexOf(\" \");\n\t\t\tif(idx == -1) idx = lines[R].length; else idx++;\n\t\t\tstart = Math.max(start, idx);\n\t\t}\n\t\tfor(R = 0; R <= L; ++R) {\n\t\t\tarr[R] = [];\n\t\t\t/* TODO: confirm that widths are always 10 */\n\t\t\tvar C = 0;\n\t\t\tset_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n\t\t\tfor(C = 1; C <= (lines[R].length - start)/10 + 1; ++C)\n\t\t\t\tset_text_arr(lines[R].slice(start+(C-1)*10,start+C*10).trim(),arr,R,C,o);\n\t\t}\n\t\tif(o.sheetRows) arr = arr.slice(0, o.sheetRows);\n\t\treturn arr;\n\t}\n\n\t// List of accepted CSV separators\n\tvar guess_seps = {\n0x2C: ',',\n0x09: \"\\t\",\n0x3B: ';',\n0x7C: '|'\n\t};\n\n\t// CSV separator weights to be used in case of equal numbers\n\tvar guess_sep_weights = {\n0x2C: 3,\n0x09: 2,\n0x3B: 1,\n0x7C: 0\n\t};\n\n\tfunction guess_sep(str) {\n\t\tvar cnt = {}, instr = false, end = 0, cc = 0;\n\t\tfor(;end < str.length;++end) {\n\t\t\tif((cc=str.charCodeAt(end)) == 0x22) instr = !instr;\n\t\t\telse if(!instr && cc in guess_seps) cnt[cc] = (cnt[cc]||0)+1;\n\t\t}\n\n\t\tcc = [];\n\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\tcc.push([ cnt[end], end ]);\n\t\t}\n\n\t\tif ( !cc.length ) {\n\t\t\tcnt = guess_sep_weights;\n\t\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\t\tcc.push([ cnt[end], end ]);\n\t\t\t}\n\t\t}\n\n\t\tcc.sort(function(a, b) { return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]]; });\n\n\t\treturn guess_seps[cc.pop()[1]] || 0x2C;\n\t}\n\n\tfunction dsv_to_sheet_str(str, opts) {\n\t\tvar o = opts || {};\n\t\tvar sep = \"\";\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar ws = ({});\n\t\tif(o.dense) ws[\"!data\"] = [];\n\t\tvar range = ({s: {c:0, r:0}, e: {c:0, r:0}});\n\n\t\tif(str.slice(0,4) == \"sep=\") {\n\t\t\t// If the line ends in \\r\\n\n\t\t\tif(str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(7);\n\t\t\t}\n\t\t\t// If line ends in \\r OR \\n\n\t\t\telse if(str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(6);\n\t\t\t}\n\t\t\telse sep = guess_sep(str.slice(0,1024));\n\t\t}\n\t\telse if(o && o.FS) sep = o.FS;\n\t\telse sep = guess_sep(str.slice(0,1024));\n\t\tvar R = 0, C = 0, v = 0;\n\t\tvar start = 0, end = 0, sepcc = sep.charCodeAt(0), instr = false, cc=0, startcc=str.charCodeAt(0);\n\t\tvar _re = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n\t\tfunction finish_cell() {\n\t\t\t/* TODO: fuzzy parsers should pass back assumed number format */\n\t\t\tvar s = str.slice(start, end); if(s.slice(-1) == \"\\r\") s = s.slice(0, -1);\n\t\t\tvar cell = ({});\n\t\t\tif(s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1,-1).replace(/\"\"/g,'\"');\n\t\t\tif(o.cellText !== false) cell.w = s;\n\t\t\tif(s.length === 0) cell.t = 'z';\n\t\t\telse if(o.raw) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.trim().length === 0) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.charCodeAt(0) == 0x3D) {\n\t\t\t\tif(s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) { cell.t = 's'; cell.v = s.slice(2,-1).replace(/\"\"/g,'\"'); }\n\t\t\t\telse if(fuzzyfmla(s)) { cell.t = 'n'; cell.f = s.slice(1); }\n\t\t\t\telse { cell.t = 's'; cell.v = s; } }\n\t\t\telse if(s == \"TRUE\") { cell.t = 'b'; cell.v = true; }\n\t\t\telse if(s == \"FALSE\") { cell.t = 'b'; cell.v = false; }\n\t\t\telse if(!isNaN(v = fuzzynum(s))) { cell.t = 'n'; cell.v = v; }\n\t\t\telse if(!isNaN((v = fuzzydate(s)).getDate()) || _re && s.match(_re)) {\n\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\tif(_re && s.match(_re)){ var news=dateNF_fix(s, o.dateNF, (s.match(_re)||[])); v = parseDate(news); if(o && o.UTC === false) v = utc_to_local(v); }\n\t\t\t\telse if(o && o.UTC === false) v = utc_to_local(v);\n\t\t\t\telse if(o.cellText !== false && o.dateNF) cell.w = SSF_format(cell.z, v);\n\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.v = v; }\n\t\t\t\telse { cell.t = 'n'; cell.v = datenum(v); }\n\t\t\t\tif(!o.cellNF) delete cell.z;\n\t\t\t} else {\n\t\t\t\tcell.t = 's';\n\t\t\t\tcell.v = s;\n\t\t\t}\n\t\t\tif(cell.t == 'z'){}\n\t\t\telse if(o.dense) { if(!ws[\"!data\"][R]) ws[\"!data\"][R] = []; ws[\"!data\"][R][C] = cell; }\n\t\t\telse ws[encode_cell({c:C,r:R})] = cell;\n\t\t\tstart = end+1; startcc = str.charCodeAt(start);\n\t\t\tif(range.e.c < C) range.e.c = C;\n\t\t\tif(range.e.r < R) range.e.r = R;\n\t\t\tif(cc == sepcc) ++C; else { C = 0; ++R; if(o.sheetRows && o.sheetRows <= R) return true; }\n\t\t}\n\t\touter: for(;end < str.length;++end) switch((cc=str.charCodeAt(end))) {\n\t\t\tcase 0x22: if(startcc === 0x22) instr = !instr; break;\n\t\t\tcase 0x0d:\n\t\t\t\tif(instr) break;\n\t\t\t\tif(str.charCodeAt(end+1) == 0x0a) ++end;\n\t\t\t\t/* falls through */\n\t\t\tcase sepcc: case 0x0a: if(!instr && finish_cell()) break outer; break;\n\t\t\tdefault: break;\n\t\t}\n\t\tif(end - start > 0) finish_cell();\n\n\t\tws['!ref'] = encode_range(range);\n\t\treturn ws;\n\t}\n\n\tfunction prn_to_sheet_str(str, opts) {\n\t\tif(!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n\t\tif(opts.FS) return dsv_to_sheet_str(str, opts);\n\t\tif(str.slice(0,4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n\t\tif(str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n\t\treturn aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n\t}\n\n\tfunction prn_to_sheet(d, opts) {\n\t\tvar str = \"\", bytes = opts.type == 'string' ? [0,0,0,0] : firstbyte(d, opts);\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': str = Base64_decode(d); break;\n\t\t\tcase 'binary': str = d; break;\n\t\t\tcase 'buffer':\n\t\t\t\tif(opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n\t\t\t\telse if(opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);\n\t\t\t\telse str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n\t\t\t\tbreak;\n\t\t\tcase 'array': str = cc2str(d); break;\n\t\t\tcase 'string': str = d; break;\n\t\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t\t}\n\t\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));\n\t\telse if(opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);\n\t\telse if((opts.type == 'binary') && typeof $cptable !== 'undefined' && opts.codepage)  str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591,str));\n\t\tif(str.slice(0,19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n\t\treturn prn_to_sheet_str(str, opts);\n\t}\n\n\tfunction prn_to_workbook(d, opts) { return sheet_to_workbook(prn_to_sheet(d, opts), opts); }\n\n\tfunction sheet_to_prn(ws) {\n\t\tvar o = [];\n\t\tvar r = safe_decode_range(ws['!ref']), cell;\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tvar oo = [];\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[\"!data\"][R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null) { oo.push(\"          \"); continue; }\n\t\t\t\tvar w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0,10);\n\t\t\t\twhile(w.length < 10) w += \" \";\n\t\t\t\too.push(w + (C === 0 ? \" \" : \"\"));\n\t\t\t}\n\t\t\to.push(oo.join(\"\"));\n\t\t}\n\t\treturn o.join(\"\\n\");\n\t}\n\n\treturn {\n\t\tto_workbook: prn_to_workbook,\n\t\tto_sheet: prn_to_sheet,\n\t\tfrom_sheet: sheet_to_prn\n\t};\n})();\n\n/* Excel defaults to SYLK but warns if data is not valid */\nfunction read_wb_ID(d, opts) {\n\tvar o = opts || {}, OLD_WTF = !!o.WTF; o.WTF = true;\n\ttry {\n\t\tvar out = SYLK.to_workbook(d, o);\n\t\to.WTF = OLD_WTF;\n\t\treturn out;\n\t} catch(e) {\n\t\to.WTF = OLD_WTF;\n\t\tif(!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\n\t\treturn PRN.to_workbook(d, opts);\n\t}\n}\n\nvar WK_ = (function() {\n\tfunction lotushopper(data, cb, opts) {\n\t\tif(!data) return;\n\t\tprep_blob(data, data.l || 0);\n\t\tvar Enum = opts.Enum || WK1Enum;\n\t\twhile(data.l < data.length) {\n\t\t\tvar RT = data.read_shift(2);\n\t\t\tvar R = Enum[RT] || Enum[0xFFFF];\n\t\t\tvar length = data.read_shift(2);\n\t\t\tvar tgt = data.l + length;\n\t\t\tvar d = R.f && R.f(data, length, opts);\n\t\t\tdata.l = tgt;\n\t\t\tif(cb(d, R, RT)) return;\n\t\t}\n\t}\n\n\tfunction lotus_to_workbook(d, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n\t\t\tcase 'binary': return lotus_to_workbook_buf(s2a(d), opts);\n\t\t\tcase 'buffer':\n\t\t\tcase 'array': return lotus_to_workbook_buf(d, opts);\n\t\t}\n\t\tthrow \"Unsupported type \" + opts.type;\n\t}\n\n\t/* NOTE: this list intentionally starts at 1 */\n\tvar LOTUS_DATE_FMTS = [\n\t\t\"mmmm\",\n\t\t\"dd-mmm-yyyy\",\n\t\t\"dd-mmm\",\n\t\t\"mmm-yyyy\",\n\t\t\"@\", // \"text\"?\n\t\t\"mm/dd\",\n\t\t\"hh:mm:ss AM/PM\", // 7\n\t\t\"hh:mm AM/PM\",\n\t\t\"mm/dd/yyyy\",\n\t\t\"mm/dd\",\n\t\t\"hh:mm:ss\",\n\t\t\"hh:mm\" // 12\n\t];\n\n\tfunction lotus_to_workbook_buf(d, opts) {\n\t\tif(!d) return d;\n\t\tvar o = opts || {};\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar s = ({}), n = \"Sheet1\", next_n = \"\", sidx = 0;\n\t\tvar sheets = {}, snames = [], realnames = [], sdata = [];\n\t\tif(o.dense) sdata = s[\"!data\"] = [];\n\n\t\tvar refguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\tvar sheetRows = o.sheetRows || 0;\n\t\tvar lastcell = {};\n\n\t\tif(d[4] == 0x51 && d[5] == 0x50 && d[6] == 0x57) return qpw_to_workbook_buf(d, opts);\n\t\tif(d[2] == 0x00) {\n\t\t\tif(d[3] == 0x08 || d[3] == 0x09) {\n\t\t\t\tif(d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n\t\t\t}\n\t\t}\n\n\t\tif(d[2] == 0x02) {\n\t\t\to.Enum = WK1Enum;\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0x00: /* BOF */\n\t\t\t\t\to.vers = val;\n\t\t\t\t\tif(val >= 0x1000) o.qpro = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xFF: /* BOF (works 3+) */\n\t\t\t\t\to.vers = val;\n\t\t\t\t\to.works = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x06: refguess = val; break; /* RANGE */\n\t\t\t\tcase 0xCC: if(val) next_n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0xDE: next_n = val; break; /* SHEETNAMELP */\n\t\t\t\tcase 0x0F: /* LABEL */\n\t\t\t\tcase 0x33: /* STRING */\n\t\t\t\t\tif((!o.qpro && !o.works || RT == 0x33) && val[1].v.charCodeAt(0) < 0x30) val[1].v = val[1].v.slice(1);\n\t\t\t\t\tif(o.works || o.works2) val[1].v = val[1].v.replace(/\\r\\n/g, \"\\n\");\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x0D: /* INTEGER */\n\t\t\t\tcase 0x0E: /* NUMBER */\n\t\t\t\tcase 0x10: /* FORMULA */\n\t\t\t\t\t/* TODO: actual translation of the format code */\n\t\t\t\t\tif((val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n\t\t\t\t\t\tval[1].z = o.dateNF || LOTUS_DATE_FMTS[(val[2] & 0x0F)-1] || table_fmt[14];\n\t\t\t\t\t\tif(o.cellDates) { val[1].v = numdate(val[1].v); val[1].t = typeof val[1].v == \"number\" ? 'n' : 'd'; }\n\t\t\t\t\t}\n\n\t\t\t\t\tif(o.qpro) {\n\t\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\t\ts = ({}); if(o.dense) sdata = s[\"!data\"] = [];\n\t\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\t\tsidx = val[3]; n = next_n || \"Sheet\" + (sidx + 1); next_n = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar tmpcell = o.dense ? (sdata[val[0].r]||[])[val[0].c] : s[encode_cell(val[0])];\n\t\t\t\t\tif(tmpcell) {\n\t\t\t\t\t\ttmpcell.t = val[1].t; tmpcell.v = val[1].v;\n\t\t\t\t\t\tif(val[1].z != null) tmpcell.z = val[1].z;\n\t\t\t\t\t\tif(val[1].f != null) tmpcell.f = val[1].f;\n\t\t\t\t\t\tlastcell = tmpcell;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!sdata[val[0].r]) sdata[val[0].r] = [];\n\t\t\t\t\t\tsdata[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tlastcell = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x5405: o.works2 = true; break;\n\t\t\t\tcase 0x5402: {\n\t\t\t\t\t/* TODO: enumerate all extended number formats */\n\t\t\t\t\tif(val == 0x14a1) {\n\t\t\t\t\t\tlastcell.z = \"hh:mm:ss\";\n\t\t\t\t\t\tif(o.cellDates && lastcell.t == \"n\") {\n\t\t\t\t\t\t\tlastcell.v = numdate(lastcell.v); lastcell.t = typeof lastcell.v == \"number\" ? 'n' : 'd';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t}}, o);\n\t\t} else if(d[2] == 0x1A || d[2] == 0x0E) {\n\t\t\to.Enum = WK3Enum;\n\t\t\tif(d[2] == 0x0E) { o.qpro = true; d.l = 0; }\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0xCC: n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0x16: /* LABEL16 */\n\t\t\t\t\tif(val[1].v.charCodeAt(0) < 0x30) val[1].v = val[1].v.slice(1);\n\t\t\t\t\t// TODO: R9 appears to encode control codes this way -- verify against other versions\n\t\t\t\t\tval[1].v = val[1].v.replace(/\\x0F./g, function($$) { return String.fromCharCode($$.charCodeAt(1) - 0x20); }).replace(/\\r\\n/g, \"\\n\");\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x17: /* NUMBER17 */\n\t\t\t\tcase 0x18: /* NUMBER18 */\n\t\t\t\tcase 0x19: /* FORMULA19 */\n\t\t\t\tcase 0x25: /* NUMBER25 */\n\t\t\t\tcase 0x27: /* NUMBER27 */\n\t\t\t\tcase 0x28: /* FORMULA28 */\n\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\ts = ({}); if(o.dense) sdata = s[\"!data\"] = [];\n\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\tsidx = val[3]; n = \"Sheet\" + (sidx + 1);\n\t\t\t\t\t}\n\t\t\t\t\tif(sheetRows > 0 && val[0].r >= sheetRows) break;\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!sdata[val[0].r]) sdata[val[0].r] = [];\n\t\t\t\t\t\tsdata[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tif(refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n\t\t\t\t\tif(refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x1B: /* XFORMAT */\n\t\t\t\t\tif(val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0601: /* SHEETINFOQP */\n\t\t\t\t\trealnames[val[0]] = val[1]; if(val[0] == sidx) n = val[1]; break;\n\t\t\t\tdefault: break;\n\t\t\t}}, o);\n\t\t} else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n\t\ts[\"!ref\"] = encode_range(refguess);\n\t\tsheets[next_n || n] = s;\n\t\tsnames.push(next_n || n);\n\t\tif(!realnames.length) return { SheetNames: snames, Sheets: sheets };\n\t\tvar osheets = {}, rnames = [];\n\t\t/* TODO: verify no collisions */\n\t\tfor(var i = 0; i < realnames.length; ++i) if(sheets[snames[i]]) {\n\t\t\trnames.push(realnames[i] || snames[i]);\n\t\t\tosheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n\t\t} else {\n\t\t\trnames.push(realnames[i]);\n\t\t\tosheets[realnames[i]] = ({ \"!ref\": \"A1\" });\n\t\t}\n\t\treturn { SheetNames: rnames, Sheets: osheets };\n\t}\n\n\tfunction sheet_to_wk1(ws, opts) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n\t\tvar ba = buf_array();\n\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar cols = [];\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n\t\twrite_biff_rec(ba, 0x06, write_RANGE(range));\n\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\tvar rr = encode_row(R);\n\t\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[cols[C] + rr];\n\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t/* TODO: formula records */\n\t\t\t\tswitch(cell.t) {\n\t\t\t\tcase \"n\":\n\t\t\t\t\tif((cell.v|0)==cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell));\n\t\t\t\t\telse write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell));\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\":\n\t\t\t\t\tvar dc = datenum(cell.v);\n\t\t\t\t\tif((dc|0)==dc && dc >= -32768 && dc <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, {t:\"n\", v:dc, z:cell.z || table_fmt[14]}));\n\t\t\t\t\telse write_biff_rec(ba, 0x0e, write_NUMBER(R, C, {t:\"n\", v:dc, z:cell.z || table_fmt[14]}));\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\twrite_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\tfunction book_to_wk3(wb, opts) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n\t\tvar ba = buf_array();\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n\n\t\tfor(var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n\n\t\tvar wsidx = 0;\n\t\tfor(i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\t\tvar dense = ws[\"!data\"] != null;\n\t\t\tvar cols = [];\n\t\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\t\tvar rr = encode_row(R);\n\t\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\t\t\tvar ref = cols[C] + rr;\n\t\t\t\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[ref];\n\t\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t\t/* TODO: FORMULA19 NUMBER18 records */\n\t\t\t\t\tif(cell.t == \"n\") {\n\t\t\t\t\t\twrite_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\t\t/* TODO: max len? */\n\t\t\t\t\t\twrite_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t++wsidx;\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\n\tfunction write_BOF_WK1(v) {\n\t\tvar out = new_buf(2);\n\t\tout.write_shift(2, v);\n\t\treturn out;\n\t}\n\n\tfunction write_BOF_WK3(wb) {\n\t\tvar out = new_buf(26);\n\t\tout.write_shift(2, 0x1000);\n\t\tout.write_shift(2, 0x0004);\n\t\tout.write_shift(4, 0x0000);\n\t\tvar rows = 0, cols = 0, wscnt = 0;\n\t\tfor(var i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar name = wb.SheetNames[i];\n\t\t\tvar ws = wb.Sheets[name];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\t++wscnt;\n\t\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\t\tif(rows < range.e.r) rows = range.e.r;\n\t\t\tif(cols < range.e.c) cols = range.e.c;\n\t\t}\n\t\tif(rows > 8191) rows = 8191;\n\t\tout.write_shift(2, rows);\n\t\tout.write_shift(1, wscnt);\n\t\tout.write_shift(1, cols);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(1, 0x01);\n\t\tout.write_shift(1, 0x02);\n\t\tout.write_shift(4, 0);\n\t\tout.write_shift(4, 0);\n\t\treturn out;\n\t}\n\n\tfunction parse_RANGE(blob, length, opts) {\n\t\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\t\tif(length == 8 && opts.qpro) {\n\t\t\to.s.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.s.r = blob.read_shift(2);\n\t\t\to.e.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.e.r = blob.read_shift(2);\n\t\t\treturn o;\n\t\t}\n\t\to.s.c = blob.read_shift(2);\n\t\to.s.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\to.e.c = blob.read_shift(2);\n\t\to.e.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\tif(o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n\t\treturn o;\n\t}\n\tfunction write_RANGE(range) {\n\t\tvar out = new_buf(8);\n\t\tout.write_shift(2, range.s.c);\n\t\tout.write_shift(2, range.s.r);\n\t\tout.write_shift(2, range.e.c);\n\t\tout.write_shift(2, range.e.r);\n\t\treturn out;\n\t}\n\n\tfunction parse_cell(blob, length, opts) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0, 0];\n\t\tif(opts.qpro && opts.vers != 0x5120) {\n\t\t\to[0].c = blob.read_shift(1);\n\t\t\to[3] = blob.read_shift(1);\n\t\t\to[0].r = blob.read_shift(2);\n\t\t\tblob.l+=2;\n\t\t} else if(opts.works) { // TODO: verify with more complex works3-4 examples\n\t\t\to[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\n\t\t\to[2] = blob.read_shift(2);\n\t\t} else {\n\t\t\to[2] = blob.read_shift(1);\n\t\t\to[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction get_wk1_fmt(cell) {\n\t\t/* TODO: some fuzzy matching on the number format */\n\t\tif(cell.z && fmt_is_date(cell.z)) {\n\t\t\treturn 0xf0 | (LOTUS_DATE_FMTS.indexOf(cell.z) + 1 || 2);\n\t\t}\n\t\treturn 0xFF;\n\t}\n\tfunction parse_LABEL(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].t = 's';\n\t\tif((opts.vers & 0xFFFE) == 0x5120) { // WQ1 / WQ2\n\t\t\tblob.l++;\n\t\t\tvar len = blob.read_shift(1);\n\t\t\to[1].v = blob.read_shift(len, 'utf8');\n\t\t\treturn o;\n\t\t}\n\t\tif(opts.qpro) blob.l++;\n\t\to[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL(R, C, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(7 + s.length);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, 0x27); // ??\n\t\tfor(var i = 0; i < o.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\tfunction parse_STRING(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].t = 's';\n\t\tif(opts.vers == 0x5120) {\n\t\t\tvar len = blob.read_shift(1);\n\t\t\to[1].v = blob.read_shift(len, 'utf8');\n\t\t\treturn o;\n\t\t}\n\t\to[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n\t\treturn o;\n\t}\n\n\tfunction parse_INTEGER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(2, 'i');\n\t\treturn o;\n\t}\n\tfunction write_INTEGER(R, C, cell) {\n\t\tvar o = new_buf(7);\n\t\to.write_shift(1, get_wk1_fmt(cell));\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(2, cell.v, 'i');\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\treturn o;\n\t}\n\tfunction write_NUMBER(R, C, cell) {\n\t\tvar o = new_buf(13);\n\t\to.write_shift(1, get_wk1_fmt(cell));\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(8, cell.v, 'f');\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\t/* TODO: formula */\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\tif(opts.qpro) blob.l = tgt;\n\t\telse {\n\t\t\tvar flen = blob.read_shift(2);\n\t\t\twk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n\t\t\tblob.l += flen;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction wk1_parse_rc(B, V, col) {\n\t\tvar rel = V & 0x8000;\n\t\tV &= ~0x8000;\n\t\tV = (rel ? B : 0) + ((V >= 0x2000) ? V - 0x4000 : V);\n\t\treturn (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n\t}\n\t/* var oprec = [\n\t\t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n\t\t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n\t]; */\n\t/* TODO: flesh out */\n\tvar FuncTab = {\n\t\t0x1F: [\"NA\", 0],\n\t\t// 0x20: [\"ERR\", 0],\n\t\t0x21: [\"ABS\", 1],\n\t\t0x22: [\"TRUNC\", 1],\n\t\t0x23: [\"SQRT\", 1],\n\t\t0x24: [\"LOG\", 1],\n\t\t0x25: [\"LN\", 1],\n\t\t0x26: [\"PI\", 0],\n\t\t0x27: [\"SIN\", 1],\n\t\t0x28: [\"COS\", 1],\n\t\t0x29: [\"TAN\", 1],\n\t\t0x2A: [\"ATAN2\", 2],\n\t\t0x2B: [\"ATAN\", 1],\n\t\t0x2C: [\"ASIN\", 1],\n\t\t0x2D: [\"ACOS\", 1],\n\t\t0x2E: [\"EXP\", 1],\n\t\t0x2F: [\"MOD\", 2],\n\t\t// 0x30\n\t\t0x31: [\"ISNA\", 1],\n\t\t0x32: [\"ISERR\", 1],\n\t\t0x33: [\"FALSE\", 0],\n\t\t0x34: [\"TRUE\", 0],\n\t\t0x35: [\"RAND\", 0],\n\t\t0x36: [\"DATE\", 3],\n\t\t// 0x37 NOW\n\t\t// 0x38 PMT\n\t\t// 0x39 PV\n\t\t// 0x3A FV\n\t\t// 0x3B IF\n\t\t// 0x3C DAY\n\t\t// 0x3D MONTH\n\t\t// 0x3E YEAR\n\t\t0x3F: [\"ROUND\", 2],\n\t\t0x40: [\"TIME\", 3],\n\t\t// 0x41 HOUR\n\t\t// 0x42 MINUTE\n\t\t// 0x43 SECOND\n\t\t0x44: [\"ISNUMBER\", 1],\n\t\t0x45: [\"ISTEXT\", 1],\n\t\t0x46: [\"LEN\", 1],\n\t\t0x47: [\"VALUE\", 1],\n\t\t// 0x48: [\"FIXED\", ?? 1],\n\t\t0x49: [\"MID\", 3],\n\t\t0x4A: [\"CHAR\", 1],\n\t\t// 0x4B\n\t\t// 0x4C FIND\n\t\t// 0x4D DATEVALUE\n\t\t// 0x4E TIMEVALUE\n\t\t// 0x4F CELL\n\t\t0x50: [\"SUM\", 69],\n\t\t0x51: [\"AVERAGEA\", 69],\n\t\t0x52: [\"COUNTA\", 69],\n\t\t0x53: [\"MINA\", 69],\n\t\t0x54: [\"MAXA\", 69],\n\t\t// 0x55 VLOOKUP\n\t\t// 0x56 NPV\n\t\t// 0x57 VAR\n\t\t// 0x58 STD\n\t\t// 0x59 IRR\n\t\t// 0x5A HLOOKUP\n\t\t// 0x5B DSUM\n\t\t// 0x5C DAVERAGE\n\t\t// 0x5D DCOUNTA\n\t\t// 0x5E DMIN\n\t\t// 0x5F DMAX\n\t\t// 0x60 DVARP\n\t\t// 0x61 DSTDEVP\n\t\t// 0x62 INDEX\n\t\t// 0x63 COLS\n\t\t// 0x64 ROWS\n\t\t// 0x65 REPEAT\n\t\t0x66: [\"UPPER\", 1],\n\t\t0x67: [\"LOWER\", 1],\n\t\t// 0x68 LEFT\n\t\t// 0x69 RIGHT\n\t\t// 0x6A REPLACE\n\t\t0x6B: [\"PROPER\", 1],\n\t\t// 0x6C CELL\n\t\t0x6D: [\"TRIM\", 1],\n\t\t// 0x6E CLEAN\n\t\t0x6F: [\"T\", 1]\n\t\t// 0x70 V\n\t};\n\tvar BinOpTab = [\n\t\t  \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t  \"\",  \"+\",  \"-\",  \"*\",  \"/\",  \"^\",  \"=\", \"<>\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t\"<=\", \">=\",  \"<\",  \">\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t \"&\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\"  // eslint-disable-line no-mixed-spaces-and-tabs\n\t];\n\n\tfunction wk1_fmla_to_csf(blob, o) {\n\t\tprep_blob(blob, 0);\n\t\tvar out = [], argc = 0, R = \"\", C = \"\", argL = \"\", argR = \"\";\n\t\twhile(blob.l < blob.length) {\n\t\t\tvar cc = blob[blob.l++];\n\t\t\tswitch(cc) {\n\t\t\t\tcase 0x00: out.push(blob.read_shift(8, 'f')); break;\n\t\t\t\tcase 0x01: {\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x02: {\n\t\t\t\t\tvar c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tvar r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(c + r + \":\" + C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x03:\n\t\t\t\t\tif(blob.l < blob.length) { console.error(\"WK1 premature formula end\"); return; }\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x04: out.push(\"(\" + out.pop() + \")\"); break;\n\t\t\t\tcase 0x05: out.push(blob.read_shift(2)); break;\n\t\t\t\tcase 0x06: {\n\t\t\t\t\t/* TODO: text encoding */\n\t\t\t\t\tvar Z = \"\"; while((cc = blob[blob.l++])) Z += String.fromCharCode(cc);\n\t\t\t\t\tout.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x08: out.push(\"-\" + out.pop()); break;\n\t\t\t\tcase 0x17: out.push(\"+\" + out.pop()); break;\n\t\t\t\tcase 0x16: out.push(\"NOT(\" + out.pop() + \")\"); break;\n\n\t\t\t\tcase 0x14: case 0x15: {\n\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\tout.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n\t\t\t\t} break;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif(cc < 0x20 && BinOpTab[cc]) {\n\t\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\t\tout.push(argL + BinOpTab[cc] + argR);\n\t\t\t\t\t} else if(FuncTab[cc]) {\n\t\t\t\t\t\targc = FuncTab[cc][1];\n\t\t\t\t\t\tif(argc == 69) argc = blob[blob.l++];\n\t\t\t\t\t\tif(argc > out.length) { console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\"); return; }\n\t\t\t\t\t\tvar args = out.slice(-argc);\n\t\t\t\t\t\tout.length -= argc;\n\t\t\t\t\t\tout.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16));\n\t\t\t\t\t// possible future functions ??\n\t\t\t\t\telse return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n\t\t\t}\n\t\t}\n\t\tif(out.length == 1) o[1].f = \"\" + out[0];\n\t\telse console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n\t}\n\n\n\tfunction parse_cell_3(blob) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0];\n\t\to[0].r = blob.read_shift(2); o[3] = blob[blob.l++]; o[0].c = blob[blob.l++];\n\t\treturn o;\n\t}\n\n\tfunction parse_LABEL_16(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].t = 's';\n\t\to[1].v = blob.read_shift(length - 4, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL_16(R, C, wsidx, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(6 + s.length);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\to.write_shift(1, 0x27);\n\t\tfor(var i = 0; i < s.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_18(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].v = blob.read_shift(2);\n\t\tvar v = o[1].v >> 1;\n\t\tif(o[1].v & 0x1) {\n\t\t\tswitch(v & 0x07) {\n\t\t\t\tcase 0: v = (v >> 3) * 5000; break;\n\t\t\t\tcase 1: v = (v >> 3) * 500; break;\n\t\t\t\tcase 2: v = (v >> 3) / 20; break;\n\t\t\t\tcase 3: v = (v >> 3) / 200; break;\n\t\t\t\tcase 4: v = (v >> 3) / 2000; break;\n\t\t\t\tcase 5: v = (v >> 3) / 20000; break;\n\t\t\t\tcase 6: v = (v >> 3) / 16; break;\n\t\t\t\tcase 7: v = (v >> 3) / 64; break;\n\t\t\t}\n\t\t}\n\t\to[1].v = v;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_17(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\tvar v2 = blob.read_shift(4);\n\t\tvar e = blob.read_shift(2);\n\t\tif(e == 0xFFFF) {\n\t\t\tif(v1 === 0 && v2 === 0xC0000000) { o[1].t = \"e\"; o[1].v = 0x0F; } // ERR -> #VALUE!\n\t\t\telse if(v1 === 0 && v2 === 0xD0000000) { o[1].t = \"e\"; o[1].v = 0x2A; } // NA -> #N/A\n\t\t\telse o[1].v = 0;\n\t\t\treturn o;\n\t\t}\n\t\tvar s = e & 0x8000; e = (e&0x7FFF) - 16446;\n\t\to[1].v = (1 - s*2) * (v2 * Math.pow(2, e+32) + v1 * Math.pow(2, e));\n\t\treturn o;\n\t}\n\tfunction write_NUMBER_17(R, C, wsidx, v) {\n\t\tvar o = new_buf(14);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\tif(v == 0) {\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(2, 0xFFFF);\n\t\t\treturn o;\n\t\t}\n\t\tvar s = 0, e = 0, v1 = 0, v2 = 0;\n\t\tif(v < 0) { s = 1; v = -v; }\n\t\te = Math.log2(v) | 0;\n\t\tv /= Math.pow(2, e-31);\n\t\tv2 = (v)>>>0;\n\t\tif((v2&0x80000000) == 0) { v/=2; ++e; v2 = v >>> 0; }\n\t\tv -= v2;\n\t\tv2 |= 0x80000000;\n\t\tv2 >>>= 0;\n\t\tv *= Math.pow(2, 32);\n\t\tv1 = v>>>0;\n\t\to.write_shift(4, v1);\n\t\to.write_shift(4, v2);\n\t\te += 0x3FFF + (s ? 0x8000 : 0);\n\t\to.write_shift(2, e);\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_19(blob, length) {\n\t\tvar o = parse_NUMBER_17(blob, 14);\n\t\tblob.l += length - 14; /* TODO: WK3 formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_25(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\to[1].v = v1 >> 6;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_27(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(8,'f');\n\t\to[1].v = v1;\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_28(blob, length) {\n\t\tvar o = parse_NUMBER_27(blob, 12);\n\t\tblob.l += length - 12; /* TODO: formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETNAMECS(blob, length) {\n\t\treturn blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n\t}\n\n\tfunction parse_SHEETNAMELP(blob, length) {\n\t\tvar len = blob[blob.l++];\n\t\tif(len > length - 1) len = length - 1;\n\t\tvar o = \"\"; while(o.length < len) o += String.fromCharCode(blob[blob.l++]);\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETINFOQP(blob, length, opts) {\n\t\tif(!opts.qpro || length < 21) return;\n\t\tvar id = blob.read_shift(1);\n\t\tblob.l += 17;\n\t\tblob.l += 1; //var len = blob.read_shift(1);\n\t\tblob.l += 2;\n\t\tvar nm = blob.read_shift(length - 21, 'cstr');\n\t\treturn [id, nm];\n\t}\n\n\tfunction parse_XFORMAT(blob, length) {\n\t\tvar o = {}, tgt = blob.l + length;\n\t\twhile(blob.l < tgt) {\n\t\t\tvar dt = blob.read_shift(2);\n\t\t\tif(dt == 0x36b0) {\n\t\t\t\to[dt] = [0, \"\"];\n\t\t\t\to[dt][0] = blob.read_shift(2);\n\t\t\t\twhile(blob[blob.l]) { o[dt][1] += String.fromCharCode(blob[blob.l]); blob.l++; } blob.l++;\n\t\t\t}\n\t\t\t// TODO: 0x3a99 ??\n\t\t}\n\t\treturn o;\n\t}\n\tfunction write_XFORMAT_SHEETNAME(name, wsidx) {\n\t\tvar out = new_buf(5 + name.length);\n\t\tout.write_shift(2, 0x36b0);\n\t\tout.write_shift(2, wsidx);\n\t\tfor(var i = 0; i < name.length; ++i) {\n\t\t\tvar cc = name.charCodeAt(i);\n\t\t\tout[out.l++] = cc > 0x7F ? 0x5F : cc;\n\t\t}\n\t\tout[out.l++] = 0;\n\t\treturn out;\n\t}\n\n\tvar WK1Enum = {\n0x0000: { n:\"BOF\", f:parseuint16 },\n0x0001: { n:\"EOF\" },\n0x0002: { n:\"CALCMODE\" },\n0x0003: { n:\"CALCORDER\" },\n0x0004: { n:\"SPLIT\" },\n0x0005: { n:\"SYNC\" },\n0x0006: { n:\"RANGE\", f:parse_RANGE },\n0x0007: { n:\"WINDOW1\" },\n0x0008: { n:\"COLW1\" },\n0x0009: { n:\"WINTWO\" },\n0x000A: { n:\"COLW2\" },\n0x000B: { n:\"NAME\" },\n0x000C: { n:\"BLANK\" },\n0x000D: { n:\"INTEGER\", f:parse_INTEGER },\n0x000E: { n:\"NUMBER\", f:parse_NUMBER },\n0x000F: { n:\"LABEL\", f:parse_LABEL },\n0x0010: { n:\"FORMULA\", f:parse_FORMULA },\n0x0018: { n:\"TABLE\" },\n0x0019: { n:\"ORANGE\" },\n0x001A: { n:\"PRANGE\" },\n0x001B: { n:\"SRANGE\" },\n0x001C: { n:\"FRANGE\" },\n0x001D: { n:\"KRANGE1\" },\n0x0020: { n:\"HRANGE\" },\n0x0023: { n:\"KRANGE2\" },\n0x0024: { n:\"PROTEC\" },\n0x0025: { n:\"FOOTER\" },\n0x0026: { n:\"HEADER\" },\n0x0027: { n:\"SETUP\" },\n0x0028: { n:\"MARGINS\" },\n0x0029: { n:\"LABELFMT\" },\n0x002A: { n:\"TITLES\" },\n0x002B: { n:\"SHEETJS\" },\n0x002D: { n:\"GRAPH\" },\n0x002E: { n:\"NGRAPH\" },\n0x002F: { n:\"CALCCOUNT\" },\n0x0030: { n:\"UNFORMATTED\" },\n0x0031: { n:\"CURSORW12\" },\n0x0032: { n:\"WINDOW\" },\n0x0033: { n:\"STRING\", f:parse_STRING },\n0x0037: { n:\"PASSWORD\" },\n0x0038: { n:\"LOCKED\" },\n0x003C: { n:\"QUERY\" },\n0x003D: { n:\"QUERYNAME\" },\n0x003E: { n:\"PRINT\" },\n0x003F: { n:\"PRINTNAME\" },\n0x0040: { n:\"GRAPH2\" },\n0x0041: { n:\"GRAPHNAME\" },\n0x0042: { n:\"ZOOM\" },\n0x0043: { n:\"SYMSPLIT\" },\n0x0044: { n:\"NSROWS\" },\n0x0045: { n:\"NSCOLS\" },\n0x0046: { n:\"RULER\" },\n0x0047: { n:\"NNAME\" },\n0x0048: { n:\"ACOMM\" },\n0x0049: { n:\"AMACRO\" },\n0x004A: { n:\"PARSE\" },\n\t\t// 0x0064\n0x0066: { n:\"PRANGES??\" },\n0x0067: { n:\"RRANGES??\" },\n0x0068: { n:\"FNAME??\" },\n0x0069: { n:\"MRANGES??\" },\n\t\t// 0x0096\n\t\t// 0x0099\n\t\t// 0x009A\n\t\t// 0x009B\n\t\t// 0x009C\n\t\t// 0x00C0\n\t\t// 0x00C7\n\t\t// 0x00C9\n0x00CC: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n\t\t// 0x00CD\n0x00DE: { n:\"SHEETNAMELP\", f:parse_SHEETNAMELP },\n0x00FF: { n:\"BOF\", f:parseuint16 },\n0x5402: { n:\"WKSNF\", f:parseuint16 },\n0xFFFF: { n:\"\" }\n\t};\n\n\tvar WK3Enum = {\n0x0000: { n:\"BOF\" },\n0x0001: { n:\"EOF\" },\n0x0002: { n:\"PASSWORD\" },\n0x0003: { n:\"CALCSET\" },\n0x0004: { n:\"WINDOWSET\" },\n0x0005: { n:\"SHEETCELLPTR\" },\n0x0006: { n:\"SHEETLAYOUT\" },\n0x0007: { n:\"COLUMNWIDTH\" },\n0x0008: { n:\"HIDDENCOLUMN\" },\n0x0009: { n:\"USERRANGE\" },\n0x000A: { n:\"SYSTEMRANGE\" },\n0x000B: { n:\"ZEROFORCE\" },\n0x000C: { n:\"SORTKEYDIR\" },\n0x000D: { n:\"FILESEAL\" },\n0x000E: { n:\"DATAFILLNUMS\" },\n0x000F: { n:\"PRINTMAIN\" },\n0x0010: { n:\"PRINTSTRING\" },\n0x0011: { n:\"GRAPHMAIN\" },\n0x0012: { n:\"GRAPHSTRING\" },\n0x0013: { n:\"??\" },\n0x0014: { n:\"ERRCELL\" },\n0x0015: { n:\"NACELL\" },\n0x0016: { n:\"LABEL16\", f:parse_LABEL_16},\n0x0017: { n:\"NUMBER17\", f:parse_NUMBER_17 },\n0x0018: { n:\"NUMBER18\", f:parse_NUMBER_18 },\n0x0019: { n:\"FORMULA19\", f:parse_FORMULA_19},\n0x001A: { n:\"FORMULA1A\" },\n0x001B: { n:\"XFORMAT\", f:parse_XFORMAT },\n0x001C: { n:\"DTLABELMISC\" },\n0x001D: { n:\"DTLABELCELL\" },\n0x001E: { n:\"GRAPHWINDOW\" },\n0x001F: { n:\"CPA\" },\n0x0020: { n:\"LPLAUTO\" },\n0x0021: { n:\"QUERY\" },\n0x0022: { n:\"HIDDENSHEET\" },\n0x0023: { n:\"??\" },\n0x0025: { n:\"NUMBER25\", f:parse_NUMBER_25 },\n0x0026: { n:\"??\" },\n0x0027: { n:\"NUMBER27\", f:parse_NUMBER_27 },\n0x0028: { n:\"FORMULA28\", f:parse_FORMULA_28 },\n0x008E: { n:\"??\" },\n0x0093: { n:\"??\" },\n0x0096: { n:\"??\" },\n0x0097: { n:\"??\" },\n0x0098: { n:\"??\" },\n0x0099: { n:\"??\" },\n0x009A: { n:\"??\" },\n0x009B: { n:\"??\" },\n0x009C: { n:\"??\" },\n0x00A3: { n:\"??\" },\n0x00AE: { n:\"??\" },\n0x00AF: { n:\"??\" },\n0x00B0: { n:\"??\" },\n0x00B1: { n:\"??\" },\n0x00B8: { n:\"??\" },\n0x00B9: { n:\"??\" },\n0x00BA: { n:\"??\" },\n0x00BB: { n:\"??\" },\n0x00BC: { n:\"??\" },\n0x00C3: { n:\"??\" },\n0x00C9: { n:\"??\" },\n0x00CC: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n0x00CD: { n:\"??\" },\n0x00CE: { n:\"??\" },\n0x00CF: { n:\"??\" },\n0x00D0: { n:\"??\" },\n0x0100: { n:\"??\" },\n0x0103: { n:\"??\" },\n0x0104: { n:\"??\" },\n0x0105: { n:\"??\" },\n0x0106: { n:\"??\" },\n0x0107: { n:\"??\" },\n0x0109: { n:\"??\" },\n0x010A: { n:\"??\" },\n0x010B: { n:\"??\" },\n0x010C: { n:\"??\" },\n0x010E: { n:\"??\" },\n0x010F: { n:\"??\" },\n0x0180: { n:\"??\" },\n0x0185: { n:\"??\" },\n0x0186: { n:\"??\" },\n0x0189: { n:\"??\" },\n0x018C: { n:\"??\" },\n0x0200: { n:\"??\" },\n0x0202: { n:\"??\" },\n0x0201: { n:\"??\" },\n0x0204: { n:\"??\" },\n0x0205: { n:\"??\" },\n0x0280: { n:\"??\" },\n0x0281: { n:\"??\" },\n0x0282: { n:\"??\" },\n0x0283: { n:\"??\" },\n0x0284: { n:\"??\" },\n0x0285: { n:\"??\" },\n0x0286: { n:\"??\" },\n0x0287: { n:\"??\" },\n0x0288: { n:\"??\" },\n0x0292: { n:\"??\" },\n0x0293: { n:\"??\" },\n0x0294: { n:\"??\" },\n0x0295: { n:\"??\" },\n0x0296: { n:\"??\" },\n0x0299: { n:\"??\" },\n0x029A: { n:\"??\" },\n0x0300: { n:\"??\" },\n0x0304: { n:\"??\" },\n0x0601: { n:\"SHEETINFOQP\", f:parse_SHEETINFOQP },\n0x0640: { n:\"??\" },\n0x0642: { n:\"??\" },\n0x0701: { n:\"??\" },\n0x0702: { n:\"??\" },\n0x0703: { n:\"??\" },\n0x0704: { n:\"??\" },\n0x0780: { n:\"??\" },\n0x0800: { n:\"??\" },\n0x0801: { n:\"??\" },\n0x0804: { n:\"??\" },\n0x0A80: { n:\"??\" },\n0x2AF6: { n:\"??\" },\n0x3231: { n:\"??\" },\n0x6E49: { n:\"??\" },\n0x6F44: { n:\"??\" },\n0xFFFF: { n:\"\" }\n\t};\n\n\t/* TODO: fill out and verify this table across QP versions */\n\tvar QPWNFTable = {\n0x05: \"dd-mmm-yy\",\n0x06: \"dd-mmm\",\n0x07: \"mmm-yy\",\n0x08: \"mm/dd/yy\", // Long Date Intl\n0x0A: \"hh:mm:ss AM/PM\",\n0x0B: \"hh:mm AM/PM\",\n0x0E: \"dd-mmm-yyyy\",\n0x0F: \"mmm-yyyy\",\n\n0x22: \"0.00\",\n0x32: \"0.00;[Red]0.00\",\n0x42: \"0.00;\\(0.00\\)\",\n0x52: \"0.00;[Red]\\(0.00\\)\",\n\n162: '\"$\"#,##0;\\\\(\"$\"#,##0\\\\)' // slightly different from SSF 5\n\t};\n\t/* QPW uses a different set of record types */\n\tfunction qpw_to_workbook_buf(d, opts) {\n\t\tprep_blob(d, 0);\n\t\tvar o = opts || {};\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar s = ({}); if(o.dense) s[\"!data\"] = [];\n\t\tvar SST = [], sname = \"\", formulae = [];\n\t\tvar range = {s:{r:-1,c:-1}, e:{r:-1,c:-1}};\n\t\tvar cnt = 0, type = 0, C = 0, R = 0;\n\t\tvar wb = { SheetNames: [], Sheets: {} };\n\t\tvar FMTS = [];\n\t\touter: while(d.l < d.length) {\n\t\t\tvar RT = d.read_shift(2), length = d.read_shift(2);\n\t\t\tvar p = d.slice(d.l, d.l + length);\n\t\t\tprep_blob(p, 0);\n\t\t\tswitch(RT) {\n\t\t\t\tcase 0x01: /* BOF */\n\t\t\t\t\tif(p.read_shift(4) != 0x39575051) throw \"Bad QPW9 BOF!\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x02: /* EOF */ break outer;\n\n\t\t\t\tcase 0x08: /* NF */ break; // TODO: this is tied to custom number formats\n\n\t\t\t\tcase 0x0A: /* FORMATS */ {\n\t\t\t\t\tvar fcnt = p.read_shift(4);\n\t\t\t\t\tvar step = ((p.length - p.l)/ fcnt)|0;\n\t\t\t\t\tfor(var ifmt = 0; ifmt < fcnt; ++ifmt) {\n\t\t\t\t\t\tvar end = p.l + step;\n\t\t\t\t\t\tvar fmt = {};\n\t\t\t\t\t\tp.l += 2;\n\t\t\t\t\t\tfmt.numFmtId = p.read_shift(2);\n\t\t\t\t\t\tif(QPWNFTable[fmt.numFmtId]) fmt.z = QPWNFTable[fmt.numFmtId];\n\t\t\t\t\t\tp.l = end;\n\t\t\t\t\t\tFMTS.push(fmt);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\n\t\t\t\t/* TODO: The behavior here should be consistent with Numbers: QP Notebook ~ .TN.SheetArchive, QP Sheet ~ .TST.TableModelArchive */\n\t\t\t\tcase 0x0401: /* BON */ break;\n\t\t\t\tcase 0x0402: /* EON */ /* TODO: backfill missing sheets based on BON cnt */ break;\n\n\t\t\t\tcase 0x0407: { /* SST */\n\t\t\t\t\tp.l += 12;\n\t\t\t\t\twhile(p.l < p.length) {\n\t\t\t\t\t\tcnt = p.read_shift(2);\n\t\t\t\t\t\ttype = p.read_shift(1);\n\t\t\t\t\t\tSST.push(p.read_shift(cnt, 'cstr'));\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0408: { /* FORMULAE */\n\t\t\t\t\t//p.l += 12;\n\t\t\t\t\t//while(p.l < p.length) {\n\t\t\t\t\t//\tcnt = p.read_shift(2);\n\t\t\t\t\t//\tformulae.push(p.slice(p.l, p.l + cnt + 1)); p.l += cnt + 1;\n\t\t\t\t\t//}\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0601: { /* BOS */\n\t\t\t\t\tvar sidx = p.read_shift(2);\n\t\t\t\t\ts = ({}); if(o.dense) s[\"!data\"] = [];\n\t\t\t\t\trange.s.c = p.read_shift(2);\n\t\t\t\t\trange.e.c = p.read_shift(2);\n\t\t\t\t\trange.s.r = p.read_shift(4);\n\t\t\t\t\trange.e.r = p.read_shift(4);\n\t\t\t\t\tp.l += 4;\n\t\t\t\t\tif(p.l + 2 < p.length) {\n\t\t\t\t\t\tcnt = p.read_shift(2);\n\t\t\t\t\t\ttype = p.read_shift(1);\n\t\t\t\t\t\tsname = cnt == 0 ? \"\" : p.read_shift(cnt, 'cstr');\n\t\t\t\t\t}\n\t\t\t\t\tif(!sname) sname = encode_col(sidx);\n\t\t\t\t\t/* TODO: backfill empty sheets */\n\t\t\t\t} break;\n\t\t\t\tcase 0x0602: { /* EOS */\n\t\t\t\t\t/* NOTE: QP valid range A1:IV1000000 */\n\t\t\t\t\tif(range.s.c > 0xFF || range.s.r > 999999) break;\n\t\t\t\t\tif(range.e.c < range.s.c) range.e.c = range.s.c;\n\t\t\t\t\tif(range.e.r < range.s.r) range.e.r = range.s.r;\n\t\t\t\t\ts[\"!ref\"] = encode_range(range);\n\t\t\t\t\tbook_append_sheet(wb, s, sname); // TODO: a barrel roll\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0A01: { /* COL (like XLS Row, modulo the layout transposition) */\n\t\t\t\t\tC = p.read_shift(2);\n\t\t\t\t\tif(range.e.c < C) range.e.c = C;\n\t\t\t\t\tif(range.s.c > C) range.s.c = C;\n\t\t\t\t\tR = p.read_shift(4);\n\t\t\t\t\tif(range.s.r > R) range.s.r = R;\n\t\t\t\t\tR = p.read_shift(4);\n\t\t\t\t\tif(range.e.r < R) range.e.r = R;\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0C01: { /* MulCells (like XLS MulRK, but takes advantage of common column data patterns) */\n\t\t\t\t\tR = p.read_shift(4), cnt = p.read_shift(4);\n\t\t\t\t\tif(range.s.r > R) range.s.r = R;\n\t\t\t\t\tif(range.e.r < R + cnt - 1) range.e.r = R + cnt - 1;\n\t\t\t\t\tvar CC = encode_col(C);\n\t\t\t\t\twhile(p.l < p.length) {\n\t\t\t\t\t\tvar cell = { t: \"z\" };\n\t\t\t\t\t\tvar flags = p.read_shift(1), fmtidx = -1;\n\t\t\t\t\t\tif(flags & 0x80) fmtidx = p.read_shift(2);\n\t\t\t\t\t\tvar mul = (flags & 0x40) ? p.read_shift(2) - 1: 0;\n\t\t\t\t\t\tswitch(flags & 0x1F) {\n\t\t\t\t\t\t\tcase 0: break;\n\t\t\t\t\t\t\tcase 1: break;\n\t\t\t\t\t\t\tcase 2: cell = { t: \"n\", v: p.read_shift(2) }; break;\n\t\t\t\t\t\t\tcase 3: cell = { t: \"n\", v: p.read_shift(2, 'i') }; break;\n\t\t\t\t\t\t\tcase 4: cell = { t: \"n\", v: parse_RkNumber(p) }; break;\n\t\t\t\t\t\t\tcase 5: cell = { t: \"n\", v: p.read_shift(8, 'f') }; break;\n\t\t\t\t\t\t\tcase 7: cell = { t: \"s\", v: SST[type = p.read_shift(4) - 1] }; break;\n\t\t\t\t\t\t\tcase 8: cell = { t: \"n\", v: p.read_shift(8, 'f') }; p.l += 2; /* cell.f = formulae[p.read_shift(4)]; */ p.l += 4; break;\n\t\t\t\t\t\t\tdefault: throw \"Unrecognized QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(fmtidx != -1 && (FMTS[fmtidx - 1]||{}).z) cell.z = FMTS[fmtidx-1].z;\n\t\t\t\t\t\tvar delta = 0;\n\t\t\t\t\t\tif(flags & 0x20) switch(flags & 0x1F) {\n\t\t\t\t\t\t\tcase 2: delta = p.read_shift(2); break;\n\t\t\t\t\t\t\tcase 3: delta = p.read_shift(2, 'i'); break;\n\t\t\t\t\t\t\tcase 7: delta = p.read_shift(2); break;\n\t\t\t\t\t\t\tdefault: throw \"Unsupported delta for QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!(!o.sheetStubs && cell.t == \"z\")) {\n\t\t\t\t\t\t\tvar newcell = dup(cell);\n\t\t\t\t\t\t\tif(cell.t == \"n\" && cell.z && fmt_is_date(cell.z) && o.cellDates) {\n\t\t\t\t\t\t\t\tnewcell.v = numdate(cell.v); newcell.t = typeof newcell.v == \"number\" ? 'n' : 'd';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(s[\"!data\"] != null) {\n\t\t\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\t\t\ts[\"!data\"][R][C] = newcell;\n\t\t\t\t\t\t\t} else s[CC + encode_row(R)] = newcell;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++R; --cnt;\n\t\t\t\t\t\twhile(mul-- > 0 && cnt >= 0) {\n\t\t\t\t\t\t\tif(flags & 0x20) switch(flags & 0x1F) {\n\t\t\t\t\t\t\t\tcase 2: cell = { t: \"n\", v: (cell.v + delta) & 0xFFFF }; break;\n\t\t\t\t\t\t\t\tcase 3: cell = { t: \"n\", v: (cell.v + delta) & 0xFFFF }; if(cell.v > 0x7FFF) cell.v -= 0x10000; break;\n\t\t\t\t\t\t\t\tcase 7: cell = { t: \"s\", v: SST[type = (type + delta) >>> 0] }; break;\n\t\t\t\t\t\t\t\tdefault: throw \"Cannot apply delta for QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t\t} else switch(flags & 0x1F) {\n\t\t\t\t\t\t\t\tcase 1: cell = { t: \"z\" }; break;\n\t\t\t\t\t\t\t\tcase 2: cell = { t: \"n\", v: p.read_shift(2) }; break;\n\t\t\t\t\t\t\t\tcase 7: cell = { t: \"s\", v: SST[type = p.read_shift(4) - 1] }; break;\n\t\t\t\t\t\t\t\tdefault: throw \"Cannot apply repeat for QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(fmtidx != -1);\n\t\t\t\t\t\t\tif(!(!o.sheetStubs && cell.t == \"z\")) {\n\t\t\t\t\t\t\t\tif(s[\"!data\"] != null) {\n\t\t\t\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\t\t\t\ts[\"!data\"][R][C] = cell;\n\t\t\t\t\t\t\t\t} else s[CC + encode_row(R)] = cell;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t++R; --cnt;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} break;\n\n\t\t\t\tdefault: break;\n\t\t\t}\n\t\t\td.l += length;\n\t\t}\n\t\treturn wb;\n\t}\n\n\treturn {\n\t\tsheet_to_wk1: sheet_to_wk1,\n\t\tbook_to_wk3: book_to_wk3,\n\t\tto_workbook: lotus_to_workbook\n\t};\n})();\n/* 18.4.7 rPr CT_RPrElt */\nfunction parse_rpr(rpr) {\n\tvar font = {}, m = rpr.match(tagregex), i = 0;\n\tvar pass = false;\n\tif(m) for(;i!=m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(y[0].replace(/\\w*:/g,\"\")) {\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<condense': break;\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<extend': break;\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<shadow':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<shadow>':\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\t\t\tcase '</shadow>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty TODO */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\tfont.cp = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.4.2 outline CT_BooleanProperty TODO */\n\t\t\tcase '<outline':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<outline>':\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\t\t\tcase '</outline>': break;\n\n\t\t\t/* 18.4.5 rFont CT_FontName */\n\t\t\tcase '<rFont': font.name = y.val; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': font.sz = y.val; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<strike>':\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\t\t\tcase '</strike>': break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tif(!y.val) break;\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase 'double': font.uval = \"double\"; break;\n\t\t\t\t\tcase 'singleAccounting': font.uval = \"single-accounting\"; break;\n\t\t\t\t\tcase 'doubleAccounting': font.uval = \"double-accounting\"; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '<u>':\n\t\t\tcase '<u/>': font.u = 1; break;\n\t\t\tcase '</u>': break;\n\n\t\t\t/* 18.8.2 b */\n\t\t\tcase '<b':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<b>':\n\t\t\tcase '<b/>': font.b = 1; break;\n\t\t\tcase '</b>': break;\n\n\t\t\t/* 18.8.26 i */\n\t\t\tcase '<i':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<i>':\n\t\t\tcase '<i/>': font.i = 1; break;\n\t\t\tcase '</i>': break;\n\n\t\t\t/* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\t\t\tcase '<color':\n\t\t\t\tif(y.rgb) font.color = y.rgb.slice(2,8);\n\t\t\t\tbreak;\n\t\t\tcase '<color>': case '<color/>': case '</color>': break;\n\n\t\t\t/* 18.8.18 family ST_FontFamily */\n\t\t\tcase '<family': font.family = y.val; break;\n\t\t\tcase '<family>': case '<family/>': case '</family>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\t\t\tcase '<vertAlign': font.valign = y.val; break;\n\t\t\tcase '<vertAlign>': case '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme TODO */\n\t\t\tcase '<scheme': break;\n\t\t\tcase '<scheme>': case '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault:\n\t\t\t\tif(y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n\t\t}\n\t}\n\treturn font;\n}\n\nvar parse_rs = (function() {\n\tvar tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\");\n\t/* 18.4.4 r CT_RElt */\n\tfunction parse_r(r) {\n\t\t/* 18.4.12 t ST_Xstring */\n\t\tvar t = r.match(tregex)/*, cp = 65001*/;\n\t\tif(!t) return {t:\"s\", v:\"\"};\n\n\t\tvar o = ({t:'s', v:unescapexml(t[1])});\n\t\tvar rpr = r.match(rpregex);\n\t\tif(rpr) o.s = parse_rpr(rpr[1]);\n\t\treturn o;\n\t}\n\tvar rregex = /<(?:\\w+:)?r>/g, rend = /<\\/(?:\\w+:)?r>/;\n\treturn function parse_rs(rs) {\n\t\treturn rs.replace(rregex,\"\").split(rend).map(parse_r).filter(function(r) { return r.v; });\n\t};\n})();\n\n\n/* Parse a list of <r> tags */\nvar rs_to_html = (function parse_rs_factory() {\n\tvar nlregex = /(\\r\\n|\\n)/g;\n\tfunction parse_rpr2(font, intro, outro) {\n\t\tvar style = [];\n\n\t\tif(font.u) style.push(\"text-decoration: underline;\");\n\t\tif(font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n\t\tif(font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n\t\tif(font.outline) style.push(\"text-effect: outline;\");\n\t\tif(font.shadow) style.push(\"text-shadow: auto;\");\n\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\n\n\t\tif(font.b) { intro.push(\"<b>\"); outro.push(\"</b>\"); }\n\t\tif(font.i) { intro.push(\"<i>\"); outro.push(\"</i>\"); }\n\t\tif(font.strike) { intro.push(\"<s>\"); outro.push(\"</s>\"); }\n\n\t\tvar align = font.valign || \"\";\n\t\tif(align == \"superscript\" || align == \"super\") align = \"sup\";\n\t\telse if(align == \"subscript\") align = \"sub\";\n\t\tif(align != \"\") { intro.push(\"<\" + align + \">\"); outro.push(\"</\" + align + \">\"); }\n\n\t\toutro.push(\"</span>\");\n\t\treturn font;\n\t}\n\n\t/* 18.4.4 r CT_RElt */\n\tfunction r_to_html(r) {\n\t\tvar terms = [[],r.v,[]];\n\t\tif(!r.v) return \"\";\n\n\t\tif(r.s) parse_rpr2(r.s, terms[0], terms[2]);\n\n\t\treturn terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\n\t}\n\n\treturn function parse_rs(rs) {\n\t\treturn rs.map(r_to_html).join(\"\");\n\t};\n})();\n\n/* 18.4.8 si CT_Rst */\nvar sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g, sirregex = /<(?:\\w+:)?r\\b[^>]*>/;\nvar sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\nfunction parse_si(x, opts) {\n\tvar html = opts ? opts.cellHTML : true;\n\tvar z = {};\n\tif(!x) return { t: \"\" };\n\t//var y;\n\t/* 18.4.12 t ST_Xstring (Plaintext String) */\n\t// TODO: is whitespace actually valid here?\n\tif(x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n\t\tz.t = unescapexml(utf8read(x.slice(x.indexOf(\">\")+1).split(/<\\/(?:\\w+:)?t>/)[0]||\"\"), true);\n\t\tz.r = utf8read(x);\n\t\tif(html) z.h = escapehtml(z.t);\n\t}\n\t/* 18.4.4 r CT_RElt (Rich Text Run) */\n\telse if((/*y = */x.match(sirregex))) {\n\t\tz.r = utf8read(x);\n\t\tz.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex)||[]).join(\"\").replace(tagregex,\"\")), true);\n\t\tif(html) z.h = rs_to_html(parse_rs(z.r));\n\t}\n\t/* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\t/* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\treturn z;\n}\n\n/* 18.4 Shared String Table */\nvar sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\nvar sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\nfunction parse_sst_xml(data, opts) {\n\tvar s = ([]), ss = \"\";\n\tif(!data) return s;\n\t/* 18.4.9 sst CT_Sst */\n\tvar sst = data.match(sstr0);\n\tif(sst) {\n\t\tss = sst[2].replace(sstr1,\"\").split(sstr2);\n\t\tfor(var i = 0; i != ss.length; ++i) {\n\t\t\tvar o = parse_si(ss[i].trim(), opts);\n\t\t\tif(o != null) s[s.length] = o;\n\t\t}\n\t\tsst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\n\t}\n\treturn s;\n}\n\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\nfunction write_sst_xml(sst, opts) {\n\tif(!opts.bookSST) return \"\";\n\tvar o = [XML_HEADER];\n\to[o.length] = (writextag('sst', null, {\n\t\txmlns: XMLNS_main[0],\n\t\tcount: sst.Count,\n\t\tuniqueCount: sst.Unique\n\t}));\n\tfor(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\n\t\tvar s = sst[i];\n\t\tvar sitag = \"<si>\";\n\t\tif(s.r) sitag += s.r;\n\t\telse {\n\t\t\tsitag += \"<t\";\n\t\t\tif(!s.t) s.t = \"\";\n\t\t\tif(typeof s.t !== \"string\") s.t = String(s.t);\n\t\t\tif(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\n\t\t}\n\t\tsitag += \"</si>\";\n\t\to[o.length] = (sitag);\n\t}\n\tif(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.221 BrtBeginSst */\nfunction parse_BrtBeginSst(data) {\n\treturn [data.read_shift(4), data.read_shift(4)];\n}\n\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\nfunction parse_sst_bin(data, opts) {\n\tvar s = ([]);\n\tvar pass = false;\n\trecordhopper(data, function hopper_sst(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009F: /* BrtBeginSst */\n\t\t\t\ts.Count = val[0]; s.Unique = val[1]; break;\n\t\t\tcase 0x0013: /* BrtSSTItem */\n\t\t\t\ts.push(val); break;\n\t\t\tcase 0x00A0: /* BrtEndSst */\n\t\t\t\treturn true;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){}\n\t\t\t\tif(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn s;\n}\n\nfunction write_BrtBeginSst(sst, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(4, sst.Count);\n\to.write_shift(4, sst.Unique);\n\treturn o;\n}\n\nvar write_BrtSSTItem = write_RichStr;\n\nfunction write_sst_bin(sst) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x009F /* BrtBeginSst */, write_BrtBeginSst(sst));\n\tfor(var i = 0; i < sst.length; ++i) write_record(ba, 0x0013 /* BrtSSTItem */, write_BrtSSTItem(sst[i]));\n\t/* FRTSST */\n\twrite_record(ba, 0x00A0 /* BrtEndSst */);\n\treturn ba.end();\n}\nfunction _JS2ANSI(str) {\n\tif(typeof $cptable !== 'undefined') return $cptable.utils.encode(current_ansi, str);\n\tvar o = [], oo = str.split(\"\");\n\tfor(var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.4 Version */\nfunction parse_CRYPTOVersion(blob, length) {\n\tvar o = {};\n\to.Major = blob.read_shift(2);\n\to.Minor = blob.read_shift(2);\nif(length >= 4) blob.l += length - 4;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\nfunction parse_DataSpaceVersionInfo(blob) {\n\tvar o = {};\n\to.id = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\nfunction parse_DataSpaceMapEntry(blob) {\n\tvar len = blob.read_shift(4);\n\tvar end = blob.l + len - 4;\n\tvar o = {};\n\tvar cnt = blob.read_shift(4);\n\tvar comps = [];\n\t/* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n\twhile(cnt-- > 0) comps.push({ t: blob.read_shift(4), v: blob.read_shift(0, 'lpp4') });\n\to.name = blob.read_shift(0, 'lpp4');\n\to.comps = comps;\n\tif(blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\nfunction parse_DataSpaceMap(blob) {\n\tvar o = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\nfunction parse_DataSpaceDefinition(blob) {\n\tvar o = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\nfunction parse_TransformInfoHeader(blob) {\n\tvar o = {};\n\t/*var len = */blob.read_shift(4);\n\tblob.l += 4; // must be 0x1\n\to.id = blob.read_shift(0, 'lpp4');\n\to.name = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\nfunction parse_Primary(blob) {\n\t/* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n\tvar hdr = parse_TransformInfoHeader(blob);\n\t/* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n\thdr.ename = blob.read_shift(0, '8lpp4');\n\thdr.blksz = blob.read_shift(4);\n\thdr.cmode = blob.read_shift(4);\n\tif(blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n\treturn hdr;\n}\n\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\nfunction parse_EncryptionHeader(blob, length) {\n\tvar tgt = blob.l + length;\n\tvar o = {};\n\to.Flags = (blob.read_shift(4) & 0x3F);\n\tblob.l += 4;\n\to.AlgID = blob.read_shift(4);\n\tvar valid = false;\n\tswitch(o.AlgID) {\n\t\tcase 0x660E: case 0x660F: case 0x6610: valid = (o.Flags == 0x24); break;\n\t\tcase 0x6801: valid = (o.Flags == 0x04); break;\n\t\tcase 0: valid = (o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24); break;\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n\t}\n\tif(!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n\to.AlgIDHash = blob.read_shift(4);\n\to.KeySize = blob.read_shift(4);\n\to.ProviderType = blob.read_shift(4);\n\tblob.l += 8;\n\to.CSPName = blob.read_shift((tgt-blob.l)>>1, 'utf16le');\n\tblob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\nfunction parse_EncryptionVerifier(blob, length) {\n\tvar o = {}, tgt = blob.l + length;\n\tblob.l += 4; // SaltSize must be 0x10\n\to.Salt = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\to.Verifier = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\t/*var sz = */blob.read_shift(4);\n\to.VerifierHash = blob.slice(blob.l, tgt); blob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\nfunction parse_EncryptionInfo(blob) {\n\tvar vers = parse_CRYPTOVersion(blob);\n\tswitch(vers.Minor) {\n\t\tcase 0x02: return [vers.Minor, parse_EncInfoStd(blob, vers)];\n\t\tcase 0x03: return [vers.Minor, parse_EncInfoExt(blob, vers)];\n\t\tcase 0x04: return [vers.Minor, parse_EncInfoAgl(blob, vers)];\n\t}\n\tthrow new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\nfunction parse_EncInfoStd(blob) {\n\tvar flags = blob.read_shift(4);\n\tif((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n\tvar sz = blob.read_shift(4);\n\t//var tgt = blob.l + sz;\n\tvar hdr = parse_EncryptionHeader(blob, sz);\n\tvar verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n\treturn { t:\"Std\", h:hdr, v:verifier };\n}\n/* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\nfunction parse_EncInfoExt() { throw new Error(\"File is password-protected: ECMA-376 Extensible\"); }\n/* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\nfunction parse_EncInfoAgl(blob) {\n\tvar KeyData = [\"saltSize\",\"blockSize\",\"keyBits\",\"hashSize\",\"cipherAlgorithm\",\"cipherChaining\",\"hashAlgorithm\",\"saltValue\"];\n\tblob.l+=4;\n\tvar xml = blob.read_shift(blob.length - blob.l, 'utf8');\n\tvar o = {};\n\txml.replace(tagregex, function xml_agile(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<encryption': case '</encryption>': break;\n\t\t\tcase '<keyData': KeyData.forEach(function(k) { o[k] = y[k]; }); break;\n\t\t\tcase '<dataIntegrity': o.encryptedHmacKey = y.encryptedHmacKey; o.encryptedHmacValue = y.encryptedHmacValue; break;\n\t\t\tcase '<keyEncryptors>': case '<keyEncryptors': o.encs = []; break;\n\t\t\tcase '</keyEncryptors>': break;\n\n\t\t\tcase '<keyEncryptor': o.uri = y.uri; break;\n\t\t\tcase '</keyEncryptor>': break;\n\t\t\tcase '<encryptedKey': o.encs.push(y); break;\n\t\t\tdefault: throw y[0];\n\t\t}\n\t});\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\nfunction parse_RC4CryptoHeader(blob, length) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4); length -= 4;\n\tif(vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n\tif(vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n\to.Flags = blob.read_shift(4); length -= 4;\n\tvar sz = blob.read_shift(4); length -= 4;\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\nfunction parse_RC4Header(blob) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n\to.Salt = blob.read_shift(16);\n\to.EncryptedVerifier = blob.read_shift(16);\n\to.EncryptedVerifierHash = blob.read_shift(16);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\nfunction crypto_CreatePasswordVerifier_Method1(Password) {\n\tvar Verifier = 0x0000, PasswordArray;\n\tvar PasswordDecoded = _JS2ANSI(Password);\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\n\tvar Intermediate1, Intermediate2, Intermediate3;\n\tPasswordArray = new_raw_buf(len);\n\tPasswordArray[0] = PasswordDecoded.length;\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\n\tfor(i = len-1; i >= 0; --i) {\n\t\tPasswordByte = PasswordArray[i];\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\n\t\tVerifier = Intermediate3 ^ PasswordByte;\n\t}\n\treturn Verifier ^ 0xCE4B;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\nvar crypto_CreateXorArray_Method1 = (function() {\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\n\tvar CreateXorKey_Method1 = function(Password) {\n\t\tvar XorKey = InitialCode[Password.length - 1];\n\t\tvar CurrentElement = 0x68;\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\n\t\t\tvar Char = Password[i];\n\t\t\tfor(var j = 0; j != 7; ++j) {\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n\t\t\t\tChar *= 2; --CurrentElement;\n\t\t\t}\n\t\t}\n\t\treturn XorKey;\n\t};\n\treturn function(password) {\n\t\tvar Password = _JS2ANSI(password);\n\t\tvar XorKey = CreateXorKey_Method1(Password);\n\t\tvar Index = Password.length;\n\t\tvar ObfuscationArray = new_raw_buf(16);\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\t\tvar Temp, PasswordLastChar, PadIndex;\n\t\tif((Index & 1) === 1) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tPasswordLastChar = Password[Password.length - 1];\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n\t\t}\n\t\twhile(Index > 0) {\n\t\t\t--Index;\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t}\n\t\tIndex = 15;\n\t\tPadIndex = 15 - Password.length;\n\t\twhile(PadIndex > 0) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t}\n\t\treturn ObfuscationArray;\n\t};\n})();\n\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\nvar crypto_DecryptData_Method1 = function(password, Data, XorArrayIndex, XorArray, O) {\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\n\tif(!O) O = Data;\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n\tvar Index, Value;\n\tfor(Index = 0; Index != Data.length; ++Index) {\n\t\tValue = Data[Index];\n\t\tValue ^= XorArray[XorArrayIndex];\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\n\t\tO[Index] = Value;\n\t\t++XorArrayIndex;\n\t}\n\treturn [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function(password) {\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\n\treturn function(Data) {\n\t\tvar O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n\t\tXorArrayIndex = O[1];\n\t\treturn O[0];\n\t};\n};\n\n/* 2.5.343 */\nfunction parse_XORObfuscation(blob, length, opts, out) {\n\tvar o = ({ key: parseuint16(blob), verificationBytes: parseuint16(blob) });\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n\tout.valid = o.verificationBytes === o.verifier;\n\tif(out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n\treturn o;\n}\n\n/* 2.4.117 */\nfunction parse_FilePassHeader(blob, length, oo) {\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\n\treturn o;\n}\nfunction parse_FilePass(blob, length, opts) {\n\tvar o = ({ Type: opts.biff >= 8 ? blob.read_shift(2) : 0 }); /* wEncryptionType */\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\n\telse parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n\treturn o;\n}\n\n\nfunction rtf_to_sheet(d, opts) {\n  switch (opts.type) {\n    case \"base64\":\n      return rtf_to_sheet_str(Base64_decode(d), opts);\n    case \"binary\":\n      return rtf_to_sheet_str(d, opts);\n    case \"buffer\":\n      return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString(\"binary\") : a2s(d), opts);\n    case \"array\":\n      return rtf_to_sheet_str(cc2str(d), opts);\n  }\n  throw new Error(\"Unrecognized type \" + opts.type);\n}\nfunction rtf_to_sheet_str(str, opts) {\n  var o = opts || {};\n  var ws = {};\n  var dense = o.dense;\n  if (dense)\n    ws[\"!data\"] = [];\n  var rows = str.match(/\\\\trowd[\\s\\S]*?\\\\row\\b/g);\n  if (!rows)\n    throw new Error(\"RTF missing table\");\n  var range = { s: { c: 0, r: 0 }, e: { c: 0, r: rows.length - 1 } };\n  var row = [];\n  rows.forEach(function(rowtf, R) {\n    if (dense)\n      row = ws[\"!data\"][R] = [];\n    var rtfre = /\\\\[\\w\\-]+\\b/g;\n    var last_index = 0;\n    var res;\n    var C = -1;\n    var payload = [];\n    while ((res = rtfre.exec(rowtf)) != null) {\n      var data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n      if (data.charCodeAt(0) == 32)\n        data = data.slice(1);\n      if (data.length)\n        payload.push(data);\n      switch (res[0]) {\n        case \"\\\\cell\":\n          ++C;\n          if (payload.length) {\n            var cell = { v: payload.join(\"\"), t: \"s\" };\n            if (cell.v == \"TRUE\" || cell.v == \"FALSE\") {\n              cell.v = cell.v == \"TRUE\";\n              cell.t = \"b\";\n            } else if (!isNaN(fuzzynum(cell.v))) {\n              cell.t = \"n\";\n              if (o.cellText !== false)\n                cell.w = cell.v;\n              cell.v = fuzzynum(cell.v);\n            }\n            if (dense)\n              row[C] = cell;\n            else\n              ws[encode_cell({ r: R, c: C })] = cell;\n          }\n          payload = [];\n          break;\n        case \"\\\\par\":\n          payload.push(\"\\n\");\n          break;\n      }\n      last_index = rtfre.lastIndex;\n    }\n    if (C > range.e.c)\n      range.e.c = C;\n  });\n  ws[\"!ref\"] = encode_range(range);\n  return ws;\n}\nfunction rtf_to_workbook(d, opts) {\n  var wb = sheet_to_workbook(rtf_to_sheet(d, opts), opts);\n  wb.bookType = \"rtf\";\n  return wb;\n}\nfunction sheet_to_rtf(ws, opts) {\n  var o = [\"{\\\\rtf1\\\\ansi\"];\n  if (!ws[\"!ref\"])\n    return o[0] + \"}\";\n  var r = safe_decode_range(ws[\"!ref\"]), cell;\n  var dense = ws[\"!data\"] != null, row = [];\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    o.push(\"\\\\trowd\\\\trautofit1\");\n    for (var C = r.s.c; C <= r.e.c; ++C)\n      o.push(\"\\\\cellx\" + (C + 1));\n    o.push(\"\\\\pard\\\\intbl\");\n    if (dense)\n      row = ws[\"!data\"][R] || [];\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      var coord = encode_cell({ r: R, c: C });\n      cell = dense ? row[C] : ws[coord];\n      if (!cell || cell.v == null && (!cell.f || cell.F)) {\n        o.push(\" \\\\cell\");\n        continue;\n      }\n      o.push(\" \" + (cell.w || (format_cell(cell), cell.w) || \"\").replace(/[\\r\\n]/g, \"\\\\par \"));\n      o.push(\"\\\\cell\");\n    }\n    o.push(\"\\\\pard\\\\intbl\\\\row\");\n  }\n  return o.join(\"\") + \"}\";\n}\nfunction hex2RGB(h) {\n\tvar o = h.slice(h[0]===\"#\"?1:0).slice(0,6);\n\treturn [parseInt(o.slice(0,2),16),parseInt(o.slice(2,4),16),parseInt(o.slice(4,6),16)];\n}\nfunction rgb2Hex(rgb) {\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\n\treturn o.toString(16).toUpperCase().slice(1);\n}\n\nfunction rgb2HSL(rgb) {\n\tvar R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\n\tvar M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\n\tif(C === 0) return [0, 0, R];\n\n\tvar H6 = 0, S = 0, L2 = (M + m);\n\tS = C / (L2 > 1 ? 2 - L2 : L2);\n\tswitch(M){\n\t\tcase R: H6 = ((G - B) / C + 6)%6; break;\n\t\tcase G: H6 = ((B - R) / C + 2); break;\n\t\tcase B: H6 = ((R - G) / C + 4); break;\n\t}\n\treturn [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl){\n\tvar H = hsl[0], S = hsl[1], L = hsl[2];\n\tvar C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\n\tvar rgb = [m,m,m], h6 = 6*H;\n\n\tvar X;\n\tif(S !== 0) switch(h6|0) {\n\t\tcase 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\n\t\tcase 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\n\t\tcase 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\n\t\tcase 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\n\t\tcase 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\n\t\tcase 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\n\t}\n\tfor(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\n\treturn rgb;\n}\n\n/* 18.8.3 bgColor tint algorithm */\nfunction rgb_tint(hex, tint) {\n\tif(tint === 0) return hex;\n\tvar hsl = rgb2HSL(hex2RGB(hex));\n\tif (tint < 0) hsl[2] = hsl[2] * (1 + tint);\n\telse hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n\treturn rgb2Hex(hsl2RGB(hsl));\n}\n\n/* 18.3.1.13 width calculations */\n/* [MS-OI29500] 2.1.595 Column Width & Formatting */\nvar DEF_MDW = 6, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\nfunction width2px(width) { return Math.floor(( width + (Math.round(128/MDW))/256 )* MDW ); }\nfunction px2char(px) { return (Math.floor((px - 5)/MDW * 100 + 0.5))/100; }\nfunction char2width(chr) { return (Math.round((chr * MDW + 5)/MDW*256))/256; }\n//function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\nfunction cycle_width(collw) { return char2width(px2char(width2px(collw))); }\n/* XLSX/XLSB/XLS specify width in units of MDW */\nfunction find_mdw_colw(collw) {\n\tvar delta = Math.abs(collw - cycle_width(collw)), _MDW = MDW;\n\tif(delta > 0.005) for(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) if(Math.abs(collw - cycle_width(collw)) <= delta) { delta = Math.abs(collw - cycle_width(collw)); _MDW = MDW; }\n\tMDW = _MDW;\n}\n/* XLML specifies width in terms of pixels */\n/*function find_mdw_wpx(wpx) {\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n\t\tguess = char2width_(px2char_(wpx))*256;\n\t\tguess = (guess) % 1;\n\t\tif(guess > 0.5) guess--;\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n\t}\n\tMDW = _MDW;\n}*/\n\nfunction process_col(coll) {\n\tif(coll.width) {\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.MDW = MDW;\n\t} else if(coll.wpx) {\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.MDW = MDW;\n\t} else if(typeof coll.wch == 'number') {\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.MDW = MDW;\n\t}\n\tif(coll.customWidth) delete coll.customWidth;\n}\n\nvar DEF_PPI = 96, PPI = DEF_PPI;\nfunction px2pt(px) { return px * 96 / PPI; }\nfunction pt2px(pt) { return pt * PPI / 96; }\n\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\nvar XLMLPatternTypeMap = {\n\t\"None\": \"none\",\n\t\"Solid\": \"solid\",\n\t\"Gray50\": \"mediumGray\",\n\t\"Gray75\": \"darkGray\",\n\t\"Gray25\": \"lightGray\",\n\t\"HorzStripe\": \"darkHorizontal\",\n\t\"VertStripe\": \"darkVertical\",\n\t\"ReverseDiagStripe\": \"darkDown\",\n\t\"DiagStripe\": \"darkUp\",\n\t\"DiagCross\": \"darkGrid\",\n\t\"ThickDiagCross\": \"darkTrellis\",\n\t\"ThinHorzStripe\": \"lightHorizontal\",\n\t\"ThinVertStripe\": \"lightVertical\",\n\t\"ThinReverseDiagStripe\": \"lightDown\",\n\t\"ThinHorzCross\": \"lightGrid\"\n};\n\n/* 18.8.5 borders CT_Borders */\nfunction parse_borders(t, styles, themes, opts) {\n\tstyles.Borders = [];\n\tvar border = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<borders': case '<borders>': case '</borders>': break;\n\n\t\t\t/* 18.8.4 border CT_Border */\n\t\t\tcase '<border': case '<border>': case '<border/>':\n\t\t\t\tborder = {};\n\t\t\t\tif(y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n\t\t\t\tif(y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n\t\t\t\tstyles.Borders.push(border);\n\t\t\t\tbreak;\n\t\t\tcase '</border>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<left/>': break;\n\t\t\tcase '<left': case '<left>': break;\n\t\t\tcase '</left>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<right/>': break;\n\t\t\tcase '<right': case '<right>': break;\n\t\t\tcase '</right>': break;\n\n\t\t\t/* 18.8.43 top CT_BorderPr */\n\t\t\tcase '<top/>': break;\n\t\t\tcase '<top': case '<top>': break;\n\t\t\tcase '</top>': break;\n\n\t\t\t/* 18.8.6 bottom CT_BorderPr */\n\t\t\tcase '<bottom/>': break;\n\t\t\tcase '<bottom': case '<bottom>': break;\n\t\t\tcase '</bottom>': break;\n\n\t\t\t/* 18.8.13 diagonal CT_BorderPr */\n\t\t\tcase '<diagonal': case '<diagonal>': case '<diagonal/>': break;\n\t\t\tcase '</diagonal>': break;\n\n\t\t\t/* 18.8.25 horizontal CT_BorderPr */\n\t\t\tcase '<horizontal': case '<horizontal>': case '<horizontal/>': break;\n\t\t\tcase '</horizontal>': break;\n\n\t\t\t/* 18.8.44 vertical CT_BorderPr */\n\t\t\tcase '<vertical': case '<vertical>': case '<vertical/>': break;\n\t\t\tcase '</vertical>': break;\n\n\t\t\t/* 18.8.37 start CT_BorderPr */\n\t\t\tcase '<start': case '<start>': case '<start/>': break;\n\t\t\tcase '</start>': break;\n\n\t\t\t/* 18.8.16 end CT_BorderPr */\n\t\t\tcase '<end': case '<end>': case '<end/>': break;\n\t\t\tcase '</end>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color>':\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.21 fills CT_Fills */\nfunction parse_fills(t, styles, themes, opts) {\n\tstyles.Fills = [];\n\tvar fill = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fills': case '<fills>': case '</fills>': break;\n\n\t\t\t/* 18.8.20 fill CT_Fill */\n\t\t\tcase '<fill>': case '<fill': case '<fill/>':\n\t\t\t\tfill = {}; styles.Fills.push(fill); break;\n\t\t\tcase '</fill>': break;\n\n\t\t\t/* 18.8.24 gradientFill CT_GradientFill */\n\t\t\tcase '<gradientFill>': break;\n\t\t\tcase '<gradientFill':\n\t\t\tcase '</gradientFill>': styles.Fills.push(fill); fill = {}; break;\n\n\t\t\t/* 18.8.32 patternFill CT_PatternFill */\n\t\t\tcase '<patternFill': case '<patternFill>':\n\t\t\t\tif(y.patternType) fill.patternType = y.patternType;\n\t\t\t\tbreak;\n\t\t\tcase '<patternFill/>': case '</patternFill>': break;\n\n\t\t\t/* 18.8.3 bgColor CT_Color */\n\t\t\tcase '<bgColor':\n\t\t\t\tif(!fill.bgColor) fill.bgColor = {};\n\t\t\t\tif(y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n\t\t\t\tif(y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<bgColor/>': case '</bgColor>': break;\n\n\t\t\t/* 18.8.19 fgColor CT_Color */\n\t\t\tcase '<fgColor':\n\t\t\t\tif(!fill.fgColor) fill.fgColor = {};\n\t\t\t\tif(y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<fgColor/>': case '</fgColor>': break;\n\n\t\t\t/* 18.8.38 stop CT_GradientStop */\n\t\t\tcase '<stop': case '<stop/>': break;\n\t\t\tcase '</stop>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color/>': break;\n\t\t\tcase '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.23 fonts CT_Fonts */\nfunction parse_fonts(t, styles, themes, opts) {\n\tstyles.Fonts = [];\n\tvar font = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fonts': case '<fonts>': case '</fonts>': break;\n\n\t\t\t/* 18.8.22 font CT_Font */\n\t\t\tcase '<font': case '<font>': break;\n\t\t\tcase '</font>': case '<font/>':\n\t\t\t\tstyles.Fonts.push(font);\n\t\t\t\tfont = {};\n\t\t\t\tbreak;\n\n\t\t\t/* 18.8.29 name CT_FontName */\n\t\t\tcase '<name': if(y.val) font.name = utf8read(y.val); break;\n\t\t\tcase '<name/>': case '</name>': break;\n\n\t\t\t/* 18.8.2  b CT_BooleanProperty */\n\t\t\tcase '<b': font.bold = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<b/>': font.bold = 1; break;\n\n\t\t\t/* 18.8.26 i CT_BooleanProperty */\n\t\t\tcase '<i': font.italic = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<i/>': font.italic = 1; break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase \"none\": font.underline = 0x00; break;\n\t\t\t\t\tcase \"single\": font.underline = 0x01; break;\n\t\t\t\t\tcase \"double\": font.underline = 0x02; break;\n\t\t\t\t\tcase \"singleAccounting\": font.underline = 0x21; break;\n\t\t\t\t\tcase \"doubleAccounting\": font.underline = 0x22; break;\n\t\t\t\t} break;\n\t\t\tcase '<u/>': font.underline = 1; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike': font.strike = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\n\t\t\t/* 18.4.2  outline CT_BooleanProperty */\n\t\t\tcase '<outline': font.outline = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\tcase '<shadow': font.shadow = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\tcase '<condense': font.condense = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<condense/>': font.condense = 1; break;\n\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\tcase '<extend': font.extend = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<extend/>': font.extend = 1; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': if(y.val) font.sz = +y.val; break;\n\t\t\tcase '<sz/>': case '</sz>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n\t\t\tcase '<vertAlign': if(y.val) font.vertAlign = y.val; break;\n\t\t\tcase '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.18 family CT_FontFamily */\n\t\t\tcase '<family': if(y.val) font.family = parseInt(y.val,10); break;\n\t\t\tcase '<family/>': case '</family>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme */\n\t\t\tcase '<scheme': if(y.val) font.scheme = y.val; break;\n\t\t\tcase '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\ty.codepage = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.?.? color CT_Color */\n\t\t\tcase '<color':\n\t\t\t\tif(!font.color) font.color = {};\n\t\t\t\tif(y.auto) font.color.auto = parsexmlbool(y.auto);\n\n\t\t\t\tif(y.rgb) font.color.rgb = y.rgb.slice(-6);\n\t\t\t\telse if(y.indexed) {\n\t\t\t\t\tfont.color.index = parseInt(y.indexed, 10);\n\t\t\t\t\tvar icv = XLSIcv[font.color.index];\n\t\t\t\t\tif(font.color.index == 81) icv = XLSIcv[1];\n\t\t\t\t\tif(!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n\t\t\t\t\tfont.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n\t\t\t\t} else if(y.theme) {\n\t\t\t\t\tfont.color.theme = parseInt(y.theme, 10);\n\t\t\t\t\tif(y.tint) font.color.tint = parseFloat(y.tint);\n\t\t\t\t\tif(y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\t\tfont.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.31 numFmts CT_NumFmts */\nfunction parse_numFmts(t, styles, opts) {\n\tstyles.NumberFmt = [];\n\tvar k/*Array<number>*/ = (keys(table_fmt));\n\tfor(var i=0; i < k.length; ++i) styles.NumberFmt[k[i]] = table_fmt[k[i]];\n\tvar m = t[0].match(tagregex);\n\tif(!m) return;\n\tfor(i=0; i < m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<numFmts': case '</numFmts>': case '<numFmts/>': case '<numFmts>': break;\n\t\t\tcase '<numFmt': {\n\t\t\t\tvar f=unescapexml(utf8read(y.formatCode)), j=parseInt(y.numFmtId,10);\n\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\tif(j>0) {\n\t\t\t\t\tif(j > 0x188) {\n\t\t\t\t\t\tfor(j = 0x188; j > 0x3c; --j) if(styles.NumberFmt[j] == null) break;\n\t\t\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\t\t}\n\t\t\t\t\tSSF__load(f,j);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase '</numFmt>': break;\n\t\t\tdefault: if(opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n\t\t}\n\t}\n}\n\nfunction write_numFmts(NF) {\n\tvar o = [\"<numFmts>\"];\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) o[o.length] = (writextag('numFmt',null,{numFmtId:i,formatCode:escapexml(NF[i])}));\n\t});\n\tif(o.length === 1) return \"\";\n\to[o.length] = (\"</numFmts>\");\n\to[0] = writextag('numFmts', null, { count:o.length-2 }).replace(\"/>\", \">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8.10 cellXfs CT_CellXfs */\nvar cellXF_uint = [ \"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\" ];\nvar cellXF_bool = [ \"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\" ];\nfunction parse_cellXfs(t, styles, opts) {\n\tstyles.CellXf = [];\n\tvar xf;\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x), i = 0;\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<cellXfs': case '<cellXfs>': case '<cellXfs/>': case '</cellXfs>': break;\n\n\t\t\t/* 18.8.45 xf CT_Xf */\n\t\t\tcase '<xf': case '<xf/>':\n\t\t\t\txf = y;\n\t\t\t\tdelete xf[0];\n\t\t\t\tfor(i = 0; i < cellXF_uint.length; ++i) if(xf[cellXF_uint[i]])\n\t\t\t\t\txf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n\t\t\t\tfor(i = 0; i < cellXF_bool.length; ++i) if(xf[cellXF_bool[i]])\n\t\t\t\t\txf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n\t\t\t\tif(styles.NumberFmt && xf.numFmtId > 0x188) {\n\t\t\t\t\tfor(i = 0x188; i > 0x3c; --i) if(styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) { xf.numFmtId = i; break; }\n\t\t\t\t}\n\t\t\t\tstyles.CellXf.push(xf); break;\n\t\t\tcase '</xf>': break;\n\n\t\t\t/* 18.8.1 alignment CT_CellAlignment */\n\t\t\tcase '<alignment': case '<alignment/>':\n\t\t\t\tvar alignment = {};\n\t\t\t\tif(y.vertical) alignment.vertical = y.vertical;\n\t\t\t\tif(y.horizontal) alignment.horizontal = y.horizontal;\n\t\t\t\tif(y.textRotation != null) alignment.textRotation = y.textRotation;\n\t\t\t\tif(y.indent) alignment.indent = y.indent;\n\t\t\t\tif(y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n\t\t\t\txf.alignment = alignment;\n\t\t\t\tbreak;\n\t\t\tcase '</alignment>': break;\n\n\t\t\t/* 18.8.33 protection CT_CellProtection */\n\t\t\tcase '<protection':\n\t\t\t\tbreak;\n\t\t\tcase '</protection>': case '<protection/>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction write_cellXfs(cellXfs) {\n\tvar o = [];\n\to[o.length] = (writextag('cellXfs',null));\n\tcellXfs.forEach(function(c) {\n\t\to[o.length] = (writextag('xf', null, c));\n\t});\n\to[o.length] = (\"</cellXfs>\");\n\tif(o.length === 2) return \"\";\n\to[0] = writextag('cellXfs',null, {count:o.length-2}).replace(\"/>\",\">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8 Styles CT_Stylesheet*/\nvar parse_sty_xml= (function make_pstyx() {\nvar numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\nvar cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\nvar fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\nvar fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\nvar bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\n\nreturn function parse_sty_xml(data, themes, opts) {\n\tvar styles = {};\n\tif(!data) return styles;\n\tdata = data.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\t/* 18.8.39 styleSheet CT_Stylesheet */\n\tvar t;\n\n\t/* 18.8.31 numFmts CT_NumFmts ? */\n\tif((t=data.match(numFmtRegex))) parse_numFmts(t, styles, opts);\n\n\t/* 18.8.23 fonts CT_Fonts ? */\n\tif((t=data.match(fontsRegex))) parse_fonts(t, styles, themes, opts);\n\n\t/* 18.8.21 fills CT_Fills ? */\n\tif((t=data.match(fillsRegex))) parse_fills(t, styles, themes, opts);\n\n\t/* 18.8.5  borders CT_Borders ? */\n\tif((t=data.match(bordersRegex))) parse_borders(t, styles, themes, opts);\n\n\t/* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n\t/* 18.8.8  cellStyles CT_CellStyles ? */\n\n\t/* 18.8.10 cellXfs CT_CellXfs ? */\n\tif((t=data.match(cellXfRegex))) parse_cellXfs(t, styles, opts);\n\n\t/* 18.8.15 dxfs CT_Dxfs ? */\n\t/* 18.8.42 tableStyles CT_TableStyles ? */\n\t/* 18.8.11 colors CT_Colors ? */\n\t/* 18.2.10 extLst CT_ExtensionList ? */\n\n\treturn styles;\n};\n})();\n\nfunction write_sty_xml(wb, opts) {\n\tvar o = [XML_HEADER, writextag('styleSheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:vt': XMLNS.vt\n\t})], w;\n\tif(wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n\to[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\n\to[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\n\to[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\n\to[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\n\tif((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\n\to[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\n\to[o.length] = ('<dxfs count=\"0\"/>');\n\to[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\n\n\tif(o.length>2){ o[o.length] = ('</styleSheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.657 BrtFmt */\nfunction parse_BrtFmt(data, length) {\n\tvar numFmtId = data.read_shift(2);\n\tvar stFmtCode = parse_XLWideString(data,length-2);\n\treturn [numFmtId, stFmtCode];\n}\nfunction write_BrtFmt(i, f, o) {\n\tif(!o) o = new_buf(6 + 4 * f.length);\n\to.write_shift(2, i);\n\twrite_XLWideString(f, o);\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(o.l == null) o.l = o.length;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.4.659 BrtFont TODO */\nfunction parse_BrtFont(data, length, opts) {\n\tvar out = ({});\n\n\tout.sz = data.read_shift(2) / 20;\n\n\tvar grbit = parse_FontFlags(data, 2, opts);\n\tif(grbit.fItalic) out.italic = 1;\n\tif(grbit.fCondense) out.condense = 1;\n\tif(grbit.fExtend) out.extend = 1;\n\tif(grbit.fShadow) out.shadow = 1;\n\tif(grbit.fOutline) out.outline = 1;\n\tif(grbit.fStrikeout) out.strike = 1;\n\n\tvar bls = data.read_shift(2);\n\tif(bls === 0x02BC) out.bold = 1;\n\n\tswitch(data.read_shift(2)) {\n\t\t/* case 0: out.vertAlign = \"baseline\"; break; */\n\t\tcase 1: out.vertAlign = \"superscript\"; break;\n\t\tcase 2: out.vertAlign = \"subscript\"; break;\n\t}\n\n\tvar underline = data.read_shift(1);\n\tif(underline != 0) out.underline = underline;\n\n\tvar family = data.read_shift(1);\n\tif(family > 0) out.family = family;\n\n\tvar bCharSet = data.read_shift(1);\n\tif(bCharSet > 0) out.charset = bCharSet;\n\n\tdata.l++;\n\tout.color = parse_BrtColor(data, 8);\n\n\tswitch(data.read_shift(1)) {\n\t\t/* case 0: out.scheme = \"none\": break; */\n\t\tcase 1: out.scheme = \"major\"; break;\n\t\tcase 2: out.scheme = \"minor\"; break;\n\t}\n\n\tout.name = parse_XLWideString(data, length - 21);\n\n\treturn out;\n}\nfunction write_BrtFont(font, o) {\n\tif(!o) o = new_buf(25+4*32);\n\to.write_shift(2, font.sz * 20);\n\twrite_FontFlags(font, o);\n\to.write_shift(2, font.bold ? 0x02BC : 0x0190);\n\tvar sss = 0;\n\tif(font.vertAlign == \"superscript\") sss = 1;\n\telse if(font.vertAlign == \"subscript\") sss = 2;\n\to.write_shift(2, sss);\n\to.write_shift(1, font.underline || 0);\n\to.write_shift(1, font.family || 0);\n\to.write_shift(1, font.charset || 0);\n\to.write_shift(1, 0);\n\twrite_BrtColor(font.color, o);\n\tvar scheme = 0;\n\tif(font.scheme == \"major\") scheme = 1;\n\tif(font.scheme == \"minor\") scheme = 2;\n\to.write_shift(1, scheme);\n\twrite_XLWideString(font.name, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.650 BrtFill */\nvar XLSBFillPTNames = [\n\t\"none\",\n\t\"solid\",\n\t\"mediumGray\",\n\t\"darkGray\",\n\t\"lightGray\",\n\t\"darkHorizontal\",\n\t\"darkVertical\",\n\t\"darkDown\",\n\t\"darkUp\",\n\t\"darkGrid\",\n\t\"darkTrellis\",\n\t\"lightHorizontal\",\n\t\"lightVertical\",\n\t\"lightDown\",\n\t\"lightUp\",\n\t\"lightGrid\",\n\t\"lightTrellis\",\n\t\"gray125\",\n\t\"gray0625\"\n];\nvar rev_XLSBFillPTNames;\n/* TODO: gradient fill representation */\nvar parse_BrtFill = parsenoop;\nfunction write_BrtFill(fill, o) {\n\tif(!o) o = new_buf(4*3 + 8*7 + 16*1);\n\tif(!rev_XLSBFillPTNames) rev_XLSBFillPTNames = (evert(XLSBFillPTNames));\n\tvar fls = rev_XLSBFillPTNames[fill.patternType];\n\tif(fls == null) fls = 0x28;\n\to.write_shift(4, fls);\n\tvar j = 0;\n\tif(fls != 0x28) {\n\t\t/* TODO: custom FG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\t\t/* TODO: custom BG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0);\n\t} else {\n\t\tfor(; j < 4; ++j) o.write_shift(4, 0);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0); /* TODO */\n\t\t/* iGradientType */\n\t\t/* xnumDegree */\n\t\t/* xnumFillToLeft */\n\t\t/* xnumFillToRight */\n\t\t/* xnumFillToTop */\n\t\t/* xnumFillToBottom */\n\t\t/* cNumStop */\n\t\t/* xfillGradientStop */\n\t}\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.824 BrtXF */\nfunction parse_BrtXF(data, length) {\n\tvar tgt = data.l + length;\n\tvar ixfeParent = data.read_shift(2);\n\tvar ifmt = data.read_shift(2);\n\tdata.l = tgt;\n\treturn {ixfe:ixfeParent, numFmtId:ifmt };\n}\nfunction write_BrtXF(data, ixfeP, o) {\n\tif(!o) o = new_buf(16);\n\to.write_shift(2, ixfeP||0);\n\to.write_shift(2, data.numFmtId||0);\n\to.write_shift(2, 0); /* iFont */\n\to.write_shift(2, 0); /* iFill */\n\to.write_shift(2, 0); /* ixBorder */\n\to.write_shift(1, 0); /* trot */\n\to.write_shift(1, 0); /* indent */\n\tvar flow = 0;\n\to.write_shift(1, flow); /* flags */\n\to.write_shift(1, 0); /* flags */\n\to.write_shift(1, 0); /* xfGrbitAtr */\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.4 Blxf TODO */\nfunction write_Blxf(data, o) {\n\tif(!o) o = new_buf(10);\n\to.write_shift(1, 0); /* dg */\n\to.write_shift(1, 0);\n\to.write_shift(4, 0); /* color */\n\to.write_shift(4, 0); /* color */\n\treturn o;\n}\n/* [MS-XLSB] 2.4.302 BrtBorder TODO */\nvar parse_BrtBorder = parsenoop;\nfunction write_BrtBorder(border, o) {\n\tif(!o) o = new_buf(51);\n\to.write_shift(1, 0); /* diagonal */\n\twrite_Blxf(null, o); /* top */\n\twrite_Blxf(null, o); /* bottom */\n\twrite_Blxf(null, o); /* left */\n\twrite_Blxf(null, o); /* right */\n\twrite_Blxf(null, o); /* diag */\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.763 BrtStyle TODO */\nfunction write_BrtStyle(style, o) {\n\tif(!o) o = new_buf(12+4*10);\n\to.write_shift(4, style.xfId);\n\to.write_shift(2, 1);\n\to.write_shift(1, +style.builtinId);\n\to.write_shift(1, 0); /* iLevel */\n\twrite_XLNullableWideString(style.name || \"\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\nfunction write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\n\tvar o = new_buf(4+256*2*4);\n\to.write_shift(4, cnt);\n\twrite_XLNullableWideString(defTableStyle, o);\n\twrite_XLNullableWideString(defPivotStyle, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction parse_sty_bin(data, themes, opts) {\n\tvar styles = {};\n\tstyles.NumberFmt = ([]);\n\tfor(var y in table_fmt) styles.NumberFmt[y] = table_fmt[y];\n\n\tstyles.CellXf = [];\n\tstyles.Fonts = [];\n\tvar state = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_sty(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x002C: /* BrtFmt */\n\t\t\t\tstyles.NumberFmt[val[0]] = val[1]; SSF__load(val[1], val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x002B: /* BrtFont */\n\t\t\t\tstyles.Fonts.push(val);\n\t\t\t\tif(val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\tval.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0401: /* BrtKnownFonts */ break;\n\t\t\tcase 0x002D: /* BrtFill */\n\t\t\t\tbreak;\n\t\t\tcase 0x002E: /* BrtBorder */\n\t\t\t\tbreak;\n\t\t\tcase 0x002F: /* BrtXF */\n\t\t\t\tif(state[state.length - 1] == 0x0269 /* BrtBeginCellXFs */) {\n\t\t\t\t\tstyles.CellXf.push(val);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0030: /* BrtStyle */\n\t\t\tcase 0x01FB: /* BrtDXF */\n\t\t\tcase 0x023C: /* BrtMRUColor */\n\t\t\tcase 0x01DB: /* BrtIndexedColor */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0493: /* BrtDXF14 */\n\t\t\tcase 0x0836: /* BrtDXF15 */\n\t\t\tcase 0x046A: /* BrtSlicerStyleElement */\n\t\t\tcase 0x0200: /* BrtTableStyleElement */\n\t\t\tcase 0x082F: /* BrtTimelineStyleElement */\n\t\t\tcase 0x0C00: /* BrtUid */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* BrtACBegin */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* BrtACEnd */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn styles;\n}\n\nfunction write_FMTS_bin(ba, NF) {\n\tif(!NF) return;\n\tvar cnt = 0;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\nfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) ++cnt;\n\t});\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0267 /* BrtBeginFmts */, write_UInt32LE(cnt));\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\nfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_record(ba, 0x002C /* BrtFmt */, write_BrtFmt(i, NF[i]));\n\t});\n\twrite_record(ba, 0x0268 /* BrtEndFmts */);\n}\n\nfunction write_FONTS_bin(ba) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0263 /* BrtBeginFonts */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002B /* BrtFont */, write_BrtFont({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Calibri\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}));\n\t/* 1*65491BrtFont [ACFONTS] */\n\twrite_record(ba, 0x0264 /* BrtEndFonts */);\n}\n\nfunction write_FILLS_bin(ba) {\n\tvar cnt = 2;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x025B /* BrtBeginFills */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"none\"}));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"gray125\"}));\n\t/* 1*65431BrtFill */\n\twrite_record(ba, 0x025C /* BrtEndFills */);\n}\n\nfunction write_BORDERS_bin(ba) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0265 /* BrtBeginBorders */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002E /* BrtBorder */, write_BrtBorder({}));\n\t/* 1*65430BrtBorder */\n\twrite_record(ba, 0x0266 /* BrtEndBorders */);\n}\n\nfunction write_CELLSTYLEXFS_bin(ba) {\n\tvar cnt = 1;\n\twrite_record(ba, 0x0272 /* BrtBeginCellStyleXFs */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002F /* BrtXF */, write_BrtXF({\n\t\tnumFmtId: 0,\n\t\tfontId:   0,\n\t\tfillId:   0,\n\t\tborderId: 0\n\t}, 0xFFFF));\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x0273 /* BrtEndCellStyleXFs */);\n}\n\nfunction write_CELLXFS_bin(ba, data) {\n\twrite_record(ba, 0x0269 /* BrtBeginCellXFs */, write_UInt32LE(data.length));\n\tdata.forEach(function(c) { write_record(ba, 0x002F /* BrtXF */, write_BrtXF(c,0)); });\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x026A /* BrtEndCellXFs */);\n}\n\nfunction write_STYLES_bin(ba) {\n\tvar cnt = 1;\n\n\twrite_record(ba, 0x026B /* BrtBeginStyles */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x0030 /* BrtStyle */, write_BrtStyle({\n\t\txfId:0,\n\t\tbuiltinId:0,\n\t\tname:\"Normal\"\n\t}));\n\t/* 1*65430(BrtStyle *FRT) */\n\twrite_record(ba, 0x026C /* BrtEndStyles */);\n}\n\nfunction write_DXFS_bin(ba) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01F9 /* BrtBeginDXFs */, write_UInt32LE(cnt));\n\t/* *2147483647(BrtDXF *FRT) */\n\twrite_record(ba, 0x01FA /* BrtEndDXFs */);\n}\n\nfunction write_TABLESTYLES_bin(ba) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01FC /* BrtBeginTableStyles */, write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\n\t/* *TABLESTYLE */\n\twrite_record(ba, 0x01FD /* BrtEndTableStyles */);\n}\n\nfunction write_COLORPALETTE_bin() {\n\treturn;\n\t/* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction write_sty_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0116 /* BrtBeginStyleSheet */);\n\twrite_FMTS_bin(ba, wb.SSF);\n\twrite_FONTS_bin(ba, wb);\n\twrite_FILLS_bin(ba, wb);\n\twrite_BORDERS_bin(ba, wb);\n\twrite_CELLSTYLEXFS_bin(ba, wb);\n\twrite_CELLXFS_bin(ba, opts.cellXfs);\n\twrite_STYLES_bin(ba, wb);\n\twrite_DXFS_bin(ba, wb);\n\twrite_TABLESTYLES_bin(ba, wb);\n\twrite_COLORPALETTE_bin(ba, wb);\n\t/* FRTSTYLESHEET*/\n\twrite_record(ba, 0x0117 /* BrtEndStyleSheet */);\n\treturn ba.end();\n}\n/* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\nvar XLSXThemeClrScheme = [\n\t'</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>',\n\t'</a:accent1>', '</a:accent2>', '</a:accent3>',\n\t'</a:accent4>', '</a:accent5>', '</a:accent6>',\n\t'</a:hlink>', '</a:folHlink>'\n];\n/* 20.1.6.2 clrScheme CT_ColorScheme */\nfunction parse_clrScheme(t, themes, opts) {\n\tthemes.themeElements.clrScheme = [];\n\tvar color = {};\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\t/* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n\t\t\tcase '<a:clrScheme': case '</a:clrScheme>': break;\n\n\t\t\t/* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\t\t\tcase '<a:srgbClr':\n\t\t\t\tcolor.rgb = y.val; break;\n\n\t\t\t/* 20.1.2.3.33 sysClr CT_SystemColor */\n\t\t\tcase '<a:sysClr':\n\t\t\t\tcolor.rgb = y.lastClr; break;\n\n\t\t\t/* 20.1.4.1.1 accent1 (Accent 1) */\n\t\t\t/* 20.1.4.1.2 accent2 (Accent 2) */\n\t\t\t/* 20.1.4.1.3 accent3 (Accent 3) */\n\t\t\t/* 20.1.4.1.4 accent4 (Accent 4) */\n\t\t\t/* 20.1.4.1.5 accent5 (Accent 5) */\n\t\t\t/* 20.1.4.1.6 accent6 (Accent 6) */\n\t\t\t/* 20.1.4.1.9 dk1 (Dark 1) */\n\t\t\t/* 20.1.4.1.10 dk2 (Dark 2) */\n\t\t\t/* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\t\t\t/* 20.1.4.1.19 hlink (Hyperlink) */\n\t\t\t/* 20.1.4.1.22 lt1 (Light 1) */\n\t\t\t/* 20.1.4.1.23 lt2 (Light 2) */\n\t\t\tcase '<a:dk1>': case '</a:dk1>':\n\t\t\tcase '<a:lt1>': case '</a:lt1>':\n\t\t\tcase '<a:dk2>': case '</a:dk2>':\n\t\t\tcase '<a:lt2>': case '</a:lt2>':\n\t\t\tcase '<a:accent1>': case '</a:accent1>':\n\t\t\tcase '<a:accent2>': case '</a:accent2>':\n\t\t\tcase '<a:accent3>': case '</a:accent3>':\n\t\t\tcase '<a:accent4>': case '</a:accent4>':\n\t\t\tcase '<a:accent5>': case '</a:accent5>':\n\t\t\tcase '<a:accent6>': case '</a:accent6>':\n\t\t\tcase '<a:hlink>': case '</a:hlink>':\n\t\t\tcase '<a:folHlink>': case '</a:folHlink>':\n\t\t\t\tif (y[0].charAt(1) === '/') {\n\t\t\t\t\tthemes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n\t\t\t\t\tcolor = {};\n\t\t\t\t} else {\n\t\t\t\t\tcolor.name = y[0].slice(3, y[0].length - 1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault: if(opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n\t\t}\n\t});\n}\n\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\nfunction parse_fontScheme() { }\n\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\nfunction parse_fmtScheme() { }\n\nvar clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\nvar fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\nvar fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\n\n/* 20.1.6.10 themeElements CT_BaseStyles */\nfunction parse_themeElements(data, themes, opts) {\n\tthemes.themeElements = {};\n\n\tvar t;\n\n\t[\n\t\t/* clrScheme CT_ColorScheme */\n\t\t['clrScheme', clrsregex, parse_clrScheme],\n\t\t/* fontScheme CT_FontScheme */\n\t\t['fontScheme', fntsregex, parse_fontScheme],\n\t\t/* fmtScheme CT_StyleMatrix */\n\t\t['fmtScheme', fmtsregex, parse_fmtScheme]\n\t].forEach(function(m) {\n\t\tif(!(t=data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\n\t\tm[2](t, themes, opts);\n\t});\n}\n\nvar themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\n\n/* 14.2.7 Theme Part */\nfunction parse_theme_xml(data, opts) {\n\t/* 20.1.6.9 theme CT_OfficeStyleSheet */\n\tif(!data || data.length === 0) data = write_theme();\n\n\tvar t;\n\tvar themes = {};\n\n\t/* themeElements CT_BaseStyles */\n\tif(!(t=data.match(themeltregex))) throw new Error('themeElements not found in theme');\n\tparse_themeElements(t[0], themes, opts);\n\tthemes.raw = data;\n\treturn themes;\n}\n\nfunction write_theme(Themes, opts) {\n\tif(opts && opts.themeXLSX) return opts.themeXLSX;\n\tif(Themes && typeof Themes.raw == \"string\") return Themes.raw;\n\tvar o = [XML_HEADER];\n\to[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n\to[o.length] =  '<a:themeElements>';\n\n\to[o.length] =   '<a:clrScheme name=\"Office\">';\n\to[o.length] =    '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n\to[o.length] =    '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n\to[o.length] =    '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n\to[o.length] =    '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n\to[o.length] =    '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n\to[o.length] =    '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n\to[o.length] =    '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n\to[o.length] =    '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n\to[o.length] =    '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n\to[o.length] =    '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n\to[o.length] =    '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n\to[o.length] =    '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n\to[o.length] =   '</a:clrScheme>';\n\n\to[o.length] =   '<a:fontScheme name=\"Office\">';\n\to[o.length] =    '<a:majorFont>';\n\to[o.length] =     '<a:latin typeface=\"Cambria\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:majorFont>';\n\to[o.length] =    '<a:minorFont>';\n\to[o.length] =     '<a:latin typeface=\"Calibri\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:minorFont>';\n\to[o.length] =   '</a:fontScheme>';\n\n\to[o.length] =   '<a:fmtScheme name=\"Office\">';\n\to[o.length] =    '<a:fillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:fillStyleLst>';\n\to[o.length] =    '<a:lnStyleLst>';\n\to[o.length] =     '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =    '</a:lnStyleLst>';\n\to[o.length] =    '<a:effectStyleLst>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =      '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n\to[o.length] =      '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =    '</a:effectStyleLst>';\n\to[o.length] =    '<a:bgFillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:bgFillStyleLst>';\n\to[o.length] =   '</a:fmtScheme>';\n\to[o.length] =  '</a:themeElements>';\n\n\to[o.length] =  '<a:objectDefaults>';\n\to[o.length] =   '<a:spDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:spDef>';\n\to[o.length] =   '<a:lnDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:lnDef>';\n\to[o.length] =  '</a:objectDefaults>';\n\to[o.length] =  '<a:extraClrSchemeLst/>';\n\to[o.length] = '</a:theme>';\n\treturn o.join(\"\");\n}\n/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\nfunction parse_Theme(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar dwThemeVersion = blob.read_shift(4);\n\tif(dwThemeVersion === 124226) return;\n\tif(!opts.cellStyles) { blob.l = end; return; }\n\tvar data = blob.slice(blob.l);\n\tblob.l = end;\n\tvar zip; try { zip = zip_read(data, {type: \"array\"}); } catch(e) { return; }\n\tvar themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n\tif(!themeXML) return;\n\treturn parse_theme_xml(themeXML, opts);\n}\n\n/* 2.5.49 */\nfunction parse_ColorTheme(blob) { return blob.read_shift(4); }\n\n/* 2.5.155 */\nfunction parse_FullColorExt(blob) {\n\tvar o = {};\n\to.xclrType = blob.read_shift(2);\n\to.nTintShade = blob.read_shift(2);\n\tswitch(o.xclrType) {\n\t\tcase 0: blob.l += 4; break;\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\n\t\tcase 4: blob.l += 4; break;\n\t}\n\tblob.l += 8;\n\treturn o;\n}\n\n/* 2.5.164 TODO: read 7 bits*/\nfunction parse_IcvXF(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.280 */\nfunction parse_XFExtGradient(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* [MS-XLS] 2.5.108 */\nfunction parse_ExtProp(blob) {\n\tvar extType = blob.read_shift(2);\n\tvar cb = blob.read_shift(2) - 4;\n\tvar o = [extType];\n\tswitch(extType) {\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 1 ? 1 : 2); break;\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n\t}\n\treturn o;\n}\n\n/* 2.4.355 */\nfunction parse_XFExt(blob, length) {\n\tvar end = blob.l + length;\n\tblob.l += 2;\n\tvar ixfe = blob.read_shift(2);\n\tblob.l += 2;\n\tvar cexts = blob.read_shift(2);\n\tvar ext = [];\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\n\treturn {ixfe:ixfe, ext:ext};\n}\n\n/* xf is an XF, see parse_XFExt for xfext */\nfunction update_xfext(xf, xfext) {\n\txfext.forEach(function(xfe) {\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\n\t\t\tcase 0x04: break; /* foreground color */\n\t\t\tcase 0x05: break; /* background color */\n\t\t\tcase 0x06: break; /* gradient fill */\n\t\t\tcase 0x07: break; /* top cell border color */\n\t\t\tcase 0x08: break; /* bottom cell border color */\n\t\t\tcase 0x09: break; /* left cell border color */\n\t\t\tcase 0x0a: break; /* right cell border color */\n\t\t\tcase 0x0b: break; /* diagonal cell border color */\n\t\t\tcase 0x0d: /* text color */\n\t\t\t\tbreak;\n\t\t\tcase 0x0e: break; /* font scheme */\n\t\t\tcase 0x0f: break; /* indentation level */\n\t\t}\n\t});\n}\n\nfunction parse_BrtMdtinfo(data, length) {\n  return {\n    flags: data.read_shift(4),\n    version: data.read_shift(4),\n    name: parse_XLWideString(data, length - 8)\n  };\n}\nfunction write_BrtMdtinfo(data) {\n  var o = new_buf(12 + 2 * data.name.length);\n  o.write_shift(4, data.flags);\n  o.write_shift(4, data.version);\n  write_XLWideString(data.name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtMdb(data) {\n  var out = [];\n  var cnt = data.read_shift(4);\n  while (cnt-- > 0)\n    out.push([data.read_shift(4), data.read_shift(4)]);\n  return out;\n}\nfunction write_BrtMdb(mdb) {\n  var o = new_buf(4 + 8 * mdb.length);\n  o.write_shift(4, mdb.length);\n  for (var i = 0; i < mdb.length; ++i) {\n    o.write_shift(4, mdb[i][0]);\n    o.write_shift(4, mdb[i][1]);\n  }\n  return o;\n}\nfunction write_BrtBeginEsfmd(cnt, name) {\n  var o = new_buf(8 + 2 * name.length);\n  o.write_shift(4, cnt);\n  write_XLWideString(name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtBeginEsmdb(data) {\n  data.l += 4;\n  return data.read_shift(4) != 0;\n}\nfunction write_BrtBeginEsmdb(cnt, cm) {\n  var o = new_buf(8);\n  o.write_shift(4, cnt);\n  o.write_shift(4, cm ? 1 : 0);\n  return o;\n}\nfunction parse_xlmeta_bin(data, name, _opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  var opts = _opts || {};\n  var state = [];\n  var pass = false;\n  var metatype = 2;\n  recordhopper(data, function(val, R, RT) {\n    switch (RT) {\n      case 335:\n        out.Types.push({ name: val.name });\n        break;\n      case 51:\n        val.forEach(function(r) {\n          if (metatype == 1)\n            out.Cell.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n          else if (metatype == 0)\n            out.Value.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n        });\n        break;\n      case 337:\n        metatype = val ? 1 : 0;\n        break;\n      case 338:\n        metatype = 2;\n        break;\n      case 35:\n        state.push(RT);\n        pass = true;\n        break;\n      case 36:\n        state.pop();\n        pass = false;\n        break;\n      default:\n        if (R.T) {\n        } else if (!pass || opts.WTF && state[state.length - 1] != 35)\n          throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n}\nfunction write_xlmeta_bin() {\n  var ba = buf_array();\n  write_record(ba, 332);\n  write_record(ba, 334, write_UInt32LE(1));\n  write_record(ba, 335, write_BrtMdtinfo({\n    name: \"XLDAPR\",\n    version: 12e4,\n    flags: 3496657072\n  }));\n  write_record(ba, 336);\n  write_record(ba, 339, write_BrtBeginEsfmd(1, \"XLDAPR\"));\n  write_record(ba, 52);\n  write_record(ba, 35, write_UInt32LE(514));\n  write_record(ba, 4096, write_UInt32LE(0));\n  write_record(ba, 4097, writeuint16(1));\n  write_record(ba, 36);\n  write_record(ba, 53);\n  write_record(ba, 340);\n  write_record(ba, 337, write_BrtBeginEsmdb(1, true));\n  write_record(ba, 51, write_BrtMdb([[1, 0]]));\n  write_record(ba, 338);\n  write_record(ba, 333);\n  return ba.end();\n}\nfunction parse_xlmeta_xml(data, name, opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  if (!data)\n    return out;\n  var pass = false;\n  var metatype = 2;\n  var lastmeta;\n  data.replace(tagregex, function(x) {\n    var y = parsexmltag(x);\n    switch (strip_ns(y[0])) {\n      case \"<?xml\":\n        break;\n      case \"<metadata\":\n      case \"</metadata>\":\n        break;\n      case \"<metadataTypes\":\n      case \"</metadataTypes>\":\n        break;\n      case \"<metadataType\":\n        out.Types.push({ name: y.name });\n        break;\n      case \"</metadataType>\":\n        break;\n      case \"<futureMetadata\":\n        for (var j = 0; j < out.Types.length; ++j)\n          if (out.Types[j].name == y.name)\n            lastmeta = out.Types[j];\n        break;\n      case \"</futureMetadata>\":\n        break;\n      case \"<bk>\":\n        break;\n      case \"</bk>\":\n        break;\n      case \"<rc\":\n        if (metatype == 1)\n          out.Cell.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        else if (metatype == 0)\n          out.Value.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        break;\n      case \"</rc>\":\n        break;\n      case \"<cellMetadata\":\n        metatype = 1;\n        break;\n      case \"</cellMetadata>\":\n        metatype = 2;\n        break;\n      case \"<valueMetadata\":\n        metatype = 0;\n        break;\n      case \"</valueMetadata>\":\n        metatype = 2;\n        break;\n      case \"<extLst\":\n      case \"<extLst>\":\n      case \"</extLst>\":\n      case \"<extLst/>\":\n        break;\n      case \"<ext\":\n        pass = true;\n        break;\n      case \"</ext>\":\n        pass = false;\n        break;\n      case \"<rvb\":\n        if (!lastmeta)\n          break;\n        if (!lastmeta.offsets)\n          lastmeta.offsets = [];\n        lastmeta.offsets.push(+y.i);\n        break;\n      default:\n        if (!pass && (opts == null ? void 0 : opts.WTF))\n          throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n    }\n    return x;\n  });\n  return out;\n}\nfunction write_xlmeta_xml() {\n  var o = [XML_HEADER];\n  o.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');\n  return o.join(\"\");\n}\n/* 18.6 Calculation Chain */\nfunction parse_cc_xml(data) {\n\tvar d = [];\n\tif(!data) return d;\n\tvar i = 1;\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\t/* 18.6.2  calcChain CT_CalcChain 1 */\n\t\t\tcase '<calcChain': case '<calcChain>': case '</calcChain>': break;\n\t\t\t/* 18.6.1  c CT_CalcCell 1 */\n\t\t\tcase '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\n\t\t}\n\t});\n\treturn d;\n}\n\n//function write_cc_xml(data, opts) { }\n\n/* [MS-XLSB] 2.6.4.1 */\nfunction parse_BrtCalcChainItem$(data) {\n\tvar out = {};\n\tout.i = data.read_shift(4);\n\tvar cell = {};\n\tcell.r = data.read_shift(4);\n\tcell.c = data.read_shift(4);\n\tout.r = encode_cell(cell);\n\tvar flags = data.read_shift(1);\n\tif(flags & 0x2) out.l = '1';\n\tif(flags & 0x8) out.a = '1';\n\treturn out;\n}\n\n/* 18.6 Calculation Chain */\nfunction parse_cc_bin(data, name, opts) {\n\tvar out = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_cc(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x003F: /* 'BrtCalcChainItem$' */\n\t\t\t\tout.push(val); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\n//function write_cc_bin(data, opts) { }\n/* 18.14 Supplementary Workbook Data */\nfunction parse_xlink_xml() {\n\t//var opts = _opts || {};\n\t//if(opts.WTF) throw \"XLSX External Link\";\n}\n\n/* [MS-XLSB] 2.1.7.25 External Link */\nfunction parse_xlink_bin(data, rel, name, _opts) {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\n\tvar pass = false, end = false;\n\n\trecordhopper(data, function xlink_parse(val, R, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0167: /* 'BrtSupTabs' */\n\t\t\tcase 0x016B: /* 'BrtExternTableStart' */\n\t\t\tcase 0x016C: /* 'BrtExternTableEnd' */\n\t\t\tcase 0x016E: /* 'BrtExternRowHdr' */\n\t\t\tcase 0x016F: /* 'BrtExternCellBlank' */\n\t\t\tcase 0x0170: /* 'BrtExternCellReal' */\n\t\t\tcase 0x0171: /* 'BrtExternCellBool' */\n\t\t\tcase 0x0172: /* 'BrtExternCellError' */\n\t\t\tcase 0x0173: /* 'BrtExternCellString' */\n\t\t\tcase 0x01D8: /* 'BrtExternValueMeta' */\n\t\t\tcase 0x0241: /* 'BrtSupNameStart' */\n\t\t\tcase 0x0242: /* 'BrtSupNameValueStart' */\n\t\t\tcase 0x0243: /* 'BrtSupNameValueEnd' */\n\t\t\tcase 0x0244: /* 'BrtSupNameNum' */\n\t\t\tcase 0x0245: /* 'BrtSupNameErr' */\n\t\t\tcase 0x0246: /* 'BrtSupNameSt' */\n\t\t\tcase 0x0247: /* 'BrtSupNameNil' */\n\t\t\tcase 0x0248: /* 'BrtSupNameBool' */\n\t\t\tcase 0x0249: /* 'BrtSupNameFmla' */\n\t\t\tcase 0x024A: /* 'BrtSupNameBits' */\n\t\t\tcase 0x024B: /* 'BrtSupNameEnd' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n}\n/* 20.5 DrawingML - SpreadsheetML Drawing */\n/* 20.5.2.35 wsDr CT_Drawing */\nfunction parse_drawing(data, rels) {\n\tif(!data) return \"??\";\n\t/*\n\t  Chartsheet Drawing:\n\t   - 20.5.2.35 wsDr CT_Drawing\n\t    - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n\t     - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n\t      - 20.1.2.2.16 graphic CT_GraphicalObject\n\t       - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n          - chart reference\n\t   the actual type is based on the URI of the graphicData\n\t\tTODO: handle embedded charts and other types of graphics\n\t*/\n\tvar id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/)||[\"\",\"\"])[1];\n\n\treturn rels['!id'][id].Target;\n}\n\n/* L.5.5.2 SpreadsheetML Comments + VML Schema */\nvar shapevmlregex = /<(?:\\w+:)?shape(?:[^\\w][^>]*)?>([\\s\\S]*?)<\\/(?:\\w+:)?shape>/g;\nfunction parse_vml(data, sheet, comments) {\n\tvar cidx = 0;\n\t(data.match(shapevmlregex)||[]).forEach(function(m) {\n\t\tvar type = \"\";\n\t\tvar hidden = true;\n\t\tvar aidx = -1;\n\t\tvar R = -1, C = -1;\n\t\tm.replace(tagregex, function(x, idx) {\n\t\t\tvar y = parsexmltag(x);\n\t\t\tswitch(strip_ns(y[0])) {\n\t\t\t\tcase '<ClientData': if(y.ObjectType) type = y.ObjectType; break;\n\n\t\t\t\tcase '<Visible': case '<Visible/>': hidden = false; break;\n\n\t\t\t\tcase '<Row': case '<Row>': aidx = idx + x.length; break;\n\t\t\t\tcase '</Row>': R = +m.slice(aidx, idx).trim(); break;\n\n\t\t\t\tcase '<Column': case '<Column>': aidx = idx + x.length; break;\n\t\t\t\tcase '</Column>': C = +m.slice(aidx, idx).trim(); break;\n\t\t\t}\n\t\t\treturn \"\";\n\t\t});\n\t\tswitch(type) {\n\t\tcase 'Note':\n\t\t\tvar cell = ws_get_cell_stub(sheet, ((R>=0 && C>=0) ? encode_cell({r:R,c:C}) : comments[cidx].ref));\n\t\t\tif(cell.c) {\n\t\t\t\tcell.c.hidden = hidden;\n\t\t\t}\n\t\t\t++cidx;\n\t\t\tbreak;\n\t\t}\n\n\t});\n}\n\n\n/* comment boxes */\nfunction write_vml(rId, comments, ws) {\n\tvar csize = [21600, 21600];\n\t/* L.5.2.1.2 Path Attribute */\n\tvar bbox = [\"m0,0l0\",csize[1],csize[0],csize[1],csize[0],\"0xe\"].join(\",\");\n\tvar o = [\n\t\twritextag(\"xml\", null, { 'xmlns:v': XLMLNS.v, 'xmlns:o': XLMLNS.o, 'xmlns:x': XLMLNS.x, 'xmlns:mv': XLMLNS.mv }).replace(/\\/>/,\">\"),\n\t\twritextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {'v:ext':\"edit\", 'data':rId}), {'v:ext':\"edit\"})\n\t];\n\n\tvar _shapeid = 65536 * rId;\n\n\tvar _comments = comments || [];\n\tif(_comments.length > 0) o.push(writextag(\"v:shapetype\", [\n\t\twritextag(\"v:stroke\", null, {joinstyle:\"miter\"}),\n\t\twritextag(\"v:path\", null, {gradientshapeok:\"t\", 'o:connecttype':\"rect\"})\n\t].join(\"\"), {id:\"_x0000_t202\", coordsize:csize.join(\",\"), 'o:spt':202, path:bbox}));\n\n\t_comments.forEach(function(x) { ++_shapeid; o.push(write_vml_comment(x, _shapeid)); });\n\to.push('</xml>');\n\treturn o.join(\"\");\n}\n\nfunction write_vml_comment(x, _shapeid, ws) {\n\tvar c = decode_cell(x[0]);\n\tvar fillopts = {'color2':\"#BEFF82\", 'type':\"gradient\"};\n\tif(fillopts.type == \"gradient\") fillopts.angle = \"-180\";\n\tvar fillparm = fillopts.type == \"gradient\" ? writextag(\"o:fill\", null, {type:\"gradientUnscaled\", 'v:ext':\"view\"}) : null;\n\tvar fillxml = writextag('v:fill', fillparm, fillopts);\n\n\tvar shadata = ({on:\"t\", 'obscured':\"t\"});\n\n\treturn [\n\t'<v:shape' + wxt_helper({\n\t\tid:'_x0000_s' + _shapeid,\n\t\ttype:\"#_x0000_t202\",\n\t\tstyle:\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\") ,\n\t\tfillcolor:\"#ECFAD4\",\n\t\tstrokecolor:\"#edeaa1\"\n\t}) + '>',\n\t\tfillxml,\n\t\twritextag(\"v:shadow\", null, shadata),\n\t\twritextag(\"v:path\", null, {'o:connecttype':\"none\"}),\n\t\t'<v:textbox><div style=\"text-align:left\"></div></v:textbox>',\n\t\t'<x:ClientData ObjectType=\"Note\">',\n\t\t\t'<x:MoveWithCells/>',\n\t\t\t'<x:SizeWithCells/>',\n\t\t\t/* Part 4 19.4.2.3 Anchor (Anchor) */\n\t\t\twritetag('x:Anchor', [c.c+1, 0, c.r+1, 0, c.c+3, 20, c.r+5, 20].join(\",\")),\n\t\t\twritetag('x:AutoFill', \"False\"),\n\t\t\twritetag('x:Row', String(c.r)),\n\t\t\twritetag('x:Column', String(c.c)),\n\t\t\tx[1].hidden ? '' : '<x:Visible/>',\n\t\t'</x:ClientData>',\n\t'</v:shape>'\n\t].join(\"\");\n}\nfunction sheet_insert_comments(sheet, comments, threaded, people) {\n\tvar dense = sheet[\"!data\"] != null;\n\tvar cell;\n\tcomments.forEach(function(comment) {\n\t\tvar r = decode_cell(comment.ref);\n\t\tif(r.r < 0 || r.c < 0) return;\n\t\tif(dense) {\n\t\t\tif(!sheet[\"!data\"][r.r]) sheet[\"!data\"][r.r] = [];\n\t\t\tcell = sheet[\"!data\"][r.r][r.c];\n\t\t} else cell = sheet[comment.ref];\n\t\tif (!cell) {\n\t\t\tcell = ({t:\"z\"});\n\t\t\tif(dense) sheet[\"!data\"][r.r][r.c] = cell;\n\t\t\telse sheet[comment.ref] = cell;\n\t\t\tvar range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\n\t\t\tif(range.s.r > r.r) range.s.r = r.r;\n\t\t\tif(range.e.r < r.r) range.e.r = r.r;\n\t\t\tif(range.s.c > r.c) range.s.c = r.c;\n\t\t\tif(range.e.c < r.c) range.e.c = r.c;\n\t\t\tvar encoded = encode_range(range);\n\t\t\tsheet[\"!ref\"] = encoded;\n\t\t}\n\n\t\tif (!cell.c) cell.c = [];\n\t\tvar o = ({a: comment.author, t: comment.t, r: comment.r, T: threaded});\n\t\tif(comment.h) o.h = comment.h;\n\n\t\t/* threaded comments always override */\n\t\tfor(var i = cell.c.length - 1; i >= 0; --i) {\n\t\t\tif(!threaded && cell.c[i].T) return;\n\t\t\tif(threaded && !cell.c[i].T) cell.c.splice(i, 1);\n\t\t}\n\t\tif(threaded && people) for(i = 0; i < people.length; ++i) {\n\t\t\tif(o.a == people[i].id) { o.a = people[i].name || o.a; break; }\n\t\t}\n\t\tcell.c.push(o);\n\t});\n}\n/* 18.7 Comments */\nfunction parse_comments_xml(data, opts) {\n\t/* 18.7.6 CT_Comments */\n\tif(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n\tvar authors = [];\n\tvar commentList = [];\n\tvar authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\n\tif(authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\n\t\tif(a) authors.push(a[1]);\n\t});\n\tvar cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\n\tif(cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\n\t\tif(!cm) return;\n\t\tvar y = parsexmltag(cm[0]);\n\t\tvar comment = ({ author: y.authorId && authors[y.authorId] || \"sheetjsghost\", ref: y.ref, guid: y.guid });\n\t\tvar cell = decode_cell(y.ref);\n\t\tif(opts.sheetRows && opts.sheetRows <= cell.r) return;\n\t\tvar textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\n\t\tvar rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {r:\"\",t:\"\",h:\"\"};\n\t\tcomment.r = rt.r;\n\t\tif(rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n\t\tcomment.t = (rt.t||\"\").replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\t\tif(opts.cellHTML) comment.h = rt.h;\n\t\tcommentList.push(comment);\n\t});\n\treturn commentList;\n}\n\nfunction write_comments_xml(data) {\n\tvar o = [XML_HEADER, writextag('comments', null, { 'xmlns': XMLNS_main[0] })];\n\n\tvar iauthor = [];\n\to.push(\"<authors>\");\n\tdata.forEach(function(x) { x[1].forEach(function(w) { var a = escapexml(w.a);\n\t\tif(iauthor.indexOf(a) == -1) {\n\t\t\tiauthor.push(a);\n\t\t\to.push(\"<author>\" + a + \"</author>\");\n\t\t}\n\t\tif(w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) == -1) {\n\t\t\tiauthor.push(\"tc=\" + w.ID);\n\t\t\to.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n\t\t}\n\t}); });\n\tif(iauthor.length == 0) { iauthor.push(\"SheetJ5\"); o.push(\"<author>SheetJ5</author>\"); }\n\to.push(\"</authors>\");\n\to.push(\"<commentList>\");\n\tdata.forEach(function(d) {\n\t\t/* 18.7.3 CT_Comment */\n\t\tvar lastauthor = 0, ts = [], tcnt = 0;\n\t\tif(d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\td[1].forEach(function(c) {\n\t\t\tif(c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n\t\t\tif(c.T) ++tcnt;\n\t\t\tts.push(c.t == null ? \"\" : escapexml(c.t));\n\t\t});\n\t\tif(tcnt === 0) {\n\t\t\td[1].forEach(function(c) {\n\t\t\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + iauthor.indexOf(escapexml(c.a)) + '\"><text>');\n\t\t\t\to.push(writetag(\"t\", c.t == null ? \"\" : escapexml(c.t)));\n\t\t\t\to.push('</text></comment>');\n\t\t\t});\n\t\t} else {\n\t\t\tif(d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\t\t/* based on Threaded Comments -> Comments projection */\n\t\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n\t\t\tvar t = \"Comment:\\n    \" + (ts[0]) + \"\\n\";\n\t\t\tfor(var i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n\t\t\to.push(writetag(\"t\", escapexml(t)));\n\t\t\to.push('</text></comment>');\n\t\t}\n\t});\n\to.push(\"</commentList>\");\n\tif(o.length>2) { o[o.length] = ('</comments>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.17 */\nfunction parse_tcmnt_xml(data, opts) {\n\tvar out = [];\n\tvar pass = false, comment = {}, tidx = 0;\n\tdata.replace(tagregex, function xml_tcmnt(x, idx) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.6.207 ThreadedComments CT_ThreadedComments */\n\t\t\tcase '<ThreadedComments': break;\n\t\t\tcase '</ThreadedComments>': break;\n\n\t\t\t/* 2.6.205 threadedComment CT_ThreadedComment */\n\t\t\tcase '<threadedComment': comment = {author: y.personId, guid: y.id, ref: y.ref, T: 1}; break;\n\t\t\tcase '</threadedComment>': if(comment.t != null) out.push(comment); break;\n\n\t\t\tcase '<text>': case '<text': tidx = idx + x.length; break;\n\t\t\tcase '</text>': comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\"); break;\n\n\t\t\t/* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n\t\t\tcase '<mentions': case '<mentions>': pass = true; break;\n\t\t\tcase '</mentions>': pass = false; break;\n\n\t\t\t/* 2.6.202 mention CT_Mention TODO */\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\nfunction write_tcmnt_xml(comments, people, opts) {\n\tvar o = [XML_HEADER, writextag('ThreadedComments', null, { 'xmlns': XMLNS.TCMNT }).replace(/[\\/]>/, \">\")];\n\tcomments.forEach(function(carr) {\n\t\tvar rootid = \"\";\n\t\t(carr[1] || []).forEach(function(c, idx) {\n\t\t\tif(!c.T) { delete c.ID; return; }\n\t\t\tif(c.a && people.indexOf(c.a) == -1) people.push(c.a);\n\t\t\tvar tcopts = {\n\t\t\t\tref: carr[0],\n\t\t\t\tid: \"{54EE7951-7262-4200-6969-\" + (\"000000000000\" + opts.tcid++).slice(-12) + \"}\"\n\t\t\t};\n\t\t\tif(idx == 0) rootid = tcopts.id;\n\t\t\telse tcopts.parentId = rootid;\n\t\t\tc.ID = tcopts.id;\n\t\t\tif(c.a) tcopts.personId = \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + people.indexOf(c.a)).slice(-12) + \"}\";\n\t\t\to.push(writextag('threadedComment', writetag('text', c.t||\"\"), tcopts));\n\t\t});\n\t});\n\to.push('</ThreadedComments>');\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.18 */\nfunction parse_people_xml(data, opts) {\n\tvar out = [];\n\tvar pass = false;\n\tdata.replace(tagregex, function xml_tcmnt(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.4.85 personList CT_PersonList */\n\t\t\tcase '<personList': break;\n\t\t\tcase '</personList>': break;\n\n\t\t\t/* 2.6.203 person CT_Person TODO: providers */\n\t\t\tcase '<person': out.push({name: y.displayname, id: y.id }); break;\n\t\t\tcase '</person>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\nfunction write_people_xml(people/*, opts*/) {\n\tvar o = [XML_HEADER, writextag('personList', null, {\n\t\t'xmlns': XMLNS.TCMNT,\n\t\t'xmlns:x': XMLNS_main[0]\n\t}).replace(/[\\/]>/, \">\")];\n\tpeople.forEach(function(person, idx) {\n\t\to.push(writextag('person', null, {\n\t\t\tdisplayName: person,\n\t\t\tid: \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + idx).slice(-12) + \"}\",\n\t\t\tuserId: person,\n\t\t\tproviderId: \"None\"\n\t\t}));\n\t});\n\to.push(\"</personList>\");\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\nfunction parse_BrtBeginComment(data) {\n\tvar out = {};\n\tout.iauthor = data.read_shift(4);\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tout.rfx = rfx.s;\n\tout.ref = encode_cell(rfx.s);\n\tdata.l += 16; /*var guid = parse_GUID(data); */\n\treturn out;\n}\nfunction write_BrtBeginComment(data, o) {\n\tif(o == null) o = new_buf(36);\n\to.write_shift(4, data[1].iauthor);\n\twrite_UncheckedRfX((data[0]), o);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.327 BrtCommentAuthor */\nvar parse_BrtCommentAuthor = parse_XLWideString;\nfunction write_BrtCommentAuthor(data) { return write_XLWideString(data.slice(0, 54)); }\n\n/* [MS-XLSB] 2.1.7.8 Comments */\nfunction parse_comments_bin(data, opts) {\n\tvar out = [];\n\tvar authors = [];\n\tvar c = {};\n\tvar pass = false;\n\trecordhopper(data, function hopper_cmnt(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x0278: /* 'BrtCommentAuthor' */\n\t\t\t\tauthors.push(val); break;\n\t\t\tcase 0x027B: /* 'BrtBeginComment' */\n\t\t\t\tc = val; break;\n\t\t\tcase 0x027D: /* 'BrtCommentText' */\n\t\t\t\tc.t = val.t; c.h = val.h; c.r = val.r; break;\n\t\t\tcase 0x027C: /* 'BrtEndComment' */\n\t\t\t\tc.author = authors[c.iauthor];\n\t\t\t\tdelete (c).iauthor;\n\t\t\t\tif(opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n\t\t\t\tif(!c.t) c.t = \"\";\n\t\t\t\tdelete c.rfx; out.push(c); break;\n\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */ break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */ break;\n\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\nfunction write_comments_bin(data) {\n\tvar ba = buf_array();\n\tvar iauthor = [];\n\twrite_record(ba, 0x0274 /* BrtBeginComments */);\n\n\twrite_record(ba, 0x0276 /* BrtBeginCommentAuthors */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tif(iauthor.indexOf(c.a) > -1) return;\n\t\t\tiauthor.push(c.a.slice(0,54));\n\t\t\twrite_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(c.a));\n\t\t\tif(c.T && c.ID && iauthor.indexOf(\"tc=\" + c.ID) == -1) {\n\t\t\t\tiauthor.push(\"tc=\" + c.ID);\n\t\t\t\twrite_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(\"tc=\" + c.ID));\n\t\t\t}\n\t\t});\n\t});\n\twrite_record(ba, 0x0277 /* BrtEndCommentAuthors */);\n\n\twrite_record(ba, 0x0279 /* BrtBeginCommentList */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tvar _ia = -1;\n\t\t\tif(c.ID) _ia = iauthor.indexOf(\"tc=\" + c.ID);\n\t\t\tif(_ia == -1 && comment[1][0].T && comment[1][0].ID) _ia = iauthor.indexOf(\"tc=\" + comment[1][0].ID);\n\t\t\tif(_ia == -1) _ia = iauthor.indexOf(c.a);\n\t\t\tc.iauthor = _ia;\n\t\t\tvar range = {s:decode_cell(comment[0]),e:decode_cell(comment[0])};\n\t\t\twrite_record(ba, 0x027B /* BrtBeginComment */, write_BrtBeginComment([range, c]));\n\t\t\tif(c.t && c.t.length > 0) write_record(ba, 0x027D /* BrtCommentText */, write_BrtCommentText(c));\n\t\t\twrite_record(ba, 0x027C /* BrtEndComment */);\n\t\t\tdelete c.iauthor;\n\t\t});\n\t});\n\twrite_record(ba, 0x027A /* BrtEndCommentList */);\n\n\twrite_record(ba, 0x0275 /* BrtEndComments */);\n\treturn ba.end();\n}\nvar CT_VBA = \"application/vnd.ms-office.vbaProject\";\nfunction make_vba_xls(cfb) {\n  var newcfb = CFB.utils.cfb_new({ root: \"R\" });\n  cfb.FullPaths.forEach(function(p, i) {\n    if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/))\n      return;\n    var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n    CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n  });\n  return CFB.write(newcfb);\n}\nfunction fill_vba_xls(cfb, vba) {\n  vba.FullPaths.forEach(function(p, i) {\n    if (i == 0)\n      return;\n    var newpath = p.replace(/[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\n    if (newpath.slice(-1) !== \"/\")\n      CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\n  });\n}\nvar VBAFMTS = [\"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\"];\n/* macro and dialog sheet stubs */\nfunction parse_ds_bin() { return {'!type':'dialog'}; }\nfunction parse_ds_xml() { return {'!type':'dialog'}; }\nfunction parse_ms_bin() { return {'!type':'macro'}; }\nfunction parse_ms_xml() { return {'!type':'macro'}; }\n/* TODO: it will be useful to parse the function str */\nvar rc_to_a1 = (function(){\n\tvar rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n\tvar rcbase = ({r:0,c:0});\n\tfunction rcfunc($$,$1,$2,$3) {\n\t\tvar cRel = false, rRel = false;\n\n\t\tif($2.length == 0) rRel = true;\n\t\telse if($2.charAt(0) == \"[\") { rRel = true; $2 = $2.slice(1, -1); }\n\n\t\tif($3.length == 0) cRel = true;\n\t\telse if($3.charAt(0) == \"[\") { cRel = true; $3 = $3.slice(1, -1); }\n\n\t\tvar R = $2.length>0?parseInt($2,10)|0:0, C = $3.length>0?parseInt($3,10)|0:0;\n\n\t\tif(cRel) C += rcbase.c; else --C;\n\t\tif(rRel) R += rcbase.r; else --R;\n\t\treturn $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n\t}\n\treturn function rc_to_a1(fstr, base) {\n\t\trcbase = base;\n\t\treturn fstr.replace(rcregex, rcfunc);\n\t};\n})();\n\nvar crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\nvar a1_to_rc = (function(){\n\treturn function a1_to_rc(fstr, base) {\n\t\treturn fstr.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\t\tvar c = decode_col($3) - ($2 ? 0 : base.c);\n\t\t\tvar r = decode_row($5) - ($4 ? 0 : base.r);\n\t\t\tvar R = $4 == \"$\" ? (r+1) : (r == 0 ? \"\" : \"[\" + r + \"]\");\n\t\t\tvar C = $2 == \"$\" ? (c+1) : (c == 0 ? \"\" : \"[\" + c + \"]\");\n\t\t\treturn $1 + \"R\" + R + \"C\" + C;\n\t\t});\n\t};\n})();\n\n/* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\nfunction shift_formula_str(f, delta) {\n\treturn f.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\treturn $1+($2==\"$\" ? $2+$3 : encode_col(decode_col($3)+delta.c))+($4==\"$\" ? $4+$5 : encode_row(decode_row($5) + delta.r));\n\t});\n}\n\nfunction shift_formula_xlsx(f, range, cell) {\n\tvar r = decode_range(range), s = r.s, c = decode_cell(cell);\n\tvar delta = {r:c.r - s.r, c:c.c - s.c};\n\treturn shift_formula_str(f, delta);\n}\n\n/* TODO: parse formula */\nfunction fuzzyfmla(f) {\n\tif(f.length == 1) return false;\n\treturn true;\n}\n\nfunction _xlfn(f) {\n\treturn f.replace(/_xlfn\\./g,\"\");\n}\nfunction parseread1(blob) { blob.l+=1; return; }\n\n/* [MS-XLS] 2.5.51 */\nfunction parse_ColRelU(blob, length) {\n\tvar c = blob.read_shift(length == 1 ? 1 : 2);\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\nfunction parse_RgceArea(blob, length, opts) {\n\tvar w = 2;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\n\t\telse if(opts.biff == 12) w = 4;\n\t}\n\tvar r=blob.read_shift(w), R=blob.read_shift(w);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n/* BIFF 2-5 encodes flags in the row field */\nfunction parse_RgceArea_BIFF2(blob) {\n\tvar r=parse_ColRelU(blob, 2), R=parse_ColRelU(blob, 2);\n\tvar c=blob.read_shift(1);\n\tvar C=blob.read_shift(1);\n\treturn { s:{r:r[0], c:c, cRel:r[1], rRel:r[2]}, e:{r:R[0], c:C, cRel:R[1], rRel:R[2]} };\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\nfunction parse_RgceAreaRel(blob, length, opts) {\n\tif(opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\n\tvar r=blob.read_shift(opts.biff == 12 ? 4 : 2), R=blob.read_shift(opts.biff == 12 ? 4 : 2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\nfunction parse_RgceLoc(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n\tvar c = parse_ColRelU(blob, 2);\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\n}\nfunction parse_RgceLoc_BIFF2(blob) {\n\tvar r = parse_ColRelU(blob, 2);\n\tvar c = blob.read_shift(1);\n\treturn {r:r[0], c:c, cRel:r[1], rRel:r[2]};\n}\n\n/* [MS-XLS] 2.5.198.107, 2.5.47 */\nfunction parse_RgceElfLoc(blob) {\n\tvar r = blob.read_shift(2);\n\tvar c = blob.read_shift(2);\n\treturn {r:r, c:c & 0xFF, fQuoted:!!(c & 0x4000), cRel:c>>15, rRel:c>>15 };\n}\n\n/* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\nfunction parse_RgceLocRel(blob, length, opts) {\n\tvar biff = opts && opts.biff ? opts.biff : 8;\n\tif(biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(biff >= 12 ? 4 : 2);\n\tvar cl = blob.read_shift(2);\n\tvar cRel = (cl & 0x4000) >> 14, rRel = (cl & 0x8000) >> 15;\n\tcl &= 0x3FFF;\n\tif(rRel == 1) while(r > 0x7FFFF) r -= 0x100000;\n\tif(cRel == 1) while(cl > 0x1FFF) cl = cl - 0x4000;\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\n}\nfunction parse_RgceLocRel_BIFF2(blob) {\n\tvar rl = blob.read_shift(2);\n\tvar c = blob.read_shift(1);\n\tvar rRel = (rl & 0x8000) >> 15, cRel = (rl & 0x4000) >> 14;\n\trl &= 0x3FFF;\n\tif(rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n\tif(cRel == 1 && c >= 0x80) c = c - 0x100;\n\treturn {r:rl,c:c,cRel:cRel,rRel:rRel};\n}\n\n/* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\nfunction parse_PtgArea(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\nfunction parse_PtgArea3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2, 'i');\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tvar area = parse_RgceArea(blob, w, opts);\n\treturn [type, ixti, area];\n}\n\n/* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\nfunction parse_PtgAreaErr(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts && (opts.biff > 8) ? 12 : (opts.biff < 8 ? 6 : 8);\n\treturn [type];\n}\n/* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\nfunction parse_PtgAreaN(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceAreaRel(blob, length - 1, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\nfunction parse_PtgArray(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\nfunction parse_PtgAttrBaxcel(blob) {\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\n\tvar bitBaxcel = 1;\n\tblob.l += 4;\n\treturn [bitSemi, bitBaxcel];\n}\n\n/* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\nfunction parse_PtgAttrChoose(blob, length, opts) {\n\tblob.l +=2;\n\tvar offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar o = [];\n\t/* offset is 1 less than the number of elements */\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\nfunction parse_PtgAttrGoto(blob, length, opts) {\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\nfunction parse_PtgAttrIf(blob, length, opts) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLSB] 2.5.97.28 */\nfunction parse_PtgAttrIfError(blob) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(2)];\n}\n\n/* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\nfunction parse_PtgAttrSemi(blob, length, opts) {\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += opts && opts.biff == 2 ? 3 : 4;\n\treturn [bitSemi];\n}\n\n/* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\nfunction parse_PtgAttrSpaceType(blob) {\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\n\treturn [type, cch];\n}\n\n/* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\nfunction parse_PtgAttrSpace(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\nfunction parse_PtgAttrSpaceSemi(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\nfunction parse_PtgRef(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLoc(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\nfunction parse_PtgRefN(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLocRel(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\nfunction parse_PtgRef3d(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tif(opts && opts.biff == 5) blob.l += 12;\n\tvar loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n\treturn [type, ixti, loc];\n}\n\n\n/* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\nfunction parse_PtgFunc(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n\treturn [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\nfunction parse_PtgFuncVar(blob, length, opts) {\n\tvar type = blob[blob.l++];\n\tvar cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [(type == 0x58 ? -1 : 0), blob.read_shift(1)]: parsetab(blob);\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob) {\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\n}\n\n/* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\nfunction parse_PtgAttrSum(blob, length, opts) {\n\tblob.l += opts && opts.biff == 2 ? 3 : 4; return;\n}\n\n/* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\nfunction parse_PtgExp(blob, length, opts) {\n\tblob.l++;\n\tif(opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n\tvar row = blob.read_shift(2);\n\tvar col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [row, col];\n}\n\n/* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\nfunction parse_PtgErr(blob) { blob.l++; return BErr[blob.read_shift(1)]; }\n\n/* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\nfunction parse_PtgInt(blob) { blob.l++; return blob.read_shift(2); }\n\n/* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\nfunction parse_PtgBool(blob) { blob.l++; return blob.read_shift(1)!==0;}\n\n/* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\nfunction parse_PtgNum(blob) { blob.l++; return parse_Xnum(blob, 8); }\n\n/* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\nfunction parse_PtgStr(blob, length, opts) { blob.l++; return parse_ShortXLUnicodeString(blob, length-1, opts); }\n\n/* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n/* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\nfunction parse_SerAr(blob, biff) {\n\tvar val = [blob.read_shift(1)];\n\tif(biff == 12) switch(val[0]) {\n\t\tcase 0x02: val[0] = 0x04; break; /* SerBool */\n\t\tcase 0x04: val[0] = 0x10; break; /* SerErr */\n\t\tcase 0x00: val[0] = 0x01; break; /* SerNum */\n\t\tcase 0x01: val[0] = 0x02; break; /* SerStr */\n\t}\n\tswitch(val[0]) {\n\t\tcase 0x04: /* SerBool -- boolean */\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n\t\t\tif(biff != 12) blob.l += 7; break;\n\t\tcase 0x25: /* appears to be an alias */\n\t\tcase 0x10: /* SerErr -- error */\n\t\t\tval[1] = BErr[blob[blob.l]];\n\t\t\tblob.l += ((biff == 12) ? 4 : 8); break;\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\n\t\t\tblob.l += 8; break;\n\t\tcase 0x01: /* SerNum -- Xnum */\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\n\t\t\tval[1] = parse_XLUnicodeString2(blob, 0, {biff:biff > 0 && biff < 8 ? 2 : biff}); break;\n\t\tdefault: throw new Error(\"Bad SerAr: \" + val[0]); /* Unreachable */\n\t}\n\treturn val;\n}\n\n/* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\nfunction parse_PtgExtraMem(blob, cce, opts) {\n\tvar count = blob.read_shift((opts.biff == 12) ? 4 : 2);\n\tvar out = [];\n\tfor(var i = 0; i != count; ++i) out.push(((opts.biff == 12) ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\nfunction parse_PtgExtraArray(blob, length, opts) {\n\tvar rows = 0, cols = 0;\n\tif(opts.biff == 12) {\n\t\trows = blob.read_shift(4); // DRw\n\t\tcols = blob.read_shift(4); // DCol\n\t} else {\n\t\tcols = 1 + blob.read_shift(1); //DColByteU\n\t\trows = 1 + blob.read_shift(2); //DRw\n\t}\n\tif(opts.biff >= 2 && opts.biff < 8) { --rows; if(--cols == 0) cols = 0x100; }\n\t// $FlowIgnore\n\tfor(var i = 0, o = []; i != rows && (o[i] = []); ++i)\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\nfunction parse_PtgName(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar w = (!opts || (opts.biff >= 8)) ? 4 : 2;\n\tvar nameindex = blob.read_shift(w);\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l += 5; break;\n\t\tcase 3: case 4: blob.l += 8; break;\n\t\tcase 5: blob.l += 12; break;\n\t}\n\treturn [type, 0, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\nfunction parse_PtgNameX(blob, length, opts) {\n\tif(opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, ixti, nameindex];\n}\nfunction parse_PtgNameX_BIFF5(blob) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2, 'i'); // XtiIndex\n\tblob.l += 8;\n\tvar nameindex = blob.read_shift(2);\n\tblob.l += 12;\n\treturn [type, ixti, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\nfunction parse_PtgMemArea(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += (opts && opts.biff == 2 ? 3 : 4);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n/* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\nfunction parse_PtgMemFunc(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n\n/* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\nfunction parse_PtgRefErr(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\tif(opts.biff < 8) blob.l--;\n\tif(opts.biff == 12) blob.l += 2;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\nfunction parse_PtgRefErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 4;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: w = 15; break;\n\t\tcase 12: w = 6; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\nvar parse_PtgMemErr = parsenoop;\n/* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\nvar parse_PtgMemNoMem = parsenoop;\n/* [MS-XLS] 2.5.198.92 */\nvar parse_PtgTbl = parsenoop;\n\nfunction parse_PtgElfLoc(blob, length, opts) {\n\tblob.l += 2;\n\treturn [parse_RgceElfLoc(blob, 4, opts)];\n}\nfunction parse_PtgElfNoop(blob) {\n\tblob.l += 6;\n\treturn [];\n}\n/* [MS-XLS] 2.5.198.46 */\nvar parse_PtgElfCol = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.47 */\nvar parse_PtgElfColS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.48 */\nvar parse_PtgElfColSV = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.49 */\nvar parse_PtgElfColV = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.50 */\nfunction parse_PtgElfLel(blob) {\n\tblob.l += 2;\n\treturn [parseuint16(blob), blob.read_shift(2) & 0x01];\n}\n/* [MS-XLS] 2.5.198.51 */\nvar parse_PtgElfRadical = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.52 */\nvar parse_PtgElfRadicalLel = parse_PtgElfLel;\n/* [MS-XLS] 2.5.198.53 */\nvar parse_PtgElfRadicalS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.54 */\nvar parse_PtgElfRw = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.55 */\nvar parse_PtgElfRwV = parse_PtgElfLoc;\n\n/* [MS-XLSB] 2.5.97.52 TODO */\nvar PtgListRT = [\n\t\"Data\",\n\t\"All\",\n\t\"Headers\",\n\t\"??\",\n\t\"?Data2\",\n\t\"??\",\n\t\"?DataHeaders\",\n\t\"??\",\n\t\"Totals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?DataTotals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?Current\"\n];\nfunction parse_PtgList(blob) {\n\tblob.l += 2;\n\tvar ixti = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tvar idx = blob.read_shift(4);\n\tvar c = blob.read_shift(2);\n\tvar C = blob.read_shift(2);\n\tvar rt = PtgListRT[(flags >> 2) & 0x1F];\n\treturn {ixti: ixti, coltype:(flags&0x3), rt:rt, idx:idx, c:c, C:C};\n}\n/* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\nfunction parse_PtgSxName(blob) {\n\tblob.l += 2;\n\treturn [blob.read_shift(4)];\n}\n\n/* [XLS] old spec */\nfunction parse_PtgSheet(blob, length, opts) {\n\tblob.l += 5;\n\tblob.l += 2;\n\tblob.l += (opts.biff == 2 ? 1 : 4);\n\treturn [\"PTGSHEET\"];\n}\nfunction parse_PtgEndSheet(blob, length, opts) {\n\tblob.l += (opts.biff == 2 ? 4 : 5);\n\treturn [\"PTGENDSHEET\"];\n}\nfunction parse_PtgMemAreaN(blob) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgMemNoMemN(blob) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgAttrNoop(blob) {\n\tblob.l += 4;\n\treturn [0, 0];\n}\n\n/* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\nvar PtgTypes = {\n0x01: { n:'PtgExp', f:parse_PtgExp },\n0x02: { n:'PtgTbl', f:parse_PtgTbl },\n0x03: { n:'PtgAdd', f:parseread1 },\n0x04: { n:'PtgSub', f:parseread1 },\n0x05: { n:'PtgMul', f:parseread1 },\n0x06: { n:'PtgDiv', f:parseread1 },\n0x07: { n:'PtgPower', f:parseread1 },\n0x08: { n:'PtgConcat', f:parseread1 },\n0x09: { n:'PtgLt', f:parseread1 },\n0x0A: { n:'PtgLe', f:parseread1 },\n0x0B: { n:'PtgEq', f:parseread1 },\n0x0C: { n:'PtgGe', f:parseread1 },\n0x0D: { n:'PtgGt', f:parseread1 },\n0x0E: { n:'PtgNe', f:parseread1 },\n0x0F: { n:'PtgIsect', f:parseread1 },\n0x10: { n:'PtgUnion', f:parseread1 },\n0x11: { n:'PtgRange', f:parseread1 },\n0x12: { n:'PtgUplus', f:parseread1 },\n0x13: { n:'PtgUminus', f:parseread1 },\n0x14: { n:'PtgPercent', f:parseread1 },\n0x15: { n:'PtgParen', f:parseread1 },\n0x16: { n:'PtgMissArg', f:parseread1 },\n0x17: { n:'PtgStr', f:parse_PtgStr },\n0x1A: { n:'PtgSheet', f:parse_PtgSheet },\n0x1B: { n:'PtgEndSheet', f:parse_PtgEndSheet },\n0x1C: { n:'PtgErr', f:parse_PtgErr },\n0x1D: { n:'PtgBool', f:parse_PtgBool },\n0x1E: { n:'PtgInt', f:parse_PtgInt },\n0x1F: { n:'PtgNum', f:parse_PtgNum },\n0x20: { n:'PtgArray', f:parse_PtgArray },\n0x21: { n:'PtgFunc', f:parse_PtgFunc },\n0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\n0x23: { n:'PtgName', f:parse_PtgName },\n0x24: { n:'PtgRef', f:parse_PtgRef },\n0x25: { n:'PtgArea', f:parse_PtgArea },\n0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\n0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\n0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\n0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\n0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\n0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\n0x2C: { n:'PtgRefN', f:parse_PtgRefN },\n0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\n0x2E: { n:'PtgMemAreaN', f:parse_PtgMemAreaN },\n0x2F: { n:'PtgMemNoMemN', f:parse_PtgMemNoMemN },\n0x39: { n:'PtgNameX', f:parse_PtgNameX },\n0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\n0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\n0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\n0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\n0xFF: {}\n};\n/* These are duplicated in the PtgTypes table */\nvar PtgDupes = {\n0x40: 0x20, 0x60: 0x20,\n0x41: 0x21, 0x61: 0x21,\n0x42: 0x22, 0x62: 0x22,\n0x43: 0x23, 0x63: 0x23,\n0x44: 0x24, 0x64: 0x24,\n0x45: 0x25, 0x65: 0x25,\n0x46: 0x26, 0x66: 0x26,\n0x47: 0x27, 0x67: 0x27,\n0x48: 0x28, 0x68: 0x28,\n0x49: 0x29, 0x69: 0x29,\n0x4A: 0x2A, 0x6A: 0x2A,\n0x4B: 0x2B, 0x6B: 0x2B,\n0x4C: 0x2C, 0x6C: 0x2C,\n0x4D: 0x2D, 0x6D: 0x2D,\n0x4E: 0x2E, 0x6E: 0x2E,\n0x4F: 0x2F, 0x6F: 0x2F,\n0x58: 0x22, 0x78: 0x22,\n0x59: 0x39, 0x79: 0x39,\n0x5A: 0x3A, 0x7A: 0x3A,\n0x5B: 0x3B, 0x7B: 0x3B,\n0x5C: 0x3C, 0x7C: 0x3C,\n0x5D: 0x3D, 0x7D: 0x3D\n};\n\nvar Ptg18 = {\n0x01: { n:'PtgElfLel', f:parse_PtgElfLel },\n0x02: { n:'PtgElfRw', f:parse_PtgElfRw },\n0x03: { n:'PtgElfCol', f:parse_PtgElfCol },\n0x06: { n:'PtgElfRwV', f:parse_PtgElfRwV },\n0x07: { n:'PtgElfColV', f:parse_PtgElfColV },\n0x0A: { n:'PtgElfRadical', f:parse_PtgElfRadical },\n0x0B: { n:'PtgElfRadicalS', f:parse_PtgElfRadicalS },\n0x0D: { n:'PtgElfColS', f:parse_PtgElfColS },\n0x0F: { n:'PtgElfColSV', f:parse_PtgElfColSV },\n0x10: { n:'PtgElfRadicalLel', f:parse_PtgElfRadicalLel },\n0x19: { n:'PtgList', f:parse_PtgList },\n0x1D: { n:'PtgSxName', f:parse_PtgSxName },\n0xFF: {}\n};\nvar Ptg19 = {\n0x00: { n:'PtgAttrNoop', f:parse_PtgAttrNoop },\n0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\n0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\n0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\n0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\n0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\n0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n0x21: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\n0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\n0x80: { n:'PtgAttrIfError', f:parse_PtgAttrIfError },\n0xFF: {}\n};\n\n/* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n\tif(opts.biff < 8) return parsenoop(blob, length);\n\tvar target = blob.l + length;\n\tvar o = [];\n\tfor(var i = 0; i !== rgce.length; ++i) {\n\t\tswitch(rgce[i][0]) {\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n\t\t\t\to.push(rgce[i][1]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n\t\t\t\to.push(rgce[i][2]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgExp': /* PtgExp -> PtgExtraCol */\n\t\t\t\tif(opts && opts.biff == 12) {\n\t\t\t\t\trgce[i][1][1] = blob.read_shift(4);\n\t\t\t\t\to.push(rgce[i][1]);\n\t\t\t\t} break;\n\t\t\tcase 'PtgList': /* TODO: PtgList -> PtgExtraList */\n\t\t\tcase 'PtgElfRadicalS': /* TODO: PtgElfRadicalS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColS': /* TODO: PtgElfColS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColSV': /* TODO: PtgElfColSV -> PtgExtraElf */\n\t\t\t\tthrow \"Unsupported \" + rgce[i][0];\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tlength = target - blob.l;\n\t/* note: this is technically an error but Excel disregards */\n\t//if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n\tif(length !== 0) o.push(parsenoop(blob, length));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\nfunction parse_Rgce(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar R, id, ptgs = [];\n\twhile(target != blob.l) {\n\t\tlength = target - blob.l;\n\t\tid = blob[blob.l];\n\t\tR = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n\t\tif(id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n\t\tif(!R || !R.f) { /*ptgs.push*/(parsenoop(blob, length)); }\n\t\telse { ptgs.push([R.n, R.f(blob, length, opts)]); }\n\t}\n\treturn ptgs;\n}\n\nfunction stringify_array(f) {\n\tvar o = [];\n\tfor(var i = 0; i < f.length; ++i) {\n\t\tvar x = f[i], r = [];\n\t\tfor(var j = 0; j < x.length; ++j) {\n\t\t\tvar y = x[j];\n\t\t\tif(y) switch(y[0]) {\n\t\t\t\t// TODO: handle embedded quotes\n\t\t\t\tcase 0x02:\nr.push('\"' + y[1].replace(/\"/g,'\"\"') + '\"'); break;\n\t\t\t\tdefault: r.push(y[1]);\n\t\t\t} else r.push(\"\");\n\t\t}\n\t\to.push(r.join(\",\"));\n\t}\n\treturn o.join(\";\");\n}\n\n/* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\nvar PtgBinOp = {\n\tPtgAdd: \"+\",\n\tPtgConcat: \"&\",\n\tPtgDiv: \"/\",\n\tPtgEq: \"=\",\n\tPtgGe: \">=\",\n\tPtgGt: \">\",\n\tPtgLe: \"<=\",\n\tPtgLt: \"<\",\n\tPtgMul: \"*\",\n\tPtgNe: \"<>\",\n\tPtgPower: \"^\",\n\tPtgSub: \"-\"\n};\n\n// TODO: explore space\nfunction make_3d_range(start, end) {\n\tvar s = start.lastIndexOf(\"!\"), e = end.lastIndexOf(\"!\");\n\tif(s == -1 && e == -1) return start + \":\" + end;\n\tif(s > 0 && e > 0 && start.slice(0, s).toLowerCase() == end.slice(0, e).toLowerCase()) return start + \":\" + end.slice(e+1);\n\tconsole.error(\"Cannot hydrate range\", start, end);\n\treturn start + \":\" + end;\n}\n\nfunction get_ixti_raw(supbooks, ixti, opts) {\n\tif(!supbooks) return \"SH33TJSERR0\";\n\tif(opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n\tif(!supbooks.XTI) return \"SH33TJSERR6\";\n\tvar XTI = supbooks.XTI[ixti];\n\tif(opts.biff < 8) {\n\t\tif(ixti > 10000) ixti-= 65536;\n\t\tif(ixti < 0) ixti = -ixti;\n\t\treturn ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n\t}\n\tif(!XTI) return \"SH33TJSERR1\";\n\tvar o = \"\";\n\tif(opts.biff > 8) switch(supbooks[XTI[0]][0]) {\n\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\to = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tif(opts.SID != null) return supbooks.SheetNames[opts.SID];\n\t\t\treturn \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\t/* falls through */\n\t\tdefault: return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n\t}\n\tswitch(supbooks[XTI[0]][0][0]) {\n\t\tcase 0x0401:\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x3A01: return supbooks[XTI[0]].slice(1).map(function(name) { return name.Name; }).join(\";;\"); //return \"SH33TJSERR8\";\n\t\tdefault:\n\t\t\tif(!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n\t}\n}\nfunction get_ixti(supbooks, ixti, opts) {\n\tvar ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n\treturn ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n}\nfunction stringify_formula(formula/*Array<any>*/, range, cell, supbooks, opts) {\n\tvar biff = (opts && opts.biff) || 8;\n\tvar _range = /*range != null ? range :*/ {s:{c:0, r:0},e:{c:0, r:0}};\n\tvar stack = [], e1, e2,  c, ixti=0, nameidx=0, r, sname=\"\";\n\tif(!formula[0] || !formula[0][0]) return \"\";\n\tvar last_sp = -1, sp = \"\";\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n\t\tvar f = formula[0][ff];\n\t\tswitch(f[0]) {\n\t\t\tcase 'PtgUminus': /* [MS-XLS] 2.5.198.93 */\n\t\t\t\tstack.push(\"-\" + stack.pop()); break;\n\t\t\tcase 'PtgUplus': /* [MS-XLS] 2.5.198.95 */\n\t\t\t\tstack.push(\"+\" + stack.pop()); break;\n\t\t\tcase 'PtgPercent': /* [MS-XLS] 2.5.198.81 */\n\t\t\t\tstack.push(stack.pop() + \"%\"); break;\n\n\t\t\tcase 'PtgAdd':    /* [MS-XLS] 2.5.198.26 */\n\t\t\tcase 'PtgConcat': /* [MS-XLS] 2.5.198.43 */\n\t\t\tcase 'PtgDiv':    /* [MS-XLS] 2.5.198.45 */\n\t\t\tcase 'PtgEq':     /* [MS-XLS] 2.5.198.56 */\n\t\t\tcase 'PtgGe':     /* [MS-XLS] 2.5.198.64 */\n\t\t\tcase 'PtgGt':     /* [MS-XLS] 2.5.198.65 */\n\t\t\tcase 'PtgLe':     /* [MS-XLS] 2.5.198.68 */\n\t\t\tcase 'PtgLt':     /* [MS-XLS] 2.5.198.69 */\n\t\t\tcase 'PtgMul':    /* [MS-XLS] 2.5.198.75 */\n\t\t\tcase 'PtgNe':     /* [MS-XLS] 2.5.198.78 */\n\t\t\tcase 'PtgPower':  /* [MS-XLS] 2.5.198.82 */\n\t\t\tcase 'PtgSub':    /* [MS-XLS] 2.5.198.90 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\" \", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\"\\r\", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tsp = \"\";\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\te2 = e2 + sp;\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(e2+PtgBinOp[f[0]]+e1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgIsect': /* [MS-XLS] 2.5.198.67 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\" \"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgUnion': /* [MS-XLS] 2.5.198.94 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\",\"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRange': /* [MS-XLS] 2.5.198.83 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(make_3d_range(e2,e1));\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrChoose': /* [MS-XLS] 2.5.198.34 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrGoto': /* [MS-XLS] 2.5.198.35 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIf': /* [MS-XLS] 2.5.198.36 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIfError': /* [MS-XLSB] 2.5.97.28 */\n\t\t\t\tbreak;\n\n\n\t\t\tcase 'PtgRef': /* [MS-XLS] 2.5.198.84 */\nc = shift_cell_xls((f[1][1]), _range, opts);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRefN': /* [MS-XLS] 2.5.198.88 */\nc = cell ? shift_cell_xls((f[1][1]), cell, opts) : (f[1][1]);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRef3d': /* [MS-XLS] 2.5.198.85 */\nixti = f[1][1]; c = shift_cell_xls((f[1][2]), _range, opts);\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tvar w = sname; /* IE9 fails on defined names */ // eslint-disable-line no-unused-vars\n\t\t\t\tstack.push(sname + \"!\" + encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgFunc': /* [MS-XLS] 2.5.198.62 */\n\t\t\tcase 'PtgFuncVar': /* [MS-XLS] 2.5.198.63 */\n\t\t\t\t/* f[1] = [argc, func, type] */\n\t\t\t\tvar argc = (f[1][0]), func = (f[1][1]);\n\t\t\t\tif(!argc) argc = 0;\n\t\t\t\targc &= 0x7F;\n\t\t\t\tvar args = argc == 0 ? [] : stack.slice(-argc);\n\t\t\t\tstack.length -= argc;\n\t\t\t\tif(func === 'User') func = args.shift();\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgBool': /* [MS-XLS] 2.5.198.42 */\n\t\t\t\tstack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\n\t\t\tcase 'PtgInt': /* [MS-XLS] 2.5.198.66 */\n\t\t\t\tstack.push(f[1]); break;\n\t\t\tcase 'PtgNum': /* [MS-XLS] 2.5.198.79 TODO: precision? */\n\t\t\t\tstack.push(String(f[1])); break;\n\t\t\tcase 'PtgStr': /* [MS-XLS] 2.5.198.89 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"'); break;\n\t\t\tcase 'PtgErr': /* [MS-XLS] 2.5.198.57 */\n\t\t\t\tstack.push(f[1]); break;\n\t\t\tcase 'PtgAreaN': /* [MS-XLS] 2.5.198.31 TODO */\nr = shift_range_xls(f[1][1], cell ? {s:cell} : _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea': /* [MS-XLS] 2.5.198.27 TODO: fixed points */\nr = shift_range_xls(f[1][1], _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea3d': /* [MS-XLS] 2.5.198.28 TODO */\nixti = f[1][1]; r = f[1][2];\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tstack.push(sname + \"!\" + encode_range_xls((r), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrSum': /* [MS-XLS] 2.5.198.41 */\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrBaxcel': /* [MS-XLS] 2.5.198.33 */\n\t\t\tcase 'PtgAttrSemi': /* [MS-XLS] 2.5.198.37 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgName': /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n\t\t\t\t/* f[1] = type, 0, nameindex */\n\t\t\t\tnameidx = (f[1][2]);\n\t\t\t\tvar lbl = (supbooks.names||[])[nameidx-1] || (supbooks[0]||[])[nameidx];\n\t\t\t\tvar name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n\t\t\t\t/* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n\t\t\t\tif(name && name.slice(0,6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n\t\t\t\tstack.push(name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgNameX': /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n\t\t\t\t/* f[1] = type, ixti, nameindex */\n\t\t\t\tvar bookidx = (f[1][1]); nameidx = (f[1][2]); var externbook;\n\t\t\t\t/* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n\t\t\t\tif(opts.biff <= 5) {\n\t\t\t\t\tif(bookidx < 0) bookidx = -bookidx;\n\t\t\t\t\tif(supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n\t\t\t\t} else {\n\t\t\t\t\tvar o = \"\";\n\t\t\t\t\tif(((supbooks[bookidx]||[])[0]||[])[0] == 0x3A01){/* empty */}\n\t\t\t\t\telse if(((supbooks[bookidx]||[])[0]||[])[0] == 0x0401){\n\t\t\t\t\t\tif(supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n\t\t\t\t\t\t\to = supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1] + \"!\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse o = supbooks.SheetNames[nameidx-1]+ \"!\";\n\t\t\t\t\tif(supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;\n\t\t\t\t\telse if(supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar ixtidata = (get_ixti_raw(supbooks, bookidx, opts)||\"\").split(\";;\");\n\t\t\t\t\t\tif(ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n\t\t\t\t\t\telse o += \"SH33TJSERRX\";\n\t\t\t\t\t}\n\t\t\t\t\tstack.push(o);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!externbook) externbook = {Name: \"SH33TJSERRY\"};\n\t\t\t\tstack.push(externbook.Name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgParen': /* [MS-XLS] 2.5.198.80 */\n\t\t\t\tvar lp = '(', rp = ')';\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 2: lp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 3: lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 4: rp = fill(\" \", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 5: rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(lp + stack.pop() + rp); break;\n\n\t\t\tcase 'PtgRefErr': /* [MS-XLS] 2.5.198.86 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgRefErr3d': /* [MS-XLS] 2.5.198.87 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgExp': /* [MS-XLS] 2.5.198.58 TODO */\n\t\t\t\tc = {c:(f[1][1]),r:(f[1][0])};\n\t\t\t\tvar q = ({c: cell.c, r:cell.r});\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n\t\t\t\t} else {\n\t\t\t\t\tvar fnd = false;\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\n\t\t\t\t\t\t/* TODO: should be something like range_has */\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n\t\t\t\t\t\tfnd = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(!fnd) stack.push(f[1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgArray': /* [MS-XLS] 2.5.198.32 TODO */\n\t\t\t\tstack.push(\"{\" + stringify_array(f[1]) + \"}\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemArea': /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrSpace': /* [MS-XLS] 2.5.198.38 */\n\t\t\tcase 'PtgAttrSpaceSemi': /* [MS-XLS] 2.5.198.39 */\n\t\t\t\tlast_sp = ff;\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgTbl': /* [MS-XLS] 2.5.198.92 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemErr': /* [MS-XLS] 2.5.198.71 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMissArg': /* [MS-XLS] 2.5.198.74 */\n\t\t\t\tstack.push(\"\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAreaErr': /* [MS-XLS] 2.5.198.29 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgAreaErr3d': /* [MS-XLS] 2.5.198.30 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgList': /* [MS-XLSB] 2.5.97.52 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemAreaN':\n\t\t\tcase 'PtgMemNoMemN':\n\t\t\tcase 'PtgAttrNoop':\n\t\t\tcase 'PtgSheet':\n\t\t\tcase 'PtgEndSheet':\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemFunc': /* [MS-XLS] 2.5.198.72 TODO */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemNoMem': /* [MS-XLS] 2.5.198.73 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgElfCol': /* [MS-XLS] 2.5.198.46 */\n\t\t\tcase 'PtgElfColS': /* [MS-XLS] 2.5.198.47 */\n\t\t\tcase 'PtgElfColSV': /* [MS-XLS] 2.5.198.48 */\n\t\t\tcase 'PtgElfColV': /* [MS-XLS] 2.5.198.49 */\n\t\t\tcase 'PtgElfLel': /* [MS-XLS] 2.5.198.50 */\n\t\t\tcase 'PtgElfRadical': /* [MS-XLS] 2.5.198.51 */\n\t\t\tcase 'PtgElfRadicalLel': /* [MS-XLS] 2.5.198.52 */\n\t\t\tcase 'PtgElfRadicalS': /* [MS-XLS] 2.5.198.53 */\n\t\t\tcase 'PtgElfRw': /* [MS-XLS] 2.5.198.54 */\n\t\t\tcase 'PtgElfRwV': /* [MS-XLS] 2.5.198.55 */\n\t\t\t\tthrow new Error(\"Unsupported ELFs\");\n\n\t\t\tcase 'PtgSxName': /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n\t\t\t\tthrow new Error('Unrecognized Formula Token: ' + String(f));\n\t\t\tdefault: throw new Error('Unrecognized Formula Token: ' + String(f));\n\t\t}\n\t\tvar PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n\t\tif(opts.biff != 3) if(last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n\t\t\tf = formula[0][last_sp];\n\t\t\tvar _left = true;\n\t\t\tswitch(f[1][0]) {\n\t\t\t\t/* note: some bad XLSB files omit the PtgParen */\n\t\t\t\tcase 4: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 0:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\" \", f[1][1]); break;\n\t\t\t\tcase 5: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 1:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\"\\r\", f[1][1]); break;\n\t\t\t\tdefault:\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n\t\t\t}\n\t\t\tstack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n\t\t\tlast_sp = -1;\n\t\t}\n\t}\n\tif(stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n\tif(stack[0] == \"TRUE\") return true; if(stack[0] == \"FALSE\") return false;\n\treturn stack[0];\n}\n\n/* [MS-XLS] 2.5.198.1 TODO */\nfunction parse_ArrayParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.3 TODO */\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.21 */\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n\tvar target = blob.l + length;\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tvar rgcb;\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.118 TODO */\nfunction parse_SharedParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\nfunction parse_FormulaValue(blob) {\n\tvar b;\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\n\tswitch(blob[blob.l]) {\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\n\t}\n\treturn [];\n}\nfunction write_FormulaValue(value) {\n\tif(value == null) {\n\t\t// Blank String Value\n\t\tvar o = new_buf(8);\n\t\to.write_shift(1, 0x03);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0xFFFF);\n\t\treturn o;\n\t} else if(typeof value == \"number\") return write_Xnum(value);\n\treturn write_Xnum(0);\n}\n\n/* [MS-XLS] 2.4.127 TODO */\nfunction parse_Formula(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar val = parse_FormulaValue(blob,8);\n\tvar flags = blob.read_shift(1);\n\tif(opts.biff != 2) {\n\t\tblob.read_shift(1);\n\t\tif(opts.biff >= 5) {\n\t\t\t/*var chn = */blob.read_shift(4);\n\t\t}\n\t}\n\tvar cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\n}\nfunction write_Formula(cell, R, C, opts, os) {\n\t// Cell\n\tvar o1 = write_XLSCell(R, C, os);\n\n\t// FormulaValue\n\tvar o2 = write_FormulaValue(cell.v);\n\n\t// flags + cache\n\tvar o3 = new_buf(6);\n\tvar flags = 0x01 | 0x20;\n\to3.write_shift(2, flags);\n\to3.write_shift(4, 0);\n\n\t// CellParsedFormula\n\tvar bf = new_buf(cell.bf.length);\n\tfor(var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];\n\n\tvar out = bconcat([o1, o2, o3, bf]);\n\treturn out;\n}\n\n\n/* XLSB Parsed Formula records have the same shape */\nfunction parse_XLSBParsedFormula(data, length, opts) {\n\tvar cce = data.read_shift(4);\n\tvar rgce = parse_Rgce(data, cce, opts);\n\tvar cb = data.read_shift(4);\n\tvar rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\nvar parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula */\nvar parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n//var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n//var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n/* [MS-XLSB] 2.5.97.12 NameParsedFormula */\nvar parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\nvar parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\n\n/* Writes a PtgNum or PtgInt */\nfunction write_XLSBFormulaNum(val) {\n\tif((val | 0) == val && val < Math.pow(2,16) && val >= 0) {\n\t\tvar oint = new_buf(11);\n\t\toint.write_shift(4, 3);\n\t\toint.write_shift(1, 0x1e);\n\t\toint.write_shift(2, val);\n\t\toint.write_shift(4, 0);\n\t\treturn oint;\n\t}\n\n\tvar num = new_buf(17);\n\tnum.write_shift(4, 11);\n\tnum.write_shift(1, 0x1f);\n\tnum.write_shift(8, val);\n\tnum.write_shift(4, 0);\n\treturn num;\n}\n/* Writes a PtgErr */\nfunction write_XLSBFormulaErr(val) {\n\tvar oint = new_buf(10);\n\toint.write_shift(4, 2);\n\toint.write_shift(1, 0x1C);\n\toint.write_shift(1, val);\n\toint.write_shift(4, 0);\n\treturn oint;\n}\n/* Writes a PtgBool */\nfunction write_XLSBFormulaBool(val) {\n\tvar oint = new_buf(10);\n\toint.write_shift(4, 2);\n\toint.write_shift(1, 0x1D);\n\toint.write_shift(1, val?1:0);\n\toint.write_shift(4, 0);\n\treturn oint;\n}\n\n/* Writes a PtgStr */\nfunction write_XLSBFormulaStr(val) {\n\tvar preamble = new_buf(7);\n\tpreamble.write_shift(4, 3 + 2 * val.length);\n\tpreamble.write_shift(1, 0x17);\n\tpreamble.write_shift(2, val.length);\n\n\tvar body = new_buf(2 * val.length);\n\tbody.write_shift(2 * val.length, val, \"utf16le\");\n\n\tvar postamble = new_buf(4);\n\tpostamble.write_shift(4, 0);\n\n\treturn bconcat([preamble, body, postamble]);\n}\n\n/* Writes a PtgRef */\nfunction write_XLSBFormulaRef(str) {\n\tvar cell = decode_cell(str);\n\tvar out = new_buf(15);\n\tout.write_shift(4, 7);\n\tout.write_shift(1, 0x04 | ((1)<<5));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a PtgRef3d */\nfunction write_XLSBFormulaRef3D(str, wb) {\n\tvar lastbang = str.lastIndexOf(\"!\");\n\tvar sname = str.slice(0, lastbang);\n\tstr = str.slice(lastbang+1);\n\tvar cell = decode_cell(str);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\n\tvar out = new_buf(17);\n\tout.write_shift(4, 9);\n\tout.write_shift(1, 0x1A | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a PtgRefErr3d */\nfunction write_XLSBFormulaRefErr3D(str, wb) {\n\tvar lastbang = str.lastIndexOf(\"!\");\n\tvar sname = str.slice(0, lastbang);\n\tstr = str.slice(lastbang+1);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\n\tvar out = new_buf(17);\n\tout.write_shift(4, 9);\n\tout.write_shift(1, 0x1C | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, 0);\n\tout.write_shift(2, 0); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a single sheet range [PtgRef PtgRef PtgRange] */\nfunction write_XLSBFormulaRange(_str) {\n\tvar parts = _str.split(\":\"), str = parts[0];\n\n\tvar out = new_buf(23);\n\tout.write_shift(4, 15);\n\n\t/* start cell */\n\tstr = parts[0]; var cell = decode_cell(str);\n\tout.write_shift(1, 0x04 | ((1)<<5));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\t/* end cell */\n\tstr = parts[1]; cell = decode_cell(str);\n\tout.write_shift(1, 0x04 | ((1)<<5));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\t/* PtgRange */\n\tout.write_shift(1, 0x11);\n\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a range with explicit sheet name [PtgRef3D PtgRef3D PtgRange] */\nfunction write_XLSBFormulaRangeWS(_str, wb) {\n\tvar lastbang = _str.lastIndexOf(\"!\");\n\tvar sname = _str.slice(0, lastbang);\n\t_str = _str.slice(lastbang+1);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\tvar parts = _str.split(\":\");\n\n\tvar out = new_buf(27);\n\tout.write_shift(4, 19);\n\n\t/* start cell */\n\tvar str = parts[0], cell = decode_cell(str);\n\tout.write_shift(1, 0x1A | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\n\t/* end cell */\n\tstr = parts[1]; cell = decode_cell(str);\n\tout.write_shift(1, 0x1A | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\n\t/* PtgRange */\n\tout.write_shift(1, 0x11);\n\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a range with explicit sheet name [PtgArea3d] */\nfunction write_XLSBFormulaArea3D(_str, wb) {\n\tvar lastbang = _str.lastIndexOf(\"!\");\n\tvar sname = _str.slice(0, lastbang);\n\t_str = _str.slice(lastbang+1);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\tvar range = decode_range(_str);\n\n\tvar out = new_buf(23);\n\tout.write_shift(4, 15);\n\n\tout.write_shift(1, 0x1B | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, range.s.r);\n\tout.write_shift(4, range.e.r);\n\tout.write_shift(2, range.s.c);\n\tout.write_shift(2, range.e.c);\n\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n\n/* General Formula */\nfunction write_XLSBFormula(val, wb) {\n\tif(typeof val == \"number\") return write_XLSBFormulaNum(val);\n\tif(typeof val == \"boolean\") return write_XLSBFormulaBool(val);\n\tif(/^#(DIV\\/0!|GETTING_DATA|N\\/A|NAME\\?|NULL!|NUM!|REF!|VALUE!)$/.test(val)) return write_XLSBFormulaErr(+RBErr[val]);\n\tif(val.match(/^\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRef(val);\n\tif(val.match(/^\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5}):\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRange(val);\n\tif(val.match(/^#REF!\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5}):\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaArea3D(val, wb);\n\tif(val.match(/^(?:'[^\\\\\\/?*\\[\\]:]*'|[^'][^\\\\\\/?*\\[\\]:'`~!@#$%^()\\-=+{}|;,<.>]*)!\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRef3D(val, wb);\n\tif(val.match(/^(?:'[^\\\\\\/?*\\[\\]:]*'|[^'][^\\\\\\/?*\\[\\]:'`~!@#$%^()\\-=+{}|;,<.>]*)!\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5}):\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRangeWS(val, wb);\n\tif(/^(?:'[^\\\\\\/?*\\[\\]:]*'|[^'][^\\\\\\/?*\\[\\]:'`~!@#$%^()\\-=+{}|;,<.>]*)!#REF!$/.test(val)) return write_XLSBFormulaRefErr3D(val, wb);\n\tif(/^\".*\"$/.test(val)) return write_XLSBFormulaStr(val);\n\tif(/^[+-]\\d+$/.test(val)) return write_XLSBFormulaNum(parseInt(val, 10));\n\tthrow \"Formula |\" + val + \"| not supported for XLSB\";\n}\nvar write_XLSBNameParsedFormula = write_XLSBFormula;\nvar Cetab = {\n  0: \"BEEP\",\n  1: \"OPEN\",\n  2: \"OPEN.LINKS\",\n  3: \"CLOSE.ALL\",\n  4: \"SAVE\",\n  5: \"SAVE.AS\",\n  6: \"FILE.DELETE\",\n  7: \"PAGE.SETUP\",\n  8: \"PRINT\",\n  9: \"PRINTER.SETUP\",\n  10: \"QUIT\",\n  11: \"NEW.WINDOW\",\n  12: \"ARRANGE.ALL\",\n  13: \"WINDOW.SIZE\",\n  14: \"WINDOW.MOVE\",\n  15: \"FULL\",\n  16: \"CLOSE\",\n  17: \"RUN\",\n  22: \"SET.PRINT.AREA\",\n  23: \"SET.PRINT.TITLES\",\n  24: \"SET.PAGE.BREAK\",\n  25: \"REMOVE.PAGE.BREAK\",\n  26: \"FONT\",\n  27: \"DISPLAY\",\n  28: \"PROTECT.DOCUMENT\",\n  29: \"PRECISION\",\n  30: \"A1.R1C1\",\n  31: \"CALCULATE.NOW\",\n  32: \"CALCULATION\",\n  34: \"DATA.FIND\",\n  35: \"EXTRACT\",\n  36: \"DATA.DELETE\",\n  37: \"SET.DATABASE\",\n  38: \"SET.CRITERIA\",\n  39: \"SORT\",\n  40: \"DATA.SERIES\",\n  41: \"TABLE\",\n  42: \"FORMAT.NUMBER\",\n  43: \"ALIGNMENT\",\n  44: \"STYLE\",\n  45: \"BORDER\",\n  46: \"CELL.PROTECTION\",\n  47: \"COLUMN.WIDTH\",\n  48: \"UNDO\",\n  49: \"CUT\",\n  50: \"COPY\",\n  51: \"PASTE\",\n  52: \"CLEAR\",\n  53: \"PASTE.SPECIAL\",\n  54: \"EDIT.DELETE\",\n  55: \"INSERT\",\n  56: \"FILL.RIGHT\",\n  57: \"FILL.DOWN\",\n  61: \"DEFINE.NAME\",\n  62: \"CREATE.NAMES\",\n  63: \"FORMULA.GOTO\",\n  64: \"FORMULA.FIND\",\n  65: \"SELECT.LAST.CELL\",\n  66: \"SHOW.ACTIVE.CELL\",\n  67: \"GALLERY.AREA\",\n  68: \"GALLERY.BAR\",\n  69: \"GALLERY.COLUMN\",\n  70: \"GALLERY.LINE\",\n  71: \"GALLERY.PIE\",\n  72: \"GALLERY.SCATTER\",\n  73: \"COMBINATION\",\n  74: \"PREFERRED\",\n  75: \"ADD.OVERLAY\",\n  76: \"GRIDLINES\",\n  77: \"SET.PREFERRED\",\n  78: \"AXES\",\n  79: \"LEGEND\",\n  80: \"ATTACH.TEXT\",\n  81: \"ADD.ARROW\",\n  82: \"SELECT.CHART\",\n  83: \"SELECT.PLOT.AREA\",\n  84: \"PATTERNS\",\n  85: \"MAIN.CHART\",\n  86: \"OVERLAY\",\n  87: \"SCALE\",\n  88: \"FORMAT.LEGEND\",\n  89: \"FORMAT.TEXT\",\n  90: \"EDIT.REPEAT\",\n  91: \"PARSE\",\n  92: \"JUSTIFY\",\n  93: \"HIDE\",\n  94: \"UNHIDE\",\n  95: \"WORKSPACE\",\n  96: \"FORMULA\",\n  97: \"FORMULA.FILL\",\n  98: \"FORMULA.ARRAY\",\n  99: \"DATA.FIND.NEXT\",\n  100: \"DATA.FIND.PREV\",\n  101: \"FORMULA.FIND.NEXT\",\n  102: \"FORMULA.FIND.PREV\",\n  103: \"ACTIVATE\",\n  104: \"ACTIVATE.NEXT\",\n  105: \"ACTIVATE.PREV\",\n  106: \"UNLOCKED.NEXT\",\n  107: \"UNLOCKED.PREV\",\n  108: \"COPY.PICTURE\",\n  109: \"SELECT\",\n  110: \"DELETE.NAME\",\n  111: \"DELETE.FORMAT\",\n  112: \"VLINE\",\n  113: \"HLINE\",\n  114: \"VPAGE\",\n  115: \"HPAGE\",\n  116: \"VSCROLL\",\n  117: \"HSCROLL\",\n  118: \"ALERT\",\n  119: \"NEW\",\n  120: \"CANCEL.COPY\",\n  121: \"SHOW.CLIPBOARD\",\n  122: \"MESSAGE\",\n  124: \"PASTE.LINK\",\n  125: \"APP.ACTIVATE\",\n  126: \"DELETE.ARROW\",\n  127: \"ROW.HEIGHT\",\n  128: \"FORMAT.MOVE\",\n  129: \"FORMAT.SIZE\",\n  130: \"FORMULA.REPLACE\",\n  131: \"SEND.KEYS\",\n  132: \"SELECT.SPECIAL\",\n  133: \"APPLY.NAMES\",\n  134: \"REPLACE.FONT\",\n  135: \"FREEZE.PANES\",\n  136: \"SHOW.INFO\",\n  137: \"SPLIT\",\n  138: \"ON.WINDOW\",\n  139: \"ON.DATA\",\n  140: \"DISABLE.INPUT\",\n  142: \"OUTLINE\",\n  143: \"LIST.NAMES\",\n  144: \"FILE.CLOSE\",\n  145: \"SAVE.WORKBOOK\",\n  146: \"DATA.FORM\",\n  147: \"COPY.CHART\",\n  148: \"ON.TIME\",\n  149: \"WAIT\",\n  150: \"FORMAT.FONT\",\n  151: \"FILL.UP\",\n  152: \"FILL.LEFT\",\n  153: \"DELETE.OVERLAY\",\n  155: \"SHORT.MENUS\",\n  159: \"SET.UPDATE.STATUS\",\n  161: \"COLOR.PALETTE\",\n  162: \"DELETE.STYLE\",\n  163: \"WINDOW.RESTORE\",\n  164: \"WINDOW.MAXIMIZE\",\n  166: \"CHANGE.LINK\",\n  167: \"CALCULATE.DOCUMENT\",\n  168: \"ON.KEY\",\n  169: \"APP.RESTORE\",\n  170: \"APP.MOVE\",\n  171: \"APP.SIZE\",\n  172: \"APP.MINIMIZE\",\n  173: \"APP.MAXIMIZE\",\n  174: \"BRING.TO.FRONT\",\n  175: \"SEND.TO.BACK\",\n  185: \"MAIN.CHART.TYPE\",\n  186: \"OVERLAY.CHART.TYPE\",\n  187: \"SELECT.END\",\n  188: \"OPEN.MAIL\",\n  189: \"SEND.MAIL\",\n  190: \"STANDARD.FONT\",\n  191: \"CONSOLIDATE\",\n  192: \"SORT.SPECIAL\",\n  193: \"GALLERY.3D.AREA\",\n  194: \"GALLERY.3D.COLUMN\",\n  195: \"GALLERY.3D.LINE\",\n  196: \"GALLERY.3D.PIE\",\n  197: \"VIEW.3D\",\n  198: \"GOAL.SEEK\",\n  199: \"WORKGROUP\",\n  200: \"FILL.GROUP\",\n  201: \"UPDATE.LINK\",\n  202: \"PROMOTE\",\n  203: \"DEMOTE\",\n  204: \"SHOW.DETAIL\",\n  206: \"UNGROUP\",\n  207: \"OBJECT.PROPERTIES\",\n  208: \"SAVE.NEW.OBJECT\",\n  209: \"SHARE\",\n  210: \"SHARE.NAME\",\n  211: \"DUPLICATE\",\n  212: \"APPLY.STYLE\",\n  213: \"ASSIGN.TO.OBJECT\",\n  214: \"OBJECT.PROTECTION\",\n  215: \"HIDE.OBJECT\",\n  216: \"SET.EXTRACT\",\n  217: \"CREATE.PUBLISHER\",\n  218: \"SUBSCRIBE.TO\",\n  219: \"ATTRIBUTES\",\n  220: \"SHOW.TOOLBAR\",\n  222: \"PRINT.PREVIEW\",\n  223: \"EDIT.COLOR\",\n  224: \"SHOW.LEVELS\",\n  225: \"FORMAT.MAIN\",\n  226: \"FORMAT.OVERLAY\",\n  227: \"ON.RECALC\",\n  228: \"EDIT.SERIES\",\n  229: \"DEFINE.STYLE\",\n  240: \"LINE.PRINT\",\n  243: \"ENTER.DATA\",\n  249: \"GALLERY.RADAR\",\n  250: \"MERGE.STYLES\",\n  251: \"EDITION.OPTIONS\",\n  252: \"PASTE.PICTURE\",\n  253: \"PASTE.PICTURE.LINK\",\n  254: \"SPELLING\",\n  256: \"ZOOM\",\n  259: \"INSERT.OBJECT\",\n  260: \"WINDOW.MINIMIZE\",\n  265: \"SOUND.NOTE\",\n  266: \"SOUND.PLAY\",\n  267: \"FORMAT.SHAPE\",\n  268: \"EXTEND.POLYGON\",\n  269: \"FORMAT.AUTO\",\n  272: \"GALLERY.3D.BAR\",\n  273: \"GALLERY.3D.SURFACE\",\n  274: \"FILL.AUTO\",\n  276: \"CUSTOMIZE.TOOLBAR\",\n  277: \"ADD.TOOL\",\n  278: \"EDIT.OBJECT\",\n  279: \"ON.DOUBLECLICK\",\n  280: \"ON.ENTRY\",\n  281: \"WORKBOOK.ADD\",\n  282: \"WORKBOOK.MOVE\",\n  283: \"WORKBOOK.COPY\",\n  284: \"WORKBOOK.OPTIONS\",\n  285: \"SAVE.WORKSPACE\",\n  288: \"CHART.WIZARD\",\n  289: \"DELETE.TOOL\",\n  290: \"MOVE.TOOL\",\n  291: \"WORKBOOK.SELECT\",\n  292: \"WORKBOOK.ACTIVATE\",\n  293: \"ASSIGN.TO.TOOL\",\n  295: \"COPY.TOOL\",\n  296: \"RESET.TOOL\",\n  297: \"CONSTRAIN.NUMERIC\",\n  298: \"PASTE.TOOL\",\n  302: \"WORKBOOK.NEW\",\n  305: \"SCENARIO.CELLS\",\n  306: \"SCENARIO.DELETE\",\n  307: \"SCENARIO.ADD\",\n  308: \"SCENARIO.EDIT\",\n  309: \"SCENARIO.SHOW\",\n  310: \"SCENARIO.SHOW.NEXT\",\n  311: \"SCENARIO.SUMMARY\",\n  312: \"PIVOT.TABLE.WIZARD\",\n  313: \"PIVOT.FIELD.PROPERTIES\",\n  314: \"PIVOT.FIELD\",\n  315: \"PIVOT.ITEM\",\n  316: \"PIVOT.ADD.FIELDS\",\n  318: \"OPTIONS.CALCULATION\",\n  319: \"OPTIONS.EDIT\",\n  320: \"OPTIONS.VIEW\",\n  321: \"ADDIN.MANAGER\",\n  322: \"MENU.EDITOR\",\n  323: \"ATTACH.TOOLBARS\",\n  324: \"VBAActivate\",\n  325: \"OPTIONS.CHART\",\n  328: \"VBA.INSERT.FILE\",\n  330: \"VBA.PROCEDURE.DEFINITION\",\n  336: \"ROUTING.SLIP\",\n  338: \"ROUTE.DOCUMENT\",\n  339: \"MAIL.LOGON\",\n  342: \"INSERT.PICTURE\",\n  343: \"EDIT.TOOL\",\n  344: \"GALLERY.DOUGHNUT\",\n  350: \"CHART.TREND\",\n  352: \"PIVOT.ITEM.PROPERTIES\",\n  354: \"WORKBOOK.INSERT\",\n  355: \"OPTIONS.TRANSITION\",\n  356: \"OPTIONS.GENERAL\",\n  370: \"FILTER.ADVANCED\",\n  373: \"MAIL.ADD.MAILER\",\n  374: \"MAIL.DELETE.MAILER\",\n  375: \"MAIL.REPLY\",\n  376: \"MAIL.REPLY.ALL\",\n  377: \"MAIL.FORWARD\",\n  378: \"MAIL.NEXT.LETTER\",\n  379: \"DATA.LABEL\",\n  380: \"INSERT.TITLE\",\n  381: \"FONT.PROPERTIES\",\n  382: \"MACRO.OPTIONS\",\n  383: \"WORKBOOK.HIDE\",\n  384: \"WORKBOOK.UNHIDE\",\n  385: \"WORKBOOK.DELETE\",\n  386: \"WORKBOOK.NAME\",\n  388: \"GALLERY.CUSTOM\",\n  390: \"ADD.CHART.AUTOFORMAT\",\n  391: \"DELETE.CHART.AUTOFORMAT\",\n  392: \"CHART.ADD.DATA\",\n  393: \"AUTO.OUTLINE\",\n  394: \"TAB.ORDER\",\n  395: \"SHOW.DIALOG\",\n  396: \"SELECT.ALL\",\n  397: \"UNGROUP.SHEETS\",\n  398: \"SUBTOTAL.CREATE\",\n  399: \"SUBTOTAL.REMOVE\",\n  400: \"RENAME.OBJECT\",\n  412: \"WORKBOOK.SCROLL\",\n  413: \"WORKBOOK.NEXT\",\n  414: \"WORKBOOK.PREV\",\n  415: \"WORKBOOK.TAB.SPLIT\",\n  416: \"FULL.SCREEN\",\n  417: \"WORKBOOK.PROTECT\",\n  420: \"SCROLLBAR.PROPERTIES\",\n  421: \"PIVOT.SHOW.PAGES\",\n  422: \"TEXT.TO.COLUMNS\",\n  423: \"FORMAT.CHARTTYPE\",\n  424: \"LINK.FORMAT\",\n  425: \"TRACER.DISPLAY\",\n  430: \"TRACER.NAVIGATE\",\n  431: \"TRACER.CLEAR\",\n  432: \"TRACER.ERROR\",\n  433: \"PIVOT.FIELD.GROUP\",\n  434: \"PIVOT.FIELD.UNGROUP\",\n  435: \"CHECKBOX.PROPERTIES\",\n  436: \"LABEL.PROPERTIES\",\n  437: \"LISTBOX.PROPERTIES\",\n  438: \"EDITBOX.PROPERTIES\",\n  439: \"PIVOT.REFRESH\",\n  440: \"LINK.COMBO\",\n  441: \"OPEN.TEXT\",\n  442: \"HIDE.DIALOG\",\n  443: \"SET.DIALOG.FOCUS\",\n  444: \"ENABLE.OBJECT\",\n  445: \"PUSHBUTTON.PROPERTIES\",\n  446: \"SET.DIALOG.DEFAULT\",\n  447: \"FILTER\",\n  448: \"FILTER.SHOW.ALL\",\n  449: \"CLEAR.OUTLINE\",\n  450: \"FUNCTION.WIZARD\",\n  451: \"ADD.LIST.ITEM\",\n  452: \"SET.LIST.ITEM\",\n  453: \"REMOVE.LIST.ITEM\",\n  454: \"SELECT.LIST.ITEM\",\n  455: \"SET.CONTROL.VALUE\",\n  456: \"SAVE.COPY.AS\",\n  458: \"OPTIONS.LISTS.ADD\",\n  459: \"OPTIONS.LISTS.DELETE\",\n  460: \"SERIES.AXES\",\n  461: \"SERIES.X\",\n  462: \"SERIES.Y\",\n  463: \"ERRORBAR.X\",\n  464: \"ERRORBAR.Y\",\n  465: \"FORMAT.CHART\",\n  466: \"SERIES.ORDER\",\n  467: \"MAIL.LOGOFF\",\n  468: \"CLEAR.ROUTING.SLIP\",\n  469: \"APP.ACTIVATE.MICROSOFT\",\n  470: \"MAIL.EDIT.MAILER\",\n  471: \"ON.SHEET\",\n  472: \"STANDARD.WIDTH\",\n  473: \"SCENARIO.MERGE\",\n  474: \"SUMMARY.INFO\",\n  475: \"FIND.FILE\",\n  476: \"ACTIVE.CELL.FONT\",\n  477: \"ENABLE.TIPWIZARD\",\n  478: \"VBA.MAKE.ADDIN\",\n  480: \"INSERTDATATABLE\",\n  481: \"WORKGROUP.OPTIONS\",\n  482: \"MAIL.SEND.MAILER\",\n  485: \"AUTOCORRECT\",\n  489: \"POST.DOCUMENT\",\n  491: \"PICKLIST\",\n  493: \"VIEW.SHOW\",\n  494: \"VIEW.DEFINE\",\n  495: \"VIEW.DELETE\",\n  509: \"SHEET.BACKGROUND\",\n  510: \"INSERT.MAP.OBJECT\",\n  511: \"OPTIONS.MENONO\",\n  517: \"MSOCHECKS\",\n  518: \"NORMAL\",\n  519: \"LAYOUT\",\n  520: \"RM.PRINT.AREA\",\n  521: \"CLEAR.PRINT.AREA\",\n  522: \"ADD.PRINT.AREA\",\n  523: \"MOVE.BRK\",\n  545: \"HIDECURR.NOTE\",\n  546: \"HIDEALL.NOTES\",\n  547: \"DELETE.NOTE\",\n  548: \"TRAVERSE.NOTES\",\n  549: \"ACTIVATE.NOTES\",\n  620: \"PROTECT.REVISIONS\",\n  621: \"UNPROTECT.REVISIONS\",\n  647: \"OPTIONS.ME\",\n  653: \"WEB.PUBLISH\",\n  667: \"NEWWEBQUERY\",\n  673: \"PIVOT.TABLE.CHART\",\n  753: \"OPTIONS.SAVE\",\n  755: \"OPTIONS.SPELL\",\n  808: \"HIDEALL.INKANNOTS\"\n};\nvar Ftab = {\n  0: \"COUNT\",\n  1: \"IF\",\n  2: \"ISNA\",\n  3: \"ISERROR\",\n  4: \"SUM\",\n  5: \"AVERAGE\",\n  6: \"MIN\",\n  7: \"MAX\",\n  8: \"ROW\",\n  9: \"COLUMN\",\n  10: \"NA\",\n  11: \"NPV\",\n  12: \"STDEV\",\n  13: \"DOLLAR\",\n  14: \"FIXED\",\n  15: \"SIN\",\n  16: \"COS\",\n  17: \"TAN\",\n  18: \"ATAN\",\n  19: \"PI\",\n  20: \"SQRT\",\n  21: \"EXP\",\n  22: \"LN\",\n  23: \"LOG10\",\n  24: \"ABS\",\n  25: \"INT\",\n  26: \"SIGN\",\n  27: \"ROUND\",\n  28: \"LOOKUP\",\n  29: \"INDEX\",\n  30: \"REPT\",\n  31: \"MID\",\n  32: \"LEN\",\n  33: \"VALUE\",\n  34: \"TRUE\",\n  35: \"FALSE\",\n  36: \"AND\",\n  37: \"OR\",\n  38: \"NOT\",\n  39: \"MOD\",\n  40: \"DCOUNT\",\n  41: \"DSUM\",\n  42: \"DAVERAGE\",\n  43: \"DMIN\",\n  44: \"DMAX\",\n  45: \"DSTDEV\",\n  46: \"VAR\",\n  47: \"DVAR\",\n  48: \"TEXT\",\n  49: \"LINEST\",\n  50: \"TREND\",\n  51: \"LOGEST\",\n  52: \"GROWTH\",\n  53: \"GOTO\",\n  54: \"HALT\",\n  55: \"RETURN\",\n  56: \"PV\",\n  57: \"FV\",\n  58: \"NPER\",\n  59: \"PMT\",\n  60: \"RATE\",\n  61: \"MIRR\",\n  62: \"IRR\",\n  63: \"RAND\",\n  64: \"MATCH\",\n  65: \"DATE\",\n  66: \"TIME\",\n  67: \"DAY\",\n  68: \"MONTH\",\n  69: \"YEAR\",\n  70: \"WEEKDAY\",\n  71: \"HOUR\",\n  72: \"MINUTE\",\n  73: \"SECOND\",\n  74: \"NOW\",\n  75: \"AREAS\",\n  76: \"ROWS\",\n  77: \"COLUMNS\",\n  78: \"OFFSET\",\n  79: \"ABSREF\",\n  80: \"RELREF\",\n  81: \"ARGUMENT\",\n  82: \"SEARCH\",\n  83: \"TRANSPOSE\",\n  84: \"ERROR\",\n  85: \"STEP\",\n  86: \"TYPE\",\n  87: \"ECHO\",\n  88: \"SET.NAME\",\n  89: \"CALLER\",\n  90: \"DEREF\",\n  91: \"WINDOWS\",\n  92: \"SERIES\",\n  93: \"DOCUMENTS\",\n  94: \"ACTIVE.CELL\",\n  95: \"SELECTION\",\n  96: \"RESULT\",\n  97: \"ATAN2\",\n  98: \"ASIN\",\n  99: \"ACOS\",\n  100: \"CHOOSE\",\n  101: \"HLOOKUP\",\n  102: \"VLOOKUP\",\n  103: \"LINKS\",\n  104: \"INPUT\",\n  105: \"ISREF\",\n  106: \"GET.FORMULA\",\n  107: \"GET.NAME\",\n  108: \"SET.VALUE\",\n  109: \"LOG\",\n  110: \"EXEC\",\n  111: \"CHAR\",\n  112: \"LOWER\",\n  113: \"UPPER\",\n  114: \"PROPER\",\n  115: \"LEFT\",\n  116: \"RIGHT\",\n  117: \"EXACT\",\n  118: \"TRIM\",\n  119: \"REPLACE\",\n  120: \"SUBSTITUTE\",\n  121: \"CODE\",\n  122: \"NAMES\",\n  123: \"DIRECTORY\",\n  124: \"FIND\",\n  125: \"CELL\",\n  126: \"ISERR\",\n  127: \"ISTEXT\",\n  128: \"ISNUMBER\",\n  129: \"ISBLANK\",\n  130: \"T\",\n  131: \"N\",\n  132: \"FOPEN\",\n  133: \"FCLOSE\",\n  134: \"FSIZE\",\n  135: \"FREADLN\",\n  136: \"FREAD\",\n  137: \"FWRITELN\",\n  138: \"FWRITE\",\n  139: \"FPOS\",\n  140: \"DATEVALUE\",\n  141: \"TIMEVALUE\",\n  142: \"SLN\",\n  143: \"SYD\",\n  144: \"DDB\",\n  145: \"GET.DEF\",\n  146: \"REFTEXT\",\n  147: \"TEXTREF\",\n  148: \"INDIRECT\",\n  149: \"REGISTER\",\n  150: \"CALL\",\n  151: \"ADD.BAR\",\n  152: \"ADD.MENU\",\n  153: \"ADD.COMMAND\",\n  154: \"ENABLE.COMMAND\",\n  155: \"CHECK.COMMAND\",\n  156: \"RENAME.COMMAND\",\n  157: \"SHOW.BAR\",\n  158: \"DELETE.MENU\",\n  159: \"DELETE.COMMAND\",\n  160: \"GET.CHART.ITEM\",\n  161: \"DIALOG.BOX\",\n  162: \"CLEAN\",\n  163: \"MDETERM\",\n  164: \"MINVERSE\",\n  165: \"MMULT\",\n  166: \"FILES\",\n  167: \"IPMT\",\n  168: \"PPMT\",\n  169: \"COUNTA\",\n  170: \"CANCEL.KEY\",\n  171: \"FOR\",\n  172: \"WHILE\",\n  173: \"BREAK\",\n  174: \"NEXT\",\n  175: \"INITIATE\",\n  176: \"REQUEST\",\n  177: \"POKE\",\n  178: \"EXECUTE\",\n  179: \"TERMINATE\",\n  180: \"RESTART\",\n  181: \"HELP\",\n  182: \"GET.BAR\",\n  183: \"PRODUCT\",\n  184: \"FACT\",\n  185: \"GET.CELL\",\n  186: \"GET.WORKSPACE\",\n  187: \"GET.WINDOW\",\n  188: \"GET.DOCUMENT\",\n  189: \"DPRODUCT\",\n  190: \"ISNONTEXT\",\n  191: \"GET.NOTE\",\n  192: \"NOTE\",\n  193: \"STDEVP\",\n  194: \"VARP\",\n  195: \"DSTDEVP\",\n  196: \"DVARP\",\n  197: \"TRUNC\",\n  198: \"ISLOGICAL\",\n  199: \"DCOUNTA\",\n  200: \"DELETE.BAR\",\n  201: \"UNREGISTER\",\n  204: \"USDOLLAR\",\n  205: \"FINDB\",\n  206: \"SEARCHB\",\n  207: \"REPLACEB\",\n  208: \"LEFTB\",\n  209: \"RIGHTB\",\n  210: \"MIDB\",\n  211: \"LENB\",\n  212: \"ROUNDUP\",\n  213: \"ROUNDDOWN\",\n  214: \"ASC\",\n  215: \"DBCS\",\n  216: \"RANK\",\n  219: \"ADDRESS\",\n  220: \"DAYS360\",\n  221: \"TODAY\",\n  222: \"VDB\",\n  223: \"ELSE\",\n  224: \"ELSE.IF\",\n  225: \"END.IF\",\n  226: \"FOR.CELL\",\n  227: \"MEDIAN\",\n  228: \"SUMPRODUCT\",\n  229: \"SINH\",\n  230: \"COSH\",\n  231: \"TANH\",\n  232: \"ASINH\",\n  233: \"ACOSH\",\n  234: \"ATANH\",\n  235: \"DGET\",\n  236: \"CREATE.OBJECT\",\n  237: \"VOLATILE\",\n  238: \"LAST.ERROR\",\n  239: \"CUSTOM.UNDO\",\n  240: \"CUSTOM.REPEAT\",\n  241: \"FORMULA.CONVERT\",\n  242: \"GET.LINK.INFO\",\n  243: \"TEXT.BOX\",\n  244: \"INFO\",\n  245: \"GROUP\",\n  246: \"GET.OBJECT\",\n  247: \"DB\",\n  248: \"PAUSE\",\n  251: \"RESUME\",\n  252: \"FREQUENCY\",\n  253: \"ADD.TOOLBAR\",\n  254: \"DELETE.TOOLBAR\",\n  255: \"User\",\n  256: \"RESET.TOOLBAR\",\n  257: \"EVALUATE\",\n  258: \"GET.TOOLBAR\",\n  259: \"GET.TOOL\",\n  260: \"SPELLING.CHECK\",\n  261: \"ERROR.TYPE\",\n  262: \"APP.TITLE\",\n  263: \"WINDOW.TITLE\",\n  264: \"SAVE.TOOLBAR\",\n  265: \"ENABLE.TOOL\",\n  266: \"PRESS.TOOL\",\n  267: \"REGISTER.ID\",\n  268: \"GET.WORKBOOK\",\n  269: \"AVEDEV\",\n  270: \"BETADIST\",\n  271: \"GAMMALN\",\n  272: \"BETAINV\",\n  273: \"BINOMDIST\",\n  274: \"CHIDIST\",\n  275: \"CHIINV\",\n  276: \"COMBIN\",\n  277: \"CONFIDENCE\",\n  278: \"CRITBINOM\",\n  279: \"EVEN\",\n  280: \"EXPONDIST\",\n  281: \"FDIST\",\n  282: \"FINV\",\n  283: \"FISHER\",\n  284: \"FISHERINV\",\n  285: \"FLOOR\",\n  286: \"GAMMADIST\",\n  287: \"GAMMAINV\",\n  288: \"CEILING\",\n  289: \"HYPGEOMDIST\",\n  290: \"LOGNORMDIST\",\n  291: \"LOGINV\",\n  292: \"NEGBINOMDIST\",\n  293: \"NORMDIST\",\n  294: \"NORMSDIST\",\n  295: \"NORMINV\",\n  296: \"NORMSINV\",\n  297: \"STANDARDIZE\",\n  298: \"ODD\",\n  299: \"PERMUT\",\n  300: \"POISSON\",\n  301: \"TDIST\",\n  302: \"WEIBULL\",\n  303: \"SUMXMY2\",\n  304: \"SUMX2MY2\",\n  305: \"SUMX2PY2\",\n  306: \"CHITEST\",\n  307: \"CORREL\",\n  308: \"COVAR\",\n  309: \"FORECAST\",\n  310: \"FTEST\",\n  311: \"INTERCEPT\",\n  312: \"PEARSON\",\n  313: \"RSQ\",\n  314: \"STEYX\",\n  315: \"SLOPE\",\n  316: \"TTEST\",\n  317: \"PROB\",\n  318: \"DEVSQ\",\n  319: \"GEOMEAN\",\n  320: \"HARMEAN\",\n  321: \"SUMSQ\",\n  322: \"KURT\",\n  323: \"SKEW\",\n  324: \"ZTEST\",\n  325: \"LARGE\",\n  326: \"SMALL\",\n  327: \"QUARTILE\",\n  328: \"PERCENTILE\",\n  329: \"PERCENTRANK\",\n  330: \"MODE\",\n  331: \"TRIMMEAN\",\n  332: \"TINV\",\n  334: \"MOVIE.COMMAND\",\n  335: \"GET.MOVIE\",\n  336: \"CONCATENATE\",\n  337: \"POWER\",\n  338: \"PIVOT.ADD.DATA\",\n  339: \"GET.PIVOT.TABLE\",\n  340: \"GET.PIVOT.FIELD\",\n  341: \"GET.PIVOT.ITEM\",\n  342: \"RADIANS\",\n  343: \"DEGREES\",\n  344: \"SUBTOTAL\",\n  345: \"SUMIF\",\n  346: \"COUNTIF\",\n  347: \"COUNTBLANK\",\n  348: \"SCENARIO.GET\",\n  349: \"OPTIONS.LISTS.GET\",\n  350: \"ISPMT\",\n  351: \"DATEDIF\",\n  352: \"DATESTRING\",\n  353: \"NUMBERSTRING\",\n  354: \"ROMAN\",\n  355: \"OPEN.DIALOG\",\n  356: \"SAVE.DIALOG\",\n  357: \"VIEW.GET\",\n  358: \"GETPIVOTDATA\",\n  359: \"HYPERLINK\",\n  360: \"PHONETIC\",\n  361: \"AVERAGEA\",\n  362: \"MAXA\",\n  363: \"MINA\",\n  364: \"STDEVPA\",\n  365: \"VARPA\",\n  366: \"STDEVA\",\n  367: \"VARA\",\n  368: \"BAHTTEXT\",\n  369: \"THAIDAYOFWEEK\",\n  370: \"THAIDIGIT\",\n  371: \"THAIMONTHOFYEAR\",\n  372: \"THAINUMSOUND\",\n  373: \"THAINUMSTRING\",\n  374: \"THAISTRINGLENGTH\",\n  375: \"ISTHAIDIGIT\",\n  376: \"ROUNDBAHTDOWN\",\n  377: \"ROUNDBAHTUP\",\n  378: \"THAIYEAR\",\n  379: \"RTD\",\n  380: \"CUBEVALUE\",\n  381: \"CUBEMEMBER\",\n  382: \"CUBEMEMBERPROPERTY\",\n  383: \"CUBERANKEDMEMBER\",\n  384: \"HEX2BIN\",\n  385: \"HEX2DEC\",\n  386: \"HEX2OCT\",\n  387: \"DEC2BIN\",\n  388: \"DEC2HEX\",\n  389: \"DEC2OCT\",\n  390: \"OCT2BIN\",\n  391: \"OCT2HEX\",\n  392: \"OCT2DEC\",\n  393: \"BIN2DEC\",\n  394: \"BIN2OCT\",\n  395: \"BIN2HEX\",\n  396: \"IMSUB\",\n  397: \"IMDIV\",\n  398: \"IMPOWER\",\n  399: \"IMABS\",\n  400: \"IMSQRT\",\n  401: \"IMLN\",\n  402: \"IMLOG2\",\n  403: \"IMLOG10\",\n  404: \"IMSIN\",\n  405: \"IMCOS\",\n  406: \"IMEXP\",\n  407: \"IMARGUMENT\",\n  408: \"IMCONJUGATE\",\n  409: \"IMAGINARY\",\n  410: \"IMREAL\",\n  411: \"COMPLEX\",\n  412: \"IMSUM\",\n  413: \"IMPRODUCT\",\n  414: \"SERIESSUM\",\n  415: \"FACTDOUBLE\",\n  416: \"SQRTPI\",\n  417: \"QUOTIENT\",\n  418: \"DELTA\",\n  419: \"GESTEP\",\n  420: \"ISEVEN\",\n  421: \"ISODD\",\n  422: \"MROUND\",\n  423: \"ERF\",\n  424: \"ERFC\",\n  425: \"BESSELJ\",\n  426: \"BESSELK\",\n  427: \"BESSELY\",\n  428: \"BESSELI\",\n  429: \"XIRR\",\n  430: \"XNPV\",\n  431: \"PRICEMAT\",\n  432: \"YIELDMAT\",\n  433: \"INTRATE\",\n  434: \"RECEIVED\",\n  435: \"DISC\",\n  436: \"PRICEDISC\",\n  437: \"YIELDDISC\",\n  438: \"TBILLEQ\",\n  439: \"TBILLPRICE\",\n  440: \"TBILLYIELD\",\n  441: \"PRICE\",\n  442: \"YIELD\",\n  443: \"DOLLARDE\",\n  444: \"DOLLARFR\",\n  445: \"NOMINAL\",\n  446: \"EFFECT\",\n  447: \"CUMPRINC\",\n  448: \"CUMIPMT\",\n  449: \"EDATE\",\n  450: \"EOMONTH\",\n  451: \"YEARFRAC\",\n  452: \"COUPDAYBS\",\n  453: \"COUPDAYS\",\n  454: \"COUPDAYSNC\",\n  455: \"COUPNCD\",\n  456: \"COUPNUM\",\n  457: \"COUPPCD\",\n  458: \"DURATION\",\n  459: \"MDURATION\",\n  460: \"ODDLPRICE\",\n  461: \"ODDLYIELD\",\n  462: \"ODDFPRICE\",\n  463: \"ODDFYIELD\",\n  464: \"RANDBETWEEN\",\n  465: \"WEEKNUM\",\n  466: \"AMORDEGRC\",\n  467: \"AMORLINC\",\n  468: \"CONVERT\",\n  724: \"SHEETJS\",\n  469: \"ACCRINT\",\n  470: \"ACCRINTM\",\n  471: \"WORKDAY\",\n  472: \"NETWORKDAYS\",\n  473: \"GCD\",\n  474: \"MULTINOMIAL\",\n  475: \"LCM\",\n  476: \"FVSCHEDULE\",\n  477: \"CUBEKPIMEMBER\",\n  478: \"CUBESET\",\n  479: \"CUBESETCOUNT\",\n  480: \"IFERROR\",\n  481: \"COUNTIFS\",\n  482: \"SUMIFS\",\n  483: \"AVERAGEIF\",\n  484: \"AVERAGEIFS\"\n};\nvar FtabArgc = {\n  2: 1,\n  3: 1,\n  10: 0,\n  15: 1,\n  16: 1,\n  17: 1,\n  18: 1,\n  19: 0,\n  20: 1,\n  21: 1,\n  22: 1,\n  23: 1,\n  24: 1,\n  25: 1,\n  26: 1,\n  27: 2,\n  30: 2,\n  31: 3,\n  32: 1,\n  33: 1,\n  34: 0,\n  35: 0,\n  38: 1,\n  39: 2,\n  40: 3,\n  41: 3,\n  42: 3,\n  43: 3,\n  44: 3,\n  45: 3,\n  47: 3,\n  48: 2,\n  53: 1,\n  61: 3,\n  63: 0,\n  65: 3,\n  66: 3,\n  67: 1,\n  68: 1,\n  69: 1,\n  70: 1,\n  71: 1,\n  72: 1,\n  73: 1,\n  74: 0,\n  75: 1,\n  76: 1,\n  77: 1,\n  79: 2,\n  80: 2,\n  83: 1,\n  85: 0,\n  86: 1,\n  89: 0,\n  90: 1,\n  94: 0,\n  95: 0,\n  97: 2,\n  98: 1,\n  99: 1,\n  101: 3,\n  102: 3,\n  105: 1,\n  106: 1,\n  108: 2,\n  111: 1,\n  112: 1,\n  113: 1,\n  114: 1,\n  117: 2,\n  118: 1,\n  119: 4,\n  121: 1,\n  126: 1,\n  127: 1,\n  128: 1,\n  129: 1,\n  130: 1,\n  131: 1,\n  133: 1,\n  134: 1,\n  135: 1,\n  136: 2,\n  137: 2,\n  138: 2,\n  140: 1,\n  141: 1,\n  142: 3,\n  143: 4,\n  144: 4,\n  161: 1,\n  162: 1,\n  163: 1,\n  164: 1,\n  165: 2,\n  172: 1,\n  175: 2,\n  176: 2,\n  177: 3,\n  178: 2,\n  179: 1,\n  184: 1,\n  186: 1,\n  189: 3,\n  190: 1,\n  195: 3,\n  196: 3,\n  197: 1,\n  198: 1,\n  199: 3,\n  201: 1,\n  207: 4,\n  210: 3,\n  211: 1,\n  212: 2,\n  213: 2,\n  214: 1,\n  215: 1,\n  225: 0,\n  229: 1,\n  230: 1,\n  231: 1,\n  232: 1,\n  233: 1,\n  234: 1,\n  235: 3,\n  244: 1,\n  247: 4,\n  252: 2,\n  257: 1,\n  261: 1,\n  271: 1,\n  273: 4,\n  274: 2,\n  275: 2,\n  276: 2,\n  277: 3,\n  278: 3,\n  279: 1,\n  280: 3,\n  281: 3,\n  282: 3,\n  283: 1,\n  284: 1,\n  285: 2,\n  286: 4,\n  287: 3,\n  288: 2,\n  289: 4,\n  290: 3,\n  291: 3,\n  292: 3,\n  293: 4,\n  294: 1,\n  295: 3,\n  296: 1,\n  297: 3,\n  298: 1,\n  299: 2,\n  300: 3,\n  301: 3,\n  302: 4,\n  303: 2,\n  304: 2,\n  305: 2,\n  306: 2,\n  307: 2,\n  308: 2,\n  309: 3,\n  310: 2,\n  311: 2,\n  312: 2,\n  313: 2,\n  314: 2,\n  315: 2,\n  316: 4,\n  325: 2,\n  326: 2,\n  327: 2,\n  328: 2,\n  331: 2,\n  332: 2,\n  337: 2,\n  342: 1,\n  343: 1,\n  346: 2,\n  347: 1,\n  350: 4,\n  351: 3,\n  352: 1,\n  353: 2,\n  360: 1,\n  368: 1,\n  369: 1,\n  370: 1,\n  371: 1,\n  372: 1,\n  373: 1,\n  374: 1,\n  375: 1,\n  376: 1,\n  377: 1,\n  378: 1,\n  382: 3,\n  385: 1,\n  392: 1,\n  393: 1,\n  396: 2,\n  397: 2,\n  398: 2,\n  399: 1,\n  400: 1,\n  401: 1,\n  402: 1,\n  403: 1,\n  404: 1,\n  405: 1,\n  406: 1,\n  407: 1,\n  408: 1,\n  409: 1,\n  410: 1,\n  414: 4,\n  415: 1,\n  416: 1,\n  417: 2,\n  420: 1,\n  421: 1,\n  422: 2,\n  424: 1,\n  425: 2,\n  426: 2,\n  427: 2,\n  428: 2,\n  430: 3,\n  438: 3,\n  439: 3,\n  440: 3,\n  443: 2,\n  444: 2,\n  445: 2,\n  446: 2,\n  447: 6,\n  448: 6,\n  449: 2,\n  450: 2,\n  464: 2,\n  468: 3,\n  476: 2,\n  479: 1,\n  480: 2,\n  65535: 0\n};\n/* Part 3 TODO: actually parse formulae */\nfunction ods_to_csf_formula(f) {\n\tif(f.slice(0,3) == \"of:\") f = f.slice(3);\n\t/* 5.2 Basic Expressions */\n\tif(f.charCodeAt(0) == 61) {\n\t\tf = f.slice(1);\n\t\tif(f.charCodeAt(0) == 61) f = f.slice(1);\n\t}\n\tf = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n\t/* Part 3 Section 5.8 References */\n\tf = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function($$, $1) { return $1.replace(/\\./g,\"\"); });\n\tf = f.replace(/\\$'([^']|'')+'/g, function($$) { return $$.slice(1); });\n\tf = f.replace(/\\$([^\\]\\. #$]+)/g, function($$, $1) { return ($1).match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})?$/) ? $$ : $1; });\n\t/* TODO: something other than this */\n\tf = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n\treturn f.replace(/[;~]/g,\",\").replace(/\\|/g,\";\");\n}\n\nfunction csf_to_ods_formula(f) {\n\tvar o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g,\":\");\n\t/* TODO: something other than this */\n\treturn o.replace(/;/g, \"|\").replace(/,/g,\";\");\n}\n\nfunction ods_to_csf_3D(r) {\n\tr = r.replace(/\\$'([^']|'')+'/g, function($$) { return $$.slice(1); });\n\tr = r.replace(/\\$([^\\]\\. #$]+)/g, function($$, $1) { return ($1).match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})?$/) ? $$ : $1; });\n\tvar a = r.split(\":\");\n\tvar s = a[0].split(\".\")[0];\n\treturn [s, a[0].split(\".\")[1] + (a.length > 1 ? (\":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0])) : \"\")];\n}\n\nfunction csf_to_ods_3D(r) {\n\treturn r.replace(/!/,\".\").replace(/:/, \":.\");\n}\n\nvar strs = {}; // shared strings\nvar _ssfopts = {}; // spreadsheet formatting options\n\n\n/*global Map */\nvar browser_has_Map = typeof Map !== 'undefined';\n\nfunction get_sst_id(sst, str, rev) {\n\tvar i = 0, len = sst.length;\n\tif(rev) {\n\t\tif(browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {\n\t\t\tvar revarr = browser_has_Map ? rev.get(str) : rev[str];\n\t\t\tfor(; i < revarr.length; ++i) {\n\t\t\t\tif(sst[revarr[i]].t === str) { sst.Count ++; return revarr[i]; }\n\t\t\t}\n\t\t}\n\t} else for(; i < len; ++i) {\n\t\tif(sst[i].t === str) { sst.Count ++; return i; }\n\t}\n\tsst[len] = ({t:str}); sst.Count ++; sst.Unique ++;\n\tif(rev) {\n\t\tif(browser_has_Map) {\n\t\t\tif(!rev.has(str)) rev.set(str, []);\n\t\t\trev.get(str).push(len);\n\t\t} else {\n\t\t\tif(!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];\n\t\t\trev[str].push(len);\n\t\t}\n\t}\n\treturn len;\n}\n\nfunction col_obj_w(C, col) {\n\tvar p = ({min:C+1,max:C+1});\n\t/* wch (chars), wpx (pixels) */\n\tvar wch = -1;\n\tif(col.MDW) MDW = col.MDW;\n\tif(col.width != null) p.customWidth = 1;\n\telse if(col.wpx != null) wch = px2char(col.wpx);\n\telse if(col.wch != null) wch = col.wch;\n\tif(wch > -1) { p.width = char2width(wch); p.customWidth = 1; }\n\telse if(col.width != null) p.width = col.width;\n\tif(col.hidden) p.hidden = true;\n\tif(col.level != null) { p.outlineLevel = p.level = col.level; }\n\treturn p;\n}\n\nfunction default_margins(margins, mode) {\n\tif(!margins) return;\n\tvar defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n\tif(mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n\tif(margins.left   == null) margins.left   = defs[0];\n\tif(margins.right  == null) margins.right  = defs[1];\n\tif(margins.top    == null) margins.top    = defs[2];\n\tif(margins.bottom == null) margins.bottom = defs[3];\n\tif(margins.header == null) margins.header = defs[4];\n\tif(margins.footer == null) margins.footer = defs[5];\n}\n\nfunction get_cell_style(styles, cell, opts) {\n\tvar z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n\tvar i = 0x3c, len = styles.length;\n\tif(z == null && opts.ssf) {\n\t\tfor(; i < 0x188; ++i) if(opts.ssf[i] == null) {\n\t\t\tSSF__load(cell.z, i);\n\t\t\t// $FlowIgnore\n\t\t\topts.ssf[i] = cell.z;\n\t\t\topts.revssf[cell.z] = z = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(i = 0; i != len; ++i) if(styles[i].numFmtId === z) return i;\n\tstyles[len] = {\n\t\tnumFmtId:z,\n\t\tfontId:0,\n\t\tfillId:0,\n\t\tborderId:0,\n\t\txfId:0,\n\t\tapplyNumberFormat:1\n\t};\n\treturn len;\n}\n\nfunction safe_format(p, fmtid, fillid, opts, themes, styles, date1904) {\n\ttry {\n\t\tif(opts.cellNF) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(p.t === 'z' && !opts.cellStyles) return;\n\tif(p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n\tif((!opts || opts.cellText !== false) && p.t !== 'z') try {\n\t\tif(table_fmt[fmtid] == null) SSF__load(SSFImplicit[fmtid] || \"General\", fmtid);\n\t\tif(p.t === 'e') p.w = p.w || BErr[p.v];\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse if(p.t === 'd') {\n\t\t\t\tvar dd = datenum(p.v, !!date1904);\n\t\t\t\tif((dd|0) === dd) p.w = dd.toString(10);\n\t\t\t\telse p.w = SSF_general_num(dd);\n\t\t\t}\n\t\t\telse if(p.v === undefined) return \"\";\n\t\t\telse p.w = SSF_general(p.v,_ssfopts);\n\t\t}\n\t\telse if(p.t === 'd') p.w = SSF_format(fmtid,datenum(p.v, !!date1904),_ssfopts);\n\t\telse p.w = SSF_format(fmtid,p.v,_ssfopts);\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts.cellStyles) return;\n\tif(fillid != null) try {\n\t\tp.s = styles.Fills[fillid];\n\t\tif (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n\t\t\tp.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n\t\t}\n\t\tif (p.s.bgColor && p.s.bgColor.theme) {\n\t\t\tp.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n\t\t}\n\t} catch(e) { if(opts.WTF && styles.Fills) throw e; }\n}\n\nfunction check_ws(ws, sname, i) {\n\tif(ws && ws['!ref']) {\n\t\tvar range = safe_decode_range(ws['!ref']);\n\t\tif(range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\n\t}\n}\nfunction parse_ws_xml_dim(ws, s) {\n\tvar d = safe_decode_range(s);\n\tif(d.s.r<=d.e.r && d.s.c<=d.e.c && d.s.r>=0 && d.s.c>=0) ws[\"!ref\"] = encode_range(d);\n}\nvar mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\nvar sheetdataregex = /<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\nvar hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\nvar afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\nvar marginregex= /<(?:\\w:)?pageMargins[^>]*\\/>/g;\nvar sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\nvar sheetprregex2= /<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;\nvar svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\n\n/* 18.3 Worksheets */\nfunction parse_ws_xml(data, opts, idx, rels, wb, themes, styles) {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\n\t/* 18.3.1.99 worksheet CT_Worksheet */\n\tvar s = ({}); if(opts.dense) s[\"!data\"] = [];\n\tvar refguess = ({s: {r:2000000, c:2000000}, e: {r:0, c:0} });\n\n\tvar data1 = \"\", data2 = \"\";\n\tvar mtch = data.match(sheetdataregex);\n\tif(mtch) {\n\t\tdata1 = data.slice(0, mtch.index);\n\t\tdata2 = data.slice(mtch.index + mtch[0].length);\n\t} else data1 = data2 = data;\n\n\t/* 18.3.1.82 sheetPr CT_SheetPr */\n\tvar sheetPr = data1.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\telse if((sheetPr = data1.match(sheetprregex2))) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1]||\"\", s, wb, idx, styles, themes);\n\n\t/* 18.3.1.35 dimension CT_SheetDimension */\n\tvar ridx = (data1.match(/<(?:\\w*:)?dimension/)||{index:-1}).index;\n\tif(ridx > 0) {\n\t\tvar ref = data1.slice(ridx,ridx+50).match(dimregex);\n\t\tif(ref && !(opts && opts.nodim)) parse_ws_xml_dim(s, ref[1]);\n\t}\n\n\t/* 18.3.1.88 sheetViews CT_SheetViews */\n\tvar svs = data1.match(svsregex);\n\tif(svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n\n\t/* 18.3.1.17 cols CT_Cols */\n\tvar columns = [];\n\tif(opts.cellStyles) {\n\t\t/* 18.3.1.13 col CT_Col */\n\t\tvar cols = data1.match(colregex);\n\t\tif(cols) parse_ws_xml_cols(columns, cols);\n\t}\n\n\t/* 18.3.1.80 sheetData CT_SheetData ? */\n\tif(mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles, wb);\n\n\t/* 18.3.1.2  autoFilter CT_AutoFilter */\n\tvar afilter = data2.match(afregex);\n\tif(afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n\n\t/* 18.3.1.55 mergeCells CT_MergeCells */\n\tvar merges = [];\n\tvar _merge = data2.match(mergecregex);\n\tif(_merge) for(ridx = 0; ridx != _merge.length; ++ridx)\n\t\tmerges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\")+1));\n\n\t/* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\tvar hlink = data2.match(hlinkregex);\n\tif(hlink) parse_ws_xml_hlinks(s, hlink, rels);\n\n\t/* 18.3.1.62 pageMargins CT_PageMargins */\n\tvar margins = data2.match(marginregex);\n\tif(margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n\n\t/* legacyDrawing */\n\tvar m;\n\tif((m = data2.match(/legacyDrawing r:id=\"(.*?)\"/))) s['!legrel'] = m[1];\n\n\tif(opts && opts.nodim) refguess.s.c = refguess.s.r = 0;\n\tif(!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\tif(opts.sheetRows > 0 && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(columns.length > 0) s[\"!cols\"] = columns;\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\tif(rels['!id'][s['!legrel']]) s['!legdrawel'] = rels['!id'][s['!legrel']];\n\treturn s;\n}\n\nfunction write_ws_xml_merges(merges) {\n\tif(merges.length === 0) return \"\";\n\tvar o = '<mergeCells count=\"' + merges.length + '\">';\n\tfor(var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n\treturn o + '</mergeCells>';\n}\n\n/* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\nfunction parse_ws_xml_sheetpr(sheetPr, s, wb, idx) {\n\tvar data = parsexmltag(sheetPr);\n\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\tif(data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n}\nfunction parse_ws_xml_sheetpr2(sheetPr, body, s, wb, idx) {\n\tparse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n}\nfunction write_ws_xml_sheetpr(ws, wb, idx, opts, o) {\n\tvar needed = false;\n\tvar props = {}, payload = null;\n\tif(opts.bookType !== 'xlsx' && wb.vbaraw) {\n\t\tvar cname = wb.SheetNames[idx];\n\t\ttry { if(wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname; } catch(e) {}\n\t\tneeded = true;\n\t\tprops.codeName = utf8write(escapexml(cname));\n\t}\n\n\tif(ws && ws[\"!outline\"]) {\n\t\tvar outlineprops = {summaryBelow:1, summaryRight:1};\n\t\tif(ws[\"!outline\"].above) outlineprops.summaryBelow = 0;\n\t\tif(ws[\"!outline\"].left) outlineprops.summaryRight = 0;\n\t\tpayload = (payload||\"\") + writextag('outlinePr', null, outlineprops);\n\t}\n\n\tif(!needed && !payload) return;\n\to[o.length] = (writextag('sheetPr', payload, props));\n}\n\n/* 18.3.1.85 sheetProtection CT_SheetProtection */\nvar sheetprot_deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\nvar sheetprot_deftrue = [\n\t\"formatColumns\", \"formatRows\", \"formatCells\",\n\t\"insertColumns\", \"insertRows\", \"insertHyperlinks\",\n\t\"deleteColumns\", \"deleteRows\",\n\t\"sort\", \"autoFilter\", \"pivotTables\"\n];\nfunction write_ws_xml_protection(sp) {\n\t// algorithmName, hashValue, saltValue, spinCount\n\tvar o = ({sheet:1});\n\tsheetprot_deffalse.forEach(function(n) { if(sp[n] != null && sp[n]) o[n] = \"1\"; });\n\tsheetprot_deftrue.forEach(function(n) { if(sp[n] != null && !sp[n]) o[n] = \"0\"; });\n\t/* TODO: algorithm */\n\tif(sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\n\treturn writextag('sheetProtection', null, o);\n}\n\nfunction parse_ws_xml_hlinks(s, data, rels) {\n\tvar dense = s[\"!data\"] != null;\n\tfor(var i = 0; i != data.length; ++i) {\n\t\tvar val = parsexmltag(utf8read(data[i]), true);\n\t\tif(!val.ref) return;\n\t\tvar rel = ((rels || {})['!id']||[])[val.id];\n\t\tif(rel) {\n\t\t\tval.Target = rel.Target;\n\t\t\tif(val.location) val.Target += \"#\"+unescapexml(val.location);\n\t\t} else {\n\t\t\tval.Target = \"#\" + unescapexml(val.location);\n\t\t\trel = {Target: val.Target, TargetMode: 'Internal'};\n\t\t}\n\t\tval.Rel = rel;\n\t\tif(val.tooltip) { val.Tooltip = val.tooltip; delete val.tooltip; }\n\t\tvar rng = safe_decode_range(val.ref);\n\t\tfor(var R=rng.s.r;R<=rng.e.r;++R) for(var C=rng.s.c;C<=rng.e.c;++C) {\n\t\t\tvar addr = encode_col(C) + encode_row(R);\n\t\t\tif(dense) {\n\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\tif(!s[\"!data\"][R][C]) s[\"!data\"][R][C] = {t:\"z\",v:undefined};\n\t\t\t\ts[\"!data\"][R][C].l = val;\n\t\t\t} else {\n\t\t\t\tif(!s[addr]) s[addr] = {t:\"z\",v:undefined};\n\t\t\t\ts[addr].l = val;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction parse_ws_xml_margins(margin) {\n\tvar o = {};\n\t[\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function(k) {\n\t\tif(margin[k]) o[k] = parseFloat(margin[k]);\n\t});\n\treturn o;\n}\nfunction write_ws_xml_margins(margin) {\n\tdefault_margins(margin);\n\treturn writextag('pageMargins', null, margin);\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n\tvar seencol = false;\n\tfor(var coli = 0; coli != cols.length; ++coli) {\n\t\tvar coll = parsexmltag(cols[coli], true);\n\t\tif(coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n\t\tvar colm=parseInt(coll.min, 10)-1, colM=parseInt(coll.max,10)-1;\n\t\tif(coll.outlineLevel) coll.level = (+coll.outlineLevel || 0);\n\t\tdelete coll.min; delete coll.max; coll.width = +coll.width;\n\t\tif(!seencol && coll.width) { seencol = true; find_mdw_colw(coll.width); }\n\t\tprocess_col(coll);\n\t\twhile(colm <= colM) columns[colm++] = dup(coll);\n\t}\n}\nfunction write_ws_xml_cols(ws, cols) {\n\tvar o = [\"<cols>\"], col;\n\tfor(var i = 0; i != cols.length; ++i) {\n\t\tif(!(col = cols[i])) continue;\n\t\to[o.length] = (writextag('col', null, col_obj_w(i, col)));\n\t}\n\to[o.length] = \"</cols>\";\n\treturn o.join(\"\");\n}\n\nfunction parse_ws_xml_autofilter(data) {\n\tvar o = { ref: (data.match(/ref=\"([^\"]*)\"/)||[])[1]};\n\treturn o;\n}\nfunction write_ws_xml_autofilter(data, ws, wb, idx) {\n\tvar ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]});\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = formula_quote_sheet_name(wb.SheetNames[idx]) + \"!\" + fix_range(ref); break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\n\treturn writextag(\"autoFilter\", null, {ref:ref});\n}\n\n/* 18.3.1.88 sheetViews CT_SheetViews */\n/* 18.3.1.87 sheetView CT_SheetView */\nvar sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/g;\nfunction parse_ws_xml_sheetviews(data, wb) {\n\tif(!wb.Views) wb.Views = [{}];\n\t(data.match(sviewregex)||[]).forEach(function(r, i) {\n\t\tvar tag = parsexmltag(r);\n\t\t// $FlowIgnore\n\t\tif(!wb.Views[i]) wb.Views[i] = {};\n\t\t// $FlowIgnore\n\t\tif(+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale;\n\t\t// $FlowIgnore\n\t\tif(tag.rightToLeft && parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n\t});\n}\nfunction write_ws_xml_sheetviews(ws, opts, idx, wb) {\n\tvar sview = ({workbookViewId:\"0\"});\n\t// $FlowIgnore\n\tif((((wb||{}).Workbook||{}).Views||[])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\n\treturn writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\n}\n\nfunction write_ws_xml_cell(cell, ref, ws, opts, idx, wb, date1904) {\n\tif(cell.c) ws['!comments'].push([ref, cell.c]);\n\tif((cell.v === undefined || cell.t === \"z\" && !(opts||{}).sheetStubs) && typeof cell.f !== \"string\" && typeof cell.z == \"undefined\") return \"\";\n\tvar vv = \"\";\n\tvar oldt = cell.t, oldv = cell.v;\n\tif(cell.t !== \"z\") switch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'n':\n\t\t\tif(isNaN(cell.v)) { cell.t = \"e\"; vv = BErr[cell.v = 0x24]; } // #NUM!\n\t\t\telse if(!isFinite(cell.v)) { cell.t = \"e\"; vv = BErr[cell.v = 0x07]; } // #DIV/0!\n\t\t\telse vv = ''+cell.v; break;\n\t\tcase 'e': vv = BErr[cell.v]; break;\n\t\tcase 'd':\n\t\t\tif(opts && opts.cellDates) {\n\t\t\t\tvar _vv = parseDate(cell.v, date1904);\n\t\t\t\tvv = _vv.toISOString();\n\t\t\t\tif(_vv.getUTCFullYear() < 1900) vv = vv.slice(vv.indexOf(\"T\") + 1).replace(\"Z\",\"\");\n\t\t\t} else {\n\t\t\t\tcell = dup(cell);\n\t\t\t\tcell.t = 'n';\n\t\t\t\tvv = ''+(cell.v = datenum(parseDate(cell.v, date1904), date1904));\n\t\t\t}\n\t\t\tif(typeof cell.z === 'undefined') cell.z = table_fmt[14];\n\t\t\tbreak;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar v = (cell.t == \"z\" || cell.v == null)? \"\" : writetag('v', escapexml(vv)), o = ({r:ref});\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tif(os !== 0) o.s = os;\n\tswitch(cell.t) {\n\t\tcase 'n': break;\n\t\tcase 'd': o.t = \"d\"; break;\n\t\tcase 'b': o.t = \"b\"; break;\n\t\tcase 'e': o.t = \"e\"; break;\n\t\tcase 'z': break;\n\t\tdefault: if(cell.v == null) { delete cell.t; break; }\n\t\t\tif(cell.v.length > 32767) throw new Error(\"Text length must not exceed 32767 characters\");\n\t\t\tif(opts && opts.bookSST) {\n\t\t\t\tv = writetag('v', ''+get_sst_id(opts.Strings, cell.v, opts.revStrings));\n\t\t\t\to.t = \"s\"; break;\n\t\t\t}\n\t\t\telse o.t = \"str\"; break;\n\t}\n\tif(cell.t != oldt) { cell.t = oldt; cell.v = oldv; }\n\tif(typeof cell.f == \"string\" && cell.f) {\n\t\tvar ff = cell.F && cell.F.slice(0, ref.length) == ref ? {t:\"array\", ref:cell.F} : null;\n\t\tv = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\n\t}\n\tif(cell.l) {\n\t\tcell.l.display = escapexml(vv);\n\t\tws['!links'].push([ref, cell.l]);\n\t}\n\tif(cell.D) o.cm = 1;\n\treturn writextag('c', v, o);\n}\n\nvar parse_ws_xml_data = (function() {\n\tvar cellregex = /<(?:\\w+:)?c[ \\/>]/, rowregex = /<\\/(?:\\w+:)?row>/;\n\tvar rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\n\tvar refregex = /ref=[\"']([^\"']*)[\"']/;\n\tvar match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\n\nreturn function parse_ws_xml_data(sdata, s, opts, guess, themes, styles, wb) {\n\tvar ri = 0, x = \"\", cells = [], cref = [], idx=0, i=0, cc=0, d=\"\", p;\n\tvar tag, tagr = 0, tagc = 0;\n\tvar sstr, ftag;\n\tvar fmtid = 0, fillid = 0;\n\tvar do_format = Array.isArray(styles.CellXf), cf;\n\tvar arrayf = [];\n\tvar sharedf = [];\n\tvar dense = s[\"!data\"] != null;\n\tvar rows = [], rowobj = {}, rowrite = false;\n\tvar sheetStubs = !!opts.sheetStubs;\n\tvar date1904 = !!((wb||{}).WBProps||{}).date1904;\n\tfor(var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n\t\tx = marr[mt].trim();\n\t\tvar xlen = x.length;\n\t\tif(xlen === 0) continue;\n\n\t\t/* 18.3.1.73 row CT_Row */\n\t\tvar rstarti = 0;\n\t\touta: for(ri = 0; ri < xlen; ++ri) switch(/*x.charCodeAt(ri)*/x[ri]) {\n\t\t\tcase \">\" /*62*/:\n\t\t\t\tif(/*x.charCodeAt(ri-1) != 47*/x[ri-1] != \"/\") { ++ri; break outa; }\n\t\t\t\tif(opts && opts.cellStyles) {\n\t\t\t\t\t// TODO: avoid duplication\n\t\t\t\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\t\t\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\t\t\t\trowobj = {}; rowrite = false;\n\t\t\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\t\t\tif(tag.hidden && parsexmlbool(tag.hidden)) { rowrite = true; rowobj.hidden = true; }\n\t\t\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"<\" /*60*/: rstarti = ri; break;\n\t\t}\n\t\tif(rstarti >= ri) break;\n\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\tif(!opts.nodim) {\n\t\t\tif(guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n\t\t\tif(guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\t\t}\n\n\t\tif(opts && opts.cellStyles) {\n\t\t\trowobj = {}; rowrite = false;\n\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\tif(tag.hidden && parsexmlbool(tag.hidden)) { rowrite = true; rowobj.hidden = true; }\n\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t}\n\n\t\t/* 18.3.1.4 c CT_Cell */\n\t\tcells = x.slice(ri).split(cellregex);\n\t\tfor(var rslice = 0; rslice != cells.length; ++rslice) if(cells[rslice].trim().charAt(0) != \"<\") break;\n\t\tcells = cells.slice(rslice);\n\t\tfor(ri = 0; ri != cells.length; ++ri) {\n\t\t\tx = cells[ri].trim();\n\t\t\tif(x.length === 0) continue;\n\t\t\tcref = x.match(rregex); idx = ri; i=0; cc=0;\n\t\t\tx = \"<c \" + (x.slice(0,1)==\"<\"?\">\":\"\") + x;\n\t\t\tif(cref != null && cref.length === 2) {\n\t\t\t\tidx = 0; d=cref[1];\n\t\t\t\tfor(i=0; i != d.length; ++i) {\n\t\t\t\t\tif((cc=d.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\t\t\t\tidx = 26*idx + cc;\n\t\t\t\t}\n\t\t\t\t--idx;\n\t\t\t\ttagc = idx;\n\t\t\t} else ++tagc;\n\t\t\tfor(i = 0; i != x.length; ++i) if(x.charCodeAt(i) === 62) break; ++i;\n\t\t\ttag = parsexmltag(x.slice(0,i), true);\n\t\t\tif(!tag.r) tag.r = encode_cell({r:tagr-1, c:tagc});\n\t\t\td = x.slice(i);\n\t\t\tp = ({t:\"\"});\n\n\t\t\tif((cref=d.match(match_v))!= null && cref[1] !== '') p.v=unescapexml(cref[1]);\n\t\t\tif(opts.cellFormula) {\n\t\t\t\tif((cref=d.match(match_f))!= null ) {\n\t\t\t\t\tif(cref[1] == \"\") {\n\t\t\t\t\t\tif(cref[0].indexOf('t=\"shared\"') > -1) {\n\t\t\t\t\t\t\t// TODO: parse formula\n\t\t\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\t\t\tif(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* TODO: match against XLSXFutureFunctions */\n\t\t\t\t\t\tp.f=unescapexml(utf8read(cref[1]), true);\n\t\t\t\t\t\tif(!opts.xlfn) p.f = _xlfn(p.f);\n\t\t\t\t\t\tif(cref[0].indexOf('t=\"array\"') > -1) {\n\t\t\t\t\t\t\tp.F = (d.match(refregex)||[])[1];\n\t\t\t\t\t\t\tif(p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n\t\t\t\t\t\t} else if(cref[0].indexOf('t=\"shared\"') > -1) {\n\t\t\t\t\t\t\t// TODO: parse formula\n\t\t\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\t\t\tvar ___f = unescapexml(utf8read(cref[1]));\n\t\t\t\t\t\t\tif(!opts.xlfn) ___f = _xlfn(___f);\n\t\t\t\t\t\t\tsharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if((cref=d.match(/<f[^>]*\\/>/))) {\n\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\tif(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\n\t\t\t\t}\n\t\t\t\t/* TODO: factor out contains logic */\n\t\t\t\tvar _tag = decode_cell(tag.r);\n\t\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\tif(_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r)\n\t\t\t\t\t\tif(_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\tp.F = arrayf[i][1];\n\t\t\t}\n\n\t\t\tif(tag.t == null && p.v === undefined) {\n\t\t\t\tif(p.f || p.F) {\n\t\t\t\t\tp.v = 0; p.t = \"n\";\n\t\t\t\t} else if(!sheetStubs) continue;\n\t\t\t\telse p.t = \"z\";\n\t\t\t}\n\t\t\telse p.t = tag.t || \"n\";\n\t\t\tif(guess.s.c > tagc) guess.s.c = tagc;\n\t\t\tif(guess.e.c < tagc) guess.e.c = tagc;\n\t\t\t/* 18.18.11 t ST_CellType */\n\t\t\tswitch(p.t) {\n\t\t\t\tcase 'n':\n\t\t\t\t\tif(p.v == \"\" || p.v == null) {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else p.v = parseFloat(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 's':\n\t\t\t\t\tif(typeof p.v == 'undefined') {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsstr = strs[parseInt(p.v, 10)];\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tp.r = sstr.r;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'str':\n\t\t\t\t\tp.t = \"s\";\n\t\t\t\t\tp.v = (p.v!=null) ? unescapexml(utf8read(p.v), true) : '';\n\t\t\t\t\tif(opts.cellHTML) p.h = escapehtml(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'inlineStr':\n\t\t\t\t\tcref = d.match(isregex);\n\t\t\t\t\tp.t = 's';\n\t\t\t\t\tif(cref != null && (sstr = parse_si(cref[1]))) {\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t} else p.v = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'b': p.v = parsexmlbool(p.v); break;\n\t\t\t\tcase 'd':\n\t\t\t\t\tif(opts.cellDates) p.v = parseDate(p.v, date1904);\n\t\t\t\t\telse { p.v = datenum(parseDate(p.v, date1904), date1904); p.t = 'n'; }\n\t\t\t\t\tbreak;\n\t\t\t\t/* error string in .w, number in .v */\n\t\t\t\tcase 'e':\n\t\t\t\t\tif(!opts || opts.cellText !== false) p.w = p.v;\n\t\t\t\t\tp.v = RBErr[p.v]; break;\n\t\t\t}\n\t\t\t/* formatting */\n\t\t\tfmtid = fillid = 0;\n\t\t\tcf = null;\n\t\t\tif(do_format && tag.s !== undefined) {\n\t\t\t\tcf = styles.CellXf[tag.s];\n\t\t\t\tif(cf != null) {\n\t\t\t\t\tif(cf.numFmtId != null) fmtid = cf.numFmtId;\n\t\t\t\t\tif(opts.cellStyles) {\n\t\t\t\t\t\tif(cf.fillId != null) fillid = cf.fillId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsafe_format(p, fmtid, fillid, opts, themes, styles, date1904);\n\t\t\tif(opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) { p.v = numdate(p.v + (date1904 ? 1462 : 0)); p.t = typeof p.v == \"number\" ? 'n' : 'd'; }\n\t\t\tif(tag.cm && opts.xlmeta) {\n\t\t\t\tvar cm = (opts.xlmeta.Cell||[])[+tag.cm-1];\n\t\t\t\tif(cm && cm.type == 'XLDAPR') p.D = true;\n\t\t\t}\n\t\t\tvar _r;\n\t\t\tif(opts.nodim) {\n\t\t\t\t_r = decode_cell(tag.r);\n\t\t\t\tif(guess.s.r > _r.r) guess.s.r = _r.r;\n\t\t\t\tif(guess.e.r < _r.r) guess.e.r = _r.r;\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\t_r = decode_cell(tag.r);\n\t\t\t\tif(!s[\"!data\"][_r.r]) s[\"!data\"][_r.r] = [];\n\t\t\t\ts[\"!data\"][_r.r][_r.c] = p;\n\t\t\t} else s[tag.r] = p;\n\t\t}\n\t}\n\tif(rows.length > 0) s['!rows'] = rows;\n}; })();\n\nfunction write_ws_xml_data(ws, opts, idx, wb) {\n\tvar o = [], r = [], range = safe_decode_range(ws['!ref']), cell=\"\", ref, rr = \"\", cols = [], R=0, C=0, rows = ws['!rows'];\n\tvar dense = ws[\"!data\"] != null;\n\tvar params = ({r:rr}), row, height = -1;\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\tfor(C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(R = range.s.r; R <= range.e.r; ++R) {\n\t\tr = [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tref = cols[C] + rr;\n\t\t\tvar _cell = dense ? (ws[\"!data\"][R]||[])[C]: ws[ref];\n\t\t\tif(_cell === undefined) continue;\n\t\t\tif((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb, date1904)) != null) r.push(cell);\n\t\t}\n\t\tif(r.length > 0 || (rows && rows[R])) {\n\t\t\tparams = ({r:rr});\n\t\t\tif(rows && rows[R]) {\n\t\t\t\trow = rows[R];\n\t\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\t\theight = -1;\n\t\t\t\tif(row.hpx) height = px2pt(row.hpx);\n\t\t\t\telse if(row.hpt) height = row.hpt;\n\t\t\t\tif(height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\t\tif(row.level) { params.outlineLevel = row.level; }\n\t\t\t}\n\t\t\to[o.length] = (writextag('row', r.join(\"\"), params));\n\t\t}\n\t}\n\tif(rows) for(; R < rows.length; ++R) {\n\t\tif(rows && rows[R]) {\n\t\t\tparams = ({r:R+1});\n\t\t\trow = rows[R];\n\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\theight = -1;\n\t\t\tif (row.hpx) height = px2pt(row.hpx);\n\t\t\telse if (row.hpt) height = row.hpt;\n\t\t\tif (height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\tif (row.level) { params.outlineLevel = row.level; }\n\t\t\to[o.length] = (writextag('row', \"\", params));\n\t\t}\n\t}\n\treturn o.join(\"\");\n}\n\nfunction write_ws_xml(idx, opts, wb, rels) {\n\tvar o = [XML_HEADER, writextag('worksheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t})];\n\tvar s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\n\tvar ws = wb.Sheets[s];\n\tif(ws == null) ws = {};\n\tvar ref = ws['!ref'] || 'A1';\n\tvar range = safe_decode_range(ref);\n\tif(range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\n\t\trange.e.c = Math.min(range.e.c, 0x3FFF);\n\t\trange.e.r = Math.min(range.e.c, 0xFFFFF);\n\t\tref = encode_range(range);\n\t}\n\tif(!rels) rels = {};\n\tws['!comments'] = [];\n\tvar _drawing = [];\n\n\twrite_ws_xml_sheetpr(ws, wb, idx, opts, o);\n\n\to[o.length] = (writextag('dimension', null, {'ref': ref}));\n\n\to[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\n\n\t/* TODO: store in WB, process styles */\n\tif(opts.sheetFormat) o[o.length] = (writextag('sheetFormatPr', null, {\n\t\tdefaultRowHeight:opts.sheetFormat.defaultRowHeight||'16',\n\t\tbaseColWidth:opts.sheetFormat.baseColWidth||'10',\n\t\toutlineLevelRow:opts.sheetFormat.outlineLevelRow||'7'\n\t}));\n\n\tif(ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\n\n\to[sidx = o.length] = '<sheetData/>';\n\tws['!links'] = [];\n\tif(ws['!ref'] != null) {\n\t\trdata = write_ws_xml_data(ws, opts, idx, wb, rels);\n\t\tif(rdata.length > 0) o[o.length] = (rdata);\n\t}\n\tif(o.length>sidx+1) { o[o.length] = ('</sheetData>'); o[sidx]=o[sidx].replace(\"/>\",\">\"); }\n\n\t/* sheetCalcPr */\n\n\tif(ws['!protect']) o[o.length] = write_ws_xml_protection(ws['!protect']);\n\n\t/* protectedRanges */\n\t/* scenarios */\n\n\tif(ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\n\n\t/* sortState */\n\t/* dataConsolidate */\n\t/* customSheetViews */\n\n\tif(ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\n\n\t/* phoneticPr */\n\t/* conditionalFormatting */\n\t/* dataValidations */\n\n\tvar relc = -1, rel, rId = -1;\n\tif(ws['!links'].length > 0) {\n\t\to[o.length] = \"<hyperlinks>\";\nws['!links'].forEach(function(l) {\n\t\t\tif(!l[1].Target) return;\n\t\t\trel = ({\"ref\":l[0]});\n\t\t\tif(l[1].Target.charAt(0) != \"#\") {\n\t\t\t\trId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, \"\"), RELS.HLINK);\n\t\t\t\trel[\"r:id\"] = \"rId\"+rId;\n\t\t\t}\n\t\t\tif((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc+1));\n\t\t\tif(l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\n\t\t\trel.display = l[1].display;\n\t\t\to[o.length] = writextag(\"hyperlink\",null,rel);\n\t\t});\n\t\to[o.length] = \"</hyperlinks>\";\n\t}\n\tdelete ws['!links'];\n\n\t/* printOptions */\n\n\tif(ws['!margins'] != null) o[o.length] =  write_ws_xml_margins(ws['!margins']);\n\n\t/* pageSetup */\n\t/* headerFooter */\n\t/* rowBreaks */\n\t/* colBreaks */\n\t/* customProperties */\n\t/* cellWatches */\n\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {numberStoredAsText:1, sqref:ref}));\n\n\t/* smartTags */\n\n\tif(_drawing.length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n\t\to[o.length] = writextag(\"drawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!drawing'] = _drawing;\n\t}\n\n\tif(ws['!comments'].length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\to[o.length] = writextag(\"legacyDrawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!legacy'] = rId;\n\t}\n\n\t/* legacyDrawingHF */\n\t/* picture */\n\t/* oleObjects */\n\t/* controls */\n\t/* webPublishItems */\n\t/* tableParts */\n\t/* extLst */\n\n\tif(o.length>1) { o[o.length] = ('</worksheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSB] 2.4.726 BrtRowHdr */\nfunction parse_BrtRowHdr(data, length) {\n\tvar z = ({});\n\tvar tgt = data.l + length;\n\tz.r = data.read_shift(4);\n\tdata.l += 4; // TODO: ixfe\n\tvar miyRw = data.read_shift(2);\n\tdata.l += 1; // TODO: top/bot padding\n\tvar flags = data.read_shift(1);\n\tdata.l = tgt;\n\tif(flags & 0x07) z.level = flags & 0x07;\n\tif(flags & 0x10) z.hidden = true;\n\tif(flags & 0x20) z.hpt = miyRw / 20;\n\treturn z;\n}\nfunction write_BrtRowHdr(R, range, ws) {\n\tvar o = new_buf(17+8*16);\n\tvar row = (ws['!rows']||[])[R]||{};\n\to.write_shift(4, R);\n\n\to.write_shift(4, 0); /* TODO: ixfe */\n\n\tvar miyRw = 0x0140;\n\tif(row.hpx) miyRw = px2pt(row.hpx) * 20;\n\telse if(row.hpt) miyRw = row.hpt * 20;\n\to.write_shift(2, miyRw);\n\n\to.write_shift(1, 0); /* top/bot padding */\n\n\tvar flags = 0x0;\n\tif(row.level) flags |= row.level;\n\tif(row.hidden) flags |= 0x10;\n\tif(row.hpx || row.hpt) flags |= 0x20;\n\to.write_shift(1, flags);\n\n\to.write_shift(1, 0); /* phonetic guide */\n\n\t/* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\n\tvar ncolspan = 0, lcs = o.l;\n\to.l += 4;\n\n\tvar caddr = {r:R, c:0};\n\tvar dense = ws[\"!data\"] != null;\n\tfor(var i = 0; i < 16; ++i) {\n\t\tif((range.s.c > ((i+1) << 10)) || (range.e.c < (i << 10))) continue;\n\t\tvar first = -1, last = -1;\n\t\tfor(var j = (i<<10); j < ((i+1)<<10); ++j) {\n\t\t\tcaddr.c = j;\n\t\t\tvar cell = dense ? (ws[\"!data\"][caddr.r]||[])[caddr.c] : ws[encode_cell(caddr)];\n\t\t\tif(cell) { if(first < 0) first = j; last = j; }\n\t\t}\n\t\tif(first < 0) continue;\n\t\t++ncolspan;\n\t\to.write_shift(4, first);\n\t\to.write_shift(4, last);\n\t}\n\n\tvar l = o.l;\n\to.l = lcs;\n\to.write_shift(4, ncolspan);\n\to.l = l;\n\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction write_row_header(ba, ws, range, R) {\n\tvar o = write_BrtRowHdr(R, range, ws);\n\tif((o.length > 17) || (ws['!rows']||[])[R]) write_record(ba, 0x0000 /* BrtRowHdr */, o);\n}\n\n/* [MS-XLSB] 2.4.820 BrtWsDim */\nvar parse_BrtWsDim = parse_UncheckedRfX;\nvar write_BrtWsDim = write_UncheckedRfX;\n\n/* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\nfunction parse_BrtWsFmtInfo() {\n}\n//function write_BrtWsFmtInfo(ws, o) { }\n\n/* [MS-XLSB] 2.4.823 BrtWsProp */\nfunction parse_BrtWsProp(data, length) {\n\tvar z = {};\n\tvar f = data[data.l]; ++data.l;\n\tz.above = !(f & 0x40);\n\tz.left  = !(f & 0x80);\n\t/* TODO: pull flags */\n\tdata.l += 18;\n\tz.name = parse_XLSBCodeName(data, length - 19);\n\treturn z;\n}\nfunction write_BrtWsProp(str, outl, o) {\n\tif(o == null) o = new_buf(84+4*str.length);\n\tvar f = 0xC0;\n\tif(outl) {\n\t\tif(outl.above) f &= ~0x40;\n\t\tif(outl.left)  f &= ~0x80;\n\t}\n\to.write_shift(1, f);\n\tfor(var i = 1; i < 3; ++i) o.write_shift(1,0);\n\twrite_BrtColor({auto:1}, o);\n\to.write_shift(-4,-1);\n\to.write_shift(-4,-1);\n\twrite_XLSBCodeName(str, o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.306 BrtCellBlank */\nfunction parse_BrtCellBlank(data) {\n\tvar cell = parse_XLSBCell(data);\n\treturn [cell];\n}\nfunction write_BrtCellBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\treturn write_XLSBCell(ncell, o);\n}\nfunction parse_BrtShortBlank(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\treturn [cell];\n}\nfunction write_BrtShortBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(4);\n\treturn write_XLSBShortCell(ncell, o);\n}\n\n/* [MS-XLSB] 2.4.307 BrtCellBool */\nfunction parse_BrtCellBool(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtCellBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\nfunction parse_BrtShortBool(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtShortBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(5);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.308 BrtCellError */\nfunction parse_BrtCellError(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtCellError(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v);\n\treturn o;\n}\nfunction parse_BrtShortError(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtShortError(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v);\n\to.write_shift(2, 0);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n\n/* [MS-XLSB] 2.4.311 BrtCellIsst */\nfunction parse_BrtCellIsst(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtCellIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\nfunction parse_BrtShortIsst(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtShortIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.313 BrtCellReal */\nfunction parse_BrtCellReal(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(16);\n\twrite_XLSBCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortReal(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.314 BrtCellRk */\nfunction parse_BrtCellRk(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortRk(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtCellRString */\nfunction parse_BrtCellRString(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RichStr(data);\n\treturn [cell, value, 'is'];\n}\n\n/* [MS-XLSB] 2.4.317 BrtCellSt */\nfunction parse_BrtCellSt(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtCellSt(cell, ncell, o) {\n\tvar data = cell.v == null ? \"\" : String(cell.v);\n\tif(o == null) o = new_buf(12 + 4 * cell.v.length);\n\twrite_XLSBCell(ncell, o);\n\twrite_XLWideString(data, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction parse_BrtShortSt(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtShortSt(cell, ncell, o) {\n\tvar data = cell.v == null ? \"\" : String(cell.v);\n\tif(o == null) o = new_buf(8 + 4 * data.length);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_XLWideString(data, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.653 BrtFmlaBool */\nfunction parse_BrtFmlaBool(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'b'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.654 BrtFmlaError */\nfunction parse_BrtFmlaError(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'e'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.655 BrtFmlaNum */\nfunction parse_BrtFmlaNum(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_Xnum(data);\n\tvar o = [cell, value, 'n'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.656 BrtFmlaString */\nfunction parse_BrtFmlaString(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_XLWideString(data);\n\tvar o = [cell, value, 'str'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.682 BrtMergeCell */\nvar parse_BrtMergeCell = parse_UncheckedRfX;\nvar write_BrtMergeCell = write_UncheckedRfX;\n/* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\nfunction write_BrtBeginMergeCells(cnt, o) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(4, cnt);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.662 BrtHLink */\nfunction parse_BrtHLink(data, length) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar relId = parse_XLNullableWideString(data);\n\tvar loc = parse_XLWideString(data);\n\tvar tooltip = parse_XLWideString(data);\n\tvar display = parse_XLWideString(data);\n\tdata.l = end;\n\tvar o = ({rfx:rfx, relId:relId, loc:loc, display:display});\n\tif(tooltip) o.Tooltip = tooltip;\n\treturn o;\n}\nfunction write_BrtHLink(l, rId) {\n\tvar o = new_buf(50+4*(l[1].Target.length + (l[1].Tooltip || \"\").length));\n\twrite_UncheckedRfX({s:decode_cell(l[0]), e:decode_cell(l[0])}, o);\n\twrite_RelID(\"rId\" + rId, o);\n\tvar locidx = l[1].Target.indexOf(\"#\");\n\tvar loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx+1);\n\twrite_XLWideString(loc || \"\", o);\n\twrite_XLWideString(l[1].Tooltip || \"\", o);\n\twrite_XLWideString(\"\", o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.692 BrtPane */\nfunction parse_BrtPane(/*data, length, opts*/) {\n}\n\n/* [MS-XLSB] 2.4.6 BrtArrFmla */\nfunction parse_BrtArrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_RfX(data, 16);\n\tvar fAlwaysCalc = data.read_shift(1);\n\tvar o = [rfx]; o[2] = fAlwaysCalc;\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.750 BrtShrFmla */\nfunction parse_BrtShrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar o = [rfx];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t\tdata.l = end;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtColInfo */\n/* TODO: once XLS ColInfo is set, combine the functions */\nfunction write_BrtColInfo(C, col, o) {\n\tif(o == null) o = new_buf(18);\n\tvar p = col_obj_w(C, col);\n\to.write_shift(-4, C);\n\to.write_shift(-4, C);\n\to.write_shift(4, (p.width || 10) * 256);\n\to.write_shift(4, 0/*ixfe*/); // style\n\tvar flags = 0;\n\tif(col.hidden) flags |= 0x01;\n\tif(typeof p.width == 'number') flags |= 0x02;\n\tif(col.level) flags |= (col.level << 8);\n\to.write_shift(2, flags); // bit flag\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.678 BrtMargins */\nvar BrtMarginKeys = [\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"];\nfunction parse_BrtMargins(data) {\n\tvar margins = ({});\n\tBrtMarginKeys.forEach(function(k) { margins[k] = parse_Xnum(data, 8); });\n\treturn margins;\n}\nfunction write_BrtMargins(margins, o) {\n\tif(o == null) o = new_buf(6*8);\n\tdefault_margins(margins);\n\tBrtMarginKeys.forEach(function(k) { write_Xnum((margins)[k], o); });\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.299 BrtBeginWsView */\nfunction parse_BrtBeginWsView(data) {\n\tvar f = data.read_shift(2);\n\tdata.l += 28;\n\treturn { RTL: f & 0x20 };\n}\nfunction write_BrtBeginWsView(ws, Workbook, o) {\n\tif(o == null) o = new_buf(30);\n\tvar f = 0x39c;\n\tif((((Workbook||{}).Views||[])[0]||{}).RTL) f |= 0x20;\n\to.write_shift(2, f); // bit flag\n\to.write_shift(4, 0);\n\to.write_shift(4, 0); // view first row\n\to.write_shift(4, 0); // view first col\n\to.write_shift(1, 0); // gridline color ICV\n\to.write_shift(1, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 100); // zoom scale\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(4, 0); // workbook view id\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\nfunction write_BrtCellIgnoreEC(ref) {\n\tvar o = new_buf(24);\n\to.write_shift(4, 4);\n\to.write_shift(4, 1);\n\twrite_UncheckedRfX(ref, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.748 BrtSheetProtection */\nfunction write_BrtSheetProtection(sp, o) {\n\tif(o == null) o = new_buf(16*4+2);\n\to.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\n\to.write_shift(4, 1); // this record should not be written if no protection\n\t[\n\t\t[\"objects\",             false], // fObjects\n\t\t[\"scenarios\",           false], // fScenarios\n\t\t[\"formatCells\",          true], // fFormatCells\n\t\t[\"formatColumns\",        true], // fFormatColumns\n\t\t[\"formatRows\",           true], // fFormatRows\n\t\t[\"insertColumns\",        true], // fInsertColumns\n\t\t[\"insertRows\",           true], // fInsertRows\n\t\t[\"insertHyperlinks\",     true], // fInsertHyperlinks\n\t\t[\"deleteColumns\",        true], // fDeleteColumns\n\t\t[\"deleteRows\",           true], // fDeleteRows\n\t\t[\"selectLockedCells\",   false], // fSelLockedCells\n\t\t[\"sort\",                 true], // fSort\n\t\t[\"autoFilter\",           true], // fAutoFilter\n\t\t[\"pivotTables\",          true], // fPivotTables\n\t\t[\"selectUnlockedCells\", false]  // fSelUnlockedCells\n\t].forEach(function(n) {\nif(n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);\n\t\telse      o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\n\t});\n\treturn o;\n}\n\nfunction parse_BrtDVal(/*data, length, opts*/) {\n}\nfunction parse_BrtDVal14(/*data, length, opts*/) {\n}\n/* [MS-XLSB] 2.1.7.61 Worksheet */\nfunction parse_ws_bin(data, _opts, idx, rels, wb, themes, styles) {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar s = ({}); if(opts.dense) s[\"!data\"] = [];\n\n\tvar ref;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\tvar state = [];\n\tvar pass = false, end = false;\n\tvar row, p, cf, R, C, addr, sstr, rr, cell;\n\tvar merges = [];\n\topts.biff = 12;\n\topts['!row'] = 0;\n\n\tvar ai = 0, af = false;\n\n\tvar arrayf = [];\n\tvar sharedf = {};\n\tvar supbooks = opts.supbooks || wb.supbooks || ([[]]);\n\tsupbooks.sharedf = sharedf;\n\tsupbooks.arrayf = arrayf;\n\tsupbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function(x) { return x.name; });\n\tif(!opts.supbooks) {\n\t\topts.supbooks = supbooks;\n\t\tif(wb.Names) for(var i = 0; i < wb.Names.length; ++i) supbooks[0][i+1] = wb.Names[i];\n\t}\n\n\tvar colinfo = [], rowinfo = [];\n\tvar seencol = false;\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtShortReal\", f:parse_BrtShortReal };\n\n\tvar cm, vm;\n\tvar date1904 = 1462 * +!!((wb||{}).WBProps||{}).date1904;\n\n\trecordhopper(data, function ws_parse(val, RR, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0094: /* 'BrtWsDim' */\n\t\t\t\tref = val; break;\n\t\t\tcase 0x0000: /* 'BrtRowHdr' */\n\t\t\t\trow = val;\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= row.r) end=true;\n\t\t\t\trr = encode_row(R = row.r);\n\t\t\t\topts['!row'] = row.r;\n\t\t\t\tif(val.hidden || val.hpt || val.level != null) {\n\t\t\t\t\tif(val.hpt) val.hpx = pt2px(val.hpt);\n\t\t\t\t\trowinfo[val.r] = val;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0002: /* 'BrtCellRk' */\n\t\t\tcase 0x0003: /* 'BrtCellError' */\n\t\t\tcase 0x0004: /* 'BrtCellBool' */\n\t\t\tcase 0x0005: /* 'BrtCellReal' */\n\t\t\tcase 0x0006: /* 'BrtCellSt' */\n\t\t\tcase 0x0007: /* 'BrtCellIsst' */\n\t\t\tcase 0x0008: /* 'BrtFmlaString' */\n\t\t\tcase 0x0009: /* 'BrtFmlaNum' */\n\t\t\tcase 0x000A: /* 'BrtFmlaBool' */\n\t\t\tcase 0x000B: /* 'BrtFmlaError' */\n\t\t\tcase 0x000D: /* 'BrtShortRk' */\n\t\t\tcase 0x000E: /* 'BrtShortError' */\n\t\t\tcase 0x000F: /* 'BrtShortBool' */\n\t\t\tcase 0x0010: /* 'BrtShortReal' */\n\t\t\tcase 0x0011: /* 'BrtShortSt' */\n\t\t\tcase 0x0012: /* 'BrtShortIsst' */\n\t\t\tcase 0x003E: /* 'BrtCellRString' */\n\t\t\t\tp = ({t:val[2]});\n\t\t\t\tswitch(val[2]) {\n\t\t\t\t\tcase 'n': p.v = val[1]; break;\n\t\t\t\t\tcase 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\n\t\t\t\t\tcase 'b': p.v = val[1] ? true : false; break;\n\t\t\t\t\tcase 'e': p.v = val[1]; if(opts.cellText !== false) p.w = BErr[p.v]; break;\n\t\t\t\t\tcase 'str': p.t = 's'; p.v = val[1]; break;\n\t\t\t\t\tcase 'is': p.t = 's'; p.v = val[1].t; break;\n\t\t\t\t}\n\t\t\t\tif((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.numFmtId,null,opts, themes, styles, date1904>0);\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[\"!data\"][R]) s[\"!data\"][R] = []; s[\"!data\"][R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\taf = false;\n\t\t\t\t\tfor(ai = 0; ai < arrayf.length; ++ai) {\n\t\t\t\t\t\tvar aii = arrayf[ai];\n\t\t\t\t\t\tif(row.r >= aii[0].s.r && row.r <= aii[0].e.r)\n\t\t\t\t\t\t\tif(C >= aii[0].s.c && C <= aii[0].e.c) {\n\t\t\t\t\t\t\t\tp.F = encode_range(aii[0]); af = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!af && val.length > 3) p.f = val[3];\n\t\t\t\t}\n\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n\t\t\t\t\tvar _d = SSF_parse_date_code(p.v + date1904); if(_d) { p.t = 'd'; p.v = new Date(Date.UTC(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u)); }\n\t\t\t\t}\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0001: /* 'BrtCellBlank' */\n\t\t\tcase 0x000C: /* 'BrtShortBlank' */\n\t\t\t\tif(!opts.sheetStubs || pass) break;\n\t\t\t\tp = ({t:'z',v:void 0});\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[\"!data\"][R]) s[\"!data\"][R] = []; s[\"!data\"][R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00B0: /* 'BrtMergeCell' */\n\t\t\t\tmerges.push(val); break;\n\n\t\t\tcase 0x0031: { /* 'BrtCellMeta' */\n\t\t\t\tcm = ((opts.xlmeta||{}).Cell||[])[val-1];\n\t\t\t} break;\n\n\t\t\tcase 0x01EE: /* 'BrtHLink' */\n\t\t\t\tvar rel = rels['!id'][val.relId];\n\t\t\t\tif(rel) {\n\t\t\t\t\tval.Target = rel.Target;\n\t\t\t\t\tif(val.loc) val.Target += \"#\"+val.loc;\n\t\t\t\t\tval.Rel = rel;\n\t\t\t\t} else if(val.relId == '') {\n\t\t\t\t\tval.Target = \"#\" + val.loc;\n\t\t\t\t}\n\t\t\t\tfor(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\tif(!s[\"!data\"][R][C]) s[\"!data\"][R][C] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[\"!data\"][R][C].l = val;\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddr = encode_col(C) + encode_row(R);\n\t\t\t\t\t\tif(!s[addr]) s[addr] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[addr].l = val;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01AA: /* 'BrtArrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tarrayf.push(val);\n\t\t\t\tcell = ((opts.dense ? s[\"!data\"][R][C] : s[encode_col(C) + rr]));\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tcell.F = encode_range(val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x01AB: /* 'BrtShrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tsharedf[encode_cell(val[0].s)] = val[1];\n\t\t\t\tcell = (opts.dense ? s[\"!data\"][R][C] : s[encode_col(C) + rr]);\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tbreak;\n\n\t\t\t/* identical to 'ColInfo' in XLS */\n\t\t\tcase 0x003C: /* 'BrtColInfo' */\n\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, hidden: !!(val.flags & 0x01), level: val.level };\n\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\t\tif(val) s[\"!legrel\"] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00A1: /* 'BrtBeginAFilter' */\n\t\t\t\ts['!autofilter'] = { ref:encode_range(val) };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\t\ts['!margins'] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0093: /* 'BrtWsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tif(val.above || val.left) s['!outline'] = { above: val.above, left: val.left };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0089: /* 'BrtBeginWsView' */\n\t\t\t\tif(!wb.Views) wb.Views = [{}];\n\t\t\t\tif(!wb.Views[0]) wb.Views[0] = {};\n\t\t\t\tif(val.RTL) wb.Views[0].RTL = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01E5: /* 'BrtWsFmtInfo' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0040: /* 'BrtDVal' */\n\t\t\tcase 0x041D: /* 'BrtDVal14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0097: /* 'BrtPane' */\n\t\t\t\tbreak;\n\t\t\tcase 0x0098: /* 'BrtSel' */\n\t\t\tcase 0x00AF: /* 'BrtAFilterDateGroupItem' */\n\t\t\tcase 0x0284: /* 'BrtActiveX' */\n\t\t\tcase 0x0271: /* 'BrtBigName' */\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x018C: /* 'BrtBrk' */\n\t\t\tcase 0x0458: /* 'BrtCFIcon' */\n\t\t\tcase 0x047A: /* 'BrtCFRuleExt' */\n\t\t\tcase 0x01D7: /* 'BrtCFVO' */\n\t\t\tcase 0x041A: /* 'BrtCFVO14' */\n\t\t\tcase 0x0289: /* 'BrtCellIgnoreEC' */\n\t\t\tcase 0x0451: /* 'BrtCellIgnoreEC14' */\n\t\t\tcase 0x024D: /* 'BrtCellSmartTagProperty' */\n\t\t\tcase 0x025F: /* 'BrtCellWatch' */\n\t\t\tcase 0x0234: /* 'BrtColor' */\n\t\t\tcase 0x041F: /* 'BrtColor14' */\n\t\t\tcase 0x00A8: /* 'BrtColorFilter' */\n\t\t\tcase 0x00AE: /* 'BrtCustomFilter' */\n\t\t\tcase 0x049C: /* 'BrtCustomFilter14' */\n\t\t\tcase 0x01F3: /* 'BrtDRef' */\n\t\t\tcase 0x01FB: /* 'BrtDXF' */\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\tcase 0x00AB: /* 'BrtDynamicFilter' */\n\t\t\tcase 0x00A7: /* 'BrtFilter' */\n\t\t\tcase 0x0499: /* 'BrtFilter14' */\n\t\t\tcase 0x00A9: /* 'BrtIconFilter' */\n\t\t\tcase 0x049D: /* 'BrtIconFilter14' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x0295: /* 'BrtListPart' */\n\t\t\tcase 0x027F: /* 'BrtOleObject' */\n\t\t\tcase 0x01DE: /* 'BrtPageSetup' */\n\t\t\tcase 0x0219: /* 'BrtPhoneticInfo' */\n\t\t\tcase 0x01DD: /* 'BrtPrintOptions' */\n\t\t\tcase 0x0218: /* 'BrtRangeProtection' */\n\t\t\tcase 0x044F: /* 'BrtRangeProtection14' */\n\t\t\tcase 0x02A8: /* 'BrtRangeProtectionIso' */\n\t\t\tcase 0x0450: /* 'BrtRangeProtectionIso14' */\n\t\t\tcase 0x0400: /* 'BrtRwDescent' */\n\t\t\tcase 0x0297: /* 'BrtSheetCalcProp' */\n\t\t\tcase 0x0217: /* 'BrtSheetProtection' */\n\t\t\tcase 0x02A6: /* 'BrtSheetProtectionIso' */\n\t\t\tcase 0x01F8: /* 'BrtSlc' */\n\t\t\tcase 0x0413: /* 'BrtSparkline' */\n\t\t\tcase 0x01AC: /* 'BrtTable' */\n\t\t\tcase 0x00AA: /* 'BrtTop10Filter' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0032: /* 'BrtValueMeta' */\n\t\t\tcase 0x0816: /* 'BrtWebExtension' */\n\t\t\tcase 0x0415: /* 'BrtWsFmtInfoEx14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(RR.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tdelete opts.supbooks;\n\tdelete opts['!row'];\n\n\tif(!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n\tif(opts.sheetRows && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\tif(colinfo.length > 0) s[\"!cols\"] = colinfo;\n\tif(rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n\tif(rels['!id'][s['!legrel']]) s['!legdrawel'] = rels['!id'][s['!legrel']];\n\treturn s;\n}\n\n/* TODO: something useful -- this is a stub */\nfunction write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen, date1904) {\n\tvar o = ({r:R, c:C});\n\tif(cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\n\tif(cell.v === undefined) return false;\n\tvar vv = \"\";\n\tswitch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'd': // no BrtCellDate :(\n\t\t\tcell = dup(cell);\n\t\t\tcell.z = cell.z || table_fmt[14];\n\t\t\tcell.v = datenum(parseDate(cell.v, date1904), date1904); cell.t = 'n';\n\t\t\tbreak;\n\t\t/* falls through */\n\t\tcase 'n': case 'e': vv = ''+cell.v; break;\n\t\tdefault: vv = cell.v; break;\n\t}\n\t/* TODO: cell style */\n\to.s = get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.l) ws['!links'].push([encode_cell(o), cell.l]);\n\tswitch(cell.t) {\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvv = get_sst_id(opts.Strings, (cell.v == null ? \"\" : String(cell.v)), opts.revStrings);\n\t\t\t\to.t = \"s\"; o.v = vv;\n\t\t\t\tif(last_seen) write_record(ba, 0x0012 /* BrtShortIsst */, write_BrtShortIsst(cell, o));\n\t\t\t\telse write_record(ba, 0x0007 /* BrtCellIsst */, write_BrtCellIsst(cell, o));\n\t\t\t} else {\n\t\t\t\to.t = \"str\";\n\t\t\t\tif(last_seen) write_record(ba, 0x0011 /* BrtShortSt */, write_BrtShortSt(cell, o));\n\t\t\t\telse write_record(ba, 0x0006 /* BrtCellSt */, write_BrtCellSt(cell, o));\n\t\t\t}\n\t\t\treturn true;\n\t\tcase 'n':\n\t\t\t/* TODO: determine threshold for Real vs RK */\n\t\t\tif(cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) {\n\t\t\t\tif(last_seen) write_record(ba, 0x000D /* BrtShortRk */, write_BrtShortRk(cell, o));\n\t\t\t\telse write_record(ba, 0x0002 /* BrtCellRk */, write_BrtCellRk(cell, o));\n\t\t\t} else if(isNaN(cell.v)) {\n\t\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError({t:\"e\", v: 0x24}, o)); // #NUM!\n\t\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError({t:\"e\", v: 0x24}, o)); // #NUM!\n\t\t\t} else if(!isFinite(cell.v)) {\n\t\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError({t:\"e\", v: 0x07}, o)); // #DIV/0!\n\t\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError({t:\"e\", v: 0x07}, o)); // #DIV/0!\n\t\t\t} else {\n\t\t\t\tif(last_seen) write_record(ba, 0x0010 /* BrtShortReal */, write_BrtShortReal(cell, o));\n\t\t\t\telse write_record(ba, 0x0005 /* BrtCellReal */, write_BrtCellReal(cell, o));\n\t\t\t} return true;\n\t\tcase 'b':\n\t\t\to.t = \"b\";\n\t\t\tif(last_seen) write_record(ba, 0x000F /* BrtShortBool */, write_BrtShortBool(cell, o));\n\t\t\telse write_record(ba, 0x0004 /* BrtCellBool */, write_BrtCellBool(cell, o));\n\t\t\treturn true;\n\t\tcase 'e':\n\t\t\to.t = \"e\";\n\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError(cell, o));\n\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError(cell, o));\n\t\t\treturn true;\n\t}\n\tif(last_seen) write_record(ba, 0x000C /* BrtShortBlank */, write_BrtShortBlank(cell, o));\n\telse write_record(ba, 0x0001 /* BrtCellBlank */, write_BrtCellBlank(cell, o));\n\treturn true;\n}\n\nfunction write_CELLTABLE(ba, ws, idx, opts, wb) {\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\twrite_record(ba, 0x0091 /* BrtBeginSheetData */);\n\tvar dense = ws[\"!data\"] != null;\n\tvar cap = range.e.r;\n\tif(ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\n\tfor(var R = range.s.r; R <= cap; ++R) {\n\t\trr = encode_row(R);\n\t\t/* [ACCELLTABLE] */\n\t\t/* BrtRowHdr */\n\t\twrite_row_header(ba, ws, range, R);\n\t\tvar last_seen = false;\n\t\tif(R <= range.e.r) for(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t/* *16384CELL */\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[ref];\n\t\t\tif(!cell) { last_seen = false; continue; }\n\t\t\t/* write cell */\n\t\t\tlast_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen, date1904);\n\t\t}\n\t}\n\twrite_record(ba, 0x0092 /* BrtEndSheetData */);\n}\n\nfunction write_MERGECELLS(ba, ws) {\n\tif(!ws || !ws['!merges']) return;\n\twrite_record(ba, 0x00B1 /* BrtBeginMergeCells */, write_BrtBeginMergeCells(ws['!merges'].length));\n\tws['!merges'].forEach(function(m) { write_record(ba, 0x00B0 /* BrtMergeCell */, write_BrtMergeCell(m)); });\n\twrite_record(ba, 0x00B2 /* BrtEndMergeCells */);\n}\n\nfunction write_COLINFOS(ba, ws) {\n\tif(!ws || !ws['!cols']) return;\n\twrite_record(ba, 0x0186 /* BrtBeginColInfos */);\n\tws['!cols'].forEach(function(m, i) { if(m) write_record(ba, 0x003C /* 'BrtColInfo' */, write_BrtColInfo(i, m)); });\n\twrite_record(ba, 0x0187 /* BrtEndColInfos */);\n}\n\nfunction write_IGNOREECS(ba, ws) {\n\tif(!ws || !ws['!ref']) return;\n\twrite_record(ba, 0x0288 /* BrtBeginCellIgnoreECs */);\n\twrite_record(ba, 0x0289 /* BrtCellIgnoreEC */, write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\n\twrite_record(ba, 0x028A /* BrtEndCellIgnoreECs */);\n}\n\nfunction write_HLINKS(ba, ws, rels) {\n\t/* *BrtHLink */\n\tws['!links'].forEach(function(l) {\n\t\tif(!l[1].Target) return;\n\t\tvar rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, \"\"), RELS.HLINK);\n\t\twrite_record(ba, 0x01EE /* BrtHLink */, write_BrtHLink(l, rId));\n\t});\n\tdelete ws['!links'];\n}\nfunction write_LEGACYDRAWING(ba, ws, idx, rels) {\n\t/* [BrtLegacyDrawing] */\n\tif(ws['!comments'].length > 0) {\n\t\tvar rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\twrite_record(ba, 0x0227 /* BrtLegacyDrawing */, write_RelID(\"rId\" + rId));\n\t\tws['!legacy'] = rId;\n\t}\n}\n\nfunction write_AUTOFILTER(ba, ws, wb, idx) {\n\tif(!ws['!autofilter']) return;\n\tvar data = ws['!autofilter'];\n\tvar ref = typeof data.ref === \"string\" ? data.ref : encode_range(data.ref);\n\n\t/* Update FilterDatabase defined name for the worksheet */\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]});\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = formula_quote_sheet_name(wb.SheetNames[idx]) + \"!\" + fix_range(ref); break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: formula_quote_sheet_name(wb.SheetNames[idx]) + \"!\" + fix_range(ref)  });\n\n\twrite_record(ba, 0x00A1 /* BrtBeginAFilter */, write_UncheckedRfX(safe_decode_range(ref)));\n\t/* *FILTERCOLUMN */\n\t/* [SORTSTATE] */\n\t/* BrtEndAFilter */\n\twrite_record(ba, 0x00A2 /* BrtEndAFilter */);\n}\n\nfunction write_WSVIEWS2(ba, ws, Workbook) {\n\twrite_record(ba, 0x0085 /* BrtBeginWsViews */);\n\t{ /* 1*WSVIEW2 */\n\t\t/* [ACUID] */\n\t\twrite_record(ba, 0x0089 /* BrtBeginWsView */, write_BrtBeginWsView(ws, Workbook));\n\t\t/* [BrtPane] */\n\t\t/* *4BrtSel */\n\t\t/* *4SXSELECT */\n\t\t/* *FRT */\n\t\twrite_record(ba, 0x008A /* BrtEndWsView */);\n\t}\n\t/* *FRT */\n\twrite_record(ba, 0x0086 /* BrtEndWsViews */);\n}\n\nfunction write_WSFMTINFO() {\n\t/* [ACWSFMTINFO] */\n\t// write_record(ba, 0x01E5 /* BrtWsFmtInfo */, write_BrtWsFmtInfo(ws));\n}\n\nfunction write_SHEETPROTECT(ba, ws) {\n\tif(!ws['!protect']) return;\n\t/* [BrtSheetProtectionIso] */\n\twrite_record(ba, 0x0217 /* BrtSheetProtection */, write_BrtSheetProtection(ws['!protect']));\n}\n\nfunction write_ws_bin(idx, opts, wb, rels) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar c = s; try { if(wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c; } catch(e) {}\n\tvar r = safe_decode_range(ws['!ref'] || \"A1\");\n\tif(r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\n\t\tr.e.c = Math.min(r.e.c, 0x3FFF);\n\t\tr.e.r = Math.min(r.e.c, 0xFFFFF);\n\t}\n\tws['!links'] = [];\n\t/* passed back to write_zip and removed there */\n\tws['!comments'] = [];\n\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n\tif(wb.vbaraw || ws['!outline']) write_record(ba, 0x0093 /* BrtWsProp */, write_BrtWsProp(c, ws['!outline']));\n\twrite_record(ba, 0x0094 /* BrtWsDim */, write_BrtWsDim(r));\n\twrite_WSVIEWS2(ba, ws, wb.Workbook);\n\twrite_WSFMTINFO(ba, ws);\n\twrite_COLINFOS(ba, ws, idx, opts, wb);\n\twrite_CELLTABLE(ba, ws, idx, opts, wb);\n\t/* [BrtSheetCalcProp] */\n\twrite_SHEETPROTECT(ba, ws);\n\t/* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\t/* [SCENMAN] */\n\twrite_AUTOFILTER(ba, ws, wb, idx);\n\t/* [SORTSTATE] */\n\t/* [DCON] */\n\t/* [USERSHVIEWS] */\n\twrite_MERGECELLS(ba, ws);\n\t/* [BrtPhoneticInfo] */\n\t/* *CONDITIONALFORMATTING */\n\t/* [DVALS] */\n\twrite_HLINKS(ba, ws, rels);\n\t/* [BrtPrintOptions] */\n\tif(ws['!margins']) write_record(ba, 0x01DC /* BrtMargins */, write_BrtMargins(ws['!margins']));\n\t/* [BrtPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* [RWBRK] */\n\t/* [COLBRK] */\n\t/* *BrtBigName */\n\t/* [CELLWATCHES] */\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) write_IGNOREECS(ba, ws);\n\t/* [SMARTTAGS] */\n\t/* [BrtDrawing] */\n\twrite_LEGACYDRAWING(ba, ws, idx, rels);\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [OLEOBJECTS] */\n\t/* [ACTIVEXCONTROLS] */\n\t/* [WEBPUBITEMS] */\n\t/* [LISTPARTS] */\n\t/* FRTWORKSHEET */\n\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n\treturn ba.end();\n}\nfunction parse_Cache(data) {\n\tvar col = [];\n\tvar num = data.match(/^<c:numCache>/);\n\tvar f;\n\n\t/* 21.2.2.150 pt CT_NumVal */\n\t(data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg)||[]).forEach(function(pt) {\n\t\tvar q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\n\t\tif(!q) return;\n\t\tcol[+q[1]] = num ? +q[2] : q[2];\n\t});\n\n\t/* 21.2.2.71 formatCode CT_Xstring */\n\tvar nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\",\"General\"])[1]);\n\n\t(data.match(/<c:f>(.*?)<\\/c:f>/mg)||[]).forEach(function(F) { f = F.replace(/<.*?>/g,\"\"); });\n\n\treturn [col, nf, f];\n}\n\n/* 21.2 DrawingML - Charts */\nfunction parse_chart(data, name, opts, rels, wb, csheet) {\n\tvar cs = ((csheet || {\"!type\":\"chart\"}));\n\tif(!data) return csheet;\n\t/* 21.2.2.27 chart CT_Chart */\n\n\tvar C = 0, R = 0, col = \"A\";\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\t/* 21.2.2.120 numCache CT_NumData */\n\t(data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm)||[]).forEach(function(nc) {\n\t\tvar cache = parse_Cache(nc);\n\t\trefguess.s.r = refguess.s.c = 0;\n\t\trefguess.e.c = C;\n\t\tcol = encode_col(C);\n\t\tcache[0].forEach(function(n,i) {\n\t\t\tif(cs[\"!data\"]) {\n\t\t\t\tif(!cs[\"!data\"][i]) cs[\"!data\"][i] = [];\n\t\t\t\tcs[\"!data\"][i][C] = {t:'n', v:n, z:cache[1] };\n\t\t\t} else cs[col + encode_row(i)] = {t:'n', v:n, z:cache[1] };\n\t\t\tR = i;\n\t\t});\n\t\tif(refguess.e.r < R) refguess.e.r = R;\n\t\t++C;\n\t});\n\tif(C > 0) cs[\"!ref\"] = encode_range(refguess);\n\treturn cs;\n}\n/* 18.3 Worksheets also covers Chartsheets */\nfunction parse_cs_xml(data, opts, idx, rels, wb) {\n\tif(!data) return data;\n\t/* 18.3.1.12 chartsheet CT_ChartSheet */\n\tif(!rels) rels = {'!id':{}};\n\tvar s = ({'!type':\"chart\", '!drawel':null, '!rel':\"\"});\n\tvar m;\n\n\t/* 18.3.1.83 sheetPr CT_ChartsheetPr */\n\tvar sheetPr = data.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\n\t/* 18.3.1.36 drawing CT_Drawing */\n\tif((m = data.match(/drawing r:id=\"(.*?)\"/))) s['!rel'] = m[1];\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\n//function write_cs_xml(idx, opts, wb, rels) {\n//\tvar o = [XML_HEADER, writextag('chartsheet', null, {\n//\t\t'xmlns': XMLNS_main[0],\n//\t\t'xmlns:r': XMLNS.r\n//\t})];\n//\to[o.length] = writextag(\"drawing\", null, {\"r:id\": \"rId1\"});\n//\tadd_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n//\tif(o.length>2) { o[o.length] = ('</chartsheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n//\treturn o.join(\"\");\n//}\n\n/* [MS-XLSB] 2.4.331 BrtCsProp */\nfunction parse_BrtCsProp(data, length) {\n\tdata.l += 10;\n\tvar name = parse_XLWideString(data, length - 10);\n\treturn { name: name };\n}\n\n/* [MS-XLSB] 2.1.7.7 Chart Sheet */\nfunction parse_cs_bin(data, opts, idx, rels, wb) {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tvar s = {'!type':\"chart\", '!drawel':null, '!rel':\"\"};\n\tvar state = [];\n\tvar pass = false;\n\trecordhopper(data, function cs_parse(val, R, RT) {\n\t\tswitch(RT) {\n\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\t\ts['!rel'] = val; break;\n\n\t\t\tcase 0x028B: /* 'BrtCsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x028C: /* 'BrtCsPageSetup' */\n\t\t\tcase 0x029D: /* 'BrtCsProtection' */\n\t\t\tcase 0x02A7: /* 'BrtCsProtectionIso' */\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\n//function write_cs_bin() {\n//\tvar ba = buf_array();\n//\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n//\t/* [BrtCsProp] */\n//\t/* CSVIEWS */\n//\t/* [[BrtCsProtectionIso] BrtCsProtection] */\n//\t/* [USERCSVIEWS] */\n//\t/* [BrtMargins] */\n//\t/* [BrtCsPageSetup] */\n//\t/* [HEADERFOOTER] */\n//\t/* BrtDrawing */\n//\t/* [BrtLegacyDrawing] */\n//\t/* [BrtLegacyDrawingHF] */\n//\t/* [BrtBkHim] */\n//\t/* [WEBPUBITEMS] */\n//\t/* FRTCHARTSHEET */\n//\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n//\treturn ba.end();\n//}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\nvar WBPropsDef = [\n\t['allowRefreshQuery',           false, \"bool\"],\n\t['autoCompressPictures',        true,  \"bool\"],\n\t['backupFile',                  false, \"bool\"],\n\t['checkCompatibility',          false, \"bool\"],\n\t['CodeName',                    ''],\n\t['date1904',                    false, \"bool\"],\n\t['defaultThemeVersion',         0,      \"int\"],\n\t['filterPrivacy',               false, \"bool\"],\n\t['hidePivotFieldList',          false, \"bool\"],\n\t['promptedSolutions',           false, \"bool\"],\n\t['publishItems',                false, \"bool\"],\n\t['refreshAllConnections',       false, \"bool\"],\n\t['saveExternalLinkValues',      true,  \"bool\"],\n\t['showBorderUnselectedTables',  true,  \"bool\"],\n\t['showInkAnnotation',           true,  \"bool\"],\n\t['showObjects',                 'all'],\n\t['showPivotChartFilter',        false, \"bool\"],\n\t['updateLinks', 'userSet']\n];\n\n/* 18.2.30 (CT_BookView) Defaults */\nvar WBViewDef = [\n\t['activeTab',                   0,      \"int\"],\n\t['autoFilterDateGrouping',      true,  \"bool\"],\n\t['firstSheet',                  0,      \"int\"],\n\t['minimized',                   false, \"bool\"],\n\t['showHorizontalScroll',        true,  \"bool\"],\n\t['showSheetTabs',               true,  \"bool\"],\n\t['showVerticalScroll',          true,  \"bool\"],\n\t['tabRatio',                    600,    \"int\"],\n\t['visibility',                  'visible']\n\t//window{Height,Width}, {x,y}Window\n];\n\n/* 18.2.19 (CT_Sheet) Defaults */\nvar SheetDef = [\n\t//['state', 'visible']\n];\n\n/* 18.2.2  (CT_CalcPr) Defaults */\nvar CalcPrDef = [\n\t['calcCompleted', 'true'],\n\t['calcMode', 'auto'],\n\t['calcOnSave', 'true'],\n\t['concurrentCalc', 'true'],\n\t['fullCalcOnLoad', 'false'],\n\t['fullPrecision', 'true'],\n\t['iterate', 'false'],\n\t['iterateCount', '100'],\n\t['iterateDelta', '0.001'],\n\t['refMode', 'A1']\n];\n\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\n/*var CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];*/\n\nfunction push_defaults_array(target, defaults) {\n\tfor(var j = 0; j != target.length; ++j) { var w = target[j];\n\t\tfor(var i=0; i != defaults.length; ++i) { var z = defaults[i];\n\t\t\tif(w[z[0]] == null) w[z[0]] = z[1];\n\t\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]); break;\n\t\t\tcase \"int\": if(typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10); break;\n\t\t\t}\n\t\t}\n\t}\n}\nfunction push_defaults(target, defaults) {\n\tfor(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\n\t\tif(target[z[0]] == null) target[z[0]] = z[1];\n\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]); break;\n\t\t\tcase \"int\": if(typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10); break;\n\t\t}\n\t}\n}\n\nfunction parse_wb_defaults(wb) {\n\tpush_defaults(wb.WBProps, WBPropsDef);\n\tpush_defaults(wb.CalcPr, CalcPrDef);\n\n\tpush_defaults_array(wb.WBView, WBViewDef);\n\tpush_defaults_array(wb.Sheets, SheetDef);\n\n\t_ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n}\n\nfunction safe1904(wb) {\n\t/* TODO: store date1904 somewhere else */\n\tif(!wb.Workbook) return \"false\";\n\tif(!wb.Workbook.WBProps) return \"false\";\n\treturn parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n}\n\nvar badchars = \":][*?\\/\\\\\".split(\"\");\nfunction check_ws_name(n, safe) {\n\ttry {\n\t\tif(n == \"\") throw new Error(\"Sheet name cannot be blank\");\n\t\tif(n.length > 31) throw new Error(\"Sheet name cannot exceed 31 chars\");\n\t\tif(n.charCodeAt(0) == 0x27 || n.charCodeAt(n.length - 1) == 0x27) throw new Error(\"Sheet name cannot start or end with apostrophe (')\");\n\t\tif(n.toLowerCase() == \"history\") throw new Error(\"Sheet name cannot be 'History'\");\n\t\tbadchars.forEach(function(c) {\n\t\t\tif(n.indexOf(c) == -1) return;\n\t\t\tthrow new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n\t\t});\n\t} catch(e) { if(safe) return false; throw e; }\n\treturn true;\n}\nfunction check_wb_names(N, S, codes) {\n\tN.forEach(function(n,i) {\n\t\tcheck_ws_name(n);\n\t\tfor(var j = 0; j < i; ++j) if(n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\n\t\tif(codes) {\n\t\t\tvar cn = (S && S[i] && S[i].CodeName) || n;\n\t\t\tif(cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\n\t\t}\n\t});\n}\nfunction check_wb(wb) {\n\tif(!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n\tif(!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n\tvar Sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\n\tcheck_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\n\twb.SheetNames.forEach(function(n, i) {\n\t\tvar ws = wb.Sheets[n];\n\t\tif(!ws || !ws[\"!autofilter\"]) return;\n\t\tvar DN;\n\t\tif(!wb.Workbook) wb.Workbook = {};\n\t\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\t\twb.Workbook.Names.forEach(function(dn) { if(dn.Name == \"_xlnm._FilterDatabase\" && dn.Sheet == i) DN = dn; });\n\t\tvar nn = formula_quote_sheet_name(n) + \"!\" + fix_range(ws[\"!autofilter\"].ref);\n\t\tif(DN) DN.Ref = nn;\n\t\telse wb.Workbook.Names.push({Name: \"_xlnm._FilterDatabase\", Sheet: i, Ref: nn});\n\t});\n\t/* TODO: validate workbook */\n}\n/* 18.2 Workbook */\nvar wbnsregex = /<\\w+:workbook/;\nfunction parse_wb_xml(data, opts) {\n\tif(!data) throw new Error(\"Could not find file\");\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, Names:[], xmlns: \"\" };\n\tvar pass = false, xmlns = \"xmlns\";\n\tvar dname = {}, dnstart = 0;\n\tdata.replace(tagregex, function xml_wb(x, idx) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 18.2.27 workbook CT_Workbook 1 */\n\t\t\tcase '<workbook':\n\t\t\t\tif(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n\t\t\t\twb.xmlns = y[xmlns];\n\t\t\t\tbreak;\n\t\t\tcase '</workbook>': break;\n\n\t\t\t/* 18.2.13 fileVersion CT_FileVersion ? */\n\t\t\tcase '<fileVersion': delete y[0]; wb.AppVersion = y; break;\n\t\t\tcase '<fileVersion/>': case '</fileVersion>': break;\n\n\t\t\t/* 18.2.12 fileSharing CT_FileSharing ? */\n\t\t\tcase '<fileSharing':\n\t\t\t\tbreak;\n\t\t\tcase '<fileSharing/>': break;\n\n\t\t\t/* 18.2.28 workbookPr CT_WorkbookPr ? */\n\t\t\tcase '<workbookPr':\n\t\t\tcase '<workbookPr/>':\n\t\t\t\tWBPropsDef.forEach(function(w) {\n\t\t\t\t\tif(y[w[0]] == null) return;\n\t\t\t\t\tswitch(w[2]) {\n\t\t\t\t\t\tcase \"bool\": wb.WBProps[w[0]] = parsexmlbool(y[w[0]]); break;\n\t\t\t\t\t\tcase \"int\": wb.WBProps[w[0]] = parseInt(y[w[0]], 10); break;\n\t\t\t\t\t\tdefault: wb.WBProps[w[0]] = y[w[0]];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n\t\t\t\tbreak;\n\t\t\tcase '</workbookPr>': break;\n\n\t\t\t/* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\t\t\tcase '<workbookProtection':\n\t\t\t\tbreak;\n\t\t\tcase '<workbookProtection/>': break;\n\n\t\t\t/* 18.2.1  bookViews CT_BookViews ? */\n\t\t\tcase '<bookViews': case '<bookViews>': case '</bookViews>': break;\n\t\t\t/* 18.2.30   workbookView CT_BookView + */\n\t\t\tcase '<workbookView': case '<workbookView/>': delete y[0]; wb.WBView.push(y); break;\n\t\t\tcase '</workbookView>': break;\n\n\t\t\t/* 18.2.20 sheets CT_Sheets 1 */\n\t\t\tcase '<sheets': case '<sheets>': case '</sheets>': break; // aggregate sheet\n\t\t\t/* 18.2.19   sheet CT_Sheet + */\n\t\t\tcase '<sheet':\n\t\t\t\tswitch(y.state) {\n\t\t\t\t\tcase \"hidden\": y.Hidden = 1; break;\n\t\t\t\t\tcase \"veryHidden\": y.Hidden = 2; break;\n\t\t\t\t\tdefault: y.Hidden = 0;\n\t\t\t\t}\n\t\t\t\tdelete y.state;\n\t\t\t\ty.name = unescapexml(utf8read(y.name));\n\t\t\t\tdelete y[0]; wb.Sheets.push(y); break;\n\t\t\tcase '</sheet>': break;\n\n\t\t\t/* 18.2.15 functionGroups CT_FunctionGroups ? */\n\t\t\tcase '<functionGroups': case '<functionGroups/>': break;\n\t\t\t/* 18.2.14   functionGroup CT_FunctionGroup + */\n\t\t\tcase '<functionGroup': break;\n\n\t\t\t/* 18.2.9  externalReferences CT_ExternalReferences ? */\n\t\t\tcase '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\n\t\t\t/* 18.2.8    externalReference CT_ExternalReference + */\n\t\t\tcase '<externalReference': break;\n\n\t\t\t/* 18.2.6  definedNames CT_DefinedNames ? */\n\t\t\tcase '<definedNames/>': break;\n\t\t\tcase '<definedNames>': case '<definedNames': pass=true; break;\n\t\t\tcase '</definedNames>': pass=false; break;\n\t\t\t/* 18.2.5    definedName CT_DefinedName + */\n\t\t\tcase '<definedName': {\n\t\t\t\tdname = {};\n\t\t\t\tdname.Name = utf8read(y.name);\n\t\t\t\tif(y.comment) dname.Comment = y.comment;\n\t\t\t\tif(y.localSheetId) dname.Sheet = +y.localSheetId;\n\t\t\t\tif(parsexmlbool(y.hidden||\"0\")) dname.Hidden = true;\n\t\t\t\tdnstart = idx + x.length;\n\t\t\t}\tbreak;\n\t\t\tcase '</definedName>': {\n\t\t\t\tdname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n\t\t\t\twb.Names.push(dname);\n\t\t\t} break;\n\t\t\tcase '<definedName/>': break;\n\n\t\t\t/* 18.2.2  calcPr CT_CalcPr ? */\n\t\t\tcase '<calcPr': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '</calcPr>': break;\n\n\t\t\t/* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\t\t\tcase '<oleSize': break;\n\n\t\t\t/* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\t\t\tcase '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\n\t\t\t/* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n\t\t\tcase '<customWorkbookView': case '</customWorkbookView>': break;\n\n\t\t\t/* 18.2.18 pivotCaches CT_PivotCaches ? */\n\t\t\tcase '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\n\t\t\t/* 18.2.17 pivotCache CT_PivotCache ? */\n\t\t\tcase '<pivotCache': break;\n\n\t\t\t/* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\t\t\tcase '<smartTagPr': case '<smartTagPr/>': break;\n\n\t\t\t/* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\t\t\tcase '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\n\t\t\t/* 18.2.22 smartTagType CT_SmartTagType ? */\n\t\t\tcase '<smartTagType': break;\n\n\t\t\t/* 18.2.24 webPublishing CT_WebPublishing ? */\n\t\t\tcase '<webPublishing': case '<webPublishing/>': break;\n\n\t\t\t/* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\t\t\tcase '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\n\n\t\t\t/* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\t\t\tcase '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\n\t\t\t/* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\t\t\tcase '<webPublishObject': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break; //TODO: check with versions of excel\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\t/* Others */\n\t\t\tcase '<ArchID': break;\n\t\t\tcase '<AlternateContent':\n\t\t\tcase '<AlternateContent>': pass=true; break;\n\t\t\tcase '</AlternateContent>': pass=false; break;\n\n\t\t\t/* TODO */\n\t\t\tcase '<revisionPtr': break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n\t\t}\n\t\treturn x;\n\t});\n\tif(XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\nfunction write_wb_xml(wb) {\n\tvar o = [XML_HEADER];\n\to[o.length] = writextag('workbook', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t//'xmlns:mx': XMLNS.mx,\n\t\t//'xmlns:s': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t});\n\n\tvar write_names = (wb.Workbook && (wb.Workbook.Names||[]).length > 0);\n\n\t/* fileVersion */\n\t/* fileSharing */\n\n\tvar workbookPr = ({codeName:\"ThisWorkbook\"});\n\tif(wb.Workbook && wb.Workbook.WBProps) {\n\t\tWBPropsDef.forEach(function(x) {\nif((wb.Workbook.WBProps[x[0]]) == null) return;\n\t\t\tif((wb.Workbook.WBProps[x[0]]) == x[1]) return;\n\t\t\tworkbookPr[x[0]] = (wb.Workbook.WBProps[x[0]]);\n\t\t});\nif(wb.Workbook.WBProps.CodeName) { workbookPr.codeName = wb.Workbook.WBProps.CodeName; delete workbookPr.CodeName; }\n\t}\n\to[o.length] = (writextag('workbookPr', null, workbookPr));\n\n\t/* workbookProtection */\n\n\tvar sheets = wb.Workbook && wb.Workbook.Sheets || [];\n\tvar i = 0;\n\n\t/* bookViews only written if first worksheet is hidden */\n\tif(sheets && sheets[0] && !!sheets[0].Hidden) {\n\t\to[o.length] = \"<bookViews>\";\n\t\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\t\tif(!sheets[i]) break;\n\t\t\tif(!sheets[i].Hidden) break;\n\t\t}\n\t\tif(i == wb.SheetNames.length) i = 0;\n\t\to[o.length] = '<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>';\n\t\to[o.length] = \"</bookViews>\";\n\t}\n\n\to[o.length] = \"<sheets>\";\n\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\tvar sht = ({name:escapexml(wb.SheetNames[i].slice(0,31))});\n\t\tsht.sheetId = \"\"+(i+1);\n\t\tsht[\"r:id\"] = \"rId\"+(i+1);\n\t\tif(sheets[i]) switch(sheets[i].Hidden) {\n\t\t\tcase 1: sht.state = \"hidden\"; break;\n\t\t\tcase 2: sht.state = \"veryHidden\"; break;\n\t\t}\n\t\to[o.length] = (writextag('sheet',null,sht));\n\t}\n\to[o.length] = \"</sheets>\";\n\n\t/* functionGroups */\n\t/* externalReferences */\n\n\tif(write_names) {\n\t\to[o.length] = \"<definedNames>\";\n\t\tif(wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function(n) {\n\t\t\tvar d = {name:n.Name};\n\t\t\tif(n.Comment) d.comment = n.Comment;\n\t\t\tif(n.Sheet != null) d.localSheetId = \"\"+n.Sheet;\n\t\t\tif(n.Hidden) d.hidden = \"1\";\n\t\t\tif(!n.Ref) return;\n\t\t\to[o.length] = writextag('definedName', escapexml(n.Ref), d);\n\t\t});\n\t\to[o.length] = \"</definedNames>\";\n\t}\n\n\t/* calcPr */\n\t/* oleSize */\n\t/* customWorkbookViews */\n\t/* pivotCaches */\n\t/* smartTagPr */\n\t/* smartTagTypes */\n\t/* webPublishing */\n\t/* fileRecoveryPr */\n\t/* webPublishObjects */\n\t/* extLst */\n\n\tif(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.304 BrtBundleSh */\nfunction parse_BrtBundleSh(data, length) {\n\tvar z = {};\n\tz.Hidden = data.read_shift(4); //hsState ST_SheetState\n\tz.iTabID = data.read_shift(4);\n\tz.strRelID = parse_RelID(data,length-8);\n\tz.name = parse_XLWideString(data);\n\treturn z;\n}\nfunction write_BrtBundleSh(data, o) {\n\tif(!o) o = new_buf(127);\n\to.write_shift(4, data.Hidden);\n\to.write_shift(4, data.iTabID);\n\twrite_RelID(data.strRelID, o);\n\twrite_XLWideString(data.name.slice(0,31), o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.815 BrtWbProp */\nfunction parse_BrtWbProp(data, length) {\n\tvar o = ({});\n\tvar flags = data.read_shift(4);\n\to.defaultThemeVersion = data.read_shift(4);\n\tvar strName = (length > 8) ? parse_XLWideString(data) : \"\";\n\tif(strName.length > 0) o.CodeName = strName;\n\to.autoCompressPictures = !!(flags & 0x10000);\n\to.backupFile = !!(flags & 0x40);\n\to.checkCompatibility = !!(flags & 0x1000);\n\to.date1904 = !!(flags & 0x01);\n\to.filterPrivacy = !!(flags & 0x08);\n\to.hidePivotFieldList = !!(flags & 0x400);\n\to.promptedSolutions = !!(flags & 0x10);\n\to.publishItems = !!(flags & 0x800);\n\to.refreshAllConnections = !!(flags & 0x40000);\n\to.saveExternalLinkValues = !!(flags & 0x80);\n\to.showBorderUnselectedTables = !!(flags & 0x04);\n\to.showInkAnnotation = !!(flags & 0x20);\n\to.showObjects = [\"all\", \"placeholders\", \"none\"][(flags >> 13) & 0x03];\n\to.showPivotChartFilter = !!(flags & 0x8000);\n\to.updateLinks = [\"userSet\", \"never\", \"always\"][(flags >> 8) & 0x03];\n\treturn o;\n}\nfunction write_BrtWbProp(data, o) {\n\tif(!o) o = new_buf(72);\n\tvar flags = 0;\n\tif(data) {\n\t\t/* TODO: mirror parse_BrtWbProp fields */\n\t\tif(data.date1904) flags |= 0x01;\n\t\tif(data.filterPrivacy) flags |= 0x08;\n\t}\n\to.write_shift(4, flags);\n\to.write_shift(4, 0);\n\twrite_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\n\treturn o.slice(0, o.l);\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n\tvar o = {};\n\tdata.read_shift(4);\n\to.ArchID = data.read_shift(4);\n\tdata.l += length - 8;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.687 BrtName */\nfunction parse_BrtName(data, length, opts) {\n\tvar end = data.l + length;\n\tvar flags = data.read_shift(4);\n\tdata.l += 1; //var chKey = data.read_shift(1);\n\tvar itab = data.read_shift(4);\n\tvar name = parse_XLNameWideString(data);\n\tvar formula = parse_XLSBNameParsedFormula(data, 0, opts);\n\tvar comment = parse_XLNullableWideString(data);\n\tif(flags & 0x20) name = \"_xlnm.\" + name;\n\t//if(0 /* fProc */) {\n\t\t// unusedstring1: XLNullableWideString\n\t\t// description: XLNullableWideString\n\t\t// helpTopic: XLNullableWideString\n\t\t// unusedstring2: XLNullableWideString\n\t//}\n\tdata.l = end;\n\tvar out = ({Name:name, Ptg:formula, Flags: flags});\n\tif(itab < 0xFFFFFFF) out.Sheet = itab;\n\tif(comment) out.Comment = comment;\n\treturn out;\n}\nfunction write_BrtName(name, wb) {\n\tvar o = new_buf(9);\n\tvar flags = 0;\n\tvar dname = name.Name;\n\tif(XLSLblBuiltIn.indexOf(dname) > -1) { flags |= 0x20; dname = dname.slice(6); }\n\to.write_shift(4, flags); // flags\n\to.write_shift(1, 0); // chKey\n\to.write_shift(4, name.Sheet == null ? 0xFFFFFFFF : name.Sheet);\n\n\tvar arr = [\n\t\to,\n\t\twrite_XLWideString(dname),\n\t\twrite_XLSBNameParsedFormula(name.Ref, wb)\n\t];\n\tif(name.Comment) arr.push(write_XLNullableWideString(name.Comment));\n\telse {\n\t\tvar x = new_buf(4);\n\t\tx.write_shift(4, 0xFFFFFFFF);\n\t\tarr.push(x);\n\t}\n\n\t// if macro (flags & 0x0F):\n\t// write_shift(4, 0xFFFFFFFF);\n\t// write_XLNullableWideString(description)\n\t// write_XLNullableWideString(helpTopic)\n\t// write_shift(4, 0xFFFFFFFF);\n\n\treturn bconcat(arr);\n}\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction parse_wb_bin(data, opts) {\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\n\tvar state = [];\n\tvar pass = false;\n\n\tif(!opts) opts = {};\n\topts.biff = 12;\n\n\tvar Names = [];\n\tvar supbooks = ([[]]);\n\tsupbooks.SheetNames = [];\n\tsupbooks.XTI = [];\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ };\n\n\trecordhopper(data, function hopper_wb(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009C: /* 'BrtBundleSh' */\n\t\t\t\tsupbooks.SheetNames.push(val.name);\n\t\t\t\twb.Sheets.push(val); break;\n\n\t\t\tcase 0x0099: /* 'BrtWbProp' */\n\t\t\t\twb.WBProps = val; break;\n\n\t\t\tcase 0x0027: /* 'BrtName' */\n\t\t\t\tif(val.Sheet != null) opts.SID = val.Sheet;\n\t\t\t\tval.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\n\t\t\t\tdelete opts.SID;\n\t\t\t\tdelete val.Ptg;\n\t\t\t\tNames.push(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x040C: /* 'BrtNameExt' */ break;\n\n\t\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\tcase 0x029B: /* 'BrtSupAddin' */\n\t\t\t\tif(!supbooks[0].length) supbooks[0] = [RT, val];\n\t\t\t\telse supbooks.push([RT, val]);\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = [];\n\t\t\t\tbreak;\n\t\t\tcase 0x016A: /* 'BrtExternSheet' */\n\t\t\t\tif(supbooks.length === 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n\t\t\t\tsupbooks.XTI = supbooks.XTI.concat(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x0169: /* 'BrtPlaceholderName' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0817: /* 'BrtAbsPath15' */\n\t\t\tcase 0x009E: /* 'BrtBookView' */\n\t\t\tcase 0x008F: /* 'BrtBeginBundleShs' */\n\t\t\tcase 0x0298: /* 'BrtBeginFnGroup' */\n\t\t\tcase 0x0161: /* 'BrtBeginExternals' */\n\t\t\t\tbreak;\n\n\t\t\t/* case 'BrtModelTimeGroupingCalcCol' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0C01: /* 'BrtRevisionPtr' */\n\t\t\tcase 0x0216: /* 'BrtBookProtection' */\n\t\t\tcase 0x02A5: /* 'BrtBookProtectionIso' */\n\t\t\tcase 0x009D: /* 'BrtCalcProp' */\n\t\t\tcase 0x0262: /* 'BrtCrashRecErr' */\n\t\t\tcase 0x0802: /* 'BrtDecoupledPivotCacheID' */\n\t\t\tcase 0x009B: /* 'BrtFileRecover' */\n\t\t\tcase 0x0224: /* 'BrtFileSharing' */\n\t\t\tcase 0x02A4: /* 'BrtFileSharingIso' */\n\t\t\tcase 0x0080: /* 'BrtFileVersion' */\n\t\t\tcase 0x0299: /* 'BrtFnGroup' */\n\t\t\tcase 0x0850: /* 'BrtModelRelationship' */\n\t\t\tcase 0x084D: /* 'BrtModelTable' */\n\t\t\tcase 0x0225: /* 'BrtOleSize' */\n\t\t\tcase 0x0805: /* 'BrtPivotTableRef' */\n\t\t\tcase 0x0254: /* 'BrtSmartTagType' */\n\t\t\tcase 0x081C: /* 'BrtTableSlicerCacheID' */\n\t\t\tcase 0x081B: /* 'BrtTableSlicerCacheIDs' */\n\t\t\tcase 0x0822: /* 'BrtTimelineCachePivotCacheID' */\n\t\t\tcase 0x018D: /* 'BrtUserBookView' */\n\t\t\tcase 0x009A: /* 'BrtWbFactoid' */\n\t\t\tcase 0x045D: /* 'BrtWbProp14' */\n\t\t\tcase 0x0229: /* 'BrtWebOpt' */\n\t\t\tcase 0x082B: /* 'BrtWorkBookPr15' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tcase 0x0010: /* 'BrtFRTArchID$' */ break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */ && state[state.length-1] != 0x0023 /* BrtFRTBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tparse_wb_defaults(wb);\n\n\t// $FlowIgnore\n\twb.Names = Names;\n\n\t(wb).supbooks = supbooks;\n\treturn wb;\n}\n\nfunction write_BUNDLESHS(ba, wb) {\n\twrite_record(ba, 0x008F /* BrtBeginBundleShs */);\n\tfor(var idx = 0; idx != wb.SheetNames.length; ++idx) {\n\t\tvar viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\n\t\tvar d = { Hidden: viz, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\n\t\twrite_record(ba, 0x009C /* BrtBundleSh */, write_BrtBundleSh(d));\n\t}\n\twrite_record(ba, 0x0090 /* BrtEndBundleShs */);\n}\n\n/* [MS-XLSB] 2.4.649 BrtFileVersion */\nfunction write_BrtFileVersion(data, o) {\n\tif(!o) o = new_buf(127);\n\tfor(var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\twrite_XLWideString(\"SheetJS\", o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(\"7262\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.301 BrtBookView */\nfunction write_BrtBookView(idx, o) {\n\tif(!o) o = new_buf(29);\n\to.write_shift(-4, 0);\n\to.write_shift(-4, 460);\n\to.write_shift(4,  28800);\n\to.write_shift(4,  17600);\n\to.write_shift(4,  500);\n\to.write_shift(4,  idx);\n\to.write_shift(4,  idx);\n\tvar flags = 0x78;\n\to.write_shift(1,  flags);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction write_BOOKVIEWS(ba, wb) {\n\t/* required if hidden tab appears before visible tab */\n\tif(!wb.Workbook || !wb.Workbook.Sheets) return;\n\tvar sheets = wb.Workbook.Sheets;\n\tvar i = 0, vistab = -1, hidden = -1;\n\tfor(; i < sheets.length; ++i) {\n\t\tif(!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;\n\t\telse if(sheets[i].Hidden == 1 && hidden == -1) hidden = i;\n\t}\n\tif(hidden > vistab) return;\n\twrite_record(ba, 0x0087 /* BrtBeginBookViews */);\n\twrite_record(ba, 0x009E /* BrtBookView */, write_BrtBookView(vistab));\n\t/* 1*(BrtBookView *FRT) */\n\twrite_record(ba, 0x0088 /* BrtEndBookViews */);\n}\n\nfunction write_BRTNAMES(ba, wb) {\n\tif(!wb.Workbook || !wb.Workbook.Names) return;\n\twb.Workbook.Names.forEach(function(name) { try {\n\t\tif(name.Flags & 0x0e) return; // TODO: macro name write\n\t\twrite_record(ba, 0x0027 /* BrtName */, write_BrtName(name, wb));\n\t} catch(e) {\n\t\tconsole.error(\"Could not serialize defined name \" + JSON.stringify(name));\n\t} });\n}\n\nfunction write_SELF_EXTERNS_xlsb(wb) {\n\tvar L = wb.SheetNames.length;\n\tvar o = new_buf(12 * L + 28);\n\to.write_shift(4, L + 2);\n\to.write_shift(4, 0); o.write_shift(4, -2); o.write_shift(4, -2); // workbook-level reference\n\to.write_shift(4, 0); o.write_shift(4, -1); o.write_shift(4, -1); // #REF!...\n\tfor(var i = 0; i < L; ++i) {\n\t\to.write_shift(4, 0); o.write_shift(4, i); o.write_shift(4, i);\n\t}\n\treturn o;\n}\nfunction write_EXTERNALS_xlsb(ba, wb) {\n\twrite_record(ba, 0x0161 /* BrtBeginExternals */);\n\twrite_record(ba, 0x0165 /* BrtSupSelf */);\n\twrite_record(ba, 0x016A /* BrtExternSheet */, write_SELF_EXTERNS_xlsb(wb, 0));\n\twrite_record(ba, 0x0162 /* BrtEndExternals */);\n}\n\n/* [MS-XLSB] 2.4.305 BrtCalcProp */\n/*function write_BrtCalcProp(data, o) {\n\tif(!o) o = new_buf(26);\n\to.write_shift(4,0); // force recalc\n\to.write_shift(4,1);\n\to.write_shift(4,0);\n\twrite_Xnum(0, o);\n\to.write_shift(-4, 1023);\n\to.write_shift(1, 0x33);\n\to.write_shift(1, 0x00);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.4.646 BrtFileRecover */\n/*function write_BrtFileRecover(data, o) {\n\tif(!o) o = new_buf(1);\n\to.write_shift(1,0);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction write_wb_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0083 /* BrtBeginBook */);\n\twrite_record(ba, 0x0080 /* BrtFileVersion */, write_BrtFileVersion());\n\t/* [[BrtFileSharingIso] BrtFileSharing] */\n\twrite_record(ba, 0x0099 /* BrtWbProp */, write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\n\t/* [ACABSPATH] */\n\t/* [[BrtBookProtectionIso] BrtBookProtection] */\n\twrite_BOOKVIEWS(ba, wb, opts);\n\twrite_BUNDLESHS(ba, wb, opts);\n\t/* [FNGROUP] */\n\twrite_EXTERNALS_xlsb(ba, wb);\n\tif((wb.Workbook||{}).Names) write_BRTNAMES(ba, wb);\n\t/* write_record(ba, 0x009D BrtCalcProp, write_BrtCalcProp()); */\n\t/* [BrtOleSize] */\n\t/* *(BrtUserBookView *FRT) */\n\t/* [PIVOTCACHEIDS] */\n\t/* [BrtWbFactoid] */\n\t/* [SMARTTAGTYPES] */\n\t/* [BrtWebOpt] */\n\t/* write_record(ba, 0x009B BrtFileRecover, write_BrtFileRecover()); */\n\t/* [WEBPUBITEMS] */\n\t/* [CRERRS] */\n\t/* FRTWORKBOOK */\n\twrite_record(ba, 0x0084 /* BrtEndBook */);\n\n\treturn ba.end();\n}\nfunction parse_wb(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_wb_bin((data), opts);\n\treturn parse_wb_xml((data), opts);\n}\n\nfunction parse_ws(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_ws_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_ws_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_cs(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_cs_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_cs_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ms(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_ms_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_ms_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ds(data, name, idx, opts, rels, wb, themes, styles) {\n\tif(name.slice(-4)===\".bin\") return parse_ds_bin((data), opts, idx, rels, wb, themes, styles);\n\treturn parse_ds_xml((data), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_sty(data, name, themes, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_sty_bin((data), themes, opts);\n\treturn parse_sty_xml((data), themes, opts);\n}\n\nfunction parse_sst(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_sst_bin((data), opts);\n\treturn parse_sst_xml((data), opts);\n}\n\nfunction parse_cmnt(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_comments_bin((data), opts);\n\treturn parse_comments_xml((data), opts);\n}\n\nfunction parse_cc(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_cc_bin((data), name, opts);\n\treturn parse_cc_xml((data), name, opts);\n}\n\nfunction parse_xlink(data, rel, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlink_bin((data), rel, name, opts);\n\treturn parse_xlink_xml((data), rel, name, opts);\n}\n\nfunction parse_xlmeta(data, name, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlmeta_bin((data), name, opts);\n\treturn parse_xlmeta_xml((data), name, opts);\n}\nvar attregexg2=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\nfunction xlml_parsexmltag(tag, skip_root) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = ([]); if(!skip_root) z[0] = words[0];\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\nif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\nfunction xlml_parsexmltagobj(tag) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = {};\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\nif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\n\n// ----\n\n/* map from xlml named formats to SSF TODO: localize */\nvar XLMLFormatMap;\n\nfunction xlml_format(format, value, date1904) {\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\n\tif(fmt === \"General\") return SSF_general(value);\n\treturn SSF_format(fmt, value, {date1904: !!date1904});\n}\n\nfunction xlml_set_custprop(Custprops, key, cp, val) {\n\tvar oval = val;\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\n\t\tcase \"boolean\": oval = parsexmlbool(val); break;\n\t\tcase \"i2\": case \"int\": oval = parseInt(val, 10); break;\n\t\tcase \"r4\": case \"float\": oval = parseFloat(val); break;\n\t\tcase \"date\": case \"dateTime.tz\": oval = parseDate(val); break;\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\n\t\tdefault: throw new Error(\"bad custprop:\" + cp[0]);\n\t}\n\tCustprops[unescapexml(key)] = oval;\n}\n\nfunction safe_format_xlml(cell, nf, o, date1904) {\n\tif(cell.t === 'z') return;\n\tif(!o || o.cellText !== false) try {\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\n\t\telse if(nf === \"General\") {\n\t\t\tif(cell.t === 'n') {\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = cell.v.toString(10);\n\t\t\t\telse cell.w = SSF_general_num(cell.v);\n\t\t\t}\n\t\t\telse cell.w = SSF_general(cell.v);\n\t\t}\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v, date1904);\n\t} catch(e) { if(o.WTF) throw e; }\n\ttry {\n\t\tvar z = XLMLFormatMap[nf]||nf||\"General\";\n\t\tif(o.cellNF) cell.z = z;\n\t\tif(o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n\t\t\tvar _d = SSF_parse_date_code(cell.v + (date1904 ? 1462 : 0)); if(_d) { cell.t = 'd'; cell.v = new Date(Date.UTC(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u)); }\n\t\t}\n\t} catch(e) { if(o.WTF) throw e; }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n\tif(opts.cellStyles) {\n\t\tif(stag.Interior) {\n\t\t\tvar I = stag.Interior;\n\t\t\tif(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n\t\t}\n\t}\n\tstyles[stag.ID] = stag;\n}\n\n/* TODO: there must exist some form of OSP-blessed spec */\nfunction parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, arrayf, o, date1904) {\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\n\tvar interiors = [];\n\tvar i = 0;\n\tif(sid === undefined && row) sid = row.StyleID;\n\tif(sid === undefined && csty) sid = csty.StyleID;\n\twhile(styles[sid] !== undefined) {\n\t\tif(styles[sid].nf) nf = styles[sid].nf;\n\t\tif(styles[sid].Interior) interiors.push(styles[sid].Interior);\n\t\tif(!styles[sid].Parent) break;\n\t\tsid = styles[sid].Parent;\n\t}\n\tswitch(data.Type) {\n\t\tcase 'Boolean':\n\t\t\tcell.t = 'b';\n\t\t\tcell.v = parsexmlbool(xml);\n\t\t\tbreak;\n\t\tcase 'String':\n\t\t\tcell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\n\t\t\tcell.v = (xml.indexOf(\"<\") > -1 ? unescapexml(ss||xml).replace(/<.*?>/g, \"\") : cell.r); // todo: BR etc\n\t\t\tbreak;\n\t\tcase 'DateTime':\n\t\t\tif(xml.slice(-1) != \"Z\") xml += \"Z\";\n\t\t\tcell.v = datenum(parseDate(xml, date1904), date1904);\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\t\t\t/* falls through */\n\t\tcase 'Number':\n\t\t\tif(cell.v === undefined) cell.v=+xml;\n\t\t\tif(!cell.t) cell.t = 'n';\n\t\t\tbreak;\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; if(o.cellText !== false) cell.w = xml; break;\n\t\tdefault:\n\t\t\tif(xml == \"\" && ss == \"\") { cell.t = 'z'; }\n\t\t\telse { cell.t = 's'; cell.v = xlml_fixstr(ss||xml); }\n\t\t\tbreak;\n\t}\n\tsafe_format_xlml(cell, nf, o, date1904);\n\tif(o.cellFormula !== false) {\n\t\tif(cell.Formula) {\n\t\t\tvar fstr = unescapexml(cell.Formula);\n\t\t\t/* strictly speaking, the leading = is required but some writers omit */\n\t\t\tif(fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.slice(1);\n\t\t\tcell.f = rc_to_a1(fstr, base);\n\t\t\tdelete cell.Formula;\n\t\t\tif(cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);\n\t\t\telse if(cell.ArrayRange) {\n\t\t\t\tcell.F = rc_to_a1(cell.ArrayRange, base);\n\t\t\t\tarrayf.push([safe_decode_range(cell.F), cell.F]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\tif(base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r)\n\t\t\t\t\tif(base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\tcell.F = arrayf[i][1];\n\t\t}\n\t}\n\tif(o.cellStyles) {\n\t\tinteriors.forEach(function(x) {\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\n\t\t});\n\t\tcell.s = S;\n\t}\n\tif(cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n}\n\nfunction xlml_prefix_dname(dname) {\n\treturn XLSLblBuiltIn.indexOf(\"_xlnm.\" + dname) > -1 ? \"_xlnm.\" + dname : dname;\n}\n\nfunction xlml_clean_comment(comment) {\n\tcomment.t = comment.v || \"\";\n\tcomment.t = comment.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\tcomment.v = comment.w = comment.ixfe = undefined;\n}\n\n/* TODO: Everything */\nfunction parse_xlml_xml(d, _opts) {\n\tvar opts = _opts || {};\n\tmake_ssf();\n\tvar str = debom(xlml_normalize(d));\n\tif(opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n\t\tif(typeof $cptable !== 'undefined') str = $cptable.utils.decode(65001, char_codes(str));\n\t\telse str = utf8read(str);\n\t}\n\tvar opening = str.slice(0, 1024).toLowerCase(), ishtml = false;\n\topening = opening.replace(/\".*?\"/g, \"\");\n\tif((opening.indexOf(\">\") & 1023) > Math.min((opening.indexOf(\",\") & 1023), (opening.indexOf(\";\")&1023))) { var _o = dup(opts); _o.type = \"string\"; return PRN.to_workbook(str, _o); }\n\tif(opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function(tag) { if(opening.indexOf(\"<\" + tag) >= 0) ishtml = true; });\n\tif(ishtml) return html_to_workbook(str, opts);\n\n\tXLMLFormatMap = ({\n\t\t\"General Number\": \"General\",\n\t\t\"General Date\": table_fmt[22],\n\t\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\n\t\t\"Medium Date\": table_fmt[15],\n\t\t\"Short Date\": table_fmt[14],\n\t\t\"Long Time\": table_fmt[19],\n\t\t\"Medium Time\": table_fmt[18],\n\t\t\"Short Time\": table_fmt[20],\n\t\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\t\"Fixed\": table_fmt[2],\n\t\t\"Standard\": table_fmt[4],\n\t\t\"Percent\": table_fmt[10],\n\t\t\"Scientific\": table_fmt[11],\n\t\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n\t\t\"True/False\": '\"True\";\"True\";\"False\";@',\n\t\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n\t});\n\n\n\tvar Rn;\n\tvar state = [], tmp;\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar sheets = {}, sheetnames = [], cursheet = ({}), sheetname = \"\"; if(opts.dense) cursheet[\"!data\"] = [];\n\tvar cell = ({}), row = {};// eslint-disable-line no-unused-vars\n\tvar dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'), didx = 0;\n\tvar c = 0, r = 0;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\tvar styles = {}, stag = {};\n\tvar ss = \"\", fidx = 0;\n\tvar merges = [];\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = [];\n\tvar comments = [], comment = ({});\n\tvar cstys = [], csty, seencol = false;\n\tvar arrayf = [];\n\tvar rowinfo = [], rowobj = {}, cc = 0, rr = 0;\n\tvar Workbook = ({ Sheets:[], WBProps:{date1904:false} }), wsprops = {};\n\txlmlregex.lastIndex = 0;\n\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\");\n\tvar raw_Rn3 = \"\";\n\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase())) {\n\t\tcase 'data' /*case 'Data'*/:\n\t\t\tif(raw_Rn3 == \"data\") {\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(state[state.length-1][1]) break;\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==/*\"Comment\"*/\"comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, arrayf, opts, Workbook.WBProps.date1904);\n\t\t\telse { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\n\t\t\tbreak;\n\t\tcase 'cell' /*case 'Cell'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif(comments.length > 0) cell.c = comments;\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== void 0) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!cursheet[\"!data\"][r]) cursheet[\"!data\"][r] = [];\n\t\t\t\t\t\tcursheet[\"!data\"][r][c] = cell;\n\t\t\t\t\t} else cursheet[encode_col(c) + encode_row(r)] = cell;\n\t\t\t\t}\n\t\t\t\tif(cell.HRef) {\n\t\t\t\t\tcell.l = ({Target:unescapexml(cell.HRef)});\n\t\t\t\t\tif(cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n\t\t\t\t\tdelete cell.HRef; delete cell.HRefScreenTip;\n\t\t\t\t}\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\tcc = c + (parseInt(cell.MergeAcross,10)|0);\n\t\t\t\t\trr = r + (parseInt(cell.MergeDown,10)|0);\n\t\t\t\t\tif(cc > c || rr > r) merges.push({s:{c:c,r:r},e:{c:cc,r:rr}});\n\t\t\t\t}\n\t\t\t\tif(!opts.sheetStubs) { if(cell.MergeAcross) c = cc + 1; else ++c; }\n\t\t\t\telse if(cell.MergeAcross || cell.MergeDown) {\nfor(var cma = c; cma <= cc; ++cma) {\n\t\t\t\t\t\tfor(var cmd = r; cmd <= rr; ++cmd) {\n\t\t\t\t\t\t\tif(cma > c || cmd > r) {\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!cursheet[\"!data\"][cmd]) cursheet[\"!data\"][cmd] = [];\n\t\t\t\t\t\t\t\t\tcursheet[\"!data\"][cmd][cma] = {t:'z'};\n\t\t\t\t\t\t\t\t} else cursheet[encode_col(cma) + encode_row(cmd)] = {t:'z'};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc = cc + 1;\n\t\t\t\t}\n\t\t\t\telse ++c;\n\t\t\t} else {\n\t\t\t\tcell = xlml_parsexmltagobj(Rn[0]);\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") ++c;\n\t\t\t\tcomments = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'row' /*case 'Row'*/:\n\t\t\tif(Rn[1]==='/' || Rn[0].slice(-2) === \"/>\") {\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") {\n\t\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\t}\n\t\t\t\tc = 0; ++r;\n\t\t\t} else {\n\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\trowobj = {};\n\t\t\t\tif(row.AutoFitHeight == \"0\" || row.Height) {\n\t\t\t\t\trowobj.hpx = parseInt(row.Height, 10); rowobj.hpt = px2pt(rowobj.hpx);\n\t\t\t\t\trowinfo[r] = rowobj;\n\t\t\t\t}\n\t\t\t\tif(row.Hidden == \"1\") { rowobj.hidden = true; rowinfo[r] = rowobj; }\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'worksheet' /*case 'Worksheet'*/: /* TODO: read range from FullRows/FullColumns */\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\tsheetnames.push(sheetname);\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n\t\t\t\t\t\tcursheet[\"!fullref\"] = cursheet[\"!ref\"];\n\t\t\t\t\t\trefguess.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(merges.length) cursheet[\"!merges\"] = merges;\n\t\t\t\tif(cstys.length > 0) cursheet[\"!cols\"] = cstys;\n\t\t\t\tif(rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n\t\t\t\tsheets[sheetname] = cursheet;\n\t\t\t} else {\n\t\t\t\trefguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\t\t\t\tr = c = 0;\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tsheetname = unescapexml(tmp.Name);\n\t\t\t\tcursheet = ({}); if(opts.dense) cursheet[\"!data\"] = [];\n\t\t\t\tmerges = [];\n\t\t\t\tarrayf = [];\n\t\t\t\trowinfo = [];\n\t\t\t\twsprops = {name:sheetname, Hidden:0};\n\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'table' /*case 'Table'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\n\t\t\telse {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\tcstys = []; seencol = false;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'style' /*case 'Style'*/:\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\n\t\t\telse stag = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\n\t\tcase 'numberformat' /*case 'NumberFormat'*/:\n\t\t\tstag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n\t\t\tif(XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n\t\t\tfor(var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == stag.nf) break;\n\t\t\tif(ssfidx == 0x188) for(ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == null) { SSF__load(stag.nf, ssfidx); break; }\n\t\t\tbreak;\n\n\t\tcase 'column' /*case 'Column'*/:\n\t\t\tif(state[state.length-1][0] !== /*'Table'*/'table') break;\n\t\t\tif(Rn[1]==='/') break;\n\t\t\tcsty = xlml_parsexmltag(Rn[0]);\n\t\t\tif(csty.Hidden) { csty.hidden = true; delete csty.Hidden; }\n\t\t\tif(csty.Width) csty.wpx = parseInt(csty.Width, 10);\n\t\t\tif(!seencol && csty.wpx > 10) {\n\t\t\t\tseencol = true; MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n\t\t\t\tfor(var _col = 0; _col < cstys.length; ++_col) if(cstys[_col]) process_col(cstys[_col]);\n\t\t\t}\n\t\t\tif(seencol) process_col(csty);\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\n\t\t\tbreak;\n\n\t\tcase 'namedrange' /*case 'NamedRange'*/:\n\t\t\tif(Rn[1]==='/') break;\n\t\t\tif(!Workbook.Names) Workbook.Names = [];\n\t\t\tvar _NamedRange = parsexmltag(Rn[0]);\n\t\t\tvar _DefinedName = ({\n\t\t\t\tName: xlml_prefix_dname(_NamedRange.Name),\n\t\t\t\tRef: rc_to_a1(_NamedRange.RefersTo.slice(1), {r:0, c:0})\n\t\t\t});\n\t\t\tif(Workbook.Sheets.length>0) _DefinedName.Sheet=Workbook.Sheets.length-1;\nWorkbook.Names.push(_DefinedName);\n\t\t\tbreak;\n\n\t\tcase 'namedcell' /*case 'NamedCell'*/: break;\n\t\tcase 'b' /*case 'B'*/: break;\n\t\tcase 'i' /*case 'I'*/: break;\n\t\tcase 'u' /*case 'U'*/: break;\n\t\tcase 's' /*case 'S'*/: break;\n\t\tcase 'em' /*case 'EM'*/: break;\n\t\tcase 'h2' /*case 'H2'*/: break;\n\t\tcase 'h3' /*case 'H3'*/: break;\n\t\tcase 'sub' /*case 'Sub'*/: break;\n\t\tcase 'sup' /*case 'Sup'*/: break;\n\t\tcase 'span' /*case 'Span'*/: break;\n\t\tcase 'alignment' /*case 'Alignment'*/:\n\t\t\tbreak;\n\t\tcase 'borders' /*case 'Borders'*/: break;\n\t\tcase 'border' /*case 'Border'*/: break;\n\t\tcase 'font' /*case 'Font'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\n\t\t\telse fidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'interior' /*case 'Interior'*/:\n\t\t\tif(!opts.cellStyles) break;\n\t\t\tstag.Interior = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\t\tcase 'protection' /*case 'Protection'*/: break;\n\n\t\tcase 'author' /*case 'Author'*/:\n\t\tcase 'title' /*case 'Title'*/:\n\t\tcase 'description' /*case 'Description'*/:\n\t\tcase 'created' /*case 'Created'*/:\n\t\tcase 'keywords' /*case 'Keywords'*/:\n\t\tcase 'subject' /*case 'Subject'*/:\n\t\tcase 'category' /*case 'Category'*/:\n\t\tcase 'company' /*case 'Company'*/:\n\t\tcase 'lastauthor' /*case 'LastAuthor'*/:\n\t\tcase 'lastsaved' /*case 'LastSaved'*/:\n\t\tcase 'lastprinted' /*case 'LastPrinted'*/:\n\t\tcase 'version' /*case 'Version'*/:\n\t\tcase 'revision' /*case 'Revision'*/:\n\t\tcase 'totaltime' /*case 'TotalTime'*/:\n\t\tcase 'hyperlinkbase' /*case 'HyperlinkBase'*/:\n\t\tcase 'manager' /*case 'Manager'*/:\n\t\tcase 'contentstatus' /*case 'ContentStatus'*/:\n\t\tcase 'identifier' /*case 'Identifier'*/:\n\t\tcase 'language' /*case 'Language'*/:\n\t\tcase 'appname' /*case 'AppName'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));\n\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'paragraphs' /*case 'Paragraphs'*/: break;\n\n\t\tcase 'styles' /*case 'Styles'*/:\n\t\tcase 'workbook' /*case 'Workbook'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse state.push([Rn[3], false]);\n\t\t\tbreak;\n\n\t\tcase 'comment' /*case 'Comment'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\txlml_clean_comment(comment);\n\t\t\t\tcomments.push(comment);\n\t\t\t} else {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(!parsexmlbool(tmp[\"ShowAlways\"]||\"0\")) comments.hidden = true;\n\t\t\t\tcomment = ({a:tmp.Author});\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'autofilter' /*case 'AutoFilter'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tvar AutoFilter = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcursheet['!autofilter'] = { ref:rc_to_a1(AutoFilter.Range).replace(/\\$/g,\"\") };\n\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'name' /*case 'Name'*/: break;\n\n\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t} else {\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'pixelsperinch' /*case 'PixelsPerInch'*/:\n\t\t\tbreak;\n\t\tcase 'componentoptions' /*case 'ComponentOptions'*/:\n\t\tcase 'documentproperties' /*case 'DocumentProperties'*/:\n\t\tcase 'customdocumentproperties' /*case 'CustomDocumentProperties'*/:\n\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/:\n\t\tcase 'pivottable' /*case 'PivotTable'*/:\n\t\tcase 'pivotcache' /*case 'PivotCache'*/:\n\t\tcase 'names' /*case 'Names'*/:\n\t\tcase 'mapinfo' /*case 'MapInfo'*/:\n\t\tcase 'pagebreaks' /*case 'PageBreaks'*/:\n\t\tcase 'querytable' /*case 'QueryTable'*/:\n\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\tcase 'schema' /*case 'Schema'*/: //case 'data' /*case 'data'*/:\n\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\tcase 'smarttagtype' /*case 'SmartTagType'*/:\n\t\tcase 'smarttags' /*case 'SmartTags'*/:\n\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/:\n\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/:\n\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\tbreak;\n\n\t\tcase 'null' /*case 'Null'*/: break;\n\n\t\tdefault:\n\t\t\t/* FODS file root is <office:document> */\n\t\t\tif(state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n\t\t\t/* UOS file root is <uof:UOF> */\n\t\t\tif(state.length == 0 && Rn[3] == \"uof\"/*\"UOF\"*/) return parse_fods(str, opts);\n\n\t\t\tvar seen = true;\n\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t/* OfficeDocumentSettings */\n\t\t\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'allowpng' /*case 'AllowPNG'*/: break;\n\t\t\t\t\tcase 'removepersonalinformation' /*case 'RemovePersonalInformation'*/: break;\n\t\t\t\t\tcase 'downloadcomponents' /*case 'DownloadComponents'*/: break;\n\t\t\t\t\tcase 'locationofcomponents' /*case 'LocationOfComponents'*/: break;\n\t\t\t\t\tcase 'colors' /*case 'Colors'*/: break;\n\t\t\t\t\tcase 'color' /*case 'Color'*/: break;\n\t\t\t\t\tcase 'index' /*case 'Index'*/: break;\n\t\t\t\t\tcase 'rgb' /*case 'RGB'*/: break;\n\t\t\t\t\tcase 'targetscreensize' /*case 'TargetScreenSize'*/: break;\n\t\t\t\t\tcase 'readonlyrecommended' /*case 'ReadOnlyRecommended'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ComponentOptions */\n\t\t\t\tcase 'componentoptions' /*case 'ComponentOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'toolbar' /*case 'Toolbar'*/: break;\n\t\t\t\t\tcase 'hideofficelogo' /*case 'HideOfficeLogo'*/: break;\n\t\t\t\t\tcase 'spreadsheetautofit' /*case 'SpreadsheetAutoFit'*/: break;\n\t\t\t\t\tcase 'label' /*case 'Label'*/: break;\n\t\t\t\t\tcase 'caption' /*case 'Caption'*/: break;\n\t\t\t\t\tcase 'maxheight' /*case 'MaxHeight'*/: break;\n\t\t\t\t\tcase 'maxwidth' /*case 'MaxWidth'*/: break;\n\t\t\t\t\tcase 'nextsheetnumber' /*case 'NextSheetNumber'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ExcelWorkbook */\n\t\t\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'date1904' /*case 'Date1904'*/:\nWorkbook.WBProps.date1904 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'hidehorizontalscrollbar' /*case 'HideHorizontalScrollBar'*/: break;\n\t\t\t\t\tcase 'hideverticalscrollbar' /*case 'HideVerticalScrollBar'*/: break;\n\t\t\t\t\tcase 'hideworkbooktabs' /*case 'HideWorkbookTabs'*/: break;\n\t\t\t\t\tcase 'windowheight' /*case 'WindowHeight'*/: break;\n\t\t\t\t\tcase 'windowwidth' /*case 'WindowWidth'*/: break;\n\t\t\t\t\tcase 'windowtopx' /*case 'WindowTopX'*/: break;\n\t\t\t\t\tcase 'windowtopy' /*case 'WindowTopY'*/: break;\n\t\t\t\t\tcase 'tabratio' /*case 'TabRatio'*/: break;\n\t\t\t\t\tcase 'protectstructure' /*case 'ProtectStructure'*/: break;\n\t\t\t\t\tcase 'protectwindow' /*case 'ProtectWindow'*/: break;\n\t\t\t\t\tcase 'protectwindows' /*case 'ProtectWindows'*/: break;\n\t\t\t\t\tcase 'activesheet' /*case 'ActiveSheet'*/: break;\n\t\t\t\t\tcase 'displayinknotes' /*case 'DisplayInkNotes'*/: break;\n\t\t\t\t\tcase 'firstvisiblesheet' /*case 'FirstVisibleSheet'*/: break;\n\t\t\t\t\tcase 'supbook' /*case 'SupBook'*/: break;\n\t\t\t\t\tcase 'sheetname' /*case 'SheetName'*/: break;\n\t\t\t\t\tcase 'sheetindex' /*case 'SheetIndex'*/: break;\n\t\t\t\t\tcase 'sheetindexfirst' /*case 'SheetIndexFirst'*/: break;\n\t\t\t\t\tcase 'sheetindexlast' /*case 'SheetIndexLast'*/: break;\n\t\t\t\t\tcase 'dll' /*case 'Dll'*/: break;\n\t\t\t\t\tcase 'acceptlabelsinformulas' /*case 'AcceptLabelsInFormulas'*/: break;\n\t\t\t\t\tcase 'donotsavelinkvalues' /*case 'DoNotSaveLinkValues'*/: break;\n\t\t\t\t\tcase 'iteration' /*case 'Iteration'*/: break;\n\t\t\t\t\tcase 'maxiterations' /*case 'MaxIterations'*/: break;\n\t\t\t\t\tcase 'maxchange' /*case 'MaxChange'*/: break;\n\t\t\t\t\tcase 'path' /*case 'Path'*/: break;\n\t\t\t\t\tcase 'xct' /*case 'Xct'*/: break;\n\t\t\t\t\tcase 'count' /*case 'Count'*/: break;\n\t\t\t\t\tcase 'selectedsheets' /*case 'SelectedSheets'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tcase 'uncalced' /*case 'Uncalced'*/: break;\n\t\t\t\t\tcase 'startupprompt' /*case 'StartupPrompt'*/: break;\n\t\t\t\t\tcase 'crn' /*case 'Crn'*/: break;\n\t\t\t\t\tcase 'externname' /*case 'ExternName'*/: break;\n\t\t\t\t\tcase 'formula' /*case 'Formula'*/: break;\n\t\t\t\t\tcase 'colfirst' /*case 'ColFirst'*/: break;\n\t\t\t\t\tcase 'collast' /*case 'ColLast'*/: break;\n\t\t\t\t\tcase 'wantadvise' /*case 'WantAdvise'*/: break;\n\t\t\t\t\tcase 'boolean' /*case 'Boolean'*/: break;\n\t\t\t\t\tcase 'error' /*case 'Error'*/: break;\n\t\t\t\t\tcase 'text' /*case 'Text'*/: break;\n\t\t\t\t\tcase 'ole' /*case 'OLE'*/: break;\n\t\t\t\t\tcase 'noautorecover' /*case 'NoAutoRecover'*/: break;\n\t\t\t\t\tcase 'publishobjects' /*case 'PublishObjects'*/: break;\n\t\t\t\t\tcase 'donotcalculatebeforesave' /*case 'DoNotCalculateBeforeSave'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'refmoder1c1' /*case 'RefModeR1C1'*/: break;\n\t\t\t\t\tcase 'embedsavesmarttags' /*case 'EmbedSaveSmartTags'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorkbookOptions */\n\t\t\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'owcversion' /*case 'OWCVersion'*/: break;\n\t\t\t\t\tcase 'height' /*case 'Height'*/: break;\n\t\t\t\t\tcase 'width' /*case 'Width'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorksheetOptions */\n\t\t\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'visible' /*case 'Visible'*/:\n\t\t\t\t\t\tif(Rn[0].slice(-2) === \"/>\"){/* empty */}\n\t\t\t\t\t\telse if(Rn[1]===\"/\") switch(str.slice(pidx, Rn.index)) {\n\t\t\t\t\t\t\tcase \"SheetHidden\": wsprops.Hidden = 1; break;\n\t\t\t\t\t\t\tcase \"SheetVeryHidden\": wsprops.Hidden = 2; break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'header' /*case 'Header'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'footer' /*case 'Footer'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'pagemargins' /*case 'PageMargins'*/:\n\t\t\t\t\t\tvar pagemargins = parsexmltag(Rn[0]);\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={},'xlml');\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'displayrighttoleft' /*case 'DisplayRightToLeft'*/:\n\t\t\t\t\t\tif(!Workbook.Views) Workbook.Views = [];\n\t\t\t\t\t\tif(!Workbook.Views[0]) Workbook.Views[0] = {};\n\t\t\t\t\t\tWorkbook.Views[0].RTL = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'freezepanes' /*case 'FreezePanes'*/: break;\n\t\t\t\t\tcase 'frozennosplit' /*case 'FrozenNoSplit'*/: break;\n\n\t\t\t\t\tcase 'splithorizontal' /*case 'SplitHorizontal'*/:\n\t\t\t\t\tcase 'splitvertical' /*case 'SplitVertical'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'donotdisplaygridlines' /*case 'DoNotDisplayGridlines'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'activerow' /*case 'ActiveRow'*/: break;\n\t\t\t\t\tcase 'activecol' /*case 'ActiveCol'*/: break;\n\t\t\t\t\tcase 'toprowbottompane' /*case 'TopRowBottomPane'*/: break;\n\t\t\t\t\tcase 'leftcolumnrightpane' /*case 'LeftColumnRightPane'*/: break;\n\n\t\t\t\t\tcase 'unsynced' /*case 'Unsynced'*/: break;\n\t\t\t\t\tcase 'print' /*case 'Print'*/: break;\n\t\t\t\t\tcase 'printerrors' /*case 'PrintErrors'*/: break;\n\t\t\t\t\tcase 'panes' /*case 'Panes'*/: break;\n\t\t\t\t\tcase 'scale' /*case 'Scale'*/: break;\n\t\t\t\t\tcase 'pane' /*case 'Pane'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'layout' /*case 'Layout'*/: break;\n\t\t\t\t\tcase 'pagesetup' /*case 'PageSetup'*/: break;\n\t\t\t\t\tcase 'selected' /*case 'Selected'*/: break;\n\t\t\t\t\tcase 'protectobjects' /*case 'ProtectObjects'*/: break;\n\t\t\t\t\tcase 'enableselection' /*case 'EnableSelection'*/: break;\n\t\t\t\t\tcase 'protectscenarios' /*case 'ProtectScenarios'*/: break;\n\t\t\t\t\tcase 'validprinterinfo' /*case 'ValidPrinterInfo'*/: break;\n\t\t\t\t\tcase 'horizontalresolution' /*case 'HorizontalResolution'*/: break;\n\t\t\t\t\tcase 'verticalresolution' /*case 'VerticalResolution'*/: break;\n\t\t\t\t\tcase 'numberofcopies' /*case 'NumberofCopies'*/: break;\n\t\t\t\t\tcase 'activepane' /*case 'ActivePane'*/: break;\n\t\t\t\t\tcase 'toprowvisible' /*case 'TopRowVisible'*/: break;\n\t\t\t\t\tcase 'leftcolumnvisible' /*case 'LeftColumnVisible'*/: break;\n\t\t\t\t\tcase 'fittopage' /*case 'FitToPage'*/: break;\n\t\t\t\t\tcase 'rangeselection' /*case 'RangeSelection'*/: break;\n\t\t\t\t\tcase 'papersizeindex' /*case 'PaperSizeIndex'*/: break;\n\t\t\t\t\tcase 'pagelayoutzoom' /*case 'PageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'pagebreakzoom' /*case 'PageBreakZoom'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'fitwidth' /*case 'FitWidth'*/: break;\n\t\t\t\t\tcase 'fitheight' /*case 'FitHeight'*/: break;\n\t\t\t\t\tcase 'commentslayout' /*case 'CommentsLayout'*/: break;\n\t\t\t\t\tcase 'zoom' /*case 'Zoom'*/: break;\n\t\t\t\t\tcase 'lefttoright' /*case 'LeftToRight'*/: break;\n\t\t\t\t\tcase 'gridlines' /*case 'Gridlines'*/: break;\n\t\t\t\t\tcase 'allowsort' /*case 'AllowSort'*/: break;\n\t\t\t\t\tcase 'allowfilter' /*case 'AllowFilter'*/: break;\n\t\t\t\t\tcase 'allowinsertrows' /*case 'AllowInsertRows'*/: break;\n\t\t\t\t\tcase 'allowdeleterows' /*case 'AllowDeleteRows'*/: break;\n\t\t\t\t\tcase 'allowinsertcols' /*case 'AllowInsertCols'*/: break;\n\t\t\t\t\tcase 'allowdeletecols' /*case 'AllowDeleteCols'*/: break;\n\t\t\t\t\tcase 'allowinserthyperlinks' /*case 'AllowInsertHyperlinks'*/: break;\n\t\t\t\t\tcase 'allowformatcells' /*case 'AllowFormatCells'*/: break;\n\t\t\t\t\tcase 'allowsizecols' /*case 'AllowSizeCols'*/: break;\n\t\t\t\t\tcase 'allowsizerows' /*case 'AllowSizeRows'*/: break;\n\t\t\t\t\tcase 'nosummaryrowsbelowdetail' /*case 'NoSummaryRowsBelowDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].above = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'tabcolorindex' /*case 'TabColorIndex'*/: break;\n\t\t\t\t\tcase 'donotdisplayheadings' /*case 'DoNotDisplayHeadings'*/: break;\n\t\t\t\t\tcase 'showpagelayoutzoom' /*case 'ShowPageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'nosummarycolumnsrightdetail' /*case 'NoSummaryColumnsRightDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].left = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'blackandwhite' /*case 'BlackAndWhite'*/: break;\n\t\t\t\t\tcase 'donotdisplayzeros' /*case 'DoNotDisplayZeros'*/: break;\n\t\t\t\t\tcase 'displaypagebreak' /*case 'DisplayPageBreak'*/: break;\n\t\t\t\t\tcase 'rowcolheadings' /*case 'RowColHeadings'*/: break;\n\t\t\t\t\tcase 'donotdisplayoutline' /*case 'DoNotDisplayOutline'*/: break;\n\t\t\t\t\tcase 'noorientation' /*case 'NoOrientation'*/: break;\n\t\t\t\t\tcase 'allowusepivottables' /*case 'AllowUsePivotTables'*/: break;\n\t\t\t\t\tcase 'zeroheight' /*case 'ZeroHeight'*/: break;\n\t\t\t\t\tcase 'viewablerange' /*case 'ViewableRange'*/: break;\n\t\t\t\t\tcase 'selection' /*case 'Selection'*/: break;\n\t\t\t\t\tcase 'protectcontents' /*case 'ProtectContents'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'pivottable' /*case 'PivotTable'*/: case 'pivotcache' /*case 'PivotCache'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'immediateitemsondrop' /*case 'ImmediateItemsOnDrop'*/: break;\n\t\t\t\t\tcase 'showpagemultipleitemlabel' /*case 'ShowPageMultipleItemLabel'*/: break;\n\t\t\t\t\tcase 'compactrowindent' /*case 'CompactRowIndent'*/: break;\n\t\t\t\t\tcase 'location' /*case 'Location'*/: break;\n\t\t\t\t\tcase 'pivotfield' /*case 'PivotField'*/: break;\n\t\t\t\t\tcase 'orientation' /*case 'Orientation'*/: break;\n\t\t\t\t\tcase 'layoutform' /*case 'LayoutForm'*/: break;\n\t\t\t\t\tcase 'layoutsubtotallocation' /*case 'LayoutSubtotalLocation'*/: break;\n\t\t\t\t\tcase 'layoutcompactrow' /*case 'LayoutCompactRow'*/: break;\n\t\t\t\t\tcase 'position' /*case 'Position'*/: break;\n\t\t\t\t\tcase 'pivotitem' /*case 'PivotItem'*/: break;\n\t\t\t\t\tcase 'datatype' /*case 'DataType'*/: break;\n\t\t\t\t\tcase 'datafield' /*case 'DataField'*/: break;\n\t\t\t\t\tcase 'sourcename' /*case 'SourceName'*/: break;\n\t\t\t\t\tcase 'parentfield' /*case 'ParentField'*/: break;\n\t\t\t\t\tcase 'ptlineitems' /*case 'PTLineItems'*/: break;\n\t\t\t\t\tcase 'ptlineitem' /*case 'PTLineItem'*/: break;\n\t\t\t\t\tcase 'countofsameitems' /*case 'CountOfSameItems'*/: break;\n\t\t\t\t\tcase 'item' /*case 'Item'*/: break;\n\t\t\t\t\tcase 'itemtype' /*case 'ItemType'*/: break;\n\t\t\t\t\tcase 'ptsource' /*case 'PTSource'*/: break;\n\t\t\t\t\tcase 'cacheindex' /*case 'CacheIndex'*/: break;\n\t\t\t\t\tcase 'consolidationreference' /*case 'ConsolidationReference'*/: break;\n\t\t\t\t\tcase 'filename' /*case 'FileName'*/: break;\n\t\t\t\t\tcase 'reference' /*case 'Reference'*/: break;\n\t\t\t\t\tcase 'nocolumngrand' /*case 'NoColumnGrand'*/: break;\n\t\t\t\t\tcase 'norowgrand' /*case 'NoRowGrand'*/: break;\n\t\t\t\t\tcase 'blanklineafteritems' /*case 'BlankLineAfterItems'*/: break;\n\t\t\t\t\tcase 'hidden' /*case 'Hidden'*/: break;\n\t\t\t\t\tcase 'subtotal' /*case 'Subtotal'*/: break;\n\t\t\t\t\tcase 'basefield' /*case 'BaseField'*/: break;\n\t\t\t\t\tcase 'mapchilditems' /*case 'MapChildItems'*/: break;\n\t\t\t\t\tcase 'function' /*case 'Function'*/: break;\n\t\t\t\t\tcase 'refreshonfileopen' /*case 'RefreshOnFileOpen'*/: break;\n\t\t\t\t\tcase 'printsettitles' /*case 'PrintSetTitles'*/: break;\n\t\t\t\t\tcase 'mergelabels' /*case 'MergeLabels'*/: break;\n\t\t\t\t\tcase 'defaultversion' /*case 'DefaultVersion'*/: break;\n\t\t\t\t\tcase 'refreshname' /*case 'RefreshName'*/: break;\n\t\t\t\t\tcase 'refreshdate' /*case 'RefreshDate'*/: break;\n\t\t\t\t\tcase 'refreshdatecopy' /*case 'RefreshDateCopy'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tcase 'versionlastupdate' /*case 'VersionLastUpdate'*/: break;\n\t\t\t\t\tcase 'versionupdateablemin' /*case 'VersionUpdateableMin'*/: break;\n\t\t\t\t\tcase 'versionrefreshablemin' /*case 'VersionRefreshableMin'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PageBreaks */\n\t\t\t\tcase 'pagebreaks' /*case 'PageBreaks'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'colbreaks' /*case 'ColBreaks'*/: break;\n\t\t\t\t\tcase 'colbreak' /*case 'ColBreak'*/: break;\n\t\t\t\t\tcase 'rowbreaks' /*case 'RowBreaks'*/: break;\n\t\t\t\t\tcase 'rowbreak' /*case 'RowBreak'*/: break;\n\t\t\t\t\tcase 'colstart' /*case 'ColStart'*/: break;\n\t\t\t\t\tcase 'colend' /*case 'ColEnd'*/: break;\n\t\t\t\t\tcase 'rowend' /*case 'RowEnd'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* AutoFilter */\n\t\t\t\tcase 'autofilter' /*case 'AutoFilter'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'autofiltercolumn' /*case 'AutoFilterColumn'*/: break;\n\t\t\t\t\tcase 'autofiltercondition' /*case 'AutoFilterCondition'*/: break;\n\t\t\t\t\tcase 'autofilterand' /*case 'AutoFilterAnd'*/: break;\n\t\t\t\t\tcase 'autofilteror' /*case 'AutoFilterOr'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* QueryTable */\n\t\t\t\tcase 'querytable' /*case 'QueryTable'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'id' /*case 'Id'*/: break;\n\t\t\t\t\tcase 'autoformatfont' /*case 'AutoFormatFont'*/: break;\n\t\t\t\t\tcase 'autoformatpattern' /*case 'AutoFormatPattern'*/: break;\n\t\t\t\t\tcase 'querysource' /*case 'QuerySource'*/: break;\n\t\t\t\t\tcase 'querytype' /*case 'QueryType'*/: break;\n\t\t\t\t\tcase 'enableredirections' /*case 'EnableRedirections'*/: break;\n\t\t\t\t\tcase 'refreshedinxl9' /*case 'RefreshedInXl9'*/: break;\n\t\t\t\t\tcase 'urlstring' /*case 'URLString'*/: break;\n\t\t\t\t\tcase 'htmltables' /*case 'HTMLTables'*/: break;\n\t\t\t\t\tcase 'connection' /*case 'Connection'*/: break;\n\t\t\t\t\tcase 'commandtext' /*case 'CommandText'*/: break;\n\t\t\t\t\tcase 'refreshinfo' /*case 'RefreshInfo'*/: break;\n\t\t\t\t\tcase 'notitles' /*case 'NoTitles'*/: break;\n\t\t\t\t\tcase 'nextid' /*case 'NextId'*/: break;\n\t\t\t\t\tcase 'columninfo' /*case 'ColumnInfo'*/: break;\n\t\t\t\t\tcase 'overwritecells' /*case 'OverwriteCells'*/: break;\n\t\t\t\t\tcase 'donotpromptforfile' /*case 'DoNotPromptForFile'*/: break;\n\t\t\t\t\tcase 'textwizardsettings' /*case 'TextWizardSettings'*/: break;\n\t\t\t\t\tcase 'source' /*case 'Source'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'decimal' /*case 'Decimal'*/: break;\n\t\t\t\t\tcase 'thousandseparator' /*case 'ThousandSeparator'*/: break;\n\t\t\t\t\tcase 'trailingminusnumbers' /*case 'TrailingMinusNumbers'*/: break;\n\t\t\t\t\tcase 'formatsettings' /*case 'FormatSettings'*/: break;\n\t\t\t\t\tcase 'fieldtype' /*case 'FieldType'*/: break;\n\t\t\t\t\tcase 'delimiters' /*case 'Delimiters'*/: break;\n\t\t\t\t\tcase 'tab' /*case 'Tab'*/: break;\n\t\t\t\t\tcase 'comma' /*case 'Comma'*/: break;\n\t\t\t\t\tcase 'autoformatname' /*case 'AutoFormatName'*/: break;\n\t\t\t\t\tcase 'versionlastedit' /*case 'VersionLastEdit'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\t\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* MapInfo (schema) */\n\t\t\t\tcase 'mapinfo' /*case 'MapInfo'*/: case 'schema' /*case 'Schema'*/: case 'data' /*case 'data'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'map' /*case 'Map'*/: break;\n\t\t\t\t\tcase 'entry' /*case 'Entry'*/: break;\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'xpath' /*case 'XPath'*/: break;\n\t\t\t\t\tcase 'field' /*case 'Field'*/: break;\n\t\t\t\t\tcase 'xsdtype' /*case 'XSDType'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'aggregate' /*case 'Aggregate'*/: break;\n\t\t\t\t\tcase 'elementtype' /*case 'ElementType'*/: break;\n\t\t\t\t\tcase 'attributetype' /*case 'AttributeType'*/: break;\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\n\t\t\t\t\tcase 'schema' /*case 'schema'*/:\n\t\t\t\t\tcase 'element' /*case 'element'*/:\n\t\t\t\t\tcase 'complextype' /*case 'complexType'*/:\n\t\t\t\t\tcase 'datatype' /*case 'datatype'*/:\n\t\t\t\t\tcase 'all' /*case 'all'*/:\n\t\t\t\t\tcase 'attribute' /*case 'attribute'*/:\n\t\t\t\t\tcase 'extends' /*case 'extends'*/: break;\n\n\t\t\t\t\tcase 'row' /*case 'row'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* SmartTags (can be anything) */\n\t\t\t\tcase 'smarttags' /*case 'SmartTags'*/: break;\n\n\t\t\t\tdefault: seen = false; break;\n\t\t\t}\n\t\t\tif(seen) break;\n\t\t\t/* CustomDocumentProperties */\n\t\t\tif(Rn[3].match(/!\\[CDATA/)) break;\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t\t\tif(state[state.length-1][0]===/*'CustomDocumentProperties'*/'customdocumentproperties') {\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t}\n\tvar out = ({});\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n\tout.SheetNames = sheetnames;\n\tout.Workbook = Workbook;\n\tout.SSF = dup(table_fmt);\n\tout.Props = Props;\n\tout.Custprops = Custprops;\n\tout.bookType = \"xlml\";\n\treturn out;\n}\n\nfunction parse_xlml(data, opts) {\n\tfix_read_opts(opts=opts||{});\n\tswitch(opts.type||\"base64\") {\n\t\tcase \"base64\": return parse_xlml_xml(Base64_decode(data), opts);\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\n\t\tcase \"array\": return parse_xlml_xml(a2s(data), opts);\n\t}\n}\n\n/* TODO */\nfunction write_props_xlml(wb, opts) {\n\tvar o = [];\n\t/* DocumentProperties */\n\tif(wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\n\t/* CustomDocumentProperties */\n\tif(wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\n\treturn o.join(\"\");\n}\n/* TODO */\nfunction write_wb_xlml(wb) {\n\t/* OfficeDocumentSettings */\n\t/* ExcelWorkbook */\n\tif((((wb||{}).Workbook||{}).WBProps||{}).date1904) return '<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\"><Date1904/></ExcelWorkbook>';\n\treturn \"\";\n}\n/* TODO */\nfunction write_sty_xlml(wb, opts) {\n\t/* Styles */\n\tvar styles = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\n\topts.cellXfs.forEach(function(xf, id) {\n\t\tvar payload = [];\n\t\tpayload.push(writextag('NumberFormat', null, {\"ss:Format\": escapexml(table_fmt[xf.numFmtId])}));\n\n\t\tvar o = {\"ss:ID\": \"s\" + (21+id)};\n\t\tstyles.push(writextag('Style', payload.join(\"\"), o));\n\t});\n\treturn writextag(\"Styles\", styles.join(\"\"));\n}\nfunction write_name_xlml(n) { return writextag(\"NamedRange\", null, {\"ss:Name\": n.Name.slice(0,6) == \"_xlnm.\" ? n.Name.slice(6) : n.Name, \"ss:RefersTo\":\"=\" + a1_to_rc(n.Ref, {r:0,c:0})}); }\nfunction write_names_xlml(wb) {\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\nvar names = wb.Workbook.Names;\n\tvar out = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != null) continue;\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn writextag(\"Names\", out.join(\"\"));\n}\nfunction write_ws_xlml_names(ws, opts, idx, wb) {\n\tif(!ws) return \"\";\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\nvar names = wb.Workbook.Names;\n\tvar out = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != idx) continue;\n\t\t/*switch(n.Name) {\n\t\t\tcase \"_\": continue;\n\t\t}*/\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn out.join(\"\");\n}\n/* WorksheetOptions */\nfunction write_ws_xlml_wsopts(ws, opts, idx, wb) {\n\tif(!ws) return \"\";\n\tvar o = [];\n\t/* NOTE: spec technically allows any order, but stick with implied order */\n\n\t/* FitToPage */\n\t/* DoNotDisplayColHeaders */\n\t/* DoNotDisplayRowHeaders */\n\t/* ViewableRange */\n\t/* Selection */\n\t/* GridlineColor */\n\t/* Name */\n\t/* ExcelWorksheetType */\n\t/* IntlMacro */\n\t/* Unsynced */\n\t/* Selected */\n\t/* CodeName */\n\n\tif(ws['!margins']) {\n\t\to.push(\"<PageSetup>\");\n\t\tif(ws['!margins'].header) o.push(writextag(\"Header\", null, {'x:Margin':ws['!margins'].header}));\n\t\tif(ws['!margins'].footer) o.push(writextag(\"Footer\", null, {'x:Margin':ws['!margins'].footer}));\n\t\to.push(writextag(\"PageMargins\", null, {\n\t\t\t'x:Bottom': ws['!margins'].bottom || \"0.75\",\n\t\t\t'x:Left': ws['!margins'].left || \"0.7\",\n\t\t\t'x:Right': ws['!margins'].right || \"0.7\",\n\t\t\t'x:Top': ws['!margins'].top || \"0.75\"\n\t\t}));\n\t\to.push(\"</PageSetup>\");\n\t}\n\n\t/* PageSetup */\n\t/* DisplayPageBreak */\n\t/* TransitionExpressionEvaluation */\n\t/* TransitionFormulaEntry */\n\t/* Print */\n\t/* Zoom */\n\t/* PageLayoutZoom */\n\t/* PageBreakZoom */\n\t/* ShowPageBreakZoom */\n\t/* DefaultRowHeight */\n\t/* DefaultColumnWidth */\n\t/* StandardWidth */\n\n\tif(wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\n\t\t/* Visible */\n\t\tif(wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", (wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\"), {}));\n\t\telse {\n\t\t\t/* Selected */\n\t\t\tfor(var i = 0; i < idx; ++i) if(wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\n\t\t\tif(i == idx) o.push(\"<Selected/>\");\n\t\t}\n\t}\n\n\t/* LeftColumnVisible */\n\n\tif(((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL) o.push(\"<DisplayRightToLeft/>\");\n\n\t/* GridlineColorIndex */\n\t/* DisplayFormulas */\n\t/* DoNotDisplayGridlines */\n\t/* DoNotDisplayHeadings */\n\t/* DoNotDisplayOutline */\n\t/* ApplyAutomaticOutlineStyles */\n\t/* NoSummaryRowsBelowDetail */\n\t/* NoSummaryColumnsRightDetail */\n\t/* DoNotDisplayZeros */\n\t/* ActiveRow */\n\t/* ActiveColumn */\n\t/* FilterOn */\n\t/* RangeSelection */\n\t/* TopRowVisible */\n\t/* TopRowBottomPane */\n\t/* LeftColumnRightPane */\n\t/* ActivePane */\n\t/* SplitHorizontal */\n\t/* SplitVertical */\n\t/* FreezePanes */\n\t/* FrozenNoSplit */\n\t/* TabColorIndex */\n\t/* Panes */\n\n\t/* NOTE: Password not supported in XLML Format */\n\tif(ws['!protect']) {\n\t\to.push(writetag(\"ProtectContents\", \"True\"));\n\t\tif(ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\n\t\tif(ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\n\t\tif(ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));\n\t\telse if(ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\n\t[\n\t\t[ \"formatCells\", \"AllowFormatCells\" ],\n\t\t[ \"formatColumns\", \"AllowSizeCols\" ],\n\t\t[ \"formatRows\", \"AllowSizeRows\" ],\n\t\t[ \"insertColumns\", \"AllowInsertCols\" ],\n\t\t[ \"insertRows\", \"AllowInsertRows\" ],\n\t\t[ \"insertHyperlinks\", \"AllowInsertHyperlinks\" ],\n\t\t[ \"deleteColumns\", \"AllowDeleteCols\" ],\n\t\t[ \"deleteRows\", \"AllowDeleteRows\" ],\n\t\t[ \"sort\", \"AllowSort\" ],\n\t\t[ \"autoFilter\", \"AllowFilter\" ],\n\t\t[ \"pivotTables\", \"AllowUsePivotTables\" ]\n\t].forEach(function(x) { if(ws['!protect'][x[0]]) o.push(\"<\"+x[1]+\"/>\"); });\n\t}\n\n\tif(o.length == 0) return \"\";\n\treturn writextag(\"WorksheetOptions\", o.join(\"\"), {xmlns:XLMLNS.x});\n}\nfunction write_ws_xlml_comment(comments) {\n\t/* TODO: test multiple comments */\n\treturn comments.map(function(c) {\n\t\t// TODO: formatted text\n\t\tvar t = xlml_unfixstr(c.t||\"\");\n\t\tvar d =writextag(\"ss:Data\", t, {\"xmlns\":\"http://www.w3.org/TR/REC-html40\"});\n\t\tvar p = {};\n\t\tif(c.a) p[\"ss:Author\"] = c.a;\n\t\tif(!comments.hidden) p[\"ss:ShowAlways\"] = \"1\";\n\t\treturn writextag(\"Comment\", d, p);\n\t}).join(\"\");\n}\nfunction write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr){\n\tif(!cell || (cell.v == undefined && cell.f == undefined)) return \"\";\n\n\tvar attr = {};\n\tif(cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\n\tif(cell.F && cell.F.slice(0, ref.length) == ref) {\n\t\tvar end = decode_cell(cell.F.slice(ref.length + 1));\n\t\tattr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\n\t}\n\n\tif(cell.l && cell.l.Target) {\n\t\tattr[\"ss:HRef\"] = escapexml(cell.l.Target);\n\t\tif(cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\n\t}\n\n\tif(ws['!merges']) {\n\t\tvar marr = ws['!merges'];\n\t\tfor(var mi = 0; mi != marr.length; ++mi) {\n\t\t\tif(marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\n\t\t\tif(marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\n\t\t\tif(marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\n\t\t}\n\t}\n\n\tvar t = \"\", p = \"\";\n\tswitch(cell.t) {\n\t\tcase 'z': if(!opts.sheetStubs) return \"\"; break;\n\t\tcase 'n': t = 'Number'; p = String(cell.v); break;\n\t\tcase 'b': t = 'Boolean'; p = (cell.v ? \"1\" : \"0\"); break;\n\t\tcase 'e': t = 'Error'; p = BErr[cell.v]; break;\n\t\tcase 'd': t = 'DateTime'; p = new Date(cell.v).toISOString(); if(cell.z == null) cell.z = cell.z || table_fmt[14]; break;\n\t\tcase 's': t = 'String'; p = escapexlml(cell.v||\"\"); break;\n\t}\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tattr[\"ss:StyleID\"] = \"s\" + (21+os);\n\tattr[\"ss:Index\"] = addr.c + 1;\n\tvar _v = (cell.v != null ? p : \"\");\n\tvar m = cell.t == 'z' ? \"\" : ('<Data ss:Type=\"' + t + '\">' + _v + '</Data>');\n\n\tif((cell.c||[]).length > 0) m += write_ws_xlml_comment(cell.c);\n\n\treturn writextag(\"Cell\", m, attr);\n}\nfunction write_ws_xlml_row(R, row) {\n\tvar o = '<Row ss:Index=\"' + (R+1) + '\"';\n\tif(row) {\n\t\tif(row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\n\t\tif(row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\n\t\tif(row.hidden) o += ' ss:Hidden=\"1\"';\n\t}\n\treturn o + '>';\n}\n/* TODO */\nfunction write_ws_xlml_table(ws, opts, idx, wb) {\n\tif(!ws['!ref']) return \"\";\n\tvar range = safe_decode_range(ws['!ref']);\n\tvar marr = ws['!merges'] || [], mi = 0;\n\tvar o = [];\n\tif(ws['!cols']) ws['!cols'].forEach(function(n, i) {\n\t\tprocess_col(n);\n\t\tvar w = !!n.width;\n\t\tvar p = col_obj_w(i, n);\n\t\tvar k = {\"ss:Index\":i+1};\n\t\tif(w) k['ss:Width'] = width2px(p.width);\n\t\tif(n.hidden) k['ss:Hidden']=\"1\";\n\t\to.push(writextag(\"Column\",null,k));\n\t});\n\tvar dense = ws[\"!data\"] != null;\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tvar row = [write_ws_xlml_row(R, (ws['!rows']||[])[R])];\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tvar skip = false;\n\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(skip) continue;\n\t\t\tvar addr = {r:R,c:C};\n\t\t\tvar ref = encode_col(C) + encode_row(R), cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[ref];\n\t\t\trow.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\n\t\t}\n\t\trow.push(\"</Row>\");\n\t\tif(row.length > 2) o.push(row.join(\"\"));\n\t}\n\treturn o.join(\"\");\n}\nfunction write_ws_xlml(idx, opts, wb) {\n\tvar o = [];\n\tvar s = wb.SheetNames[idx];\n\tvar ws = wb.Sheets[s];\n\n\tvar t = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\n\n\t/* Table */\n\tt = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\n\n\t/* WorksheetOptions */\n\to.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\n\n\tif(ws[\"!autofilter\"]) o.push('<AutoFilter x:Range=\"' + a1_to_rc(fix_range(ws[\"!autofilter\"].ref), {r:0,c:0}) + '\" xmlns=\"urn:schemas-microsoft-com:office:excel\"></AutoFilter>');\n\n\treturn o.join(\"\");\n}\nfunction write_xlml(wb, opts) {\n\tif(!opts) opts = {};\n\tif(!wb.SSF) wb.SSF = dup(table_fmt);\n\tif(wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t\topts.cellXfs = [];\n\t\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\t}\n\tvar d = [];\n\td.push(write_props_xlml(wb, opts));\n\td.push(write_wb_xlml(wb, opts));\n\td.push(\"\");\n\td.push(\"\");\n\tfor(var i = 0; i < wb.SheetNames.length; ++i)\n\t\td.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\"ss:Name\":escapexml(wb.SheetNames[i])}));\n\td[2] = write_sty_xlml(wb, opts);\n\td[3] = write_names_xlml(wb, opts);\n\treturn XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\n\t\t'xmlns':      XLMLNS.ss,\n\t\t'xmlns:o':    XLMLNS.o,\n\t\t'xmlns:x':    XLMLNS.x,\n\t\t'xmlns:ss':   XLMLNS.ss,\n\t\t'xmlns:dt':   XLMLNS.dt,\n\t\t'xmlns:html': XLMLNS.html\n\t});\n}\n/* [MS-OLEDS] 2.3.8 CompObjStream */\nfunction parse_compobj(obj) {\n\tvar v = {};\n\tvar o = obj.content;\n/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\to.l = 28;\n\n\tv.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n\tv.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n\n\tif(o.length - o.l <= 4) return v;\n\n\tvar m = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n\n\tif(o.length - o.l <= 4) return v;\n\tm = o.read_shift(4);\n\tif(m !== 0x71b239f4) return v;\n\tv.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n\n\tm = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved2 = o.read_shift(0, \"lpwstr\");\n}\n\n/*\n\tContinue logic for:\n\t- 2.4.58 Continue          0x003c\n\t- 2.4.59 ContinueBigName   0x043c\n\t- 2.4.60 ContinueFrt       0x0812\n\t- 2.4.61 ContinueFrt11     0x0875\n\t- 2.4.62 ContinueFrt12     0x087f\n*/\nvar CONTINUE_RT = [ 0x003c, 0x043c, 0x0812, 0x0875, 0x087f ];\nfunction slurp(RecordType, R, blob, length, opts) {\n\tvar l = length;\n\tvar bufs = [];\n\tvar d = blob.slice(blob.l,blob.l+l);\n\tif(opts && opts.enc && opts.enc.insitu && d.length > 0) switch(RecordType) {\n\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809/* BOF */: case 0x002F /* FilePass */: case 0x0195 /* FileLock */: case 0x00E1 /* InterfaceHdr */: case 0x0196 /* RRDInfo */: case 0x0138 /* RRDHead */: case 0x0194 /* UsrExcl */: case 0x000a /* EOF */:\n\t\tbreak;\n\tcase 0x0085 /* BoundSheet8 */:\n\t\tbreak;\n\tdefault:\n\t\topts.enc.insitu(d);\n\t}\n\tbufs.push(d);\n\tblob.l += l;\n\tvar nextrt = __readUInt16LE(blob,blob.l), next = XLSRecordEnum[nextrt];\n\tvar start = 0;\n\twhile(next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n\t\tl = __readUInt16LE(blob,blob.l+2);\n\t\tstart = blob.l + 4;\n\t\tif(nextrt == 0x0812 /* ContinueFrt */) start += 4;\n\t\telse if(nextrt == 0x0875 || nextrt == 0x087f) {\n\t\t\tstart += 12;\n\t\t}\n\t\td = blob.slice(start,blob.l+4+l);\n\t\tbufs.push(d);\n\t\tblob.l += 4+l;\n\t\tnext = (XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)]);\n\t}\n\tvar b = (bconcat(bufs));\n\tprep_blob(b, 0);\n\tvar ll = 0; b.lens = [];\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\n\tif(b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n\treturn R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p, opts, date1904) {\n\tif(p.t === 'z') return;\n\tif(!p.XF) return;\n\tvar fmtid = 0;\n\ttry {\n\t\tfmtid = p.z || p.XF.numFmtId || 0;\n\t\tif(opts.cellNF && p.z == null) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts || opts.cellText !== false) try {\n\t\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\n\t\telse if(fmtid === 0 || fmtid == \"General\") {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse p.w = SSF_general(p.v);\n\t\t}\n\t\telse p.w = SSF_format(fmtid,p.v, {date1904:!!date1904, dateNF: opts && opts.dateNF});\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n\t\tvar _d = SSF_parse_date_code(p.v + (date1904 ? 1462 : 0)); if(_d) { p.t = 'd'; p.v = new Date(Date.UTC(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u)); }\n\t}\n}\n\nfunction make_cell(val, ixfe, t) {\n\treturn ({v:val, ixfe:ixfe, t:t});\n}\n\n// 2.3.2\nfunction parse_workbook(blob, options) {\n\tvar wb = ({opts:{}});\n\tvar Sheets = {};\n\tif(DENSE != null && options.dense == null) options.dense = DENSE;\n\tvar out = ({}); if(options.dense) out[\"!data\"] = [];\n\tvar Directory = {};\n\tvar range = ({});\n\tvar last_formula = null;\n\tvar sst = ([]);\n\tvar cur_sheet = \"\";\n\tvar Preamble = {};\n\tvar lastcell, last_cell = \"\", cc, cmnt, rngC, rngR;\n\tvar sharedf = {};\n\tvar arrayf = [];\n\tvar temp_val;\n\tvar country;\n\tvar XFs = []; /* XF records */\n\tvar palette = [];\n\tvar Workbook = ({ Sheets:[], WBProps:{date1904:false}, Views:[{}] }), wsprops = {};\n\tvar biff4w = false;\n\tvar get_rgb = function getrgb(icv) {\n\t\tif(icv < 8) return XLSIcv[icv];\n\t\tif(icv < 64) return palette[icv-8] || XLSIcv[icv];\n\t\treturn XLSIcv[icv];\n\t};\n\tvar process_cell_style = function pcs(cell, line, options) {\n\t\tvar xfd = line.XF.data;\n\t\tif(!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n\t\tline.s = ({});\n\t\tline.s.patternType = xfd.patternType;\n\t\tvar t;\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\n\t};\n\tvar addcell = function addcell(cell, line, options) {\n\t\tif(!biff4w && file_depth > 1) return;\n\t\tif(options.sheetRows && cell.r >= options.sheetRows) return;\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\n\t\tdelete line.ixfe; delete line.XF;\n\t\tlastcell = cell;\n\t\tlast_cell = encode_cell(cell);\n\t\tif(!range || !range.s || !range.e) range = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\tif(cell.r < range.s.r) range.s.r = cell.r;\n\t\tif(cell.c < range.s.c) range.s.c = cell.c;\n\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\t\tif(options.cellFormula && line.f) {\n\t\t\tfor(var afi = 0; afi < arrayf.length; ++afi) {\n\t\t\t\tif(arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n\t\t\t\tif(arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n\t\t\t\tline.F = encode_range(arrayf[afi][0]);\n\t\t\t\tif(arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n\t\t\t\tif(line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t{\n\t\t\tif(options.dense) {\n\t\t\t\tif(!out[\"!data\"][cell.r]) out[\"!data\"][cell.r] = [];\n\t\t\t\tout[\"!data\"][cell.r][cell.c] = line;\n\t\t\t} else out[last_cell] = line;\n\t\t}\n\t};\n\tvar opts = ({\n\t\tenc: false, // encrypted\n\t\tsbcch: 0, // cch in the preceding SupBook\n\t\tsnames: [], // sheetnames\n\t\tsharedf: sharedf, // shared formulae by address\n\t\tarrayf: arrayf, // array formulae array\n\t\trrtabid: [], // RRTabId\n\t\tlastuser: \"\", // Last User from WriteAccess\n\t\tbiff: 8, // BIFF version\n\t\tcodepage: 0, // CP from CodePage record\n\t\twinlocked: 0, // fLockWn from WinProtect\n\t\tcellStyles: !!options && !!options.cellStyles,\n\t\tWTF: !!options && !!options.wtf\n\t});\n\tif(options.password) opts.password = options.password;\n\tvar themes;\n\tvar merges = [];\n\tvar objects = [];\n\tvar colinfo = [], rowinfo = [];\n\tvar seencol = false;\n\tvar supbooks = ([]); // 1-indexed, will hold extern names\n\tsupbooks.SheetNames = opts.snames;\n\tsupbooks.sharedf = opts.sharedf;\n\tsupbooks.arrayf = opts.arrayf;\n\tsupbooks.names = [];\n\tsupbooks.XTI = [];\n\tvar last_RT = 0;\n\tvar file_depth = 0; /* TODO: make a real stack */\n\tvar BIFF2Fmt = 0, BIFF2FmtTable = [];\n\tvar FilterDatabases = []; /* TODO: sort out supbooks and process elsewhere */\n\tvar last_lbl;\n\n\t/* explicit override for some broken writers */\n\topts.codepage = 1200;\n\tset_cp(1200);\n\tvar seen_codepage = false;\n\twhile(blob.l < blob.length - 1) {\n\t\tvar s = blob.l;\n\t\tvar RecordType = blob.read_shift(2);\n\t\tif(RecordType === 0 && last_RT === 0x000a /* EOF */) break;\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2));\n\t\tvar R = XLSRecordEnum[RecordType];\n\t\tif(file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(RecordType) == -1 /* BOF */) break;\n\t\t//console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n\t\t//if(!R) console.log(blob.slice(blob.l, blob.l + length));\n\t\tif(R && R.f) {\n\t\t\tif(options.bookSheets) {\n\t\t\t\tif(last_RT === 0x0085 /* BoundSheet8 */ && RecordType !== 0x0085 /* R.n !== 'BoundSheet8' */) break;\n\t\t\t}\n\t\t\tlast_RT = RecordType;\n\t\t\tif(R.r === 2 || R.r == 12) {\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\n\t\t\t\tif(!opts.enc && rt !== RecordType && (((rt&0xFF)<<8)|(rt>>8)) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n\t\t\t\tif(R.r == 12){\n\t\t\t\t\tblob.l += 10; length -= 10;\n\t\t\t\t} // skip FRT\n\t\t\t}\n\t\t\t//console.error(R,blob.l,length,blob.length);\n\t\t\tvar val = ({});\n\t\t\tif(RecordType === 0x000a /* EOF */) val = R.f(blob, length, opts);\n\t\t\telse val = slurp(RecordType, R, blob, length, opts);\nif(file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1 /* BOF */) continue;\n\t\t\tswitch(RecordType) {\n\t\t\t\tcase 0x0022 /* Date1904 */:\nwb.opts.Date1904 = Workbook.WBProps.date1904 = val; break;\n\t\t\t\tcase 0x0086 /* WriteProtect */: wb.opts.WriteProtect = true; break;\n\t\t\t\tcase 0x002f /* FilePass */:\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\n\t\t\t\t\topts.enc = val;\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\n\t\t\t\t\tif(val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x005c /* WriteAccess */: opts.lastuser = val; break;\n\t\t\t\tcase 0x0042 /* CodePage */:\n\t\t\t\t\tvar cpval = Number(val);\n\t\t\t\t\t/* overrides based on test cases */\n\t\t\t\t\tswitch(cpval) {\n\t\t\t\t\t\tcase 0x5212: cpval =  1200; break;\n\t\t\t\t\t\tcase 0x8000: cpval = 10000; break;\n\t\t\t\t\t\tcase 0x8001: cpval =  1252; break;\n\t\t\t\t\t}\n\t\t\t\t\tset_cp(opts.codepage = cpval);\n\t\t\t\t\tseen_codepage = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x013d /* RRTabId */: opts.rrtabid = val; break;\n\t\t\t\tcase 0x0019 /* WinProtect */: opts.winlocked = val; break;\n\t\t\t\tcase 0x01b7 /* RefreshAll */: wb.opts[\"RefreshAll\"] = val; break;\n\t\t\t\tcase 0x000c /* CalcCount */: wb.opts[\"CalcCount\"] = val; break;\n\t\t\t\tcase 0x0010 /* CalcDelta */: wb.opts[\"CalcDelta\"] = val; break;\n\t\t\t\tcase 0x0011 /* CalcIter */: wb.opts[\"CalcIter\"] = val; break;\n\t\t\t\tcase 0x000d /* CalcMode */: wb.opts[\"CalcMode\"] = val; break;\n\t\t\t\tcase 0x000e /* CalcPrecision */: wb.opts[\"CalcPrecision\"] = val; break;\n\t\t\t\tcase 0x005f /* CalcSaveRecalc */: wb.opts[\"CalcSaveRecalc\"] = val; break;\n\t\t\t\tcase 0x000f /* CalcRefMode */: opts.CalcRefMode = val; break; // TODO: implement R1C1\n\t\t\t\tcase 0x08a3 /* ForceFullCalculation */: wb.opts.FullCalc = val; break;\n\t\t\t\tcase 0x0081 /* WsBool */:\n\t\t\t\t\tif(val.fDialog) out[\"!type\"] = \"dialog\";\n\t\t\t\t\tif(!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n\t\t\t\t\tif(!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n\t\t\t\t\tbreak; // TODO\n\t\t\t\tcase 0x0043: /* BIFF2XF */ case 0x0243: /* BIFF3XF */ case 0x0443: /* BIFF4XF */\n\t\t\t\tcase 0x00e0 /* XF */:\n\t\t\t\t\tXFs.push(val); break;\n\t\t\t\tcase 0x01ae /* SupBook */:\n\t\t\t\t\tsupbooks.push([val]);\n\t\t\t\t\tsupbooks[supbooks.length-1].XTI = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0023: case 0x0223 /* ExternName */:\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0018: case 0x0218 /* Lbl */:\n\t\t\t\t\tlast_lbl = ({\n\t\t\t\t\t\tName: val.Name,\n\t\t\t\t\t\tRef: stringify_formula(val.rgce,range,null,supbooks,opts)\n\t\t\t\t\t});\n\t\t\t\t\tif(val.itab > 0) last_lbl.Sheet = val.itab - 1;\n\t\t\t\t\tsupbooks.names.push(last_lbl);\n\t\t\t\t\tif(!supbooks[0]) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tif(val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0)\n\t\t\t\t\t\tif(val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d')\n\t\t\t\t\t\t\tFilterDatabases[val.itab - 1] = { ref: encode_range(val.rgce[0][0][1][2]) };\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0016 /* ExternCount */: opts.ExternCount = val; break;\n\t\t\t\tcase 0x0017 /* ExternSheet */:\n\t\t\t\t\tif(supbooks.length == 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val); supbooks.XTI = supbooks.XTI.concat(val); break;\n\t\t\t\tcase 0x0894 /* NameCmt */:\n\t\t\t\t\t/* TODO: search for correct name */\n\t\t\t\t\tif(opts.biff < 8) break;\n\t\t\t\t\tif(last_lbl != null) last_lbl.Comment = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0012 /* Protect */: out[\"!protect\"] = val; break; /* for sheet or book */\n\t\t\t\tcase 0x0013 /* Password */: if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\n\t\t\t\tcase 0x0085 /* BoundSheet8 */: {\n\t\t\t\t\tDirectory[opts.biff == 4 ? opts.snames.length : val.pos] = val;\n\t\t\t\t\topts.snames.push(val.name);\n\t\t\t\t} break;\n\t\t\t\tcase 0x000a /* EOF */: {\n\t\t\t\t\tif(--file_depth ? !biff4w : biff4w) break;\n\t\t\t\t\tif(range.e) {\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\tif(options.sheetRows && options.sheetRows <= range.e.r) {\n\t\t\t\t\t\t\t\tvar tmpri = range.e.r;\n\t\t\t\t\t\t\t\trange.e.r = options.sheetRows - 1;\n\t\t\t\t\t\t\t\tout[\"!fullref\"] = out[\"!ref\"];\n\t\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\t\trange.e.r = tmpri;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(merges.length > 0) out[\"!merges\"] = merges;\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\n\t\t\t\t\t\tif(colinfo.length > 0) out[\"!cols\"] = colinfo;\n\t\t\t\t\t\tif(rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n\t\t\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t\t\t}\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\n\t\t\t\t\tout = ({}); if(options.dense) out[\"!data\"] = [];\n\t\t\t\t} break;\n\t\t\t\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809 /* BOF */: {\n\t\t\t\t\tif(opts.biff === 8) opts.biff = {\n0x0009:2,\n0x0209:3,\n0x0409:4\n\t\t\t\t\t}[RecordType] || {\n0x0200:2,\n0x0300:3,\n0x0400:4,\n0x0500:5,\n0x0600:8,\n0x0002:2,\n0x0007:2\n\t\t\t\t\t}[val.BIFFVer] || 8;\n\t\t\t\t\topts.biffguess = val.BIFFVer == 0;\n\t\t\t\t\tif(val.BIFFVer == 0 && val.dt == 0x1000) { opts.biff = 5; seen_codepage = true; set_cp(opts.codepage = 28591); }\n\t\t\t\t\tif(opts.biff == 4 && val.dt & 0x100) biff4w = true;\n\t\t\t\t\tif(opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n\t\t\t\t\tif(file_depth++ && !biff4w) break;\n\t\t\t\t\tout = ({}); if(options.dense) out[\"!data\"] = [];\n\n\t\t\t\t\tif(opts.biff < 8 && !seen_codepage) { seen_codepage = true; set_cp(opts.codepage = options.codepage || 1252); }\n\t\t\t\t\tif(opts.biff == 4 && biff4w) {\n\t\t\t\t\t\tcur_sheet = (Directory[opts.snames.indexOf(cur_sheet)+1] || {name:\"\"}).name;\n\t\t\t\t\t} else if(opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\t\t\t\t\t/* fake BoundSheet8 */\n\t\t\t\t\t\tvar fakebs8 = {pos: blob.l - length, name:cur_sheet};\n\t\t\t\t\t\tDirectory[fakebs8.pos] = fakebs8;\n\t\t\t\t\t\topts.snames.push(cur_sheet);\n\t\t\t\t\t}\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\n\t\t\t\t\tif(val.dt == 0x20) out[\"!type\"] = \"chart\";\n\t\t\t\t\tif(val.dt == 0x40) out[\"!type\"] = \"macro\";\n\t\t\t\t\tmerges = [];\n\t\t\t\t\tobjects = [];\n\t\t\t\t\topts.arrayf = arrayf = [];\n\t\t\t\t\tcolinfo = []; rowinfo = [];\n\t\t\t\t\tseencol = false;\n\t\t\t\t\twsprops = {Hidden:(Directory[s]||{hs:0}).hs, name:cur_sheet };\n\t\t\t\t} break;\n\t\t\t\tcase 0x0203 /* Number */: case 0x0003 /* BIFF2NUM */: case 0x0002 /* BIFF2INT */: {\n\t\t\t\t\tif(out[\"!type\"] == \"chart\") if(options.dense ? (out[\"!data\"][val.r]||[])[val.c]: out[encode_col(val.c) + encode_row(val.r)]) ++val.c;\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe]||{}, v:val.val, t:'n'});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x0005: case 0x0205 /* BoolErr */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x027e /* RK */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00bd /* MulRk */: {\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\n\t\t\t\t\t\ttemp_val= ({ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'});\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0006: case 0x0206: case 0x0406 /* Formula */: {\n\t\t\t\t\tif(val.val == 'String') { last_formula = val; break; }\n\t\t\t\t\ttemp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\tvar _f = val.formula;\n\t\t\t\t\t\tif(_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n\t\t\t\t\t\t\tvar _fr = _f[0][0][1][0], _fc = _f[0][0][1][1];\n\t\t\t\t\t\t\tvar _fe = encode_cell({r:_fr, c:_fc});\n\t\t\t\t\t\t\tif(sharedf[_fe]) temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\telse temp_val.F = ((options.dense ? (out[\"!data\"][_fr]||[])[_fc]: out[_fe]) || {}).F;\n\t\t\t\t\t\t} else temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell(val.cell, temp_val, options);\n\t\t\t\t\tlast_formula = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x0007: case 0x0207 /* String */: {\n\t\t\t\t\tif(last_formula) { /* technically always true */\n\t\t\t\t\t\tlast_formula.val = val;\n\t\t\t\t\t\ttemp_val = make_cell(val, last_formula.cell.ixfe, 's');\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\t\ttemp_val.f = \"\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\n\t\t\t\t\t\tlast_formula = null;\n\t\t\t\t\t} else throw new Error(\"String record expects Formula\");\n\t\t\t\t} break;\n\t\t\t\tcase 0x0021: case 0x0221 /* Array */: {\n\t\t\t\t\tarrayf.push(val);\n\t\t\t\t\tvar _arraystart = encode_cell(val[0].s);\n\t\t\t\t\tcc = options.dense ? (out[\"!data\"][val[0].s.r]||[])[val[0].s.c] : out[_arraystart];\n\t\t\t\t\tif(options.cellFormula && cc) {\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tif(!_arraystart || !cc) break;\n\t\t\t\t\t\tcc.f = \"\"+stringify_formula(val[1], range, val[0], supbooks, opts);\n\t\t\t\t\t\tcc.F = encode_range(val[0]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x04bc /* ShrFmla */: {\n\t\t\t\t\tif(!options.cellFormula) break;\n\t\t\t\t\tif(last_cell) {\n\t\t\t\t\t\t/* TODO: capture range */\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tsharedf[encode_cell(last_formula.cell)]= val[0];\n\t\t\t\t\t\tcc = options.dense ? (out[\"!data\"][last_formula.cell.r]||[])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n\t\t\t\t\t\t(cc||{}).f = \"\"+stringify_formula(val[0], range, lastcell, supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fd /* LabelSst */:\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\n\t\t\t\t\tif(sst[val.isst].h) temp_val.h = sst[val.isst].h;\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0201 /* Blank */: if(options.sheetStubs) {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], t:'z'});\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00be /* MulBlank */: if(options.sheetStubs) {\n\t\t\t\t\tfor(var _j = val.c; _j <= val.C; ++_j) {\n\t\t\t\t\t\tvar _ixfe = val.ixfe[_j-val.c];\n\t\t\t\t\t\ttemp_val= ({ixfe:_ixfe, XF:XFs[_ixfe], t:'z'});\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:_j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00d6 /* RString */:\n\t\t\t\tcase 0x0204 /* Label */: case 0x0004 /* BIFF2STR */:\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0x0000: case 0x0200 /* Dimensions */: {\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fc /* SST */: {\n\t\t\t\t\tsst = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x041e /* Format */: { /* val = [id, fmt] */\n\t\t\t\t\tif(opts.biff >= 3 && opts.biff <= 4) {\n\t\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val[1];\n\t\t\t\t\t\tfor(var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if(table_fmt[b4idx] == val[1]) break;\n\t\t\t\t\t\tif(b4idx >= 163) SSF__load(val[1], BIFF2Fmt + 163);\n\t\t\t\t\t}\n\t\t\t\t\telse SSF__load(val[1], val[0]);\n\t\t\t\t} break;\n\t\t\t\tcase 0x001e /* BIFF2FORMAT */: {\n\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val;\n\t\t\t\t\tfor(var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if(table_fmt[b2idx] == val) break;\n\t\t\t\t\tif(b2idx >= 163) SSF__load(val, BIFF2Fmt + 163);\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x00e5 /* MergeCells */: merges = merges.concat(val); break;\n\n\t\t\t\tcase 0x005d /* Obj */: objects[val.cmo[0]] = opts.lastobj = val; break;\n\t\t\t\tcase 0x01b6 /* TxO */: opts.lastobj.TxO = val; break;\n\t\t\t\tcase 0x007f /* ImData */: opts.lastobj.ImData = val; break;\n\n\t\t\t\tcase 0x01b8 /* HLink */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[\"!data\"][rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc) cc.l = val[1];\n\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0800 /* HLinkTooltip */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[\"!data\"][rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc && cc.l) cc.l.Tooltip = val[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x001c /* Note */: {\n\t\t\t\t\t/* TODO: comment continuation (row == -1 / 0xFFFF) */\n\t\t\t\t\tcc = options.dense ? (out[\"!data\"][val[0].r]||[])[val[0].c] : out[encode_cell(val[0])];\n\t\t\t\t\tif(!cc) {\n\t\t\t\t\t\tif(options.dense) {\n\t\t\t\t\t\t\tif(!out[\"!data\"][val[0].r]) out[\"!data\"][val[0].r] = [];\n\t\t\t\t\t\t\tcc = out[\"!data\"][val[0].r][val[0].c] = ({t:\"z\"});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcc = out[encode_cell(val[0])] = ({t:\"z\"});\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.e.r = Math.max(range.e.r, val[0].r);\n\t\t\t\t\t\trange.s.r = Math.min(range.s.r, val[0].r);\n\t\t\t\t\t\trange.e.c = Math.max(range.e.c, val[0].c);\n\t\t\t\t\t\trange.s.c = Math.min(range.s.c, val[0].c);\n\t\t\t\t\t}\n\t\t\t\t\tif(!cc.c) cc.c = [];\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) cmnt = {a:\"SheetJ5\", t:val[1]};\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar noteobj = objects[val[2]];\n\t\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\n\t\t\t\t\t\tif(val[3] != null && !(val[3] & 0x02)) cc.c.hidden = true;\n\t\t\t\t\t}\n\t\t\t\t\tcc.c.push(cmnt);\n\t\t\t\t} break;\n\t\t\t\tcase 0x087d /* XFExt */: update_xfext(XFs[val.ixfe], val.ext); break;\n\t\t\t\tcase 0x007d /* ColInfo */: {\n\t\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, level: (val.level || 0), hidden: !!(val.flags & 1) };\n\t\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0208 /* Row */: {\n\t\t\t\t\tvar rowobj = {};\n\t\t\t\t\tif(val.level != null) { rowinfo[val.r] = rowobj; rowobj.level = val.level; }\n\t\t\t\t\tif(val.hidden) { rowinfo[val.r] = rowobj; rowobj.hidden = true; }\n\t\t\t\t\tif(val.hpt) {\n\t\t\t\t\t\trowinfo[val.r] = rowobj;\n\t\t\t\t\t\trowobj.hpt = val.hpt; rowobj.hpx = pt2px(val.hpt);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0026 /* LeftMargin */:\n\t\t\t\tcase 0x0027 /* RightMargin */:\n\t\t\t\tcase 0x0028 /* TopMargin */:\n\t\t\t\tcase 0x0029 /* BottomMargin */:\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'][({0x26: \"left\", 0x27:\"right\", 0x28:\"top\", 0x29:\"bottom\"})[RecordType]] = val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x00a1 /* Setup */: // TODO\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'].header = val.header;\n\t\t\t\t\tout['!margins'].footer = val.footer;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x023e /* Window2 */: // TODO\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(val.RTL) Workbook.Views[0].RTL = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0092 /* Palette */: palette = val; break;\n\t\t\t\tcase 0x0896 /* Theme */: themes = val; break;\n\t\t\t\tcase 0x008c /* Country */: country = val; break;\n\t\t\t\tcase 0x01ba /* CodeName */: {\nif(!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";\n\t\t\t\t\telse wsprops.CodeName = val || wsprops.name;\n\t\t\t\t} break;\n\t\t\t}\n\t\t} else {\n\t\t\tif(!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n\t\t\tblob.l += length;\n\t\t}\n\t}\n\twb.SheetNames=keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\n\tif(!options.bookSheets) wb.Sheets=Sheets;\n\tif(!wb.SheetNames.length && Preamble[\"!ref\"]) {\n\t\twb.SheetNames.push(\"Sheet1\");\n\t\t/*jshint -W069 */\n\t\tif(wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n\t\t/*jshint +W069 */\n\t} else wb.Preamble=Preamble;\n\tif(wb.Sheets) FilterDatabases.forEach(function(r,i) { wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r; });\n\twb.Strings = sst;\n\twb.SSF = dup(table_fmt);\n\tif(opts.enc) wb.Encryption = opts.enc;\n\tif(themes) wb.Themes = themes;\n\twb.Metadata = {};\n\tif(country !== undefined) wb.Metadata.Country = country;\n\tif(supbooks.names.length > 0) Workbook.Names = supbooks.names;\n\twb.Workbook = Workbook;\n\treturn wb;\n}\n\n/* TODO: split props*/\nvar PSCLSID = {\n\tSI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n\tDSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n\tUDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n};\nfunction parse_xls_props(cfb, props, o) {\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n\tvar DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n\tif(DSI && DSI.size > 0) try {\n\t\tvar DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n\t\tfor(var d in DocSummary) props[d] = DocSummary[d];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\tvar SI = CFB.find(cfb, '/!SummaryInformation');\n\tif(SI && SI.size > 0) try {\n\t\tvar Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n\t\tfor(var s in Summary) if(props[s] == null) props[s] = Summary[s];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\tif(props.HeadingPairs && props.TitlesOfParts) {\n\t\tload_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n\t\tdelete props.HeadingPairs; delete props.TitlesOfParts;\n\t}\n}\nfunction write_xls_props(wb, cfb) {\n\tvar DSEntries = [], SEntries = [], CEntries = [];\n\tvar i = 0, Keys;\n\tvar DocSummaryRE = evert_key(DocSummaryPIDDSI, \"n\");\n\tvar SummaryRE = evert_key(SummaryPIDSI, \"n\");\n\tif(wb.Props) {\n\t\tKeys = keys(wb.Props);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\n\t}\n\tif(wb.Custprops) {\n\t\tKeys = keys(wb.Custprops);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) if(!Object.prototype.hasOwnProperty.call((wb.Props||{}), Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\n\t}\n\tvar CEntries2 = [];\n\tfor(i = 0; i < CEntries.length; ++i) {\n\t\tif(XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;\n\t\tif(CEntries[i][1] == null) continue;\n\t\tCEntries2.push(CEntries[i]);\n\t}\n\tif(SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\n\tif(DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\n}\n\nfunction parse_xlscfb(cfb, options) {\nif(!options) options = {};\nfix_read_opts(options);\nreset_cp();\nif(options.codepage) set_ansi(options.codepage);\nvar CompObj, WB;\nif(cfb.FullPaths) {\n\tif(CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n\tCompObj = CFB.find(cfb, '!CompObj');\n\tWB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n} else {\n\tswitch(options.type) {\n\t\tcase 'base64': cfb = s2a(Base64_decode(cfb)); break;\n\t\tcase 'binary': cfb = s2a(cfb); break;\n\t\tcase 'buffer': break;\n\t\tcase 'array': if(!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb); break;\n\t}\n\tprep_blob(cfb, 0);\n\tWB = ({content: cfb});\n}\nvar WorkbookP;\n\nvar _data;\nif(CompObj) parse_compobj(CompObj);\nif(options.bookProps && !options.bookSheets) WorkbookP = ({});\nelse {\n\tvar T = has_buf ? 'buffer' : 'array';\n\tif(WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n\t/* Quattro Pro 7-8 */\n\telse if((_data=CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Quattro Pro 9 */\n\telse if((_data=CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Works 4 for Mac */\n\telse if((_data=CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");\n\telse throw new Error(\"Cannot find Workbook stream\");\n\tif(options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n}\n\nvar props = {};\nif(cfb.FullPaths) parse_xls_props(cfb, props, options);\n\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\nif(options.bookFiles) WorkbookP.cfb = cfb;\n/*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\nreturn WorkbookP;\n}\n\n\nfunction write_xlscfb(wb, opts) {\n\tvar o = opts || {};\n\tvar cfb = CFB.utils.cfb_new({root:\"R\"});\n\tvar wbpath = \"/Workbook\";\n\tswitch(o.bookType || \"xls\") {\n\t\tcase \"xls\": o.bookType = \"biff8\";\n\t\t/* falls through */\n\t\tcase \"xla\": if(!o.bookType) o.bookType = \"xla\";\n\t\t/* falls through */\n\t\tcase \"biff8\": wbpath = \"/Workbook\"; o.biff = 8; break;\n\t\tcase \"biff5\": wbpath = \"/Book\"; o.biff = 5; break;\n\t\tdefault: throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\n\t}\n\tCFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\n\tif(o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);\n\t// TODO: SI, DSI, CO\n\tif(o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"}));\n\treturn cfb;\n}\n/* [MS-XLSB] 2.3 Record Enumeration */\nvar XLSBRecordEnum = {\n0x0000: { /* n:\"BrtRowHdr\", */ f:parse_BrtRowHdr },\n0x0001: { /* n:\"BrtCellBlank\", */ f:parse_BrtCellBlank },\n0x0002: { /* n:\"BrtCellRk\", */ f:parse_BrtCellRk },\n0x0003: { /* n:\"BrtCellError\", */ f:parse_BrtCellError },\n0x0004: { /* n:\"BrtCellBool\", */ f:parse_BrtCellBool },\n0x0005: { /* n:\"BrtCellReal\", */ f:parse_BrtCellReal },\n0x0006: { /* n:\"BrtCellSt\", */ f:parse_BrtCellSt },\n0x0007: { /* n:\"BrtCellIsst\", */ f:parse_BrtCellIsst },\n0x0008: { /* n:\"BrtFmlaString\", */ f:parse_BrtFmlaString },\n0x0009: { /* n:\"BrtFmlaNum\", */ f:parse_BrtFmlaNum },\n0x000A: { /* n:\"BrtFmlaBool\", */ f:parse_BrtFmlaBool },\n0x000B: { /* n:\"BrtFmlaError\", */ f:parse_BrtFmlaError },\n0x000C: { /* n:\"BrtShortBlank\", */ f:parse_BrtShortBlank },\n0x000D: { /* n:\"BrtShortRk\", */ f:parse_BrtShortRk },\n0x000E: { /* n:\"BrtShortError\", */ f:parse_BrtShortError },\n0x000F: { /* n:\"BrtShortBool\", */ f:parse_BrtShortBool },\n0x0010: { /* n:\"BrtShortReal\", */ f:parse_BrtShortReal },\n0x0011: { /* n:\"BrtShortSt\", */ f:parse_BrtShortSt },\n0x0012: { /* n:\"BrtShortIsst\", */ f:parse_BrtShortIsst },\n0x0013: { /* n:\"BrtSSTItem\", */ f:parse_RichStr },\n0x0014: { /* n:\"BrtPCDIMissing\" */ },\n0x0015: { /* n:\"BrtPCDINumber\" */ },\n0x0016: { /* n:\"BrtPCDIBoolean\" */ },\n0x0017: { /* n:\"BrtPCDIError\" */ },\n0x0018: { /* n:\"BrtPCDIString\" */ },\n0x0019: { /* n:\"BrtPCDIDatetime\" */ },\n0x001A: { /* n:\"BrtPCDIIndex\" */ },\n0x001B: { /* n:\"BrtPCDIAMissing\" */ },\n0x001C: { /* n:\"BrtPCDIANumber\" */ },\n0x001D: { /* n:\"BrtPCDIABoolean\" */ },\n0x001E: { /* n:\"BrtPCDIAError\" */ },\n0x001F: { /* n:\"BrtPCDIAString\" */ },\n0x0020: { /* n:\"BrtPCDIADatetime\" */ },\n0x0021: { /* n:\"BrtPCRRecord\" */ },\n0x0022: { /* n:\"BrtPCRRecordDt\" */ },\n0x0023: { /* n:\"BrtFRTBegin\", */ T:1 },\n0x0024: { /* n:\"BrtFRTEnd\", */ T:-1 },\n0x0025: { /* n:\"BrtACBegin\", */ T:1 },\n0x0026: { /* n:\"BrtACEnd\", */ T:-1 },\n0x0027: { /* n:\"BrtName\", */ f:parse_BrtName },\n0x0028: { /* n:\"BrtIndexRowBlock\" */ },\n0x002A: { /* n:\"BrtIndexBlock\" */ },\n0x002B: { /* n:\"BrtFont\", */ f:parse_BrtFont },\n0x002C: { /* n:\"BrtFmt\", */ f:parse_BrtFmt },\n0x002D: { /* n:\"BrtFill\", */ f:parse_BrtFill },\n0x002E: { /* n:\"BrtBorder\", */ f:parse_BrtBorder },\n0x002F: { /* n:\"BrtXF\", */ f:parse_BrtXF },\n0x0030: { /* n:\"BrtStyle\" */ },\n0x0031: { /* n:\"BrtCellMeta\", */ f:parse_Int32LE },\n0x0032: { /* n:\"BrtValueMeta\" */ },\n0x0033: { /* n:\"BrtMdb\" */ f:parse_BrtMdb },\n0x0034: { /* n:\"BrtBeginFmd\", */ T:1 },\n0x0035: { /* n:\"BrtEndFmd\", */ T:-1 },\n0x0036: { /* n:\"BrtBeginMdx\", */ T:1 },\n0x0037: { /* n:\"BrtEndMdx\", */ T:-1 },\n0x0038: { /* n:\"BrtBeginMdxTuple\", */ T:1 },\n0x0039: { /* n:\"BrtEndMdxTuple\", */ T:-1 },\n0x003A: { /* n:\"BrtMdxMbrIstr\" */ },\n0x003B: { /* n:\"BrtStr\" */ },\n0x003C: { /* n:\"BrtColInfo\", */ f:parse_ColInfo },\n0x003E: { /* n:\"BrtCellRString\", */ f:parse_BrtCellRString },\n0x003F: { /* n:\"BrtCalcChainItem$\", */ f:parse_BrtCalcChainItem$ },\n0x0040: { /* n:\"BrtDVal\", */ f:parse_BrtDVal },\n0x0041: { /* n:\"BrtSxvcellNum\" */ },\n0x0042: { /* n:\"BrtSxvcellStr\" */ },\n0x0043: { /* n:\"BrtSxvcellBool\" */ },\n0x0044: { /* n:\"BrtSxvcellErr\" */ },\n0x0045: { /* n:\"BrtSxvcellDate\" */ },\n0x0046: { /* n:\"BrtSxvcellNil\" */ },\n0x0080: { /* n:\"BrtFileVersion\" */ },\n0x0081: { /* n:\"BrtBeginSheet\", */ T:1 },\n0x0082: { /* n:\"BrtEndSheet\", */ T:-1 },\n0x0083: { /* n:\"BrtBeginBook\", */ T:1, f:parsenoop, p:0 },\n0x0084: { /* n:\"BrtEndBook\", */ T:-1 },\n0x0085: { /* n:\"BrtBeginWsViews\", */ T:1 },\n0x0086: { /* n:\"BrtEndWsViews\", */ T:-1 },\n0x0087: { /* n:\"BrtBeginBookViews\", */ T:1 },\n0x0088: { /* n:\"BrtEndBookViews\", */ T:-1 },\n0x0089: { /* n:\"BrtBeginWsView\", */ T:1, f:parse_BrtBeginWsView },\n0x008A: { /* n:\"BrtEndWsView\", */ T:-1 },\n0x008B: { /* n:\"BrtBeginCsViews\", */ T:1 },\n0x008C: { /* n:\"BrtEndCsViews\", */ T:-1 },\n0x008D: { /* n:\"BrtBeginCsView\", */ T:1 },\n0x008E: { /* n:\"BrtEndCsView\", */ T:-1 },\n0x008F: { /* n:\"BrtBeginBundleShs\", */ T:1 },\n0x0090: { /* n:\"BrtEndBundleShs\", */ T:-1 },\n0x0091: { /* n:\"BrtBeginSheetData\", */ T:1 },\n0x0092: { /* n:\"BrtEndSheetData\", */ T:-1 },\n0x0093: { /* n:\"BrtWsProp\", */ f:parse_BrtWsProp },\n0x0094: { /* n:\"BrtWsDim\", */ f:parse_BrtWsDim, p:16 },\n0x0097: { /* n:\"BrtPane\", */ f:parse_BrtPane },\n0x0098: { /* n:\"BrtSel\" */ },\n0x0099: { /* n:\"BrtWbProp\", */ f:parse_BrtWbProp },\n0x009A: { /* n:\"BrtWbFactoid\" */ },\n0x009B: { /* n:\"BrtFileRecover\" */ },\n0x009C: { /* n:\"BrtBundleSh\", */ f:parse_BrtBundleSh },\n0x009D: { /* n:\"BrtCalcProp\" */ },\n0x009E: { /* n:\"BrtBookView\" */ },\n0x009F: { /* n:\"BrtBeginSst\", */ T:1, f:parse_BrtBeginSst },\n0x00A0: { /* n:\"BrtEndSst\", */ T:-1 },\n0x00A1: { /* n:\"BrtBeginAFilter\", */ T:1, f:parse_UncheckedRfX },\n0x00A2: { /* n:\"BrtEndAFilter\", */ T:-1 },\n0x00A3: { /* n:\"BrtBeginFilterColumn\", */ T:1 },\n0x00A4: { /* n:\"BrtEndFilterColumn\", */ T:-1 },\n0x00A5: { /* n:\"BrtBeginFilters\", */ T:1 },\n0x00A6: { /* n:\"BrtEndFilters\", */ T:-1 },\n0x00A7: { /* n:\"BrtFilter\" */ },\n0x00A8: { /* n:\"BrtColorFilter\" */ },\n0x00A9: { /* n:\"BrtIconFilter\" */ },\n0x00AA: { /* n:\"BrtTop10Filter\" */ },\n0x00AB: { /* n:\"BrtDynamicFilter\" */ },\n0x00AC: { /* n:\"BrtBeginCustomFilters\", */ T:1 },\n0x00AD: { /* n:\"BrtEndCustomFilters\", */ T:-1 },\n0x00AE: { /* n:\"BrtCustomFilter\" */ },\n0x00AF: { /* n:\"BrtAFilterDateGroupItem\" */ },\n0x00B0: { /* n:\"BrtMergeCell\", */ f:parse_BrtMergeCell },\n0x00B1: { /* n:\"BrtBeginMergeCells\", */ T:1 },\n0x00B2: { /* n:\"BrtEndMergeCells\", */ T:-1 },\n0x00B3: { /* n:\"BrtBeginPivotCacheDef\", */ T:1 },\n0x00B4: { /* n:\"BrtEndPivotCacheDef\", */ T:-1 },\n0x00B5: { /* n:\"BrtBeginPCDFields\", */ T:1 },\n0x00B6: { /* n:\"BrtEndPCDFields\", */ T:-1 },\n0x00B7: { /* n:\"BrtBeginPCDField\", */ T:1 },\n0x00B8: { /* n:\"BrtEndPCDField\", */ T:-1 },\n0x00B9: { /* n:\"BrtBeginPCDSource\", */ T:1 },\n0x00BA: { /* n:\"BrtEndPCDSource\", */ T:-1 },\n0x00BB: { /* n:\"BrtBeginPCDSRange\", */ T:1 },\n0x00BC: { /* n:\"BrtEndPCDSRange\", */ T:-1 },\n0x00BD: { /* n:\"BrtBeginPCDFAtbl\", */ T:1 },\n0x00BE: { /* n:\"BrtEndPCDFAtbl\", */ T:-1 },\n0x00BF: { /* n:\"BrtBeginPCDIRun\", */ T:1 },\n0x00C0: { /* n:\"BrtEndPCDIRun\", */ T:-1 },\n0x00C1: { /* n:\"BrtBeginPivotCacheRecords\", */ T:1 },\n0x00C2: { /* n:\"BrtEndPivotCacheRecords\", */ T:-1 },\n0x00C3: { /* n:\"BrtBeginPCDHierarchies\", */ T:1 },\n0x00C4: { /* n:\"BrtEndPCDHierarchies\", */ T:-1 },\n0x00C5: { /* n:\"BrtBeginPCDHierarchy\", */ T:1 },\n0x00C6: { /* n:\"BrtEndPCDHierarchy\", */ T:-1 },\n0x00C7: { /* n:\"BrtBeginPCDHFieldsUsage\", */ T:1 },\n0x00C8: { /* n:\"BrtEndPCDHFieldsUsage\", */ T:-1 },\n0x00C9: { /* n:\"BrtBeginExtConnection\", */ T:1 },\n0x00CA: { /* n:\"BrtEndExtConnection\", */ T:-1 },\n0x00CB: { /* n:\"BrtBeginECDbProps\", */ T:1 },\n0x00CC: { /* n:\"BrtEndECDbProps\", */ T:-1 },\n0x00CD: { /* n:\"BrtBeginECOlapProps\", */ T:1 },\n0x00CE: { /* n:\"BrtEndECOlapProps\", */ T:-1 },\n0x00CF: { /* n:\"BrtBeginPCDSConsol\", */ T:1 },\n0x00D0: { /* n:\"BrtEndPCDSConsol\", */ T:-1 },\n0x00D1: { /* n:\"BrtBeginPCDSCPages\", */ T:1 },\n0x00D2: { /* n:\"BrtEndPCDSCPages\", */ T:-1 },\n0x00D3: { /* n:\"BrtBeginPCDSCPage\", */ T:1 },\n0x00D4: { /* n:\"BrtEndPCDSCPage\", */ T:-1 },\n0x00D5: { /* n:\"BrtBeginPCDSCPItem\", */ T:1 },\n0x00D6: { /* n:\"BrtEndPCDSCPItem\", */ T:-1 },\n0x00D7: { /* n:\"BrtBeginPCDSCSets\", */ T:1 },\n0x00D8: { /* n:\"BrtEndPCDSCSets\", */ T:-1 },\n0x00D9: { /* n:\"BrtBeginPCDSCSet\", */ T:1 },\n0x00DA: { /* n:\"BrtEndPCDSCSet\", */ T:-1 },\n0x00DB: { /* n:\"BrtBeginPCDFGroup\", */ T:1 },\n0x00DC: { /* n:\"BrtEndPCDFGroup\", */ T:-1 },\n0x00DD: { /* n:\"BrtBeginPCDFGItems\", */ T:1 },\n0x00DE: { /* n:\"BrtEndPCDFGItems\", */ T:-1 },\n0x00DF: { /* n:\"BrtBeginPCDFGRange\", */ T:1 },\n0x00E0: { /* n:\"BrtEndPCDFGRange\", */ T:-1 },\n0x00E1: { /* n:\"BrtBeginPCDFGDiscrete\", */ T:1 },\n0x00E2: { /* n:\"BrtEndPCDFGDiscrete\", */ T:-1 },\n0x00E3: { /* n:\"BrtBeginPCDSDTupleCache\", */ T:1 },\n0x00E4: { /* n:\"BrtEndPCDSDTupleCache\", */ T:-1 },\n0x00E5: { /* n:\"BrtBeginPCDSDTCEntries\", */ T:1 },\n0x00E6: { /* n:\"BrtEndPCDSDTCEntries\", */ T:-1 },\n0x00E7: { /* n:\"BrtBeginPCDSDTCEMembers\", */ T:1 },\n0x00E8: { /* n:\"BrtEndPCDSDTCEMembers\", */ T:-1 },\n0x00E9: { /* n:\"BrtBeginPCDSDTCEMember\", */ T:1 },\n0x00EA: { /* n:\"BrtEndPCDSDTCEMember\", */ T:-1 },\n0x00EB: { /* n:\"BrtBeginPCDSDTCQueries\", */ T:1 },\n0x00EC: { /* n:\"BrtEndPCDSDTCQueries\", */ T:-1 },\n0x00ED: { /* n:\"BrtBeginPCDSDTCQuery\", */ T:1 },\n0x00EE: { /* n:\"BrtEndPCDSDTCQuery\", */ T:-1 },\n0x00EF: { /* n:\"BrtBeginPCDSDTCSets\", */ T:1 },\n0x00F0: { /* n:\"BrtEndPCDSDTCSets\", */ T:-1 },\n0x00F1: { /* n:\"BrtBeginPCDSDTCSet\", */ T:1 },\n0x00F2: { /* n:\"BrtEndPCDSDTCSet\", */ T:-1 },\n0x00F3: { /* n:\"BrtBeginPCDCalcItems\", */ T:1 },\n0x00F4: { /* n:\"BrtEndPCDCalcItems\", */ T:-1 },\n0x00F5: { /* n:\"BrtBeginPCDCalcItem\", */ T:1 },\n0x00F6: { /* n:\"BrtEndPCDCalcItem\", */ T:-1 },\n0x00F7: { /* n:\"BrtBeginPRule\", */ T:1 },\n0x00F8: { /* n:\"BrtEndPRule\", */ T:-1 },\n0x00F9: { /* n:\"BrtBeginPRFilters\", */ T:1 },\n0x00FA: { /* n:\"BrtEndPRFilters\", */ T:-1 },\n0x00FB: { /* n:\"BrtBeginPRFilter\", */ T:1 },\n0x00FC: { /* n:\"BrtEndPRFilter\", */ T:-1 },\n0x00FD: { /* n:\"BrtBeginPNames\", */ T:1 },\n0x00FE: { /* n:\"BrtEndPNames\", */ T:-1 },\n0x00FF: { /* n:\"BrtBeginPName\", */ T:1 },\n0x0100: { /* n:\"BrtEndPName\", */ T:-1 },\n0x0101: { /* n:\"BrtBeginPNPairs\", */ T:1 },\n0x0102: { /* n:\"BrtEndPNPairs\", */ T:-1 },\n0x0103: { /* n:\"BrtBeginPNPair\", */ T:1 },\n0x0104: { /* n:\"BrtEndPNPair\", */ T:-1 },\n0x0105: { /* n:\"BrtBeginECWebProps\", */ T:1 },\n0x0106: { /* n:\"BrtEndECWebProps\", */ T:-1 },\n0x0107: { /* n:\"BrtBeginEcWpTables\", */ T:1 },\n0x0108: { /* n:\"BrtEndECWPTables\", */ T:-1 },\n0x0109: { /* n:\"BrtBeginECParams\", */ T:1 },\n0x010A: { /* n:\"BrtEndECParams\", */ T:-1 },\n0x010B: { /* n:\"BrtBeginECParam\", */ T:1 },\n0x010C: { /* n:\"BrtEndECParam\", */ T:-1 },\n0x010D: { /* n:\"BrtBeginPCDKPIs\", */ T:1 },\n0x010E: { /* n:\"BrtEndPCDKPIs\", */ T:-1 },\n0x010F: { /* n:\"BrtBeginPCDKPI\", */ T:1 },\n0x0110: { /* n:\"BrtEndPCDKPI\", */ T:-1 },\n0x0111: { /* n:\"BrtBeginDims\", */ T:1 },\n0x0112: { /* n:\"BrtEndDims\", */ T:-1 },\n0x0113: { /* n:\"BrtBeginDim\", */ T:1 },\n0x0114: { /* n:\"BrtEndDim\", */ T:-1 },\n0x0115: { /* n:\"BrtIndexPartEnd\" */ },\n0x0116: { /* n:\"BrtBeginStyleSheet\", */ T:1 },\n0x0117: { /* n:\"BrtEndStyleSheet\", */ T:-1 },\n0x0118: { /* n:\"BrtBeginSXView\", */ T:1 },\n0x0119: { /* n:\"BrtEndSXVI\", */ T:-1 },\n0x011A: { /* n:\"BrtBeginSXVI\", */ T:1 },\n0x011B: { /* n:\"BrtBeginSXVIs\", */ T:1 },\n0x011C: { /* n:\"BrtEndSXVIs\", */ T:-1 },\n0x011D: { /* n:\"BrtBeginSXVD\", */ T:1 },\n0x011E: { /* n:\"BrtEndSXVD\", */ T:-1 },\n0x011F: { /* n:\"BrtBeginSXVDs\", */ T:1 },\n0x0120: { /* n:\"BrtEndSXVDs\", */ T:-1 },\n0x0121: { /* n:\"BrtBeginSXPI\", */ T:1 },\n0x0122: { /* n:\"BrtEndSXPI\", */ T:-1 },\n0x0123: { /* n:\"BrtBeginSXPIs\", */ T:1 },\n0x0124: { /* n:\"BrtEndSXPIs\", */ T:-1 },\n0x0125: { /* n:\"BrtBeginSXDI\", */ T:1 },\n0x0126: { /* n:\"BrtEndSXDI\", */ T:-1 },\n0x0127: { /* n:\"BrtBeginSXDIs\", */ T:1 },\n0x0128: { /* n:\"BrtEndSXDIs\", */ T:-1 },\n0x0129: { /* n:\"BrtBeginSXLI\", */ T:1 },\n0x012A: { /* n:\"BrtEndSXLI\", */ T:-1 },\n0x012B: { /* n:\"BrtBeginSXLIRws\", */ T:1 },\n0x012C: { /* n:\"BrtEndSXLIRws\", */ T:-1 },\n0x012D: { /* n:\"BrtBeginSXLICols\", */ T:1 },\n0x012E: { /* n:\"BrtEndSXLICols\", */ T:-1 },\n0x012F: { /* n:\"BrtBeginSXFormat\", */ T:1 },\n0x0130: { /* n:\"BrtEndSXFormat\", */ T:-1 },\n0x0131: { /* n:\"BrtBeginSXFormats\", */ T:1 },\n0x0132: { /* n:\"BrtEndSxFormats\", */ T:-1 },\n0x0133: { /* n:\"BrtBeginSxSelect\", */ T:1 },\n0x0134: { /* n:\"BrtEndSxSelect\", */ T:-1 },\n0x0135: { /* n:\"BrtBeginISXVDRws\", */ T:1 },\n0x0136: { /* n:\"BrtEndISXVDRws\", */ T:-1 },\n0x0137: { /* n:\"BrtBeginISXVDCols\", */ T:1 },\n0x0138: { /* n:\"BrtEndISXVDCols\", */ T:-1 },\n0x0139: { /* n:\"BrtEndSXLocation\", */ T:-1 },\n0x013A: { /* n:\"BrtBeginSXLocation\", */ T:1 },\n0x013B: { /* n:\"BrtEndSXView\", */ T:-1 },\n0x013C: { /* n:\"BrtBeginSXTHs\", */ T:1 },\n0x013D: { /* n:\"BrtEndSXTHs\", */ T:-1 },\n0x013E: { /* n:\"BrtBeginSXTH\", */ T:1 },\n0x013F: { /* n:\"BrtEndSXTH\", */ T:-1 },\n0x0140: { /* n:\"BrtBeginISXTHRws\", */ T:1 },\n0x0141: { /* n:\"BrtEndISXTHRws\", */ T:-1 },\n0x0142: { /* n:\"BrtBeginISXTHCols\", */ T:1 },\n0x0143: { /* n:\"BrtEndISXTHCols\", */ T:-1 },\n0x0144: { /* n:\"BrtBeginSXTDMPS\", */ T:1 },\n0x0145: { /* n:\"BrtEndSXTDMPs\", */ T:-1 },\n0x0146: { /* n:\"BrtBeginSXTDMP\", */ T:1 },\n0x0147: { /* n:\"BrtEndSXTDMP\", */ T:-1 },\n0x0148: { /* n:\"BrtBeginSXTHItems\", */ T:1 },\n0x0149: { /* n:\"BrtEndSXTHItems\", */ T:-1 },\n0x014A: { /* n:\"BrtBeginSXTHItem\", */ T:1 },\n0x014B: { /* n:\"BrtEndSXTHItem\", */ T:-1 },\n0x014C: { /* n:\"BrtBeginMetadata\", */ T:1 },\n0x014D: { /* n:\"BrtEndMetadata\", */ T:-1 },\n0x014E: { /* n:\"BrtBeginEsmdtinfo\", */ T:1 },\n0x014F: { /* n:\"BrtMdtinfo\", */ f:parse_BrtMdtinfo },\n0x0150: { /* n:\"BrtEndEsmdtinfo\", */ T:-1 },\n0x0151: { /* n:\"BrtBeginEsmdb\", */ f:parse_BrtBeginEsmdb, T:1 },\n0x0152: { /* n:\"BrtEndEsmdb\", */ T:-1 },\n0x0153: { /* n:\"BrtBeginEsfmd\", */ T:1 },\n0x0154: { /* n:\"BrtEndEsfmd\", */ T:-1 },\n0x0155: { /* n:\"BrtBeginSingleCells\", */ T:1 },\n0x0156: { /* n:\"BrtEndSingleCells\", */ T:-1 },\n0x0157: { /* n:\"BrtBeginList\", */ T:1 },\n0x0158: { /* n:\"BrtEndList\", */ T:-1 },\n0x0159: { /* n:\"BrtBeginListCols\", */ T:1 },\n0x015A: { /* n:\"BrtEndListCols\", */ T:-1 },\n0x015B: { /* n:\"BrtBeginListCol\", */ T:1 },\n0x015C: { /* n:\"BrtEndListCol\", */ T:-1 },\n0x015D: { /* n:\"BrtBeginListXmlCPr\", */ T:1 },\n0x015E: { /* n:\"BrtEndListXmlCPr\", */ T:-1 },\n0x015F: { /* n:\"BrtListCCFmla\" */ },\n0x0160: { /* n:\"BrtListTrFmla\" */ },\n0x0161: { /* n:\"BrtBeginExternals\", */ T:1 },\n0x0162: { /* n:\"BrtEndExternals\", */ T:-1 },\n0x0163: { /* n:\"BrtSupBookSrc\", */ f:parse_RelID},\n0x0165: { /* n:\"BrtSupSelf\" */ },\n0x0166: { /* n:\"BrtSupSame\" */ },\n0x0167: { /* n:\"BrtSupTabs\" */ },\n0x0168: { /* n:\"BrtBeginSupBook\", */ T:1 },\n0x0169: { /* n:\"BrtPlaceholderName\" */ },\n0x016A: { /* n:\"BrtExternSheet\", */ f:parse_ExternSheet },\n0x016B: { /* n:\"BrtExternTableStart\" */ },\n0x016C: { /* n:\"BrtExternTableEnd\" */ },\n0x016E: { /* n:\"BrtExternRowHdr\" */ },\n0x016F: { /* n:\"BrtExternCellBlank\" */ },\n0x0170: { /* n:\"BrtExternCellReal\" */ },\n0x0171: { /* n:\"BrtExternCellBool\" */ },\n0x0172: { /* n:\"BrtExternCellError\" */ },\n0x0173: { /* n:\"BrtExternCellString\" */ },\n0x0174: { /* n:\"BrtBeginEsmdx\", */ T:1 },\n0x0175: { /* n:\"BrtEndEsmdx\", */ T:-1 },\n0x0176: { /* n:\"BrtBeginMdxSet\", */ T:1 },\n0x0177: { /* n:\"BrtEndMdxSet\", */ T:-1 },\n0x0178: { /* n:\"BrtBeginMdxMbrProp\", */ T:1 },\n0x0179: { /* n:\"BrtEndMdxMbrProp\", */ T:-1 },\n0x017A: { /* n:\"BrtBeginMdxKPI\", */ T:1 },\n0x017B: { /* n:\"BrtEndMdxKPI\", */ T:-1 },\n0x017C: { /* n:\"BrtBeginEsstr\", */ T:1 },\n0x017D: { /* n:\"BrtEndEsstr\", */ T:-1 },\n0x017E: { /* n:\"BrtBeginPRFItem\", */ T:1 },\n0x017F: { /* n:\"BrtEndPRFItem\", */ T:-1 },\n0x0180: { /* n:\"BrtBeginPivotCacheIDs\", */ T:1 },\n0x0181: { /* n:\"BrtEndPivotCacheIDs\", */ T:-1 },\n0x0182: { /* n:\"BrtBeginPivotCacheID\", */ T:1 },\n0x0183: { /* n:\"BrtEndPivotCacheID\", */ T:-1 },\n0x0184: { /* n:\"BrtBeginISXVIs\", */ T:1 },\n0x0185: { /* n:\"BrtEndISXVIs\", */ T:-1 },\n0x0186: { /* n:\"BrtBeginColInfos\", */ T:1 },\n0x0187: { /* n:\"BrtEndColInfos\", */ T:-1 },\n0x0188: { /* n:\"BrtBeginRwBrk\", */ T:1 },\n0x0189: { /* n:\"BrtEndRwBrk\", */ T:-1 },\n0x018A: { /* n:\"BrtBeginColBrk\", */ T:1 },\n0x018B: { /* n:\"BrtEndColBrk\", */ T:-1 },\n0x018C: { /* n:\"BrtBrk\" */ },\n0x018D: { /* n:\"BrtUserBookView\" */ },\n0x018E: { /* n:\"BrtInfo\" */ },\n0x018F: { /* n:\"BrtCUsr\" */ },\n0x0190: { /* n:\"BrtUsr\" */ },\n0x0191: { /* n:\"BrtBeginUsers\", */ T:1 },\n0x0193: { /* n:\"BrtEOF\" */ },\n0x0194: { /* n:\"BrtUCR\" */ },\n0x0195: { /* n:\"BrtRRInsDel\" */ },\n0x0196: { /* n:\"BrtRREndInsDel\" */ },\n0x0197: { /* n:\"BrtRRMove\" */ },\n0x0198: { /* n:\"BrtRREndMove\" */ },\n0x0199: { /* n:\"BrtRRChgCell\" */ },\n0x019A: { /* n:\"BrtRREndChgCell\" */ },\n0x019B: { /* n:\"BrtRRHeader\" */ },\n0x019C: { /* n:\"BrtRRUserView\" */ },\n0x019D: { /* n:\"BrtRRRenSheet\" */ },\n0x019E: { /* n:\"BrtRRInsertSh\" */ },\n0x019F: { /* n:\"BrtRRDefName\" */ },\n0x01A0: { /* n:\"BrtRRNote\" */ },\n0x01A1: { /* n:\"BrtRRConflict\" */ },\n0x01A2: { /* n:\"BrtRRTQSIF\" */ },\n0x01A3: { /* n:\"BrtRRFormat\" */ },\n0x01A4: { /* n:\"BrtRREndFormat\" */ },\n0x01A5: { /* n:\"BrtRRAutoFmt\" */ },\n0x01A6: { /* n:\"BrtBeginUserShViews\", */ T:1 },\n0x01A7: { /* n:\"BrtBeginUserShView\", */ T:1 },\n0x01A8: { /* n:\"BrtEndUserShView\", */ T:-1 },\n0x01A9: { /* n:\"BrtEndUserShViews\", */ T:-1 },\n0x01AA: { /* n:\"BrtArrFmla\", */ f:parse_BrtArrFmla },\n0x01AB: { /* n:\"BrtShrFmla\", */ f:parse_BrtShrFmla },\n0x01AC: { /* n:\"BrtTable\" */ },\n0x01AD: { /* n:\"BrtBeginExtConnections\", */ T:1 },\n0x01AE: { /* n:\"BrtEndExtConnections\", */ T:-1 },\n0x01AF: { /* n:\"BrtBeginPCDCalcMems\", */ T:1 },\n0x01B0: { /* n:\"BrtEndPCDCalcMems\", */ T:-1 },\n0x01B1: { /* n:\"BrtBeginPCDCalcMem\", */ T:1 },\n0x01B2: { /* n:\"BrtEndPCDCalcMem\", */ T:-1 },\n0x01B3: { /* n:\"BrtBeginPCDHGLevels\", */ T:1 },\n0x01B4: { /* n:\"BrtEndPCDHGLevels\", */ T:-1 },\n0x01B5: { /* n:\"BrtBeginPCDHGLevel\", */ T:1 },\n0x01B6: { /* n:\"BrtEndPCDHGLevel\", */ T:-1 },\n0x01B7: { /* n:\"BrtBeginPCDHGLGroups\", */ T:1 },\n0x01B8: { /* n:\"BrtEndPCDHGLGroups\", */ T:-1 },\n0x01B9: { /* n:\"BrtBeginPCDHGLGroup\", */ T:1 },\n0x01BA: { /* n:\"BrtEndPCDHGLGroup\", */ T:-1 },\n0x01BB: { /* n:\"BrtBeginPCDHGLGMembers\", */ T:1 },\n0x01BC: { /* n:\"BrtEndPCDHGLGMembers\", */ T:-1 },\n0x01BD: { /* n:\"BrtBeginPCDHGLGMember\", */ T:1 },\n0x01BE: { /* n:\"BrtEndPCDHGLGMember\", */ T:-1 },\n0x01BF: { /* n:\"BrtBeginQSI\", */ T:1 },\n0x01C0: { /* n:\"BrtEndQSI\", */ T:-1 },\n0x01C1: { /* n:\"BrtBeginQSIR\", */ T:1 },\n0x01C2: { /* n:\"BrtEndQSIR\", */ T:-1 },\n0x01C3: { /* n:\"BrtBeginDeletedNames\", */ T:1 },\n0x01C4: { /* n:\"BrtEndDeletedNames\", */ T:-1 },\n0x01C5: { /* n:\"BrtBeginDeletedName\", */ T:1 },\n0x01C6: { /* n:\"BrtEndDeletedName\", */ T:-1 },\n0x01C7: { /* n:\"BrtBeginQSIFs\", */ T:1 },\n0x01C8: { /* n:\"BrtEndQSIFs\", */ T:-1 },\n0x01C9: { /* n:\"BrtBeginQSIF\", */ T:1 },\n0x01CA: { /* n:\"BrtEndQSIF\", */ T:-1 },\n0x01CB: { /* n:\"BrtBeginAutoSortScope\", */ T:1 },\n0x01CC: { /* n:\"BrtEndAutoSortScope\", */ T:-1 },\n0x01CD: { /* n:\"BrtBeginConditionalFormatting\", */ T:1 },\n0x01CE: { /* n:\"BrtEndConditionalFormatting\", */ T:-1 },\n0x01CF: { /* n:\"BrtBeginCFRule\", */ T:1 },\n0x01D0: { /* n:\"BrtEndCFRule\", */ T:-1 },\n0x01D1: { /* n:\"BrtBeginIconSet\", */ T:1 },\n0x01D2: { /* n:\"BrtEndIconSet\", */ T:-1 },\n0x01D3: { /* n:\"BrtBeginDatabar\", */ T:1 },\n0x01D4: { /* n:\"BrtEndDatabar\", */ T:-1 },\n0x01D5: { /* n:\"BrtBeginColorScale\", */ T:1 },\n0x01D6: { /* n:\"BrtEndColorScale\", */ T:-1 },\n0x01D7: { /* n:\"BrtCFVO\" */ },\n0x01D8: { /* n:\"BrtExternValueMeta\" */ },\n0x01D9: { /* n:\"BrtBeginColorPalette\", */ T:1 },\n0x01DA: { /* n:\"BrtEndColorPalette\", */ T:-1 },\n0x01DB: { /* n:\"BrtIndexedColor\" */ },\n0x01DC: { /* n:\"BrtMargins\", */ f:parse_BrtMargins },\n0x01DD: { /* n:\"BrtPrintOptions\" */ },\n0x01DE: { /* n:\"BrtPageSetup\" */ },\n0x01DF: { /* n:\"BrtBeginHeaderFooter\", */ T:1 },\n0x01E0: { /* n:\"BrtEndHeaderFooter\", */ T:-1 },\n0x01E1: { /* n:\"BrtBeginSXCrtFormat\", */ T:1 },\n0x01E2: { /* n:\"BrtEndSXCrtFormat\", */ T:-1 },\n0x01E3: { /* n:\"BrtBeginSXCrtFormats\", */ T:1 },\n0x01E4: { /* n:\"BrtEndSXCrtFormats\", */ T:-1 },\n0x01E5: { /* n:\"BrtWsFmtInfo\", */ f:parse_BrtWsFmtInfo },\n0x01E6: { /* n:\"BrtBeginMgs\", */ T:1 },\n0x01E7: { /* n:\"BrtEndMGs\", */ T:-1 },\n0x01E8: { /* n:\"BrtBeginMGMaps\", */ T:1 },\n0x01E9: { /* n:\"BrtEndMGMaps\", */ T:-1 },\n0x01EA: { /* n:\"BrtBeginMG\", */ T:1 },\n0x01EB: { /* n:\"BrtEndMG\", */ T:-1 },\n0x01EC: { /* n:\"BrtBeginMap\", */ T:1 },\n0x01ED: { /* n:\"BrtEndMap\", */ T:-1 },\n0x01EE: { /* n:\"BrtHLink\", */ f:parse_BrtHLink },\n0x01EF: { /* n:\"BrtBeginDCon\", */ T:1 },\n0x01F0: { /* n:\"BrtEndDCon\", */ T:-1 },\n0x01F1: { /* n:\"BrtBeginDRefs\", */ T:1 },\n0x01F2: { /* n:\"BrtEndDRefs\", */ T:-1 },\n0x01F3: { /* n:\"BrtDRef\" */ },\n0x01F4: { /* n:\"BrtBeginScenMan\", */ T:1 },\n0x01F5: { /* n:\"BrtEndScenMan\", */ T:-1 },\n0x01F6: { /* n:\"BrtBeginSct\", */ T:1 },\n0x01F7: { /* n:\"BrtEndSct\", */ T:-1 },\n0x01F8: { /* n:\"BrtSlc\" */ },\n0x01F9: { /* n:\"BrtBeginDXFs\", */ T:1 },\n0x01FA: { /* n:\"BrtEndDXFs\", */ T:-1 },\n0x01FB: { /* n:\"BrtDXF\" */ },\n0x01FC: { /* n:\"BrtBeginTableStyles\", */ T:1 },\n0x01FD: { /* n:\"BrtEndTableStyles\", */ T:-1 },\n0x01FE: { /* n:\"BrtBeginTableStyle\", */ T:1 },\n0x01FF: { /* n:\"BrtEndTableStyle\", */ T:-1 },\n0x0200: { /* n:\"BrtTableStyleElement\" */ },\n0x0201: { /* n:\"BrtTableStyleClient\" */ },\n0x0202: { /* n:\"BrtBeginVolDeps\", */ T:1 },\n0x0203: { /* n:\"BrtEndVolDeps\", */ T:-1 },\n0x0204: { /* n:\"BrtBeginVolType\", */ T:1 },\n0x0205: { /* n:\"BrtEndVolType\", */ T:-1 },\n0x0206: { /* n:\"BrtBeginVolMain\", */ T:1 },\n0x0207: { /* n:\"BrtEndVolMain\", */ T:-1 },\n0x0208: { /* n:\"BrtBeginVolTopic\", */ T:1 },\n0x0209: { /* n:\"BrtEndVolTopic\", */ T:-1 },\n0x020A: { /* n:\"BrtVolSubtopic\" */ },\n0x020B: { /* n:\"BrtVolRef\" */ },\n0x020C: { /* n:\"BrtVolNum\" */ },\n0x020D: { /* n:\"BrtVolErr\" */ },\n0x020E: { /* n:\"BrtVolStr\" */ },\n0x020F: { /* n:\"BrtVolBool\" */ },\n0x0210: { /* n:\"BrtBeginCalcChain$\", */ T:1 },\n0x0211: { /* n:\"BrtEndCalcChain$\", */ T:-1 },\n0x0212: { /* n:\"BrtBeginSortState\", */ T:1 },\n0x0213: { /* n:\"BrtEndSortState\", */ T:-1 },\n0x0214: { /* n:\"BrtBeginSortCond\", */ T:1 },\n0x0215: { /* n:\"BrtEndSortCond\", */ T:-1 },\n0x0216: { /* n:\"BrtBookProtection\" */ },\n0x0217: { /* n:\"BrtSheetProtection\" */ },\n0x0218: { /* n:\"BrtRangeProtection\" */ },\n0x0219: { /* n:\"BrtPhoneticInfo\" */ },\n0x021A: { /* n:\"BrtBeginECTxtWiz\", */ T:1 },\n0x021B: { /* n:\"BrtEndECTxtWiz\", */ T:-1 },\n0x021C: { /* n:\"BrtBeginECTWFldInfoLst\", */ T:1 },\n0x021D: { /* n:\"BrtEndECTWFldInfoLst\", */ T:-1 },\n0x021E: { /* n:\"BrtBeginECTwFldInfo\", */ T:1 },\n0x0224: { /* n:\"BrtFileSharing\" */ },\n0x0225: { /* n:\"BrtOleSize\" */ },\n0x0226: { /* n:\"BrtDrawing\", */ f:parse_RelID },\n0x0227: { /* n:\"BrtLegacyDrawing\", */ f:parse_XLNullableWideString },\n0x0228: { /* n:\"BrtLegacyDrawingHF\" */ },\n0x0229: { /* n:\"BrtWebOpt\" */ },\n0x022A: { /* n:\"BrtBeginWebPubItems\", */ T:1 },\n0x022B: { /* n:\"BrtEndWebPubItems\", */ T:-1 },\n0x022C: { /* n:\"BrtBeginWebPubItem\", */ T:1 },\n0x022D: { /* n:\"BrtEndWebPubItem\", */ T:-1 },\n0x022E: { /* n:\"BrtBeginSXCondFmt\", */ T:1 },\n0x022F: { /* n:\"BrtEndSXCondFmt\", */ T:-1 },\n0x0230: { /* n:\"BrtBeginSXCondFmts\", */ T:1 },\n0x0231: { /* n:\"BrtEndSXCondFmts\", */ T:-1 },\n0x0232: { /* n:\"BrtBkHim\" */ },\n0x0234: { /* n:\"BrtColor\" */ },\n0x0235: { /* n:\"BrtBeginIndexedColors\", */ T:1 },\n0x0236: { /* n:\"BrtEndIndexedColors\", */ T:-1 },\n0x0239: { /* n:\"BrtBeginMRUColors\", */ T:1 },\n0x023A: { /* n:\"BrtEndMRUColors\", */ T:-1 },\n0x023C: { /* n:\"BrtMRUColor\" */ },\n0x023D: { /* n:\"BrtBeginDVals\", */ T:1 },\n0x023E: { /* n:\"BrtEndDVals\", */ T:-1 },\n0x0241: { /* n:\"BrtSupNameStart\" */ },\n0x0242: { /* n:\"BrtSupNameValueStart\" */ },\n0x0243: { /* n:\"BrtSupNameValueEnd\" */ },\n0x0244: { /* n:\"BrtSupNameNum\" */ },\n0x0245: { /* n:\"BrtSupNameErr\" */ },\n0x0246: { /* n:\"BrtSupNameSt\" */ },\n0x0247: { /* n:\"BrtSupNameNil\" */ },\n0x0248: { /* n:\"BrtSupNameBool\" */ },\n0x0249: { /* n:\"BrtSupNameFmla\" */ },\n0x024A: { /* n:\"BrtSupNameBits\" */ },\n0x024B: { /* n:\"BrtSupNameEnd\" */ },\n0x024C: { /* n:\"BrtEndSupBook\", */ T:-1 },\n0x024D: { /* n:\"BrtCellSmartTagProperty\" */ },\n0x024E: { /* n:\"BrtBeginCellSmartTag\", */ T:1 },\n0x024F: { /* n:\"BrtEndCellSmartTag\", */ T:-1 },\n0x0250: { /* n:\"BrtBeginCellSmartTags\", */ T:1 },\n0x0251: { /* n:\"BrtEndCellSmartTags\", */ T:-1 },\n0x0252: { /* n:\"BrtBeginSmartTags\", */ T:1 },\n0x0253: { /* n:\"BrtEndSmartTags\", */ T:-1 },\n0x0254: { /* n:\"BrtSmartTagType\" */ },\n0x0255: { /* n:\"BrtBeginSmartTagTypes\", */ T:1 },\n0x0256: { /* n:\"BrtEndSmartTagTypes\", */ T:-1 },\n0x0257: { /* n:\"BrtBeginSXFilters\", */ T:1 },\n0x0258: { /* n:\"BrtEndSXFilters\", */ T:-1 },\n0x0259: { /* n:\"BrtBeginSXFILTER\", */ T:1 },\n0x025A: { /* n:\"BrtEndSXFilter\", */ T:-1 },\n0x025B: { /* n:\"BrtBeginFills\", */ T:1 },\n0x025C: { /* n:\"BrtEndFills\", */ T:-1 },\n0x025D: { /* n:\"BrtBeginCellWatches\", */ T:1 },\n0x025E: { /* n:\"BrtEndCellWatches\", */ T:-1 },\n0x025F: { /* n:\"BrtCellWatch\" */ },\n0x0260: { /* n:\"BrtBeginCRErrs\", */ T:1 },\n0x0261: { /* n:\"BrtEndCRErrs\", */ T:-1 },\n0x0262: { /* n:\"BrtCrashRecErr\" */ },\n0x0263: { /* n:\"BrtBeginFonts\", */ T:1 },\n0x0264: { /* n:\"BrtEndFonts\", */ T:-1 },\n0x0265: { /* n:\"BrtBeginBorders\", */ T:1 },\n0x0266: { /* n:\"BrtEndBorders\", */ T:-1 },\n0x0267: { /* n:\"BrtBeginFmts\", */ T:1 },\n0x0268: { /* n:\"BrtEndFmts\", */ T:-1 },\n0x0269: { /* n:\"BrtBeginCellXFs\", */ T:1 },\n0x026A: { /* n:\"BrtEndCellXFs\", */ T:-1 },\n0x026B: { /* n:\"BrtBeginStyles\", */ T:1 },\n0x026C: { /* n:\"BrtEndStyles\", */ T:-1 },\n0x0271: { /* n:\"BrtBigName\" */ },\n0x0272: { /* n:\"BrtBeginCellStyleXFs\", */ T:1 },\n0x0273: { /* n:\"BrtEndCellStyleXFs\", */ T:-1 },\n0x0274: { /* n:\"BrtBeginComments\", */ T:1 },\n0x0275: { /* n:\"BrtEndComments\", */ T:-1 },\n0x0276: { /* n:\"BrtBeginCommentAuthors\", */ T:1 },\n0x0277: { /* n:\"BrtEndCommentAuthors\", */ T:-1 },\n0x0278: { /* n:\"BrtCommentAuthor\", */ f:parse_BrtCommentAuthor },\n0x0279: { /* n:\"BrtBeginCommentList\", */ T:1 },\n0x027A: { /* n:\"BrtEndCommentList\", */ T:-1 },\n0x027B: { /* n:\"BrtBeginComment\", */ T:1, f:parse_BrtBeginComment},\n0x027C: { /* n:\"BrtEndComment\", */ T:-1 },\n0x027D: { /* n:\"BrtCommentText\", */ f:parse_BrtCommentText },\n0x027E: { /* n:\"BrtBeginOleObjects\", */ T:1 },\n0x027F: { /* n:\"BrtOleObject\" */ },\n0x0280: { /* n:\"BrtEndOleObjects\", */ T:-1 },\n0x0281: { /* n:\"BrtBeginSxrules\", */ T:1 },\n0x0282: { /* n:\"BrtEndSxRules\", */ T:-1 },\n0x0283: { /* n:\"BrtBeginActiveXControls\", */ T:1 },\n0x0284: { /* n:\"BrtActiveX\" */ },\n0x0285: { /* n:\"BrtEndActiveXControls\", */ T:-1 },\n0x0286: { /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */ T:1 },\n0x0288: { /* n:\"BrtBeginCellIgnoreECs\", */ T:1 },\n0x0289: { /* n:\"BrtCellIgnoreEC\" */ },\n0x028A: { /* n:\"BrtEndCellIgnoreECs\", */ T:-1 },\n0x028B: { /* n:\"BrtCsProp\", */ f:parse_BrtCsProp },\n0x028C: { /* n:\"BrtCsPageSetup\" */ },\n0x028D: { /* n:\"BrtBeginUserCsViews\", */ T:1 },\n0x028E: { /* n:\"BrtEndUserCsViews\", */ T:-1 },\n0x028F: { /* n:\"BrtBeginUserCsView\", */ T:1 },\n0x0290: { /* n:\"BrtEndUserCsView\", */ T:-1 },\n0x0291: { /* n:\"BrtBeginPcdSFCIEntries\", */ T:1 },\n0x0292: { /* n:\"BrtEndPCDSFCIEntries\", */ T:-1 },\n0x0293: { /* n:\"BrtPCDSFCIEntry\" */ },\n0x0294: { /* n:\"BrtBeginListParts\", */ T:1 },\n0x0295: { /* n:\"BrtListPart\" */ },\n0x0296: { /* n:\"BrtEndListParts\", */ T:-1 },\n0x0297: { /* n:\"BrtSheetCalcProp\" */ },\n0x0298: { /* n:\"BrtBeginFnGroup\", */ T:1 },\n0x0299: { /* n:\"BrtFnGroup\" */ },\n0x029A: { /* n:\"BrtEndFnGroup\", */ T:-1 },\n0x029B: { /* n:\"BrtSupAddin\" */ },\n0x029C: { /* n:\"BrtSXTDMPOrder\" */ },\n0x029D: { /* n:\"BrtCsProtection\" */ },\n0x029F: { /* n:\"BrtBeginWsSortMap\", */ T:1 },\n0x02A0: { /* n:\"BrtEndWsSortMap\", */ T:-1 },\n0x02A1: { /* n:\"BrtBeginRRSort\", */ T:1 },\n0x02A2: { /* n:\"BrtEndRRSort\", */ T:-1 },\n0x02A3: { /* n:\"BrtRRSortItem\" */ },\n0x02A4: { /* n:\"BrtFileSharingIso\" */ },\n0x02A5: { /* n:\"BrtBookProtectionIso\" */ },\n0x02A6: { /* n:\"BrtSheetProtectionIso\" */ },\n0x02A7: { /* n:\"BrtCsProtectionIso\" */ },\n0x02A8: { /* n:\"BrtRangeProtectionIso\" */ },\n0x02A9: { /* n:\"BrtDValList\" */ },\n0x0400: { /* n:\"BrtRwDescent\" */ },\n0x0401: { /* n:\"BrtKnownFonts\" */ },\n0x0402: { /* n:\"BrtBeginSXTupleSet\", */ T:1 },\n0x0403: { /* n:\"BrtEndSXTupleSet\", */ T:-1 },\n0x0404: { /* n:\"BrtBeginSXTupleSetHeader\", */ T:1 },\n0x0405: { /* n:\"BrtEndSXTupleSetHeader\", */ T:-1 },\n0x0406: { /* n:\"BrtSXTupleSetHeaderItem\" */ },\n0x0407: { /* n:\"BrtBeginSXTupleSetData\", */ T:1 },\n0x0408: { /* n:\"BrtEndSXTupleSetData\", */ T:-1 },\n0x0409: { /* n:\"BrtBeginSXTupleSetRow\", */ T:1 },\n0x040A: { /* n:\"BrtEndSXTupleSetRow\", */ T:-1 },\n0x040B: { /* n:\"BrtSXTupleSetRowItem\" */ },\n0x040C: { /* n:\"BrtNameExt\" */ },\n0x040D: { /* n:\"BrtPCDH14\" */ },\n0x040E: { /* n:\"BrtBeginPCDCalcMem14\", */ T:1 },\n0x040F: { /* n:\"BrtEndPCDCalcMem14\", */ T:-1 },\n0x0410: { /* n:\"BrtSXTH14\" */ },\n0x0411: { /* n:\"BrtBeginSparklineGroup\", */ T:1 },\n0x0412: { /* n:\"BrtEndSparklineGroup\", */ T:-1 },\n0x0413: { /* n:\"BrtSparkline\" */ },\n0x0414: { /* n:\"BrtSXDI14\" */ },\n0x0415: { /* n:\"BrtWsFmtInfoEx14\" */ },\n0x0416: { /* n:\"BrtBeginConditionalFormatting14\", */ T:1 },\n0x0417: { /* n:\"BrtEndConditionalFormatting14\", */ T:-1 },\n0x0418: { /* n:\"BrtBeginCFRule14\", */ T:1 },\n0x0419: { /* n:\"BrtEndCFRule14\", */ T:-1 },\n0x041A: { /* n:\"BrtCFVO14\" */ },\n0x041B: { /* n:\"BrtBeginDatabar14\", */ T:1 },\n0x041C: { /* n:\"BrtBeginIconSet14\", */ T:1 },\n0x041D: { /* n:\"BrtDVal14\", */ f: parse_BrtDVal14 },\n0x041E: { /* n:\"BrtBeginDVals14\", */ T:1 },\n0x041F: { /* n:\"BrtColor14\" */ },\n0x0420: { /* n:\"BrtBeginSparklines\", */ T:1 },\n0x0421: { /* n:\"BrtEndSparklines\", */ T:-1 },\n0x0422: { /* n:\"BrtBeginSparklineGroups\", */ T:1 },\n0x0423: { /* n:\"BrtEndSparklineGroups\", */ T:-1 },\n0x0425: { /* n:\"BrtSXVD14\" */ },\n0x0426: { /* n:\"BrtBeginSXView14\", */ T:1 },\n0x0427: { /* n:\"BrtEndSXView14\", */ T:-1 },\n0x0428: { /* n:\"BrtBeginSXView16\", */ T:1 },\n0x0429: { /* n:\"BrtEndSXView16\", */ T:-1 },\n0x042A: { /* n:\"BrtBeginPCD14\", */ T:1 },\n0x042B: { /* n:\"BrtEndPCD14\", */ T:-1 },\n0x042C: { /* n:\"BrtBeginExtConn14\", */ T:1 },\n0x042D: { /* n:\"BrtEndExtConn14\", */ T:-1 },\n0x042E: { /* n:\"BrtBeginSlicerCacheIDs\", */ T:1 },\n0x042F: { /* n:\"BrtEndSlicerCacheIDs\", */ T:-1 },\n0x0430: { /* n:\"BrtBeginSlicerCacheID\", */ T:1 },\n0x0431: { /* n:\"BrtEndSlicerCacheID\", */ T:-1 },\n0x0433: { /* n:\"BrtBeginSlicerCache\", */ T:1 },\n0x0434: { /* n:\"BrtEndSlicerCache\", */ T:-1 },\n0x0435: { /* n:\"BrtBeginSlicerCacheDef\", */ T:1 },\n0x0436: { /* n:\"BrtEndSlicerCacheDef\", */ T:-1 },\n0x0437: { /* n:\"BrtBeginSlicersEx\", */ T:1 },\n0x0438: { /* n:\"BrtEndSlicersEx\", */ T:-1 },\n0x0439: { /* n:\"BrtBeginSlicerEx\", */ T:1 },\n0x043A: { /* n:\"BrtEndSlicerEx\", */ T:-1 },\n0x043B: { /* n:\"BrtBeginSlicer\", */ T:1 },\n0x043C: { /* n:\"BrtEndSlicer\", */ T:-1 },\n0x043D: { /* n:\"BrtSlicerCachePivotTables\" */ },\n0x043E: { /* n:\"BrtBeginSlicerCacheOlapImpl\", */ T:1 },\n0x043F: { /* n:\"BrtEndSlicerCacheOlapImpl\", */ T:-1 },\n0x0440: { /* n:\"BrtBeginSlicerCacheLevelsData\", */ T:1 },\n0x0441: { /* n:\"BrtEndSlicerCacheLevelsData\", */ T:-1 },\n0x0442: { /* n:\"BrtBeginSlicerCacheLevelData\", */ T:1 },\n0x0443: { /* n:\"BrtEndSlicerCacheLevelData\", */ T:-1 },\n0x0444: { /* n:\"BrtBeginSlicerCacheSiRanges\", */ T:1 },\n0x0445: { /* n:\"BrtEndSlicerCacheSiRanges\", */ T:-1 },\n0x0446: { /* n:\"BrtBeginSlicerCacheSiRange\", */ T:1 },\n0x0447: { /* n:\"BrtEndSlicerCacheSiRange\", */ T:-1 },\n0x0448: { /* n:\"BrtSlicerCacheOlapItem\" */ },\n0x0449: { /* n:\"BrtBeginSlicerCacheSelections\", */ T:1 },\n0x044A: { /* n:\"BrtSlicerCacheSelection\" */ },\n0x044B: { /* n:\"BrtEndSlicerCacheSelections\", */ T:-1 },\n0x044C: { /* n:\"BrtBeginSlicerCacheNative\", */ T:1 },\n0x044D: { /* n:\"BrtEndSlicerCacheNative\", */ T:-1 },\n0x044E: { /* n:\"BrtSlicerCacheNativeItem\" */ },\n0x044F: { /* n:\"BrtRangeProtection14\" */ },\n0x0450: { /* n:\"BrtRangeProtectionIso14\" */ },\n0x0451: { /* n:\"BrtCellIgnoreEC14\" */ },\n0x0457: { /* n:\"BrtList14\" */ },\n0x0458: { /* n:\"BrtCFIcon\" */ },\n0x0459: { /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */ T:1 },\n0x045A: { /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */ T:-1 },\n0x045B: { /* n:\"BrtBeginSlicers\", */ T:1 },\n0x045C: { /* n:\"BrtEndSlicers\", */ T:-1 },\n0x045D: { /* n:\"BrtWbProp14\" */ },\n0x045E: { /* n:\"BrtBeginSXEdit\", */ T:1 },\n0x045F: { /* n:\"BrtEndSXEdit\", */ T:-1 },\n0x0460: { /* n:\"BrtBeginSXEdits\", */ T:1 },\n0x0461: { /* n:\"BrtEndSXEdits\", */ T:-1 },\n0x0462: { /* n:\"BrtBeginSXChange\", */ T:1 },\n0x0463: { /* n:\"BrtEndSXChange\", */ T:-1 },\n0x0464: { /* n:\"BrtBeginSXChanges\", */ T:1 },\n0x0465: { /* n:\"BrtEndSXChanges\", */ T:-1 },\n0x0466: { /* n:\"BrtSXTupleItems\" */ },\n0x0468: { /* n:\"BrtBeginSlicerStyle\", */ T:1 },\n0x0469: { /* n:\"BrtEndSlicerStyle\", */ T:-1 },\n0x046A: { /* n:\"BrtSlicerStyleElement\" */ },\n0x046B: { /* n:\"BrtBeginStyleSheetExt14\", */ T:1 },\n0x046C: { /* n:\"BrtEndStyleSheetExt14\", */ T:-1 },\n0x046D: { /* n:\"BrtBeginSlicerCachesPivotCacheID\", */ T:1 },\n0x046E: { /* n:\"BrtEndSlicerCachesPivotCacheID\", */ T:-1 },\n0x046F: { /* n:\"BrtBeginConditionalFormattings\", */ T:1 },\n0x0470: { /* n:\"BrtEndConditionalFormattings\", */ T:-1 },\n0x0471: { /* n:\"BrtBeginPCDCalcMemExt\", */ T:1 },\n0x0472: { /* n:\"BrtEndPCDCalcMemExt\", */ T:-1 },\n0x0473: { /* n:\"BrtBeginPCDCalcMemsExt\", */ T:1 },\n0x0474: { /* n:\"BrtEndPCDCalcMemsExt\", */ T:-1 },\n0x0475: { /* n:\"BrtPCDField14\" */ },\n0x0476: { /* n:\"BrtBeginSlicerStyles\", */ T:1 },\n0x0477: { /* n:\"BrtEndSlicerStyles\", */ T:-1 },\n0x0478: { /* n:\"BrtBeginSlicerStyleElements\", */ T:1 },\n0x0479: { /* n:\"BrtEndSlicerStyleElements\", */ T:-1 },\n0x047A: { /* n:\"BrtCFRuleExt\" */ },\n0x047B: { /* n:\"BrtBeginSXCondFmt14\", */ T:1 },\n0x047C: { /* n:\"BrtEndSXCondFmt14\", */ T:-1 },\n0x047D: { /* n:\"BrtBeginSXCondFmts14\", */ T:1 },\n0x047E: { /* n:\"BrtEndSXCondFmts14\", */ T:-1 },\n0x0480: { /* n:\"BrtBeginSortCond14\", */ T:1 },\n0x0481: { /* n:\"BrtEndSortCond14\", */ T:-1 },\n0x0482: { /* n:\"BrtEndDVals14\", */ T:-1 },\n0x0483: { /* n:\"BrtEndIconSet14\", */ T:-1 },\n0x0484: { /* n:\"BrtEndDatabar14\", */ T:-1 },\n0x0485: { /* n:\"BrtBeginColorScale14\", */ T:1 },\n0x0486: { /* n:\"BrtEndColorScale14\", */ T:-1 },\n0x0487: { /* n:\"BrtBeginSxrules14\", */ T:1 },\n0x0488: { /* n:\"BrtEndSxrules14\", */ T:-1 },\n0x0489: { /* n:\"BrtBeginPRule14\", */ T:1 },\n0x048A: { /* n:\"BrtEndPRule14\", */ T:-1 },\n0x048B: { /* n:\"BrtBeginPRFilters14\", */ T:1 },\n0x048C: { /* n:\"BrtEndPRFilters14\", */ T:-1 },\n0x048D: { /* n:\"BrtBeginPRFilter14\", */ T:1 },\n0x048E: { /* n:\"BrtEndPRFilter14\", */ T:-1 },\n0x048F: { /* n:\"BrtBeginPRFItem14\", */ T:1 },\n0x0490: { /* n:\"BrtEndPRFItem14\", */ T:-1 },\n0x0491: { /* n:\"BrtBeginCellIgnoreECs14\", */ T:1 },\n0x0492: { /* n:\"BrtEndCellIgnoreECs14\", */ T:-1 },\n0x0493: { /* n:\"BrtDxf14\" */ },\n0x0494: { /* n:\"BrtBeginDxF14s\", */ T:1 },\n0x0495: { /* n:\"BrtEndDxf14s\", */ T:-1 },\n0x0499: { /* n:\"BrtFilter14\" */ },\n0x049A: { /* n:\"BrtBeginCustomFilters14\", */ T:1 },\n0x049C: { /* n:\"BrtCustomFilter14\" */ },\n0x049D: { /* n:\"BrtIconFilter14\" */ },\n0x049E: { /* n:\"BrtPivotCacheConnectionName\" */ },\n0x0800: { /* n:\"BrtBeginDecoupledPivotCacheIDs\", */ T:1 },\n0x0801: { /* n:\"BrtEndDecoupledPivotCacheIDs\", */ T:-1 },\n0x0802: { /* n:\"BrtDecoupledPivotCacheID\" */ },\n0x0803: { /* n:\"BrtBeginPivotTableRefs\", */ T:1 },\n0x0804: { /* n:\"BrtEndPivotTableRefs\", */ T:-1 },\n0x0805: { /* n:\"BrtPivotTableRef\" */ },\n0x0806: { /* n:\"BrtSlicerCacheBookPivotTables\" */ },\n0x0807: { /* n:\"BrtBeginSxvcells\", */ T:1 },\n0x0808: { /* n:\"BrtEndSxvcells\", */ T:-1 },\n0x0809: { /* n:\"BrtBeginSxRow\", */ T:1 },\n0x080A: { /* n:\"BrtEndSxRow\", */ T:-1 },\n0x080C: { /* n:\"BrtPcdCalcMem15\" */ },\n0x0813: { /* n:\"BrtQsi15\" */ },\n0x0814: { /* n:\"BrtBeginWebExtensions\", */ T:1 },\n0x0815: { /* n:\"BrtEndWebExtensions\", */ T:-1 },\n0x0816: { /* n:\"BrtWebExtension\" */ },\n0x0817: { /* n:\"BrtAbsPath15\" */ },\n0x0818: { /* n:\"BrtBeginPivotTableUISettings\", */ T:1 },\n0x0819: { /* n:\"BrtEndPivotTableUISettings\", */ T:-1 },\n0x081B: { /* n:\"BrtTableSlicerCacheIDs\" */ },\n0x081C: { /* n:\"BrtTableSlicerCacheID\" */ },\n0x081D: { /* n:\"BrtBeginTableSlicerCache\", */ T:1 },\n0x081E: { /* n:\"BrtEndTableSlicerCache\", */ T:-1 },\n0x081F: { /* n:\"BrtSxFilter15\" */ },\n0x0820: { /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */ T:1 },\n0x0821: { /* n:\"BrtEndTimelineCachePivotCacheIDs\", */ T:-1 },\n0x0822: { /* n:\"BrtTimelineCachePivotCacheID\" */ },\n0x0823: { /* n:\"BrtBeginTimelineCacheIDs\", */ T:1 },\n0x0824: { /* n:\"BrtEndTimelineCacheIDs\", */ T:-1 },\n0x0825: { /* n:\"BrtBeginTimelineCacheID\", */ T:1 },\n0x0826: { /* n:\"BrtEndTimelineCacheID\", */ T:-1 },\n0x0827: { /* n:\"BrtBeginTimelinesEx\", */ T:1 },\n0x0828: { /* n:\"BrtEndTimelinesEx\", */ T:-1 },\n0x0829: { /* n:\"BrtBeginTimelineEx\", */ T:1 },\n0x082A: { /* n:\"BrtEndTimelineEx\", */ T:-1 },\n0x082B: { /* n:\"BrtWorkBookPr15\" */ },\n0x082C: { /* n:\"BrtPCDH15\" */ },\n0x082D: { /* n:\"BrtBeginTimelineStyle\", */ T:1 },\n0x082E: { /* n:\"BrtEndTimelineStyle\", */ T:-1 },\n0x082F: { /* n:\"BrtTimelineStyleElement\" */ },\n0x0830: { /* n:\"BrtBeginTimelineStylesheetExt15\", */ T:1 },\n0x0831: { /* n:\"BrtEndTimelineStylesheetExt15\", */ T:-1 },\n0x0832: { /* n:\"BrtBeginTimelineStyles\", */ T:1 },\n0x0833: { /* n:\"BrtEndTimelineStyles\", */ T:-1 },\n0x0834: { /* n:\"BrtBeginTimelineStyleElements\", */ T:1 },\n0x0835: { /* n:\"BrtEndTimelineStyleElements\", */ T:-1 },\n0x0836: { /* n:\"BrtDxf15\" */ },\n0x0837: { /* n:\"BrtBeginDxfs15\", */ T:1 },\n0x0838: { /* n:\"BrtEndDxfs15\", */ T:-1 },\n0x0839: { /* n:\"BrtSlicerCacheHideItemsWithNoData\" */ },\n0x083A: { /* n:\"BrtBeginItemUniqueNames\", */ T:1 },\n0x083B: { /* n:\"BrtEndItemUniqueNames\", */ T:-1 },\n0x083C: { /* n:\"BrtItemUniqueName\" */ },\n0x083D: { /* n:\"BrtBeginExtConn15\", */ T:1 },\n0x083E: { /* n:\"BrtEndExtConn15\", */ T:-1 },\n0x083F: { /* n:\"BrtBeginOledbPr15\", */ T:1 },\n0x0840: { /* n:\"BrtEndOledbPr15\", */ T:-1 },\n0x0841: { /* n:\"BrtBeginDataFeedPr15\", */ T:1 },\n0x0842: { /* n:\"BrtEndDataFeedPr15\", */ T:-1 },\n0x0843: { /* n:\"BrtTextPr15\" */ },\n0x0844: { /* n:\"BrtRangePr15\" */ },\n0x0845: { /* n:\"BrtDbCommand15\" */ },\n0x0846: { /* n:\"BrtBeginDbTables15\", */ T:1 },\n0x0847: { /* n:\"BrtEndDbTables15\", */ T:-1 },\n0x0848: { /* n:\"BrtDbTable15\" */ },\n0x0849: { /* n:\"BrtBeginDataModel\", */ T:1 },\n0x084A: { /* n:\"BrtEndDataModel\", */ T:-1 },\n0x084B: { /* n:\"BrtBeginModelTables\", */ T:1 },\n0x084C: { /* n:\"BrtEndModelTables\", */ T:-1 },\n0x084D: { /* n:\"BrtModelTable\" */ },\n0x084E: { /* n:\"BrtBeginModelRelationships\", */ T:1 },\n0x084F: { /* n:\"BrtEndModelRelationships\", */ T:-1 },\n0x0850: { /* n:\"BrtModelRelationship\" */ },\n0x0851: { /* n:\"BrtBeginECTxtWiz15\", */ T:1 },\n0x0852: { /* n:\"BrtEndECTxtWiz15\", */ T:-1 },\n0x0853: { /* n:\"BrtBeginECTWFldInfoLst15\", */ T:1 },\n0x0854: { /* n:\"BrtEndECTWFldInfoLst15\", */ T:-1 },\n0x0855: { /* n:\"BrtBeginECTWFldInfo15\", */ T:1 },\n0x0856: { /* n:\"BrtFieldListActiveItem\" */ },\n0x0857: { /* n:\"BrtPivotCacheIdVersion\" */ },\n0x0858: { /* n:\"BrtSXDI15\" */ },\n0x0859: { /* n:\"BrtBeginModelTimeGroupings\", */ T:1 },\n0x085A: { /* n:\"BrtEndModelTimeGroupings\", */ T:-1 },\n0x085B: { /* n:\"BrtBeginModelTimeGrouping\", */ T:1 },\n0x085C: { /* n:\"BrtEndModelTimeGrouping\", */ T:-1 },\n0x085D: { /* n:\"BrtModelTimeGroupingCalcCol\" */ },\n0x0C00: { /* n:\"BrtUid\" */ },\n0x0C01: { /* n:\"BrtRevisionPtr\" */ },\n0x1000: { /* n:\"BrtBeginDynamicArrayPr\", */ T:1 },\n0x1001: { /* n:\"BrtEndDynamicArrayPr\", */ T:-1 },\n0x138A: { /* n:\"BrtBeginRichValueBlock\", */ T:1 },\n0x138B: { /* n:\"BrtEndRichValueBlock\", */ T:-1 },\n0x13D9: { /* n:\"BrtBeginRichFilters\", */ T:1 },\n0x13DA: { /* n:\"BrtEndRichFilters\", */ T:-1 },\n0x13DB: { /* n:\"BrtRichFilter\" */ },\n0x13DC: { /* n:\"BrtBeginRichFilterColumn\", */ T:1 },\n0x13DD: { /* n:\"BrtEndRichFilterColumn\", */ T:-1 },\n0x13DE: { /* n:\"BrtBeginCustomRichFilters\", */ T:1 },\n0x13DF: { /* n:\"BrtEndCustomRichFilters\", */ T:-1 },\n0x13E0: { /* n:\"BrtCustomRichFilter\" */ },\n0x13E1: { /* n:\"BrtTop10RichFilter\" */ },\n0x13E2: { /* n:\"BrtDynamicRichFilter\" */ },\n0x13E4: { /* n:\"BrtBeginRichSortCondition\", */ T:1 },\n0x13E5: { /* n:\"BrtEndRichSortCondition\", */ T:-1 },\n0x13E6: { /* n:\"BrtRichFilterDateGroupItem\" */ },\n0x13E7: { /* n:\"BrtBeginCalcFeatures\", */ T:1 },\n0x13E8: { /* n:\"BrtEndCalcFeatures\", */ T:-1 },\n0x13E9: { /* n:\"BrtCalcFeature\" */ },\n0x13EB: { /* n:\"BrtExternalLinksPr\" */ },\n0xFFFF: { n:\"\" }\n};\n\n/* [MS-XLS] 2.3 Record Enumeration (and other sources) */\nvar XLSRecordEnum = {\n\t/* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n0x0006: { /* n:\"Formula\", */ f:parse_Formula },\n0x000a: { /* n:\"EOF\", */ f:parsenoop2 },\n0x000c: { /* n:\"CalcCount\", */ f:parseuint16 }, //\n0x000d: { /* n:\"CalcMode\", */ f:parseuint16 }, //\n0x000e: { /* n:\"CalcPrecision\", */ f:parsebool }, //\n0x000f: { /* n:\"CalcRefMode\", */ f:parsebool }, //\n0x0010: { /* n:\"CalcDelta\", */ f:parse_Xnum }, //\n0x0011: { /* n:\"CalcIter\", */ f:parsebool }, //\n0x0012: { /* n:\"Protect\", */ f:parsebool },\n0x0013: { /* n:\"Password\", */ f:parseuint16 },\n0x0014: { /* n:\"Header\", */ f:parse_XLHeaderFooter },\n0x0015: { /* n:\"Footer\", */ f:parse_XLHeaderFooter },\n0x0017: { /* n:\"ExternSheet\", */ f:parse_ExternSheet },\n0x0018: { /* n:\"Lbl\", */ f:parse_Lbl },\n0x0019: { /* n:\"WinProtect\", */ f:parsebool },\n0x001a: { /* n:\"VerticalPageBreaks\", */ },\n0x001b: { /* n:\"HorizontalPageBreaks\", */ },\n0x001c: { /* n:\"Note\", */ f:parse_Note },\n0x001d: { /* n:\"Selection\", */ },\n0x0022: { /* n:\"Date1904\", */ f:parsebool },\n0x0023: { /* n:\"ExternName\", */ f:parse_ExternName },\n0x0026: { /* n:\"LeftMargin\", */ f:parse_Xnum }, // *\n0x0027: { /* n:\"RightMargin\", */ f:parse_Xnum }, // *\n0x0028: { /* n:\"TopMargin\", */ f:parse_Xnum }, // *\n0x0029: { /* n:\"BottomMargin\", */ f:parse_Xnum }, // *\n0x002a: { /* n:\"PrintRowCol\", */ f:parsebool },\n0x002b: { /* n:\"PrintGrid\", */ f:parsebool },\n0x002f: { /* n:\"FilePass\", */ f:parse_FilePass },\n0x0031: { /* n:\"Font\", */ f:parse_Font },\n0x0033: { /* n:\"PrintSize\", */ f:parseuint16 },\n0x003c: { /* n:\"Continue\", */ },\n0x003d: { /* n:\"Window1\", */ f:parse_Window1 },\n0x0040: { /* n:\"Backup\", */ f:parsebool },\n0x0041: { /* n:\"Pane\", */ f:parse_Pane },\n0x0042: { /* n:\"CodePage\", */ f:parseuint16 },\n0x004d: { /* n:\"Pls\", */ },\n0x0050: { /* n:\"DCon\", */ },\n0x0051: { /* n:\"DConRef\", */ },\n0x0052: { /* n:\"DConName\", */ },\n0x0055: { /* n:\"DefColWidth\", */ f:parseuint16 },\n0x0059: { /* n:\"XCT\", */ },\n0x005a: { /* n:\"CRN\", */ },\n0x005b: { /* n:\"FileSharing\", */ },\n0x005c: { /* n:\"WriteAccess\", */ f:parse_WriteAccess },\n0x005d: { /* n:\"Obj\", */ f:parse_Obj },\n0x005e: { /* n:\"Uncalced\", */ },\n0x005f: { /* n:\"CalcSaveRecalc\", */ f:parsebool }, //\n0x0060: { /* n:\"Template\", */ },\n0x0061: { /* n:\"Intl\", */ },\n0x0063: { /* n:\"ObjProtect\", */ f:parsebool },\n0x007d: { /* n:\"ColInfo\", */ f:parse_ColInfo },\n0x0080: { /* n:\"Guts\", */ f:parse_Guts },\n0x0081: { /* n:\"WsBool\", */ f:parse_WsBool },\n0x0082: { /* n:\"GridSet\", */ f:parseuint16 },\n0x0083: { /* n:\"HCenter\", */ f:parsebool },\n0x0084: { /* n:\"VCenter\", */ f:parsebool },\n0x0085: { /* n:\"BoundSheet8\", */ f:parse_BoundSheet8 },\n0x0086: { /* n:\"WriteProtect\", */ },\n0x008c: { /* n:\"Country\", */ f:parse_Country },\n0x008d: { /* n:\"HideObj\", */ f:parseuint16 },\n0x0090: { /* n:\"Sort\", */ },\n0x0092: { /* n:\"Palette\", */ f:parse_Palette },\n0x0097: { /* n:\"Sync\", */ },\n0x0098: { /* n:\"LPr\", */ },\n0x0099: { /* n:\"DxGCol\", */ },\n0x009a: { /* n:\"FnGroupName\", */ },\n0x009b: { /* n:\"FilterMode\", */ },\n0x009c: { /* n:\"BuiltInFnGroupCount\", */ f:parseuint16 },\n0x009d: { /* n:\"AutoFilterInfo\", */ },\n0x009e: { /* n:\"AutoFilter\", */ },\n0x00a0: { /* n:\"Scl\", */ f:parse_Scl },\n0x00a1: { /* n:\"Setup\", */ f:parse_Setup },\n0x00ae: { /* n:\"ScenMan\", */ },\n0x00af: { /* n:\"SCENARIO\", */ },\n0x00b0: { /* n:\"SxView\", */ },\n0x00b1: { /* n:\"Sxvd\", */ },\n0x00b2: { /* n:\"SXVI\", */ },\n0x00b4: { /* n:\"SxIvd\", */ },\n0x00b5: { /* n:\"SXLI\", */ },\n0x00b6: { /* n:\"SXPI\", */ },\n0x00b8: { /* n:\"DocRoute\", */ },\n0x00b9: { /* n:\"RecipName\", */ },\n0x00bd: { /* n:\"MulRk\", */ f:parse_MulRk },\n0x00be: { /* n:\"MulBlank\", */ f:parse_MulBlank },\n0x00c1: { /* n:\"Mms\", */ f:parsenoop2 },\n0x00c5: { /* n:\"SXDI\", */ },\n0x00c6: { /* n:\"SXDB\", */ },\n0x00c7: { /* n:\"SXFDB\", */ },\n0x00c8: { /* n:\"SXDBB\", */ },\n0x00c9: { /* n:\"SXNum\", */ },\n0x00ca: { /* n:\"SxBool\", */ f:parsebool },\n0x00cb: { /* n:\"SxErr\", */ },\n0x00cc: { /* n:\"SXInt\", */ },\n0x00cd: { /* n:\"SXString\", */ },\n0x00ce: { /* n:\"SXDtr\", */ },\n0x00cf: { /* n:\"SxNil\", */ },\n0x00d0: { /* n:\"SXTbl\", */ },\n0x00d1: { /* n:\"SXTBRGIITM\", */ },\n0x00d2: { /* n:\"SxTbpg\", */ },\n0x00d3: { /* n:\"ObProj\", */ },\n0x00d5: { /* n:\"SXStreamID\", */ },\n0x00d7: { /* n:\"DBCell\", */ },\n0x00d8: { /* n:\"SXRng\", */ },\n0x00d9: { /* n:\"SxIsxoper\", */ },\n0x00da: { /* n:\"BookBool\", */ f:parseuint16 },\n0x00dc: { /* n:\"DbOrParamQry\", */ },\n0x00dd: { /* n:\"ScenarioProtect\", */ f:parsebool },\n0x00de: { /* n:\"OleObjectSize\", */ },\n0x00e0: { /* n:\"XF\", */ f:parse_XF },\n0x00e1: { /* n:\"InterfaceHdr\", */ f:parse_InterfaceHdr },\n0x00e2: { /* n:\"InterfaceEnd\", */ f:parsenoop2 },\n0x00e3: { /* n:\"SXVS\", */ },\n0x00e5: { /* n:\"MergeCells\", */ f:parse_MergeCells },\n0x00e9: { /* n:\"BkHim\", */ },\n0x00eb: { /* n:\"MsoDrawingGroup\", */ },\n0x00ec: { /* n:\"MsoDrawing\", */ },\n0x00ed: { /* n:\"MsoDrawingSelection\", */ },\n0x00ef: { /* n:\"PhoneticInfo\", */ },\n0x00f0: { /* n:\"SxRule\", */ },\n0x00f1: { /* n:\"SXEx\", */ },\n0x00f2: { /* n:\"SxFilt\", */ },\n0x00f4: { /* n:\"SxDXF\", */ },\n0x00f5: { /* n:\"SxItm\", */ },\n0x00f6: { /* n:\"SxName\", */ },\n0x00f7: { /* n:\"SxSelect\", */ },\n0x00f8: { /* n:\"SXPair\", */ },\n0x00f9: { /* n:\"SxFmla\", */ },\n0x00fb: { /* n:\"SxFormat\", */ },\n0x00fc: { /* n:\"SST\", */ f:parse_SST },\n0x00fd: { /* n:\"LabelSst\", */ f:parse_LabelSst },\n0x00ff: { /* n:\"ExtSST\", */ f:parse_ExtSST },\n0x0100: { /* n:\"SXVDEx\", */ },\n0x0103: { /* n:\"SXFormula\", */ },\n0x0122: { /* n:\"SXDBEx\", */ },\n0x0137: { /* n:\"RRDInsDel\", */ },\n0x0138: { /* n:\"RRDHead\", */ },\n0x013b: { /* n:\"RRDChgCell\", */ },\n0x013d: { /* n:\"RRTabId\", */ f:parseuint16a },\n0x013e: { /* n:\"RRDRenSheet\", */ },\n0x013f: { /* n:\"RRSort\", */ },\n0x0140: { /* n:\"RRDMove\", */ },\n0x014a: { /* n:\"RRFormat\", */ },\n0x014b: { /* n:\"RRAutoFmt\", */ },\n0x014d: { /* n:\"RRInsertSh\", */ },\n0x014e: { /* n:\"RRDMoveBegin\", */ },\n0x014f: { /* n:\"RRDMoveEnd\", */ },\n0x0150: { /* n:\"RRDInsDelBegin\", */ },\n0x0151: { /* n:\"RRDInsDelEnd\", */ },\n0x0152: { /* n:\"RRDConflict\", */ },\n0x0153: { /* n:\"RRDDefName\", */ },\n0x0154: { /* n:\"RRDRstEtxp\", */ },\n0x015f: { /* n:\"LRng\", */ },\n0x0160: { /* n:\"UsesELFs\", */ f:parsebool },\n0x0161: { /* n:\"DSF\", */ f:parsenoop2 },\n0x0191: { /* n:\"CUsr\", */ },\n0x0192: { /* n:\"CbUsr\", */ },\n0x0193: { /* n:\"UsrInfo\", */ },\n0x0194: { /* n:\"UsrExcl\", */ },\n0x0195: { /* n:\"FileLock\", */ },\n0x0196: { /* n:\"RRDInfo\", */ },\n0x0197: { /* n:\"BCUsrs\", */ },\n0x0198: { /* n:\"UsrChk\", */ },\n0x01a9: { /* n:\"UserBView\", */ },\n0x01aa: { /* n:\"UserSViewBegin\", */ },\n0x01ab: { /* n:\"UserSViewEnd\", */ },\n0x01ac: { /* n:\"RRDUserView\", */ },\n0x01ad: { /* n:\"Qsi\", */ },\n0x01ae: { /* n:\"SupBook\", */ f:parse_SupBook },\n0x01af: { /* n:\"Prot4Rev\", */ f:parsebool },\n0x01b0: { /* n:\"CondFmt\", */ },\n0x01b1: { /* n:\"CF\", */ },\n0x01b2: { /* n:\"DVal\", */ },\n0x01b5: { /* n:\"DConBin\", */ },\n0x01b6: { /* n:\"TxO\", */ f:parse_TxO },\n0x01b7: { /* n:\"RefreshAll\", */ f:parsebool }, //\n0x01b8: { /* n:\"HLink\", */ f:parse_HLink },\n0x01b9: { /* n:\"Lel\", */ },\n0x01ba: { /* n:\"CodeName\", */ f:parse_XLUnicodeString },\n0x01bb: { /* n:\"SXFDBType\", */ },\n0x01bc: { /* n:\"Prot4RevPass\", */ f:parseuint16 },\n0x01bd: { /* n:\"ObNoMacros\", */ },\n0x01be: { /* n:\"Dv\", */ },\n0x01c0: { /* n:\"Excel9File\", */ f:parsenoop2 },\n0x01c1: { /* n:\"RecalcId\", */ f:parse_RecalcId, r:2},\n0x01c2: { /* n:\"EntExU2\", */ f:parsenoop2 },\n0x0200: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n0x0201: { /* n:\"Blank\", */ f:parse_Blank },\n0x0203: { /* n:\"Number\", */ f:parse_Number },\n0x0204: { /* n:\"Label\", */ f:parse_Label },\n0x0205: { /* n:\"BoolErr\", */ f:parse_BoolErr },\n0x0207: { /* n:\"String\", */ f:parse_String },\n0x0208: { /* n:\"Row\", */ f:parse_Row },\n0x020b: { /* n:\"Index\", */ },\n0x0221: { /* n:\"Array\", */ f:parse_Array },\n0x0225: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n0x0236: { /* n:\"Table\", */ },\n0x023e: { /* n:\"Window2\", */ f:parse_Window2 },\n0x027e: { /* n:\"RK\", */ f:parse_RK },\n0x0293: { /* n:\"Style\", */ },\n0x0418: { /* n:\"BigName\", */ },\n0x041e: { /* n:\"Format\", */ f:parse_Format },\n0x043c: { /* n:\"ContinueBigName\", */ },\n0x04bc: { /* n:\"ShrFmla\", */ f:parse_ShrFmla },\n0x0800: { /* n:\"HLinkTooltip\", */ f:parse_HLinkTooltip },\n0x0801: { /* n:\"WebPub\", */ },\n0x0802: { /* n:\"QsiSXTag\", */ },\n0x0803: { /* n:\"DBQueryExt\", */ },\n0x0804: { /* n:\"ExtString\", */ },\n0x0805: { /* n:\"TxtQry\", */ },\n0x0806: { /* n:\"Qsir\", */ },\n0x0807: { /* n:\"Qsif\", */ },\n0x0808: { /* n:\"RRDTQSIF\", */ },\n0x0809: { /* n:\"BOF\", */ f:parse_BOF },\n0x080a: { /* n:\"OleDbConn\", */ },\n0x080b: { /* n:\"WOpt\", */ },\n0x080c: { /* n:\"SXViewEx\", */ },\n0x080d: { /* n:\"SXTH\", */ },\n0x080e: { /* n:\"SXPIEx\", */ },\n0x080f: { /* n:\"SXVDTEx\", */ },\n0x0810: { /* n:\"SXViewEx9\", */ },\n0x0812: { /* n:\"ContinueFrt\", */ },\n0x0813: { /* n:\"RealTimeData\", */ },\n0x0850: { /* n:\"ChartFrtInfo\", */ },\n0x0851: { /* n:\"FrtWrapper\", */ },\n0x0852: { /* n:\"StartBlock\", */ },\n0x0853: { /* n:\"EndBlock\", */ },\n0x0854: { /* n:\"StartObject\", */ },\n0x0855: { /* n:\"EndObject\", */ },\n0x0856: { /* n:\"CatLab\", */ },\n0x0857: { /* n:\"YMult\", */ },\n0x0858: { /* n:\"SXViewLink\", */ },\n0x0859: { /* n:\"PivotChartBits\", */ },\n0x085a: { /* n:\"FrtFontList\", */ },\n0x0862: { /* n:\"SheetExt\", */ },\n0x0863: { /* n:\"BookExt\", */ r:12},\n0x0864: { /* n:\"SXAddl\", */ },\n0x0865: { /* n:\"CrErr\", */ },\n0x0866: { /* n:\"HFPicture\", */ },\n0x0867: { /* n:\"FeatHdr\", */ f:parsenoop2 },\n0x0868: { /* n:\"Feat\", */ },\n0x086a: { /* n:\"DataLabExt\", */ },\n0x086b: { /* n:\"DataLabExtContents\", */ },\n0x086c: { /* n:\"CellWatch\", */ },\n0x0871: { /* n:\"FeatHdr11\", */ },\n0x0872: { /* n:\"Feature11\", */ },\n0x0874: { /* n:\"DropDownObjIds\", */ },\n0x0875: { /* n:\"ContinueFrt11\", */ },\n0x0876: { /* n:\"DConn\", */ },\n0x0877: { /* n:\"List12\", */ },\n0x0878: { /* n:\"Feature12\", */ },\n0x0879: { /* n:\"CondFmt12\", */ },\n0x087a: { /* n:\"CF12\", */ },\n0x087b: { /* n:\"CFEx\", */ },\n0x087c: { /* n:\"XFCRC\", */ f:parse_XFCRC, r:12 },\n0x087d: { /* n:\"XFExt\", */ f:parse_XFExt, r:12 },\n0x087e: { /* n:\"AutoFilter12\", */ },\n0x087f: { /* n:\"ContinueFrt12\", */ },\n0x0884: { /* n:\"MDTInfo\", */ },\n0x0885: { /* n:\"MDXStr\", */ },\n0x0886: { /* n:\"MDXTuple\", */ },\n0x0887: { /* n:\"MDXSet\", */ },\n0x0888: { /* n:\"MDXProp\", */ },\n0x0889: { /* n:\"MDXKPI\", */ },\n0x088a: { /* n:\"MDB\", */ },\n0x088b: { /* n:\"PLV\", */ },\n0x088c: { /* n:\"Compat12\", */ f:parsebool, r:12 },\n0x088d: { /* n:\"DXF\", */ },\n0x088e: { /* n:\"TableStyles\", */ r:12 },\n0x088f: { /* n:\"TableStyle\", */ },\n0x0890: { /* n:\"TableStyleElement\", */ },\n0x0892: { /* n:\"StyleExt\", */ },\n0x0893: { /* n:\"NamePublish\", */ },\n0x0894: { /* n:\"NameCmt\", */ f:parse_NameCmt, r:12 },\n0x0895: { /* n:\"SortData\", */ },\n0x0896: { /* n:\"Theme\", */ f:parse_Theme, r:12 },\n0x0897: { /* n:\"GUIDTypeLib\", */ },\n0x0898: { /* n:\"FnGrp12\", */ },\n0x0899: { /* n:\"NameFnGrp12\", */ },\n0x089a: { /* n:\"MTRSettings\", */ f:parse_MTRSettings, r:12 },\n0x089b: { /* n:\"CompressPictures\", */ f:parsenoop2 },\n0x089c: { /* n:\"HeaderFooter\", */ },\n0x089d: { /* n:\"CrtLayout12\", */ },\n0x089e: { /* n:\"CrtMlFrt\", */ },\n0x089f: { /* n:\"CrtMlFrtContinue\", */ },\n0x08a3: { /* n:\"ForceFullCalculation\", */ f:parse_ForceFullCalculation },\n0x08a4: { /* n:\"ShapePropsStream\", */ },\n0x08a5: { /* n:\"TextPropsStream\", */ },\n0x08a6: { /* n:\"RichTextStream\", */ },\n0x08a7: { /* n:\"CrtLayout12A\", */ },\n0x1001: { /* n:\"Units\", */ },\n0x1002: { /* n:\"Chart\", */ },\n0x1003: { /* n:\"Series\", */ },\n0x1006: { /* n:\"DataFormat\", */ },\n0x1007: { /* n:\"LineFormat\", */ },\n0x1009: { /* n:\"MarkerFormat\", */ },\n0x100a: { /* n:\"AreaFormat\", */ },\n0x100b: { /* n:\"PieFormat\", */ },\n0x100c: { /* n:\"AttachedLabel\", */ },\n0x100d: { /* n:\"SeriesText\", */ },\n0x1014: { /* n:\"ChartFormat\", */ },\n0x1015: { /* n:\"Legend\", */ },\n0x1016: { /* n:\"SeriesList\", */ },\n0x1017: { /* n:\"Bar\", */ },\n0x1018: { /* n:\"Line\", */ },\n0x1019: { /* n:\"Pie\", */ },\n0x101a: { /* n:\"Area\", */ },\n0x101b: { /* n:\"Scatter\", */ },\n0x101c: { /* n:\"CrtLine\", */ },\n0x101d: { /* n:\"Axis\", */ },\n0x101e: { /* n:\"Tick\", */ },\n0x101f: { /* n:\"ValueRange\", */ },\n0x1020: { /* n:\"CatSerRange\", */ },\n0x1021: { /* n:\"AxisLine\", */ },\n0x1022: { /* n:\"CrtLink\", */ },\n0x1024: { /* n:\"DefaultText\", */ },\n0x1025: { /* n:\"Text\", */ },\n0x1026: { /* n:\"FontX\", */ f:parseuint16 },\n0x1027: { /* n:\"ObjectLink\", */ },\n0x1032: { /* n:\"Frame\", */ },\n0x1033: { /* n:\"Begin\", */ },\n0x1034: { /* n:\"End\", */ },\n0x1035: { /* n:\"PlotArea\", */ },\n0x103a: { /* n:\"Chart3d\", */ },\n0x103c: { /* n:\"PicF\", */ },\n0x103d: { /* n:\"DropBar\", */ },\n0x103e: { /* n:\"Radar\", */ },\n0x103f: { /* n:\"Surf\", */ },\n0x1040: { /* n:\"RadarArea\", */ },\n0x1041: { /* n:\"AxisParent\", */ },\n0x1043: { /* n:\"LegendException\", */ },\n0x1044: { /* n:\"ShtProps\", */ f:parse_ShtProps },\n0x1045: { /* n:\"SerToCrt\", */ },\n0x1046: { /* n:\"AxesUsed\", */ },\n0x1048: { /* n:\"SBaseRef\", */ },\n0x104a: { /* n:\"SerParent\", */ },\n0x104b: { /* n:\"SerAuxTrend\", */ },\n0x104e: { /* n:\"IFmtRecord\", */ },\n0x104f: { /* n:\"Pos\", */ },\n0x1050: { /* n:\"AlRuns\", */ },\n0x1051: { /* n:\"BRAI\", */ },\n0x105b: { /* n:\"SerAuxErrBar\", */ },\n0x105c: { /* n:\"ClrtClient\", */ f:parse_ClrtClient },\n0x105d: { /* n:\"SerFmt\", */ },\n0x105f: { /* n:\"Chart3DBarShape\", */ },\n0x1060: { /* n:\"Fbi\", */ },\n0x1061: { /* n:\"BopPop\", */ },\n0x1062: { /* n:\"AxcExt\", */ },\n0x1063: { /* n:\"Dat\", */ },\n0x1064: { /* n:\"PlotGrowth\", */ },\n0x1065: { /* n:\"SIIndex\", */ },\n0x1066: { /* n:\"GelFrame\", */ },\n0x1067: { /* n:\"BopPopCustom\", */ },\n0x1068: { /* n:\"Fbi2\", */ },\n\n0x0000: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n0x0001: { /* n:\"BIFF2BLANK\", */ },\n0x0002: { /* n:\"BIFF2INT\", */ f:parse_BIFF2INT },\n0x0003: { /* n:\"BIFF2NUM\", */ f:parse_BIFF2NUM },\n0x0004: { /* n:\"BIFF2STR\", */ f:parse_BIFF2STR },\n0x0005: { /* n:\"BIFF2BOOLERR\", */ f:parse_BIFF2BOOLERR },\n0x0007: { /* n:\"String\", */ f:parse_BIFF2STRING },\n0x0008: { /* n:\"BIFF2ROW\", */ },\n0x0009: { /* n:\"BOF\", */ f:parse_BOF },\n0x000b: { /* n:\"Index\", */ },\n0x0016: { /* n:\"ExternCount\", */ f:parseuint16 },\n0x001e: { /* n:\"BIFF2FORMAT\", */ f:parse_BIFF2Format },\n0x001f: { /* n:\"BIFF2FMTCNT\", */ }, /* 16-bit cnt of BIFF2FORMAT records */\n0x0020: { /* n:\"BIFF2COLINFO\", */ },\n0x0021: { /* n:\"Array\", */ f:parse_Array },\n0x0024: { /* n:\"COLWIDTH\", */ },\n0x0025: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n\t// 0x002c ??\n\t// 0x002d ??\n\t// 0x002e ??\n\t// 0x0030 FONTCOUNT: number of fonts\n0x0032: { /* n:\"BIFF2FONTXTRA\", */ f:parse_BIFF2FONTXTRA },\n\t// 0x0035: INFOOPTS\n\t// 0x0036: TABLE (BIFF2 only)\n\t// 0x0037: TABLE2 (BIFF2 only)\n\t// 0x0038: WNDESK\n\t// 0x0039 ??\n\t// 0x003a: BEGINPREF\n\t// 0x003b: ENDPREF\n0x003e: { /* n:\"BIFF2WINDOW2\", */ },\n\t// 0x003f ??\n\t// 0x0046: SHOWSCROLL\n\t// 0x0047: SHOWFORMULA\n\t// 0x0048: STATUSBAR\n\t// 0x0049: SHORTMENUS\n\t// 0x004A:\n\t// 0x004B:\n\t// 0x004C:\n\t// 0x004E:\n\t// 0x004F:\n\t// 0x0058: TOOLBAR (BIFF3)\n\n\t/* - - - */\n0x0034: { /* n:\"DDEObjName\", */ },\n0x0043: { /* n:\"BIFF2XF\", */ f:parse_BIFF2XF },\n0x0044: { /* n:\"BIFF2XFINDEX\", */ f:parseuint16 },\n0x0045: { /* n:\"BIFF2FONTCLR\", */ },\n0x0056: { /* n:\"BIFF4FMTCNT\", */ }, /* 16-bit cnt, similar to BIFF2 */\n0x007e: { /* n:\"RK\", */ }, /* Not necessarily same as 0x027e */\n0x007f: { /* n:\"ImData\", */ f:parse_ImData },\n0x0087: { /* n:\"Addin\", */ },\n0x0088: { /* n:\"Edg\", */ },\n0x0089: { /* n:\"Pub\", */ },\n\t// 0x8A\n\t// 0x8B LH: alternate menu key flag (BIFF3/4)\n\t// 0x8E\n0x008F: { /* n:\"BIFF4SheetInfo\", */ f:parse_BIFF4SheetInfo },\n0x0091: { /* n:\"Sub\", */ },\n\t// 0x93 STYLE\n0x0094: { /* n:\"LHRecord\", */ },\n0x0095: { /* n:\"LHNGraph\", */ },\n0x0096: { /* n:\"Sound\", */ },\n\t// 0xA2 FNPROTO: function prototypes (BIFF4)\n\t// 0xA3\n\t// 0xA8\n0x00a9: { /* n:\"CoordList\", */ },\n0x00ab: { /* n:\"GCW\", */ },\n0x00bc: { /* n:\"ShrFmla\", */ }, /* Not necessarily same as 0x04bc */\n0x00bf: { /* n:\"ToolbarHdr\", */ },\n0x00c0: { /* n:\"ToolbarEnd\", */ },\n0x00c2: { /* n:\"AddMenu\", */ },\n0x00c3: { /* n:\"DelMenu\", */ },\n0x00d6: { /* n:\"RString\", */ f:parse_RString },\n0x00df: { /* n:\"UDDesc\", */ },\n0x00ea: { /* n:\"TabIdConf\", */ },\n0x0162: { /* n:\"XL5Modify\", */ },\n0x01a5: { /* n:\"FileSharing2\", */ },\n0x0206: { /* n:\"Formula\", */ f:parse_Formula },\n0x0209: { /* n:\"BOF\", */ f:parse_BOF },\n0x0218: { /* n:\"Lbl\", */ f:parse_Lbl },\n0x0223: { /* n:\"ExternName\", */ f:parse_ExternName },\n0x0231: { /* n:\"Font\", */ },\n0x0243: { /* n:\"BIFF3XF\", */ f:parse_BIFF3XF },\n0x0406: { /* n:\"Formula\", */ f:parse_Formula },\n0x0409: { /* n:\"BOF\", */ f:parse_BOF },\n0x0443: { /* n:\"BIFF4XF\", */ f:parse_BIFF4XF },\n0x086d: { /* n:\"FeatInfo\", */ },\n0x0873: { /* n:\"FeatInfo11\", */ },\n0x0881: { /* n:\"SXAddl12\", */ },\n0x08c0: { /* n:\"AutoWebPub\", */ },\n0x08c1: { /* n:\"ListObj\", */ },\n0x08c2: { /* n:\"ListField\", */ },\n0x08c3: { /* n:\"ListDV\", */ },\n0x08c4: { /* n:\"ListCondFmt\", */ },\n0x08c5: { /* n:\"ListCF\", */ },\n0x08c6: { /* n:\"FMQry\", */ },\n0x08c7: { /* n:\"FMSQry\", */ },\n0x08c8: { /* n:\"PLV\", */ },\n0x08c9: { /* n:\"LnExt\", */ },\n0x08ca: { /* n:\"MkrExt\", */ },\n0x08cb: { /* n:\"CrtCoopt\", */ },\n0x08d6: { /* n:\"FRTArchId$\", */ r:12 },\n\n\t/* --- multiplan 4 records --- */\n0x0065: { /* n:\"\", */ }, // one per window\n0x0066: { /* n:\"\", */ }, // calc settings\n0x0069: { /* n:\"\", */ }, // print header\n0x006a: { /* n:\"\", */ }, // print footer\n0x006b: { /* n:\"\", */ }, // print settings\n0x006d: { /* n:\"\", */ }, // one per window\n0x0070: { /* n:\"\", */ }, // includes default col width\n0x0072: { /* n:\"\", */ }, // includes selected cell\n\n0x7262: {}\n};\n\nfunction write_biff_rec(ba, type, payload, length) {\n\tvar t = type;\n\tif(isNaN(t)) return;\n\tvar len = length || (payload||[]).length || 0;\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, len);\n\tif(len > 0 && is_buf(payload)) ba.push(payload);\n}\n\nfunction write_biff_continue(ba, type, payload, length) {\n\tvar len = length || (payload||[]).length || 0;\n\tif(len <= 8224) return write_biff_rec(ba, type, payload, len);\n\tvar t = type;\n\tif(isNaN(t)) return;\n\tvar parts = payload.parts || [], sidx = 0;\n\tvar i = 0, w = 0;\n\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, w);\n\tba.push(payload.slice(i, i + w));\n\ti += w;\n\twhile(i < len) {\n\t\to = ba.next(4);\n\t\to.write_shift(2, 0x3c); // TODO: figure out correct continue type\n\t\tw = 0;\n\t\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\t\to.write_shift(2, w);\n\t\tba.push(payload.slice(i, i+w)); i+= w;\n\t}\n}\n\nfunction write_BIFF2BERR(r, c, val, t) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c);\n\twrite_Bes(val, t || 'b', out);\n\treturn out;\n}\n\n/* TODO: codepage, large strings */\nfunction write_BIFF2LABEL(r, c, val) {\n\tvar out = new_buf(8 + 2*val.length);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(1, val.length);\n\tout.write_shift(val.length, val, 'sbcs');\n\treturn out.l < out.length ? out.slice(0, out.l) : out;\n}\n\nfunction write_comments_biff2(ba, comments) {\n\tcomments.forEach(function(data) {\n\t\tvar text = data[0].map(function(cc) { return cc.t; }).join(\"\");\n\t\t// TODO: should '\\n' be translated to '\\r' to correct for Excel 5.0 bug when exporting to BIFF2/3 ?\n\t\tif(text.length <= 2048) return write_biff_rec(ba, 0x001C, write_NOTE_BIFF2(text, data[1], data[2]));\n\t\twrite_biff_rec(ba, 0x001C, write_NOTE_BIFF2(text.slice(0, 2048), data[1], data[2], text.length));\n\t\tfor(var i = 2048; i < text.length; i += 2048)\n\t\t\twrite_biff_rec(ba, 0x001C, write_NOTE_BIFF2(text.slice(i, Math.min(i+2048, text.length)), -1, -1, Math.min(2048, text.length - i)));\n\t});\n}\n\n/* TODO: BIFF3/4 use different records -- see comments*/\nfunction write_ws_biff2_cell(ba, cell, R, C, opts, date1904) {\n\tvar ifmt = 0;\n\tif(cell.z != null) {\n\t\tifmt = opts._BIFF2FmtTable.indexOf(cell.z);\n\t\tif(ifmt == -1) { opts._BIFF2FmtTable.push(cell.z); ifmt = opts._BIFF2FmtTable.length - 1; }\n\t}\n\tvar ixfe = 0;\n\tif(cell.z != null) {\n\t\tfor(; ixfe < opts.cellXfs.length; ++ixfe) if(opts.cellXfs[ixfe].numFmtId == ifmt) break;\n\t\tif(ixfe == opts.cellXfs.length) opts.cellXfs.push({numFmtId: ifmt});\n\t}\n\tif(cell.v != null) switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v, date1904), date1904) : cell.v;\n\t\t\tif(opts.biff == 2 && (v == (v|0)) && (v >= 0) && (v < 65536))\n\t\t\t\t// 0x027E (RK) in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v, ixfe, ifmt));\n\t\t\telse if(isNaN(v))\n\t\t\t\t// 0x0205 in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, 0x24, \"e\")); // #NUM!\n\t\t\telse if(!isFinite(v))\n\t\t\t\t// 0x0205 in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, 0x07, \"e\")); // #DIV/0!\n\t\t\telse\n\t\t\t\t// 0x0203 in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0003, write_BIFF2NUM(R,C, v, ixfe, ifmt));\n\t\t\treturn;\n\t\tcase 'b': case 'e':\n\t\t\t// 0x0205 in BIFF3/4\n\t\t\twrite_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t)); return;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\t// 0x0204 in BIFF3/4\n\t\t\twrite_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, cell.v == null ? \"\" : String(cell.v).slice(0,255)));\n\t\t\treturn;\n\t}\n\t// 0x0201 in BIFF3/4\n\twrite_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\n}\n\nfunction write_ws_biff2(ba, ws, idx, opts, wb) {\n\tvar dense = ws[\"!data\"] != null;\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\n\tif(range.e.c > 0xFF || range.e.r > 0x3FFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.c, 0x3FFF);\n\t}\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\tvar row = [], comments = [];\n\t/* TODO: 0x0000 / 0x0200 dimensions? */\n\tfor(var C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tif(dense) row = ws[\"!data\"][R] || [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tvar cell = dense ? row[C] : ws[cols[C] + rr];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff2_cell(ba, cell, R, C, opts, date1904);\n\t\t\tif(cell.c) comments.push([cell.c, R, C]);\n\t\t}\n\t}\n\n\t/* ... 0x12 0x19 0x13 (Password) */\n\twrite_comments_biff2(ba, comments);\n\t/* 0x3d (Window1) ... */\n}\n\n/* Based on test files */\nfunction write_biff2_buf(wb, opts) {\n\tvar o = opts || {};\n\n\tvar ba = buf_array();\n\tvar idx = 0;\n\tfor(var i=0;i<wb.SheetNames.length;++i) if(wb.SheetNames[i] == o.sheet) idx=i;\n\tif(idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\n\twrite_biff_rec(ba, (o.biff == 4 ? 0x0409 : (o.biff == 3 ? 0x0209 : 0x0009)), write_BOF(wb, 0x10, o));\n\tif(((wb.Workbook||{}).WBProps||{}).date1904) write_biff_rec(ba, 0x0022, writebool(true));\n\to.cellXfs = [{numFmtId: 0}];\n\to._BIFF2FmtTable = [\"General\"]; o._Fonts = [];\n\tvar body = buf_array();\n\twrite_ws_biff2(body, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\n\n\to._BIFF2FmtTable.forEach(function(f) {\n\t\tif(o.biff <= 3) write_biff_rec(ba, 0x001E, write_BIFF2Format(f));\n\t\telse write_biff_rec(ba, 0x041E, write_BIFF4Format(f));\n\t});\n\to.cellXfs.forEach(function(xf) {\n\t\tswitch(o.biff) {\n\t\t\tcase 2: write_biff_rec(ba, 0x0043, write_BIFF2XF(xf)); break;\n\t\t\tcase 3: write_biff_rec(ba, 0x0243, write_BIFF3XF(xf)); break;\n\t\t\tcase 4: write_biff_rec(ba, 0x0443, write_BIFF4XF(xf)); break;\n\t\t}\n\t});\n\tdelete o._BIFF2FmtTable; delete o.cellXfs; delete o._Fonts;\n\n\tba.push(body.end());\n\twrite_biff_rec(ba, 0x000A);\n\treturn ba.end();\n}\n\nvar b8oid = 1, b8ocnts = [];\nfunction write_MsoDrawingGroup() {\n\tvar buf = new_buf(82 + 8 * b8ocnts.length);\n\t/* [MS-ODRAW] 2.2.12 OfficeArtDggContainer */\n\tbuf.write_shift(2, 0x0F);\n\tbuf.write_shift(2, 0xF000);\n\tbuf.write_shift(4, 74 + 8 * b8ocnts.length);\n\t/* 2.2.48 OfficeArtFDGGBlock */\n\t{\n\t\tbuf.write_shift(2, 0);\n\t\tbuf.write_shift(2, 0xF006);\n\t\tbuf.write_shift(4, 16 + 8 * b8ocnts.length);\n\t\t/* 2.2.47 OfficeArtFDGG */\n\t\t{\n\t\t\tbuf.write_shift(4, b8oid);\n\t\t\tbuf.write_shift(4, b8ocnts.length+1);\n\t\t\tvar acc = 0; for(var i = 0; i < b8ocnts.length; ++i) acc += (b8ocnts[i] && b8ocnts[i][1] || 0); buf.write_shift(4, acc);\n\t\t\tbuf.write_shift(4, b8ocnts.length);\n\t\t}\n\t\t/* 2.2.46 OfficeArtIDCL + */\n\t\tb8ocnts.forEach(function(b8) {\n\t\t\tbuf.write_shift(4, b8[0]);\n\t\t\tbuf.write_shift(4, b8[2]);\n\t\t});\n\t}\n\t/* 2.2.9 OfficeArtFOPT */\n\t{\n\t\tbuf.write_shift(2, 0x33); // 0x03 | (3 << 4)\n\t\tbuf.write_shift(2, 0xF00B);\n\t\tbuf.write_shift(4, 0x12); // 3 * 6\n\t\t/* 2.3.21.15 Text Boolean Properties */\n\t\tbuf.write_shift(2, 0xBF); buf.write_shift(4, 0x00080008);\n\t\t/* 2.3.7.2 fillColor */\n\t\tbuf.write_shift(2, 0x0181); buf.write_shift(4, 0x08000041);\n\t\t/* 2.3.8.1 lineColor */\n\t\tbuf.write_shift(2, 0x01C0); buf.write_shift(4, 0x08000040);\n\t}\n\t/* 2.2.45 OfficeArtSplitMenuColorContainer */\n\t{\n\t\tbuf.write_shift(2, 0x40);\n\t\tbuf.write_shift(2, 0xF11E);\n\t\tbuf.write_shift(4, 16);\n\t\tbuf.write_shift(4, 0x0800000D);\n\t\tbuf.write_shift(4, 0x0800000C);\n\t\tbuf.write_shift(4, 0x08000017);\n\t\tbuf.write_shift(4, 0x100000F7);\n\t}\n\treturn buf;\n}\nfunction write_comments_biff8(ba, comments) {\n\tvar notes = [], sz = 0, pl = buf_array(), baseid = b8oid;\n\tvar _oasc;\n\tcomments.forEach(function(c, ci) {\n\t\tvar author = \"\";\n\t\tvar text = c[0].map(function(t) { if(t.a && !author) author = t.a; return t.t; }).join(\"\");\n\t\t++b8oid;\n\n\t\t/* 2.2.14 OfficeArtSpContainer */\n\t\t{\n\t\t\tvar oasc = new_buf(0x96);\n\t\t\toasc.write_shift(2, 0x0F);\n\t\t\toasc.write_shift(2, 0xF004);\n\t\t\toasc.write_shift(4, 0x96);\n\t\t\t/* 2.2.40 OfficeArtFSP */\n\t\t\t{\n\t\t\t\toasc.write_shift(2, 0xca2); // 0x02 | (0xca << 4)\n\t\t\t\toasc.write_shift(2, 0xF00A);\n\t\t\t\toasc.write_shift(4, 8);\n\t\t\t\toasc.write_shift(4, b8oid);\n\t\t\t\toasc.write_shift(4, 0xA00);\n\t\t\t}\n\t\t\t/* 2.2.9 OfficeArtFOPT */\n\t\t\t{\n\t\t\t\toasc.write_shift(2, 0xE3); // 0x03 | (14 << 4)\n\t\t\t\toasc.write_shift(2, 0xF00B);\n\t\t\t\toasc.write_shift(4, 0x54); // 14 * 6\n\t\t\t\t/* 2.3.21.1 ITxid */\n\t\t\t\toasc.write_shift(2, 0x80); oasc.write_shift(4, 0);\n\t\t\t\t/* 2.3.21.12 txdir */\n\t\t\t\toasc.write_shift(2, 0x8B); oasc.write_shift(4, 0x02);\n\t\t\t\t/* 2.3.21.15 Text Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0xBF); oasc.write_shift(4, 0x00080008);\n\t\t\t\t/* 2.3.6.30 cxk */\n\t\t\t\toasc.write_shift(2, 0x0158); oasc.l += 4;\n\t\t\t\t/* 2.3.7.2 fillColor */\n\t\t\t\toasc.write_shift(2, 0x0181); oasc.write_shift(4, 0x08000050);\n\t\t\t\t/* 2.3.7.4 fillBackColor */\n\t\t\t\toasc.write_shift(2, 0x0183); oasc.write_shift(4, 0x08000050);\n\t\t\t\t/* 2.3.7.6 fillCrMod */\n\t\t\t\toasc.write_shift(2, 0x0185); oasc.write_shift(4, 0x100000F4);\n\t\t\t\t/* 2.3.7.43 Fill Style Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0x01BF); oasc.write_shift(4, 0x00100010);\n\t\t\t\t/* 2.3.8.1 lineColor */\n\t\t\t\toasc.write_shift(2, 0x01C0); oasc.write_shift(4, 0x08000051);\n\t\t\t\t/* 2.3.8.4 lineCrMod */\n\t\t\t\toasc.write_shift(2, 0x01C3); oasc.write_shift(4, 0x100000F4);\n\t\t\t\t/* 2.3.13.2 shadowColor */\n\t\t\t\toasc.write_shift(2, 0x0201); oasc.write_shift(4, 0x08000051);\n\t\t\t\t/* 2.3.13.4 shadowCrMod */\n\t\t\t\toasc.write_shift(2, 0x0203); oasc.write_shift(4, 0x100000F4);\n\t\t\t\t/* 2.3.13.23 Shadow Style Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0x023F); oasc.write_shift(4, 0x00030001);\n\t\t\t\t/* 2.3.4.44 Group Shape Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0x03BF); oasc.write_shift(4, 0x00020000 | (c[0].hidden ? 2 : 0));\n\t\t\t}\n\t\t\t/* [MS-XLS] 2.5.193 OfficeArtClientAnchorSheet */\n\t\t\t{\n\t\t\t\toasc.l += 2;\n\t\t\t\toasc.write_shift(2, 0xF010);\n\t\t\t\toasc.write_shift(4, 0x12);\n\t\t\t\toasc.write_shift(2, 0x3); // do not move or size with cells\n\t\t\t\toasc.write_shift(2, c[2] + 2); oasc.l += 2;\n\t\t\t\toasc.write_shift(2, c[1] + 1); oasc.l += 2;\n\t\t\t\toasc.write_shift(2, c[2] + 4); oasc.l += 2;\n\t\t\t\toasc.write_shift(2, c[1] + 5); oasc.l += 2;\n\t\t\t}\n\t\t\t/* [MS-XLS] 2.5.194 OfficeArtClientData */\n\t\t\t{\n\t\t\t\toasc.l += 2;\n\t\t\t\toasc.write_shift(2, 0xF011);\n\t\t\t\toasc.l += 4;\n\t\t\t}\n\t\t\toasc.l = 0x96;\n\t\t\tif(ci == 0) /* write_biff_rec(pl, 0x003C, oasc); */ _oasc = oasc;\n\t\t\telse write_biff_rec(pl, 0x00EC, oasc);\n\t\t}\n\t\tsz += 0x96;\n\n\t\t/* [MS-XLS] 2.4.181 Obj */\n\t\t{\n\t\t\tvar obj = new_buf(52); // 22 + 26 + 4\n\t\t\t/* [MS-XLS] 2.5.143 FtCmo */\n\t\t\tobj.write_shift(2, 0x15);\n\t\t\tobj.write_shift(2, 0x12);\n\t\t\tobj.write_shift(2, 0x19);\n\t\t\tobj.write_shift(2, b8oid);\n\t\t\tobj.write_shift(2, 0);\n\t\t\tobj.l = 22;\n\t\t\t/* [MS-XLS] 2.5.149 FtNts */\n\t\t\tobj.write_shift(2, 0x0D);\n\t\t\tobj.write_shift(2, 0x16);\n\t\t\tobj.write_shift(4, 0x62726272);\n\t\t\tobj.write_shift(4, 0x95374305);\n\t\t\tobj.write_shift(4, 0x80301328);\n\t\t\tobj.write_shift(4, 0x69696904 + b8oid*256);\n\t\t\tobj.write_shift(2,0);\n\t\t\tobj.write_shift(4,0);\n\t\t\t// reserved\n\t\t\tobj.l += 4;\n\t\t\twrite_biff_rec(pl, 0x005D, obj);\n\t\t}\n\n\t\t/* [MS-XLS] 2.5.195 OfficeArtClientTextbox */\n\t\t{\n\t\t\tvar oact = new_buf(8);\n\t\t\toact.l += 2;\n\t\t\toact.write_shift(2, 0xF00D);\n\t\t\toact.l += 4;\n\t\t\twrite_biff_rec(pl, 0x00EC, oact);\n\t\t}\n\t\tsz += 8;\n\n\t\t/* [MS-XLS] 2.4.329 TxO */\n\t\t{\n\t\t\tvar txo = new_buf(18);\n\t\t\ttxo.write_shift(2, 0x12);\n\t\t\ttxo.l += 8;\n\t\t\ttxo.write_shift(2, text.length);\n\t\t\ttxo.write_shift(2, 0x10);\n\t\t\ttxo.l += 4;\n\t\t\twrite_biff_rec(pl, 0x01b6, txo);\n\t\t\t/* text continue record TODO: switch to wide strings */\n\t\t\t{\n\t\t\t\tvar cont = new_buf(1 + text.length);\n\t\t\t\tcont.write_shift(1, 0);\n\t\t\t\tcont.write_shift(text.length, text, \"sbcs\");\n\t\t\t\twrite_biff_rec(pl, 0x003C, cont);\n\t\t\t}\n\t\t\t/* formatting continue records */\n\t\t\t{\n\t\t\t\tvar conf = new_buf(0x10);\n\t\t\t\tconf.l += 8;\n\t\t\t\tconf.write_shift(2, text.length);\n\t\t\t\tconf.l += 6;\n\t\t\t\twrite_biff_rec(pl, 0x003C, conf);\n\t\t\t}\n\t\t}\n\n\t\t/* 2.4.179 Note */\n\t\t{\n\t\t\tvar notesh = new_buf(12 + author.length);\n\t\t\tnotesh.write_shift(2, c[1]);\n\t\t\tnotesh.write_shift(2, c[2]);\n\t\t\tnotesh.write_shift(2, 0 | (c[0].hidden ? 0 : 2));\n\t\t\tnotesh.write_shift(2, b8oid);\n\t\t\tnotesh.write_shift(2, author.length);\n\t\t\tnotesh.write_shift(1, 0);\n\t\t\tnotesh.write_shift(author.length, author, \"sbcs\");\n\t\t\tnotesh.l ++;\n\t\t\tnotes.push(notesh);\n\t\t}\n\t});\n\t/* [MS-ODRAW] 2.2.13 OfficeArtDgContainer */\n\t{\n\t\tvar hdr = new_buf(80);\n\t\thdr.write_shift(2, 0x0F);\n\t\thdr.write_shift(2, 0xF002);\n\t\thdr.write_shift(4, sz + hdr.length - 8);\n\t\t/* [MS-ODRAW] 2.2.49 OfficeArtFDG */\n\t\t{\n\t\t\thdr.write_shift(2, 0x10);\n\t\t\thdr.write_shift(2, 0xF008);\n\t\t\thdr.write_shift(4, 0x08);\n\t\t\thdr.write_shift(4, comments.length + 1);\n\t\t\thdr.write_shift(4, b8oid);\n\t\t}\n\t\t/* [MS-ODRAW] 2.2.16 OfficeArtSpgrContainer */\n\t\t{\n\t\t\thdr.write_shift(2, 0x0f);\n\t\t\thdr.write_shift(2, 0xF003);\n\t\t\thdr.write_shift(4, sz + 0x30);\n\t\t\t/* [MS-ODRAW] 2.2.14 OfficeArtSpContainer */\n\t\t\t{\n\t\t\t\thdr.write_shift(2, 0x0f);\n\t\t\t\thdr.write_shift(2, 0xF004);\n\t\t\t\thdr.write_shift(4, 0x28);\n\t\t\t\t/* [MS-ODRAW] 2.2.38 OfficeArtFSPGR */\n\t\t\t\t{\n\t\t\t\t\thdr.write_shift(2, 0x01);\n\t\t\t\t\thdr.write_shift(2, 0xF009);\n\t\t\t\t\thdr.write_shift(4, 0x10);\n\t\t\t\t\thdr.l += 16;\n\t\t\t\t}\n\t\t\t\t/* [MS-ODRAW] 2.2.40 OfficeArtFSP */\n\t\t\t\t{\n\t\t\t\t\thdr.write_shift(2, 0x02);\n\t\t\t\t\thdr.write_shift(2, 0xF00A);\n\t\t\t\t\thdr.write_shift(4, 0x08);\n\t\t\t\t\thdr.write_shift(4, baseid);\n\t\t\t\t\thdr.write_shift(4, 0x05);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twrite_biff_rec(ba, 0x00EC, /* hdr */ _oasc ? bconcat([hdr, _oasc]) : hdr);\n\t}\n\tba.push(pl.end());\n\tnotes.forEach(function(n) { write_biff_rec(ba, 0x001C, n); });\n\tb8ocnts.push([baseid, comments.length + 1, b8oid]);\n\t++b8oid;\n}\n\nfunction write_FONTS_biff8(ba, data, opts) {\n\twrite_biff_rec(ba, 0x0031 /* Font */, write_Font({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Arial\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}, opts));\n}\n\n\nfunction write_FMTS_biff8(ba, NF, opts) {\n\tif(!NF) return;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\nfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_biff_rec(ba, 0x041E /* Format */, write_Format(i, NF[i], opts));\n\t});\n}\n\nfunction write_FEAT(ba, ws) {\n\t/* [MS-XLS] 2.4.112 */\n\tvar o = new_buf(19);\n\to.write_shift(4, 0x867); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 1); o.write_shift(4, 0);\n\twrite_biff_rec(ba, 0x0867 /* FeatHdr */, o);\n\t/* [MS-XLS] 2.4.111 */\n\to = new_buf(39);\n\to.write_shift(4, 0x868); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 0); o.write_shift(4, 0);\n\to.write_shift(2, 1); o.write_shift(4, 4); o.write_shift(2, 0);\n\twrite_Ref8U(safe_decode_range(ws['!ref']||\"A1\"), o);\n\to.write_shift(4, 4);\n\twrite_biff_rec(ba, 0x0868 /* Feat */, o);\n}\n\nfunction write_CELLXFS_biff8(ba, opts) {\n\tfor(var i = 0; i < 16; ++i) write_biff_rec(ba, 0x00e0 /* XF */, write_XF({numFmtId:0, style:true}, 0, opts));\n\topts.cellXfs.forEach(function(c) {\n\t\twrite_biff_rec(ba, 0x00e0 /* XF */, write_XF(c, 0, opts));\n\t});\n}\n\nfunction write_ws_biff8_hlinks(ba, ws) {\n\tfor(var R=0; R<ws['!links'].length; ++R) {\n\t\tvar HL = ws['!links'][R];\n\t\twrite_biff_rec(ba, 0x01b8 /* HLink */, write_HLink(HL));\n\t\tif(HL[1].Tooltip) write_biff_rec(ba, 0x0800 /* HLinkTooltip */, write_HLinkTooltip(HL));\n\t}\n\tdelete ws['!links'];\n}\n\nfunction write_ws_cols_biff8(ba, cols) {\n\tif(!cols) return;\n\tvar cnt = 0;\n\tcols.forEach(function(col, idx) {\n\t\tif(++cnt <= 256 && col) {\n\t\t\twrite_biff_rec(ba, 0x007d /* ColInfo */, write_ColInfo(col_obj_w(idx, col), idx));\n\t\t}\n\t});\n}\n\nfunction write_ws_biff8_cell(ba, cell, R, C, opts, date1904) {\n\tvar os = 16 + get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.v == null && !cell.bf) {\n\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t\treturn;\n\t}\n\tif(cell.bf) write_biff_rec(ba, 0x0006 /* Formula */, write_Formula(cell, R, C, opts, os));\n\telse switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v, date1904), date1904) : cell.v;\n\t\t\tif(isNaN(v)) write_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, 0x24, os, opts, \"e\")); // #NUM!\n\t\t\telse if(!isFinite(v)) write_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, 0x07, os, opts, \"e\")); // #DIV/0!\n\t\t\t/* TODO: emit RK as appropriate */\n\t\t\telse write_biff_rec(ba, 0x0203 /* Number */, write_Number(R, C, v, os, opts));\n\t\t\tbreak;\n\t\tcase 'b': case 'e':\n\t\t\twrite_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, cell.v, os, opts, cell.t));\n\t\t\tbreak;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvar isst = get_sst_id(opts.Strings, cell.v == null ? \"\" : String(cell.v), opts.revStrings);\n\t\t\t\twrite_biff_rec(ba, 0x00fd /* LabelSst */, write_LabelSst(R, C, isst, os, opts));\n\t\t\t} else write_biff_rec(ba, 0x0204 /* Label */, write_Label(R, C, (cell.v == null ? \"\" : String(cell.v)).slice(0,255), os, opts));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t}\n}\n\n/* [MS-XLS] 2.1.7.20.5 */\nfunction write_ws_biff8(idx, opts, wb) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar _WB = ((wb||{}).Workbook||{});\n\tvar _sheet = ((_WB.Sheets||[])[idx]||{});\n\tvar dense = ws[\"!data\"] != null;\n\tvar b8 = opts.biff == 8;\n\tvar ref, rr = \"\", cols = [];\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\");\n\tvar MAX_ROWS = b8 ? 65536 : 16384;\n\tif(range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.c, MAX_ROWS-1);\n\t}\n\n\twrite_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\n\t/* [Uncalced] Index */\n\twrite_biff_rec(ba, 0x000d /* CalcMode */, writeuint16(1));\n\twrite_biff_rec(ba, 0x000c /* CalcCount */, writeuint16(100));\n\twrite_biff_rec(ba, 0x000f /* CalcRefMode */, writebool(true));\n\twrite_biff_rec(ba, 0x0011 /* CalcIter */, writebool(false));\n\twrite_biff_rec(ba, 0x0010 /* CalcDelta */, write_Xnum(0.001));\n\twrite_biff_rec(ba, 0x005f /* CalcSaveRecalc */, writebool(true));\n\twrite_biff_rec(ba, 0x002a /* PrintRowCol */, writebool(false));\n\twrite_biff_rec(ba, 0x002b /* PrintGrid */, writebool(false));\n\twrite_biff_rec(ba, 0x0082 /* GridSet */, writeuint16(1));\n\twrite_biff_rec(ba, 0x0080 /* Guts */, write_Guts([0,0]));\n\t/* DefaultRowHeight WsBool [Sync] [LPr] [HorizontalPageBreaks] [VerticalPageBreaks] */\n\t/* Header (string) */\n\t/* Footer (string) */\n\twrite_biff_rec(ba, 0x0083 /* HCenter */, writebool(false));\n\twrite_biff_rec(ba, 0x0084 /* VCenter */, writebool(false));\n\t/* ... */\n\tif(b8) write_ws_cols_biff8(ba, ws[\"!cols\"]);\n\t/* ... */\n\twrite_biff_rec(ba, 0x0200 /* Dimensions */, write_Dimensions(range, opts));\n\t/* ... */\n\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\tif(b8) ws['!links'] = [];\n\tvar comments = [];\n\tvar row = [];\n\tfor(var C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tif(dense) row = ws[\"!data\"][R] || [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? row[C] : ws[ref];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff8_cell(ba, cell, R, C, opts, date1904);\n\t\t\tif(b8 && cell.l) ws['!links'].push([ref, cell.l]);\n\t\t\tif(cell.c) comments.push([cell.c, R, C]);\n\t\t}\n\t}\n\tvar cname = _sheet.CodeName || _sheet.name || s;\n\t/* ... */\n\tif(b8) write_comments_biff8(ba, comments); else write_comments_biff2(ba, comments);\n\t/* ... */\n\tif(b8) write_biff_rec(ba, 0x023e /* Window2 */, write_Window2((_WB.Views||[])[0]));\n\t/* ... */\n\tif(b8 && (ws['!merges']||[]).length) write_biff_rec(ba, 0x00e5 /* MergeCells */, write_MergeCells(ws['!merges']));\n\t/* [LRng] *QUERYTABLE [PHONETICINFO] CONDFMTS */\n\tif(b8) write_ws_biff8_hlinks(ba, ws);\n\t/* [DVAL] */\n\twrite_biff_rec(ba, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t/* *WebPub *CellWatch [SheetExt] */\n\tif(b8) write_FEAT(ba, ws);\n\t/* *FEAT11 *RECORD12 */\n\twrite_biff_rec(ba, 0x000a /* EOF */);\n\treturn ba.end();\n}\n\n/* [MS-XLS] 2.1.7.20.3 */\nfunction write_biff8_global(wb, bufs, opts) {\n\tvar A = buf_array();\n\tvar _WB = ((wb||{}).Workbook||{});\n\tvar _sheets = (_WB.Sheets||[]);\n\tvar _wb = _WB.WBProps||{};\n\tvar b8 = opts.biff == 8, b5 = opts.biff == 5;\n\twrite_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\n\tif(opts.bookType == \"xla\") write_biff_rec(A, 0x0087 /* Addin */);\n\twrite_biff_rec(A, 0x00e1 /* InterfaceHdr */, b8 ? writeuint16(0x04b0) : null);\n\twrite_biff_rec(A, 0x00c1 /* Mms */, writezeroes(2));\n\tif(b5) write_biff_rec(A, 0x00bf /* ToolbarHdr */);\n\tif(b5) write_biff_rec(A, 0x00c0 /* ToolbarEnd */);\n\twrite_biff_rec(A, 0x00e2 /* InterfaceEnd */);\n\twrite_biff_rec(A, 0x005c /* WriteAccess */, write_WriteAccess(\"SheetJS\", opts));\n\t/* [FileSharing] */\n\twrite_biff_rec(A, 0x0042 /* CodePage */, writeuint16(b8 ? 0x04b0 : 0x04E4));\n\t/* *2047 Lel */\n\tif(b8) write_biff_rec(A, 0x0161 /* DSF */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01c0 /* Excel9File */);\n\twrite_biff_rec(A, 0x013d /* RRTabId */, write_RRTabId(wb.SheetNames.length));\n\tif(b8 && wb.vbaraw) write_biff_rec(A, 0x00d3 /* ObProj */);\n\t/* [ObNoMacros] */\n\tif(b8 && wb.vbaraw) {\n\t\tvar cname = _wb.CodeName || \"ThisWorkbook\";\n\t\twrite_biff_rec(A, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t}\n\twrite_biff_rec(A, 0x009c /* BuiltInFnGroupCount */, writeuint16(0x11));\n\t/* *FnGroupName *FnGrp12 */\n\t/* *Lbl */\n\t/* [OleObjectSize] */\n\twrite_biff_rec(A, 0x0019 /* WinProtect */, writebool(false));\n\twrite_biff_rec(A, 0x0012 /* Protect */, writebool(false));\n\twrite_biff_rec(A, 0x0013 /* Password */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01af /* Prot4Rev */, writebool(false));\n\tif(b8) write_biff_rec(A, 0x01bc /* Prot4RevPass */, writeuint16(0));\n\twrite_biff_rec(A, 0x003d /* Window1 */, write_Window1(opts));\n\twrite_biff_rec(A, 0x0040 /* Backup */, writebool(false));\n\twrite_biff_rec(A, 0x008d /* HideObj */, writeuint16(0));\n\twrite_biff_rec(A, 0x0022 /* Date1904 */, writebool(safe1904(wb)==\"true\"));\n\twrite_biff_rec(A, 0x000e /* CalcPrecision */, writebool(true));\n\tif(b8) write_biff_rec(A, 0x01b7 /* RefreshAll */, writebool(false));\n\twrite_biff_rec(A, 0x00DA /* BookBool */, writeuint16(0));\n\t/* ... */\n\twrite_FONTS_biff8(A, wb, opts);\n\twrite_FMTS_biff8(A, wb.SSF, opts);\n\twrite_CELLXFS_biff8(A, opts);\n\t/* ... */\n\tif(b8) write_biff_rec(A, 0x0160 /* UsesELFs */, writebool(false));\n\tvar a = A.end();\n\n\tvar C = buf_array();\n\t/* METADATA [MTRSettings] [ForceFullCalculation] */\n\tif(b8) write_biff_rec(C, 0x008C /* Country */, write_Country());\n\t/* *SUPBOOK *LBL *RTD [RecalcId] *HFPicture */\n\n\t/* BIFF8: MsoDrawingGroup [*Continue] */\n\tif(b8 && b8ocnts.length) write_biff_rec(C, 0x00EB /* MsoDrawingGroup */, write_MsoDrawingGroup());\n\t/* BIFF8: [SST *Continue] ExtSST */\n\tif(b8 && opts.Strings) write_biff_continue(C, 0x00FC /* SST */, write_SST(opts.Strings, opts));\n\n\t/* *WebPub [WOpt] [CrErr] [BookExt] *FeatHdr *DConn [THEME] [CompressPictures] [Compat12] [GUIDTypeLib] */\n\twrite_biff_rec(C, 0x000A /* EOF */);\n\tvar c = C.end();\n\n\tvar B = buf_array();\n\tvar blen = 0, j = 0;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\n\tvar start = a.length + blen + c.length;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) {\n\t\tvar _sheet = _sheets[j] || ({});\n\t\twrite_biff_rec(B, 0x0085 /* BoundSheet8 */, write_BoundSheet8({pos:start, hs:_sheet.Hidden||0, dt:0, name:wb.SheetNames[j]}, opts));\n\t\tstart += bufs[j].length;\n\t}\n\t/* 1*BoundSheet8 */\n\tvar b = B.end();\n\tif(blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\n\n\tvar out = [];\n\tif(a.length) out.push(a);\n\tif(b.length) out.push(b);\n\tif(c.length) out.push(c);\n\treturn bconcat(out);\n}\n\n/* [MS-XLS] 2.1.7.20 Workbook Stream */\nfunction write_biff8_buf(wb, opts) {\n\tvar o = opts || {};\n\tvar bufs = [];\n\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\to.revssf = evert_num(wb.SSF); o.revssf[wb.SSF[65535]] = 0;\n\t\to.ssf = wb.SSF;\n\t}\n\n\tb8oid = 1; b8ocnts = [];\n\to.Strings = []; o.Strings.Count = 0; o.Strings.Unique = 0;\n\tfix_write_opts(o);\n\n\to.cellXfs = [];\n\tget_cell_style(o.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\n\tbufs.unshift(write_biff8_global(wb, bufs, o));\n\treturn bconcat(bufs);\n}\n\nfunction write_biff_buf(wb, opts) {\n\tfor(var i = 0; i <= wb.SheetNames.length; ++i) {\n\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\tif(range.e.c > 255) { // note: 255 is IV\n\t\t\tif(typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond column IV (255).  Data may be lost.\");\n\t\t}\n\t}\n\n\tvar o = opts || {};\n\tswitch(o.biff || 2) {\n\t\tcase 8: case 5: return write_biff8_buf(wb, opts);\n\t\tcase 4: case 3: case 2: return write_biff2_buf(wb, opts);\n\t}\n\tthrow new Error(\"invalid type \" + o.bookType + \" for BIFF\");\n}\n/* note: browser DOM element cannot see mso- style attrs, must parse */\nfunction html_to_sheet(str, _opts) {\n\tvar opts = _opts || {};\n\tvar dense = (opts.dense != null) ? opts.dense : DENSE;\n\tvar ws = ({}); if(dense) ws[\"!data\"] = [];\n\tstr = str.replace(/<!--.*?-->/g, \"\");\n\tvar mtch = str.match(/<table/i);\n\tif(!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n\tvar mtch2 = str.match(/<\\/table/i);\n\tvar i = mtch.index, j = mtch2 && mtch2.index || str.length;\n\tvar rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\n\tvar R = -1, C = 0, RS = 0, CS = 0;\n\tvar range = {s:{r:10000000, c:10000000},e:{r:0,c:0}};\n\tvar merges = [];\n\tfor(i = 0; i < rows.length; ++i) {\n\t\tvar row = rows[i].trim();\n\t\tvar hd = row.slice(0,3).toLowerCase();\n\t\tif(hd == \"<tr\") { ++R; if(opts.sheetRows && opts.sheetRows <= R) { --R; break; } C = 0; continue; }\n\t\tif(hd != \"<td\" && hd != \"<th\") continue;\n\t\tvar cells = row.split(/<\\/t[dh]>/i);\n\t\tfor(j = 0; j < cells.length; ++j) {\n\t\t\tvar cell = cells[j].trim();\n\t\t\tif(!cell.match(/<t[dh]/i)) continue;\n\t\t\tvar m = cell, cc = 0;\n\t\t\t/* TODO: parse styles etc */\n\t\t\twhile(m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc+1);\n\t\t\tfor(var midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar _merge = merges[midx];\n\t\t\t\tif(_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) { C = _merge.e.c + 1; midx = -1; }\n\t\t\t}\n\t\t\tvar tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n\t\t\tCS = tag.colspan ? +tag.colspan : 1;\n\t\t\tif((RS = +tag.rowspan)>1 || CS>1) merges.push({s:{r:R,c:C},e:{r:R + (RS||1) - 1, c:C + CS - 1}});\n\t\t\tvar _t = tag.t || tag[\"data-t\"] || \"\";\n\t\t\t/* TODO: generate stub cells */\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tm = htmldecode(m);\n\t\t\tif(range.s.r > R) range.s.r = R; if(range.e.r < R) range.e.r = R;\n\t\t\tif(range.s.c > C) range.s.c = C; if(range.e.c < C) range.e.c = C;\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tvar o = {t:'s', v:m};\n\t\t\tif(opts.raw || !m.trim().length || _t == 's'){}\n\t\t\telse if(m === 'TRUE') o = {t:'b', v:true};\n\t\t\telse if(m === 'FALSE') o = {t:'b', v:false};\n\t\t\telse if(!isNaN(fuzzynum(m))) o = {t:'n', v:fuzzynum(m)};\n\t\t\telse if(!isNaN(fuzzydate(m).getDate())) {\n\t\t\t\to = ({t:'d', v:parseDate(m)});\n\t\t\t\tif(opts.UTC === false) o.v = utc_to_local(o.v);\n\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\n\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t}\n\t\t\tif(o.cellText !== false) o.w = m;\n\t\t\tif(dense) { if(!ws[\"!data\"][R]) ws[\"!data\"][R] = []; ws[\"!data\"][R][C] = o; }\n\t\t\telse ws[encode_cell({r:R, c:C})] = o;\n\t\t\tC += CS;\n\t\t}\n\t}\n\tws['!ref'] = encode_range(range);\n\tif(merges.length) ws[\"!merges\"] = merges;\n\treturn ws;\n}\nfunction make_html_row(ws, r, R, o) {\n\tvar M = (ws['!merges'] ||[]);\n\tvar oo = [];\n\tvar sp = ({});\n\tvar dense = ws[\"!data\"] != null;\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar RS = 0, CS = 0;\n\t\tfor(var j = 0; j < M.length; ++j) {\n\t\t\tif(M[j].s.r > R || M[j].s.c > C) continue;\n\t\t\tif(M[j].e.r < R || M[j].e.c < C) continue;\n\t\t\tif(M[j].s.r < R || M[j].s.c < C) { RS = -1; break; }\n\t\t\tRS = M[j].e.r - M[j].s.r + 1; CS = M[j].e.c - M[j].s.c + 1; break;\n\t\t}\n\t\tif(RS < 0) continue;\n\t\tvar coord = encode_col(C) + encode_row(R);\n\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[coord];\n\t\t/* TODO: html entities */\n\t\tvar w = (cell && cell.v != null) && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n\t\tsp = ({});\n\t\tif(RS > 1) sp.rowspan = RS;\n\t\tif(CS > 1) sp.colspan = CS;\n\t\tif(o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';\n\t\telse if(cell) {\n\t\t\tsp[\"data-t\"] = cell && cell.t || 'z';\n\t\t\t// note: data-v is unaffected by the timezone interpretation\n\t\t\tif(cell.v != null) sp[\"data-v\"] = cell.v instanceof Date ? cell.v.toISOString() : cell.v;\n\t\t\tif(cell.z != null) sp[\"data-z\"] = cell.z;\n\t\t\tif(cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + escapehtml(cell.l.Target) +'\">' + w + '</a>';\n\t\t}\n\t\tsp.id = (o.id || \"sjs\") + \"-\" + coord;\n\t\too.push(writextag('td', w, sp));\n\t}\n\tvar preamble = \"<tr>\";\n\treturn preamble + oo.join(\"\") + \"</tr>\";\n}\n\nvar HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nvar HTML_END = '</body></html>';\n\nfunction html_to_workbook(str, opts) {\n\tvar mtch = str.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);\n\tif(!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n\tif(mtch.length == 1) {\n\t\tvar w = sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n\t\tw.bookType = \"html\";\n\t\treturn w;\n\t}\n\tvar wb = book_new();\n\tmtch.forEach(function(s, idx) { book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx+1)); });\n\twb.bookType = \"html\";\n\treturn wb;\n}\n\nfunction make_html_preamble(ws, R, o) {\n\tvar out = [];\n\treturn out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n}\n\nfunction sheet_to_html(ws, opts/*, wb:?Workbook*/) {\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tvar out = [header];\n\tvar r = decode_range(ws['!ref']);\n\tout.push(make_html_preamble(ws, r, o));\n\tfor(var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n\tout.push(\"</table>\" + footer);\n\treturn out.join(\"\");\n}\n\nfunction sheet_add_dom(ws, table, _opts) {\n\tvar rows = table.rows;\n\tif(!rows) {\n\t\t/* not an HTML TABLE */\n\t\tthrow \"Unsupported origin when \" + table.tagName + \" is not a TABLE\";\n\t}\n\n\tvar opts = _opts || {};\n\tvar dense = ws[\"!data\"] != null;\n\tvar or_R = 0, or_C = 0;\n\tif(opts.origin != null) {\n\t\tif(typeof opts.origin == 'number') or_R = opts.origin;\n\t\telse {\n\t\t\tvar _origin = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n\t\t\tor_R = _origin.r; or_C = _origin.c;\n\t\t}\n\t}\n\n\tvar sheetRows = Math.min(opts.sheetRows||10000000, rows.length);\n\tvar range = {s:{r:0,c:0},e:{r:or_R,c:or_C}};\n\tif(ws[\"!ref\"]) {\n\t\tvar _range = decode_range(ws[\"!ref\"]);\n\t\trange.s.r = Math.min(range.s.r, _range.s.r);\n\t\trange.s.c = Math.min(range.s.c, _range.s.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\tif(or_R == -1) range.e.r = or_R = _range.e.r + 1;\n\t}\n\tvar merges = [], midx = 0;\n\tvar rowinfo = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n\tvar _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;\n\tif(!ws[\"!cols\"]) ws['!cols'] = [];\n\tfor(; _R < rows.length && R < sheetRows; ++_R) {\n\t\tvar row = rows[_R];\n\t\tif (is_dom_element_hidden(row)) {\n\t\t\tif (opts.display) continue;\n\t\t\trowinfo[R] = {hidden: true};\n\t\t}\n\t\tvar elts = (row.cells);\n\t\tfor(_C = C = 0; _C < elts.length; ++_C) {\n\t\t\tvar elt = elts[_C];\n\t\t\tif (opts.display && is_dom_element_hidden(elt)) continue;\n\t\t\tvar v = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n\t\t\tvar z = elt.getAttribute('data-z') || elt.getAttribute('z');\n\t\t\tfor(midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar m = merges[midx];\n\t\t\t\tif(m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) { C = m.e.c+1 - or_C; midx = -1; }\n\t\t\t}\n\t\t\t/* TODO: figure out how to extract nonstandard mso- style */\n\t\t\tCS = +elt.getAttribute(\"colspan\") || 1;\n\t\t\tif( ((RS = (+elt.getAttribute(\"rowspan\") || 1)))>1 || CS>1) merges.push({s:{r:R + or_R,c:C + or_C},e:{r:R + or_R + (RS||1) - 1, c:C + or_C + (CS||1) - 1}});\n\t\t\tvar o = {t:'s', v:v};\n\t\t\tvar _t = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n\t\t\tif(v != null) {\n\t\t\t\tif(v.length == 0) o.t = _t || 'z';\n\t\t\t\telse if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\n\t\t\t\telse if(v === 'TRUE') o = {t:'b', v:true};\n\t\t\t\telse if(v === 'FALSE') o = {t:'b', v:false};\n\t\t\t\telse if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\n\t\t\t\telse if(!isNaN(fuzzydate(v).getDate())) {\n\t\t\t\t\to = ({t:'d', v:parseDate(v)});\n\t\t\t\t\tif(opts.UTC) o.v = local_to_utc(o.v);\n\t\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\n\t\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(o.z === undefined && z != null) o.z = z;\n\t\t\t/* The first link is used.  Links are assumed to be fully specified.\n\t\t\t * TODO: The right way to process relative links is to make a new <a> */\n\t\t\tvar l = \"\", Aelts = elt.getElementsByTagName(\"A\");\n\t\t\tif(Aelts && Aelts.length) for(var Aelti = 0; Aelti < Aelts.length; ++Aelti)\tif(Aelts[Aelti].hasAttribute(\"href\")) {\n\t\t\t\tl = Aelts[Aelti].getAttribute(\"href\"); if(l.charAt(0) != \"#\") break;\n\t\t\t}\n\t\t\tif(l && l.charAt(0) != \"#\" &&\tl.slice(0, 11).toLowerCase() != 'javascript:') o.l = ({ Target: l });\n\t\t\tif(dense) { if(!ws[\"!data\"][R + or_R]) ws[\"!data\"][R + or_R] = []; ws[\"!data\"][R + or_R][C + or_C] = o; }\n\t\t\telse ws[encode_cell({c:C + or_C, r:R + or_R})] = o;\n\t\t\tif(range.e.c < C + or_C) range.e.c = C + or_C;\n\t\t\tC += CS;\n\t\t}\n\t\t++R;\n\t}\n\tif(merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n\trange.e.r = Math.max(range.e.r, R - 1 + or_R);\n\tws['!ref'] = encode_range(range);\n\tif(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1 + or_R,range)); // We can count the real number of rows to parse but we don't to improve the performance\n\treturn ws;\n}\n\nfunction parse_dom_table(table, _opts) {\n\tvar opts = _opts || {};\n\tvar ws = ({}); if(opts.dense) ws[\"!data\"] = [];\n\treturn sheet_add_dom(ws, table, _opts);\n}\n\nfunction table_to_book(table, opts) {\n\tvar o = sheet_to_workbook(parse_dom_table(table, opts), opts);\n\t//o.bookType = \"dom\"; // TODO: define a type for this\n\treturn o;\n}\n\nfunction is_dom_element_hidden(element) {\n\tvar display = '';\n\tvar get_computed_style = get_get_computed_style_function(element);\n\tif(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n\tif(!display) display = element.style && element.style.display;\n\treturn display === 'none';\n}\n\n/* global getComputedStyle */\nfunction get_get_computed_style_function(element) {\n\t// The proper getComputedStyle implementation is the one defined in the element window\n\tif(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\n\t// If it is not available, try to get one from the global namespace\n\tif(typeof getComputedStyle === 'function') return getComputedStyle;\n\treturn null;\n}\n/* OpenDocument */\nfunction parse_text_p(text) {\n\t/* 6.1.2 White Space Characters */\n\tvar fixed = text\n\t\t.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \")\n\t\t.replace(/<text:s\\/>/g,\" \")\n\t\t.replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function($$,$1) { return Array(parseInt($1,10)+1).join(\" \"); })\n\t\t.replace(/<text:tab[^>]*\\/>/g,\"\\t\")\n\t\t.replace(/<text:line-break\\/>/g,\"\\n\");\n\tvar v = unescapexml(fixed.replace(/<[^>]*>/g,\"\"));\n\n\treturn [v];\n}\n\n/* Note: ODS can stick styles in content.xml or styles.xml, FODS blurs lines */\nfunction parse_ods_styles(d, _opts, _nfm) {\n\tvar number_format_map = _nfm || {};\n\tvar str = xlml_normalize(d);\n\txlmlregex.lastIndex = 0;\n\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\tvar Rn, NFtag, NF = \"\", tNF = \"\", y, etpos = 0, tidx = -1, infmt = false, payload = \"\";\n\twhile((Rn = xlmlregex.exec(str))) {\n\t\tswitch((Rn[3]=Rn[3].replace(/_.*$/,\"\"))) {\n\t\t/* Number Format Definitions */\n\t\tcase 'number-style': // <number:number-style> 16.29.2\n\t\tcase 'currency-style': // <number:currency-style> 16.29.8\n\t\tcase 'percentage-style': // <number:percentage-style> 16.29.10\n\t\tcase 'date-style': // <number:date-style> 16.29.11\n\t\tcase 'time-style': // <number:time-style> 16.29.19\n\t\tcase 'text-style': // <number:text-style> 16.29.26\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tinfmt = false;\n\t\t\t\tif(NFtag['truncate-on-overflow'] == \"false\") {\n\t\t\t\t\tif(NF.match(/h/)) NF = NF.replace(/h+/, \"[$&]\");\n\t\t\t\t\telse if(NF.match(/m/)) NF = NF.replace(/m+/, \"[$&]\");\n\t\t\t\t\telse if(NF.match(/s/)) NF = NF.replace(/s+/, \"[$&]\");\n\t\t\t\t}\n\t\t\t\tnumber_format_map[NFtag.name] = NF;\n\t\t\t\tNF = \"\";\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tinfmt = true;\n\t\t\t\tNF = \"\";\n\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t} break;\n\n\t\t// LibreOffice bug https://bugs.documentfoundation.org/show_bug.cgi?id=149484\n\t\tcase 'boolean-style': // <number:boolean-style> 16.29.24\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tinfmt = false;\n\t\t\t\tnumber_format_map[NFtag.name] = \"General\";\n\t\t\t\tNF = \"\";\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tinfmt = true;\n\t\t\t\tNF = \"\";\n\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t} break;\n\n\t\t/* Number Format Elements */\n\t\tcase 'boolean': // <number:boolean> 16.29.25\n\t\t\tNF += \"General\"; // ODF spec is unfortunately underspecified here\n\t\t\tbreak;\n\n\t\tcase 'text': // <number:text> 16.29.27\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tpayload = str.slice(tidx, xlmlregex.lastIndex - Rn[0].length);\n\t\t\t\t// NOTE: Excel has a different interpretation of \"%%\" and friends\n\t\t\t\tif(payload == \"%\" && NFtag[0] == '<number:percentage-style') NF += \"%\";\n\t\t\t\telse NF += '\"' + payload.replace(/\"/g, '\"\"') + '\"';\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t} break;\n\n\n\t\tcase 'day': { // <number:day> 16.29.12\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"d\"; break;\n\t\t\t\tcase \"long\": NF += \"dd\"; break;\n\t\t\t\tdefault: NF += \"dd\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'day-of-week': { // <number:day-of-week> 16.29.16\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"ddd\"; break;\n\t\t\t\tcase \"long\": NF += \"dddd\"; break;\n\t\t\t\tdefault: NF += \"ddd\"; break;\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'era': { // <number:era> 16.29.15 TODO: proper mapping\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"ee\"; break;\n\t\t\t\tcase \"long\": NF += \"eeee\"; break;\n\t\t\t\tdefault: NF += \"eeee\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'hours': { // <number:hours> 16.29.20\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"h\"; break;\n\t\t\t\tcase \"long\": NF += \"hh\"; break;\n\t\t\t\tdefault: NF += \"hh\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'minutes': { // <number:minutes> 16.29.21\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"m\"; break;\n\t\t\t\tcase \"long\": NF += \"mm\"; break;\n\t\t\t\tdefault: NF += \"mm\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'month': { // <number:month> 16.29.13\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tif(y[\"textual\"]) NF += \"mm\";\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"m\"; break;\n\t\t\t\tcase \"long\": NF += \"mm\"; break;\n\t\t\t\tdefault: NF += \"m\"; break;\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'seconds': { // <number:seconds> 16.29.22\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"s\"; break;\n\t\t\t\tcase \"long\": NF += \"ss\"; break;\n\t\t\t\tdefault: NF += \"ss\"; break; // TODO: error condition\n\t\t\t}\n\t\t\tif(y[\"decimal-places\"]) NF += \".\" + fill(\"0\", +y[\"decimal-places\"]);\n\t\t} break;\n\n\t\tcase 'year': { // <number:year> 16.29.14\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"yy\"; break;\n\t\t\t\tcase \"long\": NF += \"yyyy\"; break;\n\t\t\t\tdefault: NF += \"yy\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'am-pm': // <number:am-pm> 16.29.23\n\t\t\tNF += \"AM/PM\"; // LO autocorrects A/P -> AM/PM\n\t\t\tbreak;\n\n\t\tcase 'week-of-year': // <number:week-of-year> 16.29.17\n\t\tcase 'quarter': // <number:quarter> 16.29.18\n\t\t\tconsole.error(\"Excel does not support ODS format token \" + Rn[3]);\n\t\t\tbreak;\n\n\t\tcase 'fill-character': // <number:fill-character> 16.29.5\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tpayload = str.slice(tidx, xlmlregex.lastIndex - Rn[0].length);\n\t\t\t\t// NOTE: Excel has a different interpretation of \"%%\" and friends\n\t\t\t\tNF += '\"' + payload.replace(/\"/g, '\"\"') + '\"*';\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t} break;\n\n\t\tcase 'scientific-number': // <number:scientific-number> 16.29.6\n\t\t\t// TODO: find a mapping for all parameters\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tNF += \"0.\" + fill(\"0\", +y[\"min-decimal-places\"] || +y[\"decimal-places\"] || 2) + fill(\"?\", +y[\"decimal-places\"] - +y[\"min-decimal-places\"] || 0) + \"E\" + (parsexmlbool(y[\"forced-exponent-sign\"]) ? \"+\" : \"\") + fill(\"0\", +y[\"min-exponent-digits\"] || 2);\n\t\t\tbreak;\n\n\t\tcase 'fraction': // <number:fraction> 16.29.7\n\t\t\t// TODO: find a mapping for all parameters\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tif(!+y[\"min-integer-digits\"]) NF += \"#\";\n\t\t\telse NF += fill(\"0\", +y[\"min-integer-digits\"]);\n\t\t\tNF += \" \";\n\t\t\tNF += fill(\"?\", +y[\"min-numerator-digits\"] || 1);\n\t\t\tNF += \"/\";\n\t\t\tif(+y[\"denominator-value\"]) NF += y[\"denominator-value\"];\n\t\t\telse NF += fill(\"?\", +y[\"min-denominator-digits\"] || 1);\n\t\t\tbreak;\n\n\t\tcase 'currency-symbol': // <number:currency-symbol> 16.29.9\n\t\t\t// TODO: localization with [$-...]\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tNF += '\"' + str.slice(tidx, xlmlregex.lastIndex - Rn[0].length).replace(/\"/g, '\"\"') + '\"';\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t} else NF += \"$\";\n\t\t\tbreak;\n\n\t\tcase 'text-properties': // <style:text-properties> 16.29.29\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch((y[\"color\"]||\"\").toLowerCase().replace(\"#\", \"\")) {\n\t\t\t\tcase \"ff0000\": case \"red\": NF = \"[Red]\" + NF; break;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'text-content': // <number:text-content> 16.29.28\n\t\t\tNF += \"@\";\n\t\t\tbreak;\n\n\t\tcase 'map': // <style:map> 16.3\n\t\t\t// TODO: handle more complex maps\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tif(unescapexml(y[\"condition\"]) == \"value()>=0\") NF = number_format_map[y[\"apply-style-name\"]] + \";\" + NF;\n\t\t\telse console.error(\"ODS number format may be incorrect: \" + y[\"condition\"]);\n\t\t\tbreak;\n\n\t\tcase 'number': // <number:number> 16.29.3\n\t\t\t// TODO: handle all the attributes\n\t\t\tif(Rn[1]==='/') break;\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\ttNF = \"\";\n\t\t\ttNF += fill(\"0\", +y[\"min-integer-digits\"] || 1);\n\t\t\tif(parsexmlbool(y[\"grouping\"])) tNF = commaify(fill(\"#\", Math.max(0, 4 - tNF.length)) + tNF);\n\t\t\tif(+y[\"min-decimal-places\"] || +y[\"decimal-places\"]) tNF += \".\";\n\t\t\tif(+y[\"min-decimal-places\"]) tNF += fill(\"0\", +y[\"min-decimal-places\"] || 1);\n\t\t\tif(+y[\"decimal-places\"] - (+y[\"min-decimal-places\"]||0)) tNF += fill(\"0\", +y[\"decimal-places\"] - (+y[\"min-decimal-places\"]||0)); // TODO: should this be \"#\" ?\n\t\t\tNF += tNF;\n\t\t\tbreak;\n\n\t\tcase 'embedded-text': // <number:embedded-text> 16.29.4\n\t\t\t// TODO: verify interplay with grouping et al\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tif(etpos == 0) NF += '\"' + str.slice(tidx, xlmlregex.lastIndex - Rn[0].length).replace(/\"/g, '\"\"') + '\"';\n\t\t\t\telse NF = NF.slice(0, etpos) + '\"' + str.slice(tidx, xlmlregex.lastIndex - Rn[0].length).replace(/\"/g, '\"\"') + '\"' + NF.slice(etpos);\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t\tetpos = -+parsexmltag(Rn[0], false)[\"position\"] || 0;\n\t\t\t} break;\n\n\t}}\n\treturn number_format_map;\n}\n\nfunction parse_content_xml(d, _opts, _nfm) {\n\t\tvar opts = _opts || {};\n\t\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\t\tvar str = xlml_normalize(d);\n\t\tvar state = [], tmp;\n\t\tvar tag;\n\t\tvar nfidx, NF = \"\", pidx = 0;\n\t\tvar sheetag;\n\t\tvar rowtag;\n\t\tvar Sheets = {}, SheetNames = [];\n\t\tvar ws = ({}); if(opts.dense) ws[\"!data\"] = [];\n\t\tvar Rn, q;\n\t\tvar ctag = ({value:\"\"});\n\t\tvar textp = \"\", textpidx = 0, textptag, oldtextp = \"\", oldtextpidx = 0;\n\t\tvar textR = [], oldtextR = [];\n\t\tvar R = -1, C = -1, range = {s: {r:1000000,c:10000000}, e: {r:0, c:0}};\n\t\tvar row_ol = 0;\n\t\tvar number_format_map = _nfm || {}, styles = {};\n\t\tvar merges = [], mrange = {}, mR = 0, mC = 0;\n\t\tvar rowinfo = [], rowpeat = 1, colpeat = 1;\n\t\tvar arrayf = [];\n\t\tvar WB = {Names:[], WBProps:{}};\n\t\tvar atag = ({});\n\t\tvar _Ref = [\"\", \"\"];\n\t\tvar comments = [], comment = ({});\n\t\tvar creator = \"\", creatoridx = 0;\n\t\tvar isstub = false, intable = false;\n\t\tvar i = 0;\n\t\txlmlregex.lastIndex = 0;\n\t\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\t\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3]=Rn[3].replace(/_.*$/,\"\"))) {\n\n\t\t\tcase 'table': case '': // 9.1.2 <table:table>\n\t\t\t\tif(Rn[1]==='/') {\n\t\t\t\t\tif(range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);\n\t\t\t\t\telse ws['!ref'] = \"A1:A1\";\n\t\t\t\t\tif(opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n\t\t\t\t\t\tws['!fullref'] = ws['!ref'];\n\t\t\t\t\t\trange.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tws['!ref'] = encode_range(range);\n\t\t\t\t\t}\n\t\t\t\t\tif(merges.length) ws['!merges'] = merges;\n\t\t\t\t\tif(rowinfo.length) ws[\"!rows\"] = rowinfo;\n\t\t\t\t\tsheetag.name = sheetag[''] || sheetag.name;\n\t\t\t\t\tif(typeof JSON !== 'undefined') JSON.stringify(sheetag);\n\t\t\t\t\tSheetNames.push(sheetag.name);\n\t\t\t\t\tSheets[sheetag.name] = ws;\n\t\t\t\t\tintable = false;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tsheetag = parsexmltag(Rn[0], false);\n\t\t\t\t\tR = C = -1;\n\t\t\t\t\trange.s.r = range.s.c = 10000000; range.e.r = range.e.c = 0;\n\t\t\t\t\tws = ({}); if(opts.dense) ws[\"!data\"] = []; merges = [];\n\t\t\t\t\trowinfo = [];\n\t\t\t\t\tintable = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'table-row-group': // 9.1.9 <table:table-row-group>\n\t\t\t\tif(Rn[1] === \"/\") --row_ol; else ++row_ol;\n\t\t\t\tbreak;\n\t\t\tcase 'table-row': case '': // 9.1.3 <table:table-row>\n\t\t\t\tif(Rn[1] === '/') { R+=rowpeat; rowpeat = 1; break; }\n\t\t\t\trowtag = parsexmltag(Rn[0], false);\n\t\t\t\tif(rowtag['']) R = rowtag[''] - 1; else if(R == -1) R = 0;\n\t\t\t\trowpeat = +rowtag['number-rows-repeated'] || 1;\n\t\t\t\t/* TODO: remove magic */\n\t\t\t\tif(rowpeat < 10) for(i = 0; i < rowpeat; ++i) if(row_ol > 0) rowinfo[R + i] = {level: row_ol};\n\t\t\t\tC = -1; break;\n\t\t\tcase 'covered-table-cell': // 9.1.5 <table:covered-table-cell>\n\t\t\t\tif(Rn[1] !== '/') ++C;\n\t\t\t\tif(opts.sheetStubs) {\n\t\t\t\t\tif(opts.dense) { if(!ws[\"!data\"][R]) ws[\"!data\"][R] = []; ws[\"!data\"][R][C] = {t:'z'}; }\n\t\t\t\t\telse ws[encode_cell({r:R,c:C})] = {t:'z'};\n\t\t\t\t}\n\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\tbreak; /* stub */\n\t\t\tcase 'table-cell': case '':\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) === '/') {\n\t\t\t\t\t++C;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tq = ({t:'z', v:null});\n\t\t\t\t\tif(ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n\t\t\t\t\tif(ctag[\"style-name\"] && styles[ctag[\"style-name\"]]) q.z = styles[ctag[\"style-name\"]];\n\t\t\t\t\tif((ctag[''] || ctag['value-type']) == \"string\") {\n\t\t\t\t\t\tq.t = \"s\"; q.v = unescapexml(ctag['string-value'] || \"\");\n\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\tif(!ws[\"!data\"][R]) ws[\"!data\"][R] = [];\n\t\t\t\t\t\t\tws[\"!data\"][R][C] = q;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tws[encode_col(C) + encode_row(R)] = q;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tC+= colpeat-1;\n\t\t\t\t} else if(Rn[1]!=='/') {\n\t\t\t\t\t++C;\n\t\t\t\t\ttextp = oldtextp = \"\"; textpidx = oldtextpidx = 0; textR = []; oldtextR = [];\n\t\t\t\t\tcolpeat = 1;\n\t\t\t\t\tvar rptR = rowpeat ? R + rowpeat - 1 : R;\n\t\t\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t\t\t\tif(C < range.s.c) range.s.c = C;\n\t\t\t\t\tif(R < range.s.r) range.s.r = R;\n\t\t\t\t\tif(rptR > range.e.r) range.e.r = rptR;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcomments = []; comment = ({});\n\t\t\t\t\tq = ({t:ctag[''] || ctag['value-type'], v:null});\n\t\t\t\t\tif(ctag[\"style-name\"] && styles[ctag[\"style-name\"]]) q.z = styles[ctag[\"style-name\"]];\n\t\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\t\tif(ctag.formula) ctag.formula = unescapexml(ctag.formula);\n\t\t\t\t\t\tif(ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n\t\t\t\t\t\t\tmR = parseInt(ctag['number-matrix-rows-spanned'],10) || 0;\n\t\t\t\t\t\t\tmC = parseInt(ctag['number-matrix-columns-spanned'],10) || 0;\n\t\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\t\tq.F = encode_range(mrange);\n\t\t\t\t\t\t\tarrayf.push([mrange, q.F]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ctag.formula) q.f = ods_to_csf_formula(ctag.formula);\n\t\t\t\t\t\telse for(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\t\t\tif(R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r)\n\t\t\t\t\t\t\t\tif(C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\t\t\tq.F = arrayf[i][1];\n\t\t\t\t\t}\n\t\t\t\t\tif(ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n\t\t\t\t\t\tmR = parseInt(ctag['number-rows-spanned'],10) || 0;\n\t\t\t\t\t\tmC = parseInt(ctag['number-columns-spanned'],10) || 0;\n\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\tmerges.push(mrange);\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 19.675.2 table:number-columns-repeated */\n\t\t\t\t\tif(ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n\n\t\t\t\t\t/* 19.385 office:value-type TODO: verify ODS and UOS */\n\t\t\t\t\tswitch(q.t) {\n\t\t\t\t\t\tcase 'boolean': q.t = 'b'; q.v = parsexmlbool(ctag['boolean-value']) || (+ctag['boolean-value'] >= 1); break;\n\t\t\t\t\t\tcase 'float': q.t = 'n'; q.v = parseFloat(ctag.value);\n\t\t\t\t\t\t\tif(opts.cellDates && q.z && fmt_is_date(q.z)) { q.v = numdate(q.v + (WB.WBProps.date1904 ? 1462 : 0)); q.t = typeof q.v == \"number\" ? 'n' : 'd'; }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'percentage': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'currency': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'date': q.t = 'd'; q.v = parseDate(ctag['date-value'], WB.WBProps.date1904);\n\t\t\t\t\t\t\tif(!opts.cellDates) { q.t = 'n'; q.v = datenum(q.v, WB.WBProps.date1904); }\n\t\t\t\t\t\t\tif(!q.z) q.z = 'm/d/yy'; break;\n\t\t\t\t\t\t/* NOTE: for `time`, Excel ODS export incorrectly uses durations relative to 1900 epoch even if 1904 is specified */\n\t\t\t\t\t\tcase 'time': q.t = 'n'; q.v = parse_isodur(ctag['time-value'])/86400;\n\t\t\t\t\t\t\tif(opts.cellDates) { q.v = numdate(q.v); q.t = typeof q.v == \"number\" ? 'n' : 'd'; }\n\t\t\t\t\t\t\tif(!q.z) q.z = 'HH:MM:SS'; break;\n\t\t\t\t\t\tcase 'number': q.t = 'n'; q.v = parseFloat(ctag['']);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(q.t === 'string' || q.t === 'text' || !q.t) {\n\t\t\t\t\t\t\t\tq.t = 's';\n\t\t\t\t\t\t\t\tif(ctag['string-value'] != null) { textp = unescapexml(ctag['string-value']); textR = []; }\n\t\t\t\t\t\t\t} else throw new Error('Unsupported value type ' + q.t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisstub = false;\n\t\t\t\t\tif(q.t === 's') {\n\t\t\t\t\t\tq.v = textp || '';\n\t\t\t\t\t\tif(textR.length) q.R = textR;\n\t\t\t\t\t\tisstub = textpidx == 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(atag.Target) q.l = atag;\n\t\t\t\t\tif(comments.length > 0) { q.c = comments; comments = []; }\n\t\t\t\t\tif(textp && opts.cellText !== false) q.w = textp;\n\t\t\t\t\tif(isstub) { q.t = \"z\"; delete q.v; }\n\t\t\t\t\tif(!isstub || opts.sheetStubs) {\n\t\t\t\t\t\tif(!(opts.sheetRows && opts.sheetRows <= R)) {\n\t\t\t\t\t\t\tfor(var rpt = 0; rpt < rowpeat; ++rpt) {\n\t\t\t\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!ws[\"!data\"][R + rpt]) ws[\"!data\"][R + rpt] = [];\n\t\t\t\t\t\t\t\t\tws[\"!data\"][R + rpt][C] = rpt == 0 ? q : dup(q);\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[\"!data\"][R + rpt][C + colpeat] = dup(q);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tws[encode_cell({r:R + rpt,c:C})] = q;\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[encode_cell({r:R + rpt,c:C + colpeat})] = dup(q);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(range.e.c <= C) range.e.c = C;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tC += colpeat-1; colpeat = 0;\n\t\t\t\t\tq = {};\n\t\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\t}\n\t\t\t\tatag = ({});\n\t\t\t\tbreak; // 9.1.4 <table:table-cell>\n\n\t\t\t/* pure state */\n\t\t\tcase 'document': // TODO: <office:document> is the root for FODS\n\t\t\tcase 'document-content': case '': // 3.1.3.2 <office:document-content>\n\t\t\tcase 'spreadsheet': case '': // 3.7 <office:spreadsheet>\n\t\t\tcase 'scripts': // 3.12 <office:scripts>\n\t\t\tcase 'styles': // TODO <office:styles>\n\t\t\tcase 'font-face-decls': // 3.14 <office:font-face-decls>\n\t\t\tcase 'master-styles': // 3.15.4 <office:master-styles> -- relevant for FODS\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\n\t\t\tcase 'annotation': // 14.1 <office:annotation>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t\tcomment.t = textp;\n\t\t\t\t\tif(textR.length) comment.R = textR;\n\t\t\t\t\tcomment.a = creator;\n\t\t\t\t\tcomments.push(comment);\n\t\t\t\t\ttextp = oldtextp; textpidx = oldtextpidx; textR = oldtextR;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\t\tvar annotag = parsexmltag(Rn[0], true);\n\t\t\t\t\t/* office:display TODO: check if there is a global override */\n\t\t\t\t\tif(!(annotag[\"display\"] && parsexmlbool(annotag[\"display\"]))) comments.hidden = true;\n\t\t\t\t\toldtextp = textp; oldtextpidx = textpidx; oldtextR = textR;\n\t\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\t}\n\t\t\t\tcreator = \"\"; creatoridx = 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 'creator': // 4.3.2.7 <dc:creator>\n\t\t\t\tif(Rn[1]==='/') { creator = str.slice(creatoridx,Rn.index); }\n\t\t\t\telse creatoridx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\t/* ignore state */\n\t\t\tcase 'meta': case '': // TODO: <office:meta> <uof:> FODS/UOF\n\t\t\tcase 'settings': // TODO: <office:settings>\n\t\t\tcase 'config-item-set': // TODO: <office:config-item-set>\n\t\t\tcase 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\t\t\tcase 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'shapes': // 9.2.8 <table:shapes>\n\t\t\tcase 'frame': // 10.4.2 <draw:frame>\n\t\t\tcase 'text-box': // 10.4.3 <draw:text-box>\n\t\t\tcase 'image': // 10.4.4 <draw:image>\n\t\t\tcase 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\t\t\tcase 'list-style': // 16.30 <text:list-style>\n\t\t\tcase 'form': // 13.13 <form:form>\n\t\t\tcase 'dde-links': // 9.8 <table:dde-links>\n\t\t\tcase 'event-listeners': // TODO\n\t\t\tcase 'chart': // TODO\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], false]);\n\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\tbreak;\n\n\t\t\tcase 'scientific-number': // <number:scientific-number>\n\t\t\tcase 'currency-symbol': // <number:currency-symbol>\n\t\t\tcase 'fill-character': // 16.29.5 <number:fill-character>\n\t\t\t\tbreak;\n\n\t\t\tcase 'text-style': // 16.27.25 <number:text-style>\n\t\t\tcase 'boolean-style': // 16.27.23 <number:boolean-style>\n\t\t\tcase 'number-style': // 16.27.2 <number:number-style>\n\t\t\tcase 'currency-style': // 16.29.8 <number:currency-style>\n\t\t\tcase 'percentage-style': // 16.27.9 <number:percentage-style>\n\t\t\tcase 'date-style': // 16.27.10 <number:date-style>\n\t\t\tcase 'time-style': // 16.27.18 <number:time-style>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tvar xlmlidx = xlmlregex.lastIndex;\n\t\t\t\t\tparse_ods_styles(str.slice(nfidx, xlmlregex.lastIndex), _opts, number_format_map);\n\t\t\t\t\txlmlregex.lastIndex = xlmlidx;\n\t\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tnfidx = xlmlregex.lastIndex - Rn[0].length;\n\t\t\t\t} break;\n\n\t\t\tcase 'script': break; // 3.13 <office:script>\n\t\t\tcase 'libraries': break; // TODO: <ooo:libraries>\n\t\t\tcase 'automatic-styles': break; // 3.15.3 <office:automatic-styles>\n\n\t\t\tcase 'default-style': // TODO: <style:default-style>\n\t\t\tcase 'page-layout': break; // TODO: <style:page-layout>\n\t\t\tcase 'style': { // 16.2 <style:style>\n\t\t\t\tvar styletag = parsexmltag(Rn[0], false);\n\t\t\t\tif(styletag[\"family\"] == \"table-cell\" && number_format_map[styletag[\"data-style-name\"]]) styles[styletag[\"name\"]] = number_format_map[styletag[\"data-style-name\"]];\n\t\t\t} break;\n\t\t\tcase 'map': break; // 16.3 <style:map>\n\t\t\tcase 'font-face': break; // 16.21 <style:font-face>\n\n\t\t\tcase 'paragraph-properties': break; // 17.6 <style:paragraph-properties>\n\t\t\tcase 'table-properties': break; // 17.15 <style:table-properties>\n\t\t\tcase 'table-column-properties': break; // 17.16 <style:table-column-properties>\n\t\t\tcase 'table-row-properties': break; // 17.17 <style:table-row-properties>\n\t\t\tcase 'table-cell-properties': break; // 17.18 <style:table-cell-properties>\n\n\t\t\tcase 'number': // 16.27.3 <number:number>\n\t\t\t\tbreak;\n\n\t\t\tcase 'fraction': break; // TODO 16.27.6 <number:fraction>\n\n\t\t\tcase 'day': // 16.27.11 <number:day>\n\t\t\tcase 'month': // 16.27.12 <number:month>\n\t\t\tcase 'year': // 16.27.13 <number:year>\n\t\t\tcase 'era': // 16.27.14 <number:era>\n\t\t\tcase 'day-of-week': // 16.27.15 <number:day-of-week>\n\t\t\tcase 'week-of-year': // 16.27.16 <number:week-of-year>\n\t\t\tcase 'quarter': // 16.27.17 <number:quarter>\n\t\t\tcase 'hours': // 16.27.19 <number:hours>\n\t\t\tcase 'minutes': // 16.27.20 <number:minutes>\n\t\t\tcase 'seconds': // 16.27.21 <number:seconds>\n\t\t\tcase 'am-pm': // 16.27.22 <number:am-pm>\n\t\t\t\tbreak;\n\n\t\t\tcase 'boolean': break; // 16.27.24 <number:boolean>\n\t\t\tcase 'text': // 16.27.26 <number:text>\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") switch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'number-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\t\tNF += str.slice(pidx, Rn.index);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\tcase 'named-range': // 9.4.12 <table:named-range>\n\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t_Ref = ods_to_csf_3D(tag['cell-range-address']);\n\t\t\t\tvar nrange = ({Name:tag.name, Ref:_Ref[0] + '!' + _Ref[1]});\n\t\t\t\tif(intable) nrange.Sheet = SheetNames.length;\n\t\t\t\tWB.Names.push(nrange);\n\t\t\t\tbreak;\n\n\t\t\tcase 'text-content': break; // 16.27.27 <number:text-content>\n\t\t\tcase 'text-properties': break; // 16.27.27 <style:text-properties>\n\t\t\tcase 'embedded-text': break; // 16.27.4 <number:embedded-text>\n\n\t\t\tcase 'body': case '': break; // 3.3 16.9.6 19.726.3\n\n\t\t\tcase 'forms': break; // 12.25.2 13.2\n\t\t\tcase 'table-column': break; // 9.1.6 <table:table-column>\n\t\t\tcase 'table-header-rows': break; // 9.1.7 <table:table-header-rows>\n\t\t\tcase 'table-rows': break; // 9.1.12 <table:table-rows>\n\t\t\t/* TODO: outline levels */\n\t\t\tcase 'table-column-group': break; // 9.1.10 <table:table-column-group>\n\t\t\tcase 'table-header-columns': break; // 9.1.11 <table:table-header-columns>\n\t\t\tcase 'table-columns': break; // 9.1.12 <table:table-columns>\n\n\t\t\tcase 'null-date': // 9.4.2 <table:null-date>\n\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\tswitch(tag[\"date-value\"]) {\n\t\t\t\t\tcase \"1904-01-01\": WB.WBProps.date1904 = true; break;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'graphic-properties': break; // 17.21 <style:graphic-properties>\n\t\t\tcase 'calculation-settings': break; // 9.4.1 <table:calculation-settings>\n\t\t\tcase 'named-expressions': break; // 9.4.11 <table:named-expressions>\n\t\t\tcase 'label-range': break; // 9.4.9 <table:label-range>\n\t\t\tcase 'label-ranges': break; // 9.4.10 <table:label-ranges>\n\t\t\tcase 'named-expression': break; // 9.4.13 <table:named-expression>\n\t\t\tcase 'sort': break; // 9.4.19 <table:sort>\n\t\t\tcase 'sort-by': break; // 9.4.20 <table:sort-by>\n\t\t\tcase 'sort-groups': break; // 9.4.22 <table:sort-groups>\n\n\t\t\tcase 'tab': break; // 6.1.4 <text:tab>\n\t\t\tcase 'line-break': break; // 6.1.5 <text:line-break>\n\t\t\tcase 'span': break; // 6.1.7 <text:span>\n\t\t\tcase 'p': case '': // 5.1.3 <text:p>\n\t\t\t\tif(['master-styles'].indexOf(state[state.length-1][0]) > -1) break;\n\t\t\t\tif(Rn[1]==='/' && (!ctag || !ctag['string-value'])) {\n\t\t\t\t\tvar ptp = parse_text_p(str.slice(textpidx,Rn.index), textptag);\n\t\t\t\t\ttextp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n\t\t\t\t} else if(Rn[0].slice(-2) == \"/>\") {\n\t\t\t\t\t/* TODO: is self-closing  valid? */\n\t\t\t\t\ttextp += \"\\n\";\n\t\t\t\t} else { textptag = parsexmltag(Rn[0], false); textpidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak; // <text:p>\n\t\t\tcase 's': break; // <text:s>\n\n\t\t\tcase 'database-range': // 9.4.15 <table:database-range>\n\t\t\t\tif(Rn[1]==='/') break;\n\t\t\t\ttry {\n\t\t\t\t\t_Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n\t\t\t\t\tSheets[_Ref[0]]['!autofilter'] = { ref:_Ref[1] };\n\t\t\t\t} catch(e) {/* empty */}\n\t\t\t\tbreak;\n\n\t\t\tcase 'date': break; // <*:date>\n\n\t\t\tcase 'object': break; // 10.4.6.2 <draw:object>\n\t\t\tcase 'title': case '': break; // <*:title> OR <uof:>\n\t\t\tcase 'desc': break; // <*:desc>\n\t\t\tcase 'binary-data': break; // 10.4.5 TODO: b64 blob\n\n\t\t\t/* 9.2 Advanced Tables */\n\t\t\tcase 'table-source': break; // 9.2.6\n\t\t\tcase 'scenario': break; // 9.2.6\n\n\t\t\tcase 'iteration': break; // 9.4.3 <table:iteration>\n\t\t\tcase 'content-validations': break; // 9.4.4 <table:\n\t\t\tcase 'content-validation': break; // 9.4.5 <table:\n\t\t\tcase 'help-message': break; // 9.4.6 <table:\n\t\t\tcase 'error-message': break; // 9.4.7 <table:\n\t\t\tcase 'database-ranges': break; // 9.4.14 <table:database-ranges>\n\t\t\tcase 'filter': break; // 9.5.2 <table:filter>\n\t\t\tcase 'filter-and': break; // 9.5.3 <table:filter-and>\n\t\t\tcase 'filter-or': break; // 9.5.4 <table:filter-or>\n\t\t\tcase 'filter-condition': break; // 9.5.5 <table:filter-condition>\n\n\t\t\tcase 'list-level-style-bullet': break; // 16.31 <text:\n\t\t\tcase 'list-level-style-number': break; // 16.32 <text:\n\t\t\tcase 'list-level-properties': break; // 17.19 <style:\n\n\t\t\t/* 7.3 Document Fields */\n\t\t\tcase 'sender-firstname': // 7.3.6.2\n\t\t\tcase 'sender-lastname': // 7.3.6.3\n\t\t\tcase 'sender-initials': // 7.3.6.4\n\t\t\tcase 'sender-title': // 7.3.6.5\n\t\t\tcase 'sender-position': // 7.3.6.6\n\t\t\tcase 'sender-email': // 7.3.6.7\n\t\t\tcase 'sender-phone-private': // 7.3.6.8\n\t\t\tcase 'sender-fax': // 7.3.6.9\n\t\t\tcase 'sender-company': // 7.3.6.10\n\t\t\tcase 'sender-phone-work': // 7.3.6.11\n\t\t\tcase 'sender-street': // 7.3.6.12\n\t\t\tcase 'sender-city': // 7.3.6.13\n\t\t\tcase 'sender-postal-code': // 7.3.6.14\n\t\t\tcase 'sender-country': // 7.3.6.15\n\t\t\tcase 'sender-state-or-province': // 7.3.6.16\n\t\t\tcase 'author-name': // 7.3.7.1\n\t\t\tcase 'author-initials': // 7.3.7.2\n\t\t\tcase 'chapter': // 7.3.8\n\t\t\tcase 'file-name': // 7.3.9\n\t\t\tcase 'template-name': // 7.3.9\n\t\t\tcase 'sheet-name': // 7.3.9\n\t\t\t\tbreak;\n\n\t\t\tcase 'event-listener':\n\t\t\t\tbreak;\n\t\t\t/* TODO: FODS Properties */\n\t\t\tcase 'initial-creator':\n\t\t\tcase 'creation-date':\n\t\t\tcase 'print-date':\n\t\t\tcase 'generator':\n\t\t\tcase 'document-statistic':\n\t\t\tcase 'user-defined':\n\t\t\tcase 'editing-duration':\n\t\t\tcase 'editing-cycles':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: FODS Config */\n\t\t\tcase 'config-item':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: style tokens */\n\t\t\tcase 'page-number': break; // TODO <text:page-number>\n\t\t\tcase 'page-count': break; // TODO <text:page-count>\n\t\t\tcase 'time': break; // TODO <text:time>\n\n\t\t\t/* 9.3 Advanced Table Cells */\n\t\t\tcase 'cell-range-source': break; // 9.3.1 <table:\n\t\t\tcase 'detective': break; // 9.3.2 <table:\n\t\t\tcase 'operation': break; // 9.3.3 <table:\n\t\t\tcase 'highlighted-range': break; // 9.3.4 <table:\n\n\t\t\t/* 9.6 Data Pilot Tables <table: */\n\t\t\tcase 'data-pilot-table': // 9.6.3\n\t\t\tcase 'source-cell-range': // 9.6.5\n\t\t\tcase 'source-service': // 9.6.6\n\t\t\tcase 'data-pilot-field': // 9.6.7\n\t\t\tcase 'data-pilot-level': // 9.6.8\n\t\t\tcase 'data-pilot-subtotals': // 9.6.9\n\t\t\tcase 'data-pilot-subtotal': // 9.6.10\n\t\t\tcase 'data-pilot-members': // 9.6.11\n\t\t\tcase 'data-pilot-member': // 9.6.12\n\t\t\tcase 'data-pilot-display-info': // 9.6.13\n\t\t\tcase 'data-pilot-sort-info': // 9.6.14\n\t\t\tcase 'data-pilot-layout-info': // 9.6.15\n\t\t\tcase 'data-pilot-field-reference': // 9.6.16\n\t\t\tcase 'data-pilot-groups': // 9.6.17\n\t\t\tcase 'data-pilot-group': // 9.6.18\n\t\t\tcase 'data-pilot-group-member': // 9.6.19\n\t\t\t\tbreak;\n\n\t\t\t/* 10.3 Drawing Shapes */\n\t\t\tcase 'rect': // 10.3.2\n\t\t\t\tbreak;\n\n\t\t\t/* 14.6 DDE Connections */\n\t\t\tcase 'dde-connection-decls': // 14.6.2 <text:\n\t\t\tcase 'dde-connection-decl': // 14.6.3 <text:\n\t\t\tcase 'dde-link': // 14.6.4 <table:\n\t\t\tcase 'dde-source': // 14.6.5 <office:\n\t\t\t\tbreak;\n\n\t\t\tcase 'properties': break; // 13.7 <form:properties>\n\t\t\tcase 'property': break; // 13.8 <form:property>\n\n\t\t\tcase 'a': // 6.1.8 hyperlink\n\t\t\t\tif(Rn[1]!== '/') {\n\t\t\t\t\tatag = parsexmltag(Rn[0], false);\n\t\t\t\t\tif(!atag.href) break;\n\t\t\t\t\tatag.Target = unescapexml(atag.href); delete atag.href;\n\t\t\t\t\tif(atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n\t\t\t\t\t\t_Ref = ods_to_csf_3D(atag.Target.slice(1));\n\t\t\t\t\t\tatag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n\t\t\t\t\t} else if(atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t/* non-standard */\n\t\t\tcase 'table-protection': break;\n\t\t\tcase 'data-pilot-grand-total': break; // <table:\n\t\t\tcase 'office-document-common-attrs': break; // bare\n\t\t\tdefault: switch(Rn[2]) {\n\t\t\t\tcase 'dc:':       // TODO: properties\n\t\t\t\tcase 'calcext:':  // ignore undocumented extensions\n\t\t\t\tcase 'loext:':    // ignore undocumented extensions\n\t\t\t\tcase 'ooo:':      // ignore undocumented extensions\n\t\t\t\tcase 'chartooo:': // ignore undocumented extensions\n\t\t\t\tcase 'draw:':     // TODO: drawing\n\t\t\t\tcase 'style:':    // TODO: styles\n\t\t\t\tcase 'chart:':    // TODO: charts\n\t\t\t\tcase 'form:':     // TODO: forms\n\t\t\t\tcase 'uof:':      // TODO: uof\n\t\t\t\tcase ':':       // TODO: uof\n\t\t\t\tcase ':':       // TODO: uof\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: if(opts.WTF) throw new Error(Rn);\n\t\t\t}\n\t\t}\n\t\tvar out = ({\n\t\t\tSheets: Sheets,\n\t\t\tSheetNames: SheetNames,\n\t\t\tWorkbook: WB\n\t\t});\n\t\tif(opts.bookSheets) delete out.Sheets;\n\t\treturn out;\n}\n\nfunction parse_ods(zip, opts) {\n\topts = opts || ({});\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n\tvar styles = getzipstr(zip, 'styles.xml');\n\tvar Styles = styles && parse_ods_styles(utf8read(styles), opts);\n\tvar content = getzipstr(zip, 'content.xml');\n\tif(!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n\tvar wb = parse_content_xml(utf8read(content), opts, Styles);\n\tif(safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n\twb.bookType = \"ods\";\n\treturn wb;\n}\nfunction parse_fods(data, opts) {\n\tvar wb = parse_content_xml(data, opts);\n\twb.bookType = \"fods\";\n\treturn wb;\n}\n\n/* OpenDocument */\nvar write_styles_ods = /* @__PURE__ */(function() {\n\tvar master_styles = [\n\t\t'<office:master-styles>',\n\t\t\t'<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">',\n\t\t\t\t'<style:header/>',\n\t\t\t\t'<style:header-left style:display=\"false\"/>',\n\t\t\t\t'<style:footer/>',\n\t\t\t\t'<style:footer-left style:display=\"false\"/>',\n\t\t\t'</style:master-page>',\n\t\t'</office:master-styles>'\n\t].join(\"\");\n\n\tvar payload = '<office:document-styles ' + wxt_helper({\n\t\t'xmlns:office':   \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t'xmlns:table':    \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t'xmlns:style':    \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t'xmlns:text':     \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t'xmlns:draw':     \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t'xmlns:fo':       \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t'xmlns:xlink':    \"http://www.w3.org/1999/xlink\",\n\t\t'xmlns:dc':       \"http://purl.org/dc/elements/1.1/\",\n\t\t'xmlns:number':   \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t'xmlns:svg':      \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t'xmlns:of':       \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t'office:version': \"1.2\"\n\t}) + '>' + master_styles + '</office:document-styles>';\n\n\treturn function wso() {\n\t\treturn XML_HEADER + payload;\n\t};\n})();\n\n// TODO: find out if anyone actually read the spec.  LO has some wild errors\nfunction write_number_format_ods(nf, nfidx) {\n\tvar type = \"number\", payload = \"\", nopts = { \"style:name\": nfidx }, c = \"\", i = 0;\n\tnf = nf.replace(/\"[$]\"/g, \"$\");\n\t/* TODO: replace with an actual parser based on a real grammar */\n\tj: {\n\t\t// TODO: support style maps\n\t\tif(nf.indexOf(\";\") > -1) {\n\t\t\tconsole.error(\"Unsupported ODS Style Map exported.  Using first branch of \" + nf);\n\t\t\tnf = nf.slice(0, nf.indexOf(\";\"));\n\t\t}\n\n\t\tif(nf == \"@\") { type = \"text\"; payload = \"<number:text-content/>\"; break j; }\n\n\t\t/* currency flag */\n\t\tif(nf.indexOf(/\\$/) > -1) { type = \"currency\"; }\n\n\t\t/* opening string literal */\n\t\tif(nf[i] == '\"') {\n\t\t\tc = \"\";\n\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\tif(nf[i+1] == \"*\") {\n\t\t\t\ti++;\n\t\t\t\tpayload += '<number:fill-character>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:fill-character>';\n\t\t\t} else {\n\t\t\t\tpayload += '<number:text>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t}\n\t\t\tnf = nf.slice(i+1); i = 0;\n\t\t}\n\n\t\t/* fractions */\n\t\tvar t = nf.match(/# (\\?+)\\/(\\?+)/);\n\t\tif(t) { payload += writextag(\"number:fraction\", null, {\"number:min-integer-digits\":0, \"number:min-numerator-digits\": t[1].length, \"number:max-denominator-value\": Math.max(+(t[1].replace(/./g, \"9\")), +(t[2].replace(/./g, \"9\"))) }); break j; }\n\t\tif((t=nf.match(/# (\\?+)\\/(\\d+)/))) { payload += writextag(\"number:fraction\", null, {\"number:min-integer-digits\":0, \"number:min-numerator-digits\": t[1].length, \"number:denominator-value\": +t[2]}); break j; }\n\n\t\t/* percentages */\n\t\tif((t=nf.match(/(\\d+)(|\\.\\d+)%/))) { type = \"percentage\"; payload += writextag(\"number:number\", null, {\"number:decimal-places\": t[2] && t.length - 1 || 0, \"number:min-decimal-places\": t[2] && t.length - 1 || 0, \"number:min-integer-digits\": t[1].length }) + \"<number:text>%</number:text>\"; break j; }\n\n\t\t/* datetime */\n\t\tvar has_time = false;\n\t\tif([\"y\",\"m\",\"d\"].indexOf(nf[0]) > -1) {\n\t\t\ttype = \"date\";\n\t\t\tk: for(; i < nf.length; ++i) switch((c = nf[i].toLowerCase())) {\n\t\t\t\tcase \"h\": case \"s\": has_time = true; --i; break k;\n\t\t\t\tcase \"m\":\n\t\t\t\t\tl: for(var h = i+1; h < nf.length; ++h) switch(nf[h]) {\n\t\t\t\t\t\tcase \"y\": case \"d\": break l;\n\t\t\t\t\t\tcase \"h\": case \"s\": has_time = true; --i; break k;\n\t\t\t\t\t}\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase \"y\": case \"d\":\n\t\t\t\t\twhile((nf[++i]||\"\").toLowerCase() == c[0]) c += c[0]; --i;\n\t\t\t\t\tswitch(c) {\n\t\t\t\t\t\tcase \"y\": case \"yy\": payload += \"<number:year/>\"; break;\n\t\t\t\t\t\tcase \"yyy\": case \"yyyy\": payload += '<number:year number:style=\"long\"/>'; break;\n\t\t\t\t\t\tcase \"mmmmm\": console.error(\"ODS has no equivalent of format |mmmmm|\");\n\t\t\t\t\t\t\t/* falls through */\n\t\t\t\t\t\tcase \"m\": case \"mm\": case \"mmm\": case \"mmmm\":\n\t\t\t\t\t\t\tpayload += '<number:month number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\" number:textual=\"' + (c.length >= 3 ? \"true\" : \"false\") + '\"/>';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"d\": case \"dd\": payload += '<number:day number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t\tcase \"ddd\": case \"dddd\": payload += '<number:day-of-week number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\"':\n\t\t\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\t\t\tpayload += '<number:text>' + escapexml(c.slice(1).replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\\\\': c = nf[++i];\n\t\t\t\t\tpayload += '<number:text>' + escapexml(c) + '</number:text>'; break;\n\t\t\t\tcase '/': case ':': payload += '<number:text>' + escapexml(c) + '</number:text>'; break;\n\t\t\t\tdefault: console.error(\"unrecognized character \" + c + \" in ODF format \" + nf);\n\t\t\t}\n\t\t\tif(!has_time) break j;\n\t\t\tnf = nf.slice(i+1); i = 0;\n\t\t}\n\t\tif(nf.match(/^\\[?[hms]/)) {\n\t\t\tif(type == \"number\") type = \"time\";\n\t\t\tif(nf.match(/\\[/)) {\n\t\t\t\tnf = nf.replace(/[\\[\\]]/g, \"\");\n\t\t\t\tnopts['number:truncate-on-overflow'] = \"false\";\n\t\t\t}\n\t\t\tfor(; i < nf.length; ++i) switch((c = nf[i].toLowerCase())) {\n\t\t\t\tcase \"h\": case \"m\": case \"s\":\n\t\t\t\t\twhile((nf[++i]||\"\").toLowerCase() == c[0]) c += c[0]; --i;\n\t\t\t\t\tswitch(c) {\n\t\t\t\t\t\tcase \"h\": case \"hh\": payload += '<number:hours number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t\tcase \"m\": case \"mm\": payload += '<number:minutes number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t\tcase \"s\": case \"ss\":\n\t\t\t\t\t\t\tif(nf[i+1] == \".\") do { c += nf[i+1]; ++i; } while(nf[i+1] == \"0\");\n\t\t\t\t\t\t\tpayload += '<number:seconds number:style=\"' + (c.match(\"ss\") ? \"long\" : \"short\") + '\"' + (c.match(/\\./) ? ' number:decimal-places=\"' + (c.match(/0+/)||[\"\"])[0].length + '\"' : \"\")+ '/>'; break;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\"':\n\t\t\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\t\t\tpayload += '<number:text>' + escapexml(c.slice(1).replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t\t\tbreak;\n\t\t\t\tcase '/': case ':': payload += '<number:text>' + escapexml(c) + '</number:text>'; break;\n\t\t\t\tcase \"a\":\n\t\t\t\t\tif(nf.slice(i, i+3).toLowerCase() == \"a/p\") { payload += '<number:am-pm/>'; i += 2; break; } // Note: ODF does not support A/P\n\t\t\t\t\tif(nf.slice(i, i+5).toLowerCase() == \"am/pm\")  { payload += '<number:am-pm/>'; i += 4; break; }\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault: console.error(\"unrecognized character \" + c + \" in ODF format \" + nf);\n\t\t\t}\n\t\t\tbreak j;\n\t\t}\n\n\t\t/* currency flag */\n\t\tif(nf.indexOf(/\\$/) > -1) { type = \"currency\"; }\n\n\t\t/* should be in a char loop */\n\t\tif(nf[0] == \"$\") { payload += '<number:currency-symbol number:language=\"en\" number:country=\"US\">$</number:currency-symbol>'; nf = nf.slice(1); i = 0; }\n\t\ti = 0; if(nf[i] == '\"') {\n\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\tif(nf[i+1] == \"*\") {\n\t\t\t\ti++;\n\t\t\t\tpayload += '<number:fill-character>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:fill-character>';\n\t\t\t} else {\n\t\t\t\tpayload += '<number:text>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t}\n\t\t\tnf = nf.slice(i+1); i = 0;\n\t\t}\n\n\t\t/* number TODO: interstitial text e.g. 000)000-0000 */\n\t\tvar np = nf.match(/([#0][0#,]*)(\\.[0#]*|)(E[+]?0*|)/i);\n\t\tif(!np || !np[0]) console.error(\"Could not find numeric part of \" + nf);\n\t\telse {\n\t\t\tvar base = np[1].replace(/,/g, \"\");\n\t\t\tpayload += '<number:' + (np[3] ? \"scientific-\" : \"\")+ 'number' +\n\t\t\t\t' number:min-integer-digits=\"' + (base.indexOf(\"0\") == -1 ? \"0\" : base.length - base.indexOf(\"0\")) + '\"' +\n\t\t\t\t(np[0].indexOf(\",\") > -1 ? ' number:grouping=\"true\"' : \"\") +\n\t\t\t\t(np[2] && ' number:decimal-places=\"' + (np[2].length - 1) + '\"' || ' number:decimal-places=\"0\"') +\n\t\t\t\t(np[3] && np[3].indexOf(\"+\") > -1 ? ' number:forced-exponent-sign=\"true\"' : \"\" ) +\n\t\t\t\t(np[3] ? ' number:min-exponent-digits=\"' + np[3].match(/0+/)[0].length + '\"' : \"\" ) +\n\t\t\t\t'>' +\n\t\t\t\t/* TODO: interstitial text placeholders */\n\t\t\t\t'</number:' + (np[3] ? \"scientific-\" : \"\") + 'number>';\n\t\t\ti = np.index + np[0].length;\n\t\t}\n\n\t\t/* residual text */\n\t\tif(nf[i] == '\"') {\n\t\t\tc = \"\";\n\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\tpayload += '<number:text>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t}\n\t}\n\n\tif(!payload) { console.error(\"Could not generate ODS number format for |\" + nf + \"|\"); return \"\"; }\n\treturn writextag(\"number:\" + type + \"-style\", payload, nopts);\n}\n\nfunction write_names_ods(Names, SheetNames, idx) {\n\t//var scoped = Names.filter(function(name) { return name.Sheet == (idx == -1 ? null : idx); });\n\tvar scoped = []; for(var namei = 0; namei < Names.length; ++namei) {\n\t\tvar name = Names[namei];\n\t\tif(!name) continue;\n\t\tif(name.Sheet == (idx == -1 ? null : idx)) scoped.push(name);\n\t}\n\tif(!scoped.length) return \"\";\n\treturn \"      <table:named-expressions>\\n\" + scoped.map(function(name) {\n\t\tvar odsref =  (idx == -1 ? \"$\" : \"\") + csf_to_ods_3D(name.Ref);\n\t\treturn \"        \" + writextag(\"table:named-range\", null, {\n\t\t\t\"table:name\": name.Name,\n\t\t\t\"table:cell-range-address\": odsref,\n\t\t\t\"table:base-cell-address\": odsref.replace(/[\\.]?[^\\.]*$/, \".$A$1\")\n\t\t});\n\t}).join(\"\\n\") + \"\\n      </table:named-expressions>\\n\";\n}\nvar write_content_ods = /* @__PURE__ */(function() {\n\t/* 6.1.2 White Space Characters */\n\tvar write_text_p = function(text) {\n\t\treturn escapexml(text)\n\t\t\t.replace(/  +/g, function($$){return '<text:s text:c=\"'+$$.length+'\"/>';})\n\t\t\t.replace(/\\t/g, \"<text:tab/>\")\n\t\t\t.replace(/\\n/g, \"</text:p><text:p>\")\n\t\t\t.replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\n\t};\n\n\tvar null_cell_xml = '          <table:table-cell />\\n';\n\tvar write_ws = function(ws, wb, i, opts, nfs, date1904) {\n\t\t/* Section 9 Tables */\n\t\tvar o = [];\n\t\to.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\" table:style-name=\"ta1\">\\n');\n\t\tvar R=0,C=0, range = decode_range(ws['!ref']||\"A1\");\n\t\tvar marr = ws['!merges'] || [], mi = 0;\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tif(ws[\"!cols\"]) {\n\t\t\tfor(C = 0; C <= range.e.c; ++C) o.push('        <table:table-column' + (ws[\"!cols\"][C] ? ' table:style-name=\"co' + ws[\"!cols\"][C].ods + '\"' : '') + '></table:table-column>\\n');\n\t\t}\n\t\tvar H = \"\", ROWS = ws[\"!rows\"]||[];\n\t\tfor(R = 0; R < range.s.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '></table:table-row>\\n');\n\t\t}\n\t\tfor(; R <= range.e.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '>\\n');\n\t\t\tfor(C=0; C < range.s.c; ++C) o.push(null_cell_xml);\n\t\t\tfor(; C <= range.e.c; ++C) {\n\t\t\t\tvar skip = false, ct = {}, textp = \"\";\n\t\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\t\tct['table:number-columns-spanned'] = (marr[mi].e.c - marr[mi].s.c + 1);\n\t\t\t\t\tct['table:number-rows-spanned'] =    (marr[mi].e.r - marr[mi].s.r + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(skip) { o.push('          <table:covered-table-cell/>\\n'); continue; }\n\t\t\t\tvar ref = encode_cell({r:R, c:C}), cell = dense ? (ws[\"!data\"][R]||[])[C]: ws[ref];\n\t\t\t\tif(cell && cell.f) {\n\t\t\t\t\tct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\n\t\t\t\t\tif(cell.F) {\n\t\t\t\t\t\tif(cell.F.slice(0, ref.length) == ref) {\n\t\t\t\t\t\t\tvar _Fref = decode_range(cell.F);\n\t\t\t\t\t\t\tct['table:number-matrix-columns-spanned'] = (_Fref.e.c - _Fref.s.c + 1);\n\t\t\t\t\t\t\tct['table:number-matrix-rows-spanned'] =    (_Fref.e.r - _Fref.s.r + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!cell) { o.push(null_cell_xml); continue; }\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\ttextp = (cell.v ? 'TRUE' : 'FALSE');\n\t\t\t\t\t\tct['office:value-type'] = \"boolean\";\n\t\t\t\t\t\tct['office:boolean-value'] = (cell.v ? 'true' : 'false');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\ttextp = (cell.w||String(cell.v||0));\n\t\t\t\t\t\tct['office:value-type'] = \"float\";\n\t\t\t\t\t\tct['office:value'] = (cell.v||0);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's': case 'str':\n\t\t\t\t\t\ttextp = cell.v == null ? \"\" : cell.v;\n\t\t\t\t\t\tct['office:value-type'] = \"string\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\ttextp = (cell.w||(parseDate(cell.v, date1904).toISOString()));\n\t\t\t\t\t\tct['office:value-type'] = \"date\";\n\t\t\t\t\t\tct['office:date-value'] = (parseDate(cell.v, date1904).toISOString());\n\t\t\t\t\t\tct['table:style-name'] = \"ce1\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t//case 'e': // TODO: translate to ODS errors\n\t\t\t\t\tdefault: o.push(null_cell_xml); continue; // TODO: empty cell with comments\n\t\t\t\t}\n\t\t\t\tvar text_p = write_text_p(textp);\n\t\t\t\tif(cell.l && cell.l.Target) {\n\t\t\t\t\tvar _tgt = cell.l.Target;\n\t\t\t\t\t_tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;\n\t\t\t\t\t// TODO: choose correct parent path format based on link delimiters\n\t\t\t\t\tif(_tgt.charAt(0) != \"#\" && !_tgt.match(/^\\w+:/)) _tgt = '../' + _tgt;\n\t\t\t\t\ttext_p = writextag('text:a', text_p, {'xlink:href': _tgt.replace(/&/g, \"&amp;\")});\n\t\t\t\t}\n\t\t\t\tif(nfs[cell.z]) ct[\"table:style-name\"] = \"ce\" + nfs[cell.z].slice(1);\n\t\t\t\tvar payload = writextag('text:p', text_p, {});\n\t\t\t\tif(cell.c) {\n\t\t\t\t\tvar acreator = \"\", apayload = \"\", aprops = {};\n\t\t\t\t\tfor(var ci = 0; ci < cell.c.length; ++ci) {\n\t\t\t\t\t\tif(!acreator && cell.c[ci].a) acreator = cell.c[ci].a;\n\t\t\t\t\t\tapayload += \"<text:p>\" + write_text_p(cell.c[ci].t) + \"</text:p>\";\n\t\t\t\t\t}\n\t\t\t\t\tif(!cell.c.hidden) aprops[\"office:display\"] = true;\n\t\t\t\t\tpayload = writextag('office:annotation', apayload, aprops) + payload;\n\t\t\t\t}\n\t\t\t\to.push('          ' + writextag('table:table-cell', payload, ct) + '\\n');\n\t\t\t}\n\t\t\to.push('        </table:table-row>\\n');\n\t\t}\n\t\tif((wb.Workbook||{}).Names) o.push(write_names_ods(wb.Workbook.Names, wb.SheetNames, i));\n\t\to.push('      </table:table>\\n');\n\t\treturn o.join(\"\");\n\t};\n\n\tvar write_automatic_styles_ods = function(o, wb) {\n\t\to.push(' <office:automatic-styles>\\n');\n\n\t\t/* column styles */\n\t\tvar cidx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!cols\"]) {\n\t\t\t\tfor(var C = 0; C < ws[\"!cols\"].length; ++C) if(ws[\"!cols\"][C]) {\n\t\t\t\t\tvar colobj = ws[\"!cols\"][C];\n\t\t\t\t\tif(colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;\n\t\t\t\t\tprocess_col(colobj);\n\t\t\t\t\tcolobj.ods = cidx;\n\t\t\t\t\tvar w = ws[\"!cols\"][C].wpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"co' + cidx + '\" style:family=\"table-column\">\\n');\n\t\t\t\t\to.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"' + w + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++cidx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* row styles */\n\t\tvar ridx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!rows\"]) {\n\t\t\t\tfor(var R = 0; R < ws[\"!rows\"].length; ++R) if(ws[\"!rows\"][R]) {\n\t\t\t\t\tws[\"!rows\"][R].ods = ridx;\n\t\t\t\t\tvar h = ws[\"!rows\"][R].hpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"ro' + ridx + '\" style:family=\"table-row\">\\n');\n\t\t\t\t\to.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"' + h + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++ridx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* table */\n\t\to.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');\n\t\to.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');\n\t\to.push('  </style:style>\\n');\n\n\t\to.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\n\t\to.push('   <number:month number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:day number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:year/>\\n');\n\t\to.push('  </number:date-style>\\n');\n\n\t\t/* number formats, table cells, text */\n\t\tvar nfs = {};\n\t\tvar nfi = 69;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tvar dense = (ws[\"!data\"] != null);\n\t\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\t\tfor(var R = 0; R <= range.e.r; ++R) for(var C = 0; C <= range.e.c; ++C) {\n\t\t\t\tvar c = dense ? (ws[\"!data\"][R]||[])[C] : ws[encode_cell({r:R,c:C})];\n\t\t\t\tif(!c || !c.z || c.z.toLowerCase() == \"general\") continue;\n\t\t\t\tif(!nfs[c.z]) {\n\t\t\t\t\tvar out = write_number_format_ods(c.z, \"N\" + nfi);\n\t\t\t\t\tif(out) { nfs[c.z] = \"N\" + nfi; ++nfi; o.push(out + \"\\n\"); }\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\to.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\n\t\tkeys(nfs).forEach(function(nf) {\n\t\t\to.push('<style:style style:name=\"ce' + nfs[nf].slice(1) + '\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"' + nfs[nf] + '\"/>\\n');\n\t\t});\n\n\t\t/* page-layout */\n\n\t\to.push(' </office:automatic-styles>\\n');\n\t\treturn nfs;\n\t};\n\n\treturn function wcx(wb, opts) {\n\t\tvar o = [XML_HEADER];\n\t\t/* 3.1.3.2 */\n\t\tvar attr = wxt_helper({\n\t\t\t'xmlns:office':       \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t\t'xmlns:table':        \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t\t'xmlns:style':        \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t\t'xmlns:text':         \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t\t'xmlns:draw':         \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t\t'xmlns:fo':           \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t\t'xmlns:xlink':        \"http://www.w3.org/1999/xlink\",\n\t\t\t'xmlns:dc':           \"http://purl.org/dc/elements/1.1/\",\n\t\t\t'xmlns:meta':         \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\n\t\t\t'xmlns:number':       \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t\t'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\n\t\t\t'xmlns:svg':          \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t\t'xmlns:chart':        \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\n\t\t\t'xmlns:dr3d':         \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\n\t\t\t'xmlns:math':         \"http://www.w3.org/1998/Math/MathML\",\n\t\t\t'xmlns:form':         \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\n\t\t\t'xmlns:script':       \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\n\t\t\t'xmlns:ooo':          \"http://openoffice.org/2004/office\",\n\t\t\t'xmlns:ooow':         \"http://openoffice.org/2004/writer\",\n\t\t\t'xmlns:oooc':         \"http://openoffice.org/2004/calc\",\n\t\t\t'xmlns:dom':          \"http://www.w3.org/2001/xml-events\",\n\t\t\t'xmlns:xforms':       \"http://www.w3.org/2002/xforms\",\n\t\t\t'xmlns:xsd':          \"http://www.w3.org/2001/XMLSchema\",\n\t\t\t'xmlns:xsi':          \"http://www.w3.org/2001/XMLSchema-instance\",\n\t\t\t'xmlns:sheet':        \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\n\t\t\t'xmlns:rpt':          \"http://openoffice.org/2005/report\",\n\t\t\t'xmlns:of':           \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t\t'xmlns:xhtml':        \"http://www.w3.org/1999/xhtml\",\n\t\t\t'xmlns:grddl':        \"http://www.w3.org/2003/g/data-view#\",\n\t\t\t'xmlns:tableooo':     \"http://openoffice.org/2009/table\",\n\t\t\t'xmlns:drawooo':      \"http://openoffice.org/2010/draw\",\n\t\t\t'xmlns:calcext':      \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\n\t\t\t'xmlns:loext':        \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\n\t\t\t'xmlns:field':        \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\n\t\t\t'xmlns:formx':        \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\n\t\t\t'xmlns:css3t':        \"http://www.w3.org/TR/css3-text/\",\n\t\t\t'office:version':     \"1.2\"\n\t\t});\n\n\t\tvar fods = wxt_helper({\n\t\t\t'xmlns:config':    \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\n\t\t\t'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\n\t\t});\n\n\t\tif(opts.bookType == \"fods\") {\n\t\t\to.push('<office:document' + attr + fods + '>\\n');\n\t\t\to.push(write_meta_ods().replace(/<office:document-meta.*?>/, \"\").replace(/<\\/office:document-meta>/, \"\") + \"\\n\");\n\t\t\t// TODO: settings (equiv of settings.xml for ODS)\n\t\t} else o.push('<office:document-content' + attr  + '>\\n');\n\t\t// o.push('  <office:scripts/>\\n');\n\t\tvar nfs = write_automatic_styles_ods(o, wb);\n\t\to.push('  <office:body>\\n');\n\t\to.push('    <office:spreadsheet>\\n');\n\t\tif(((wb.Workbook||{}).WBProps||{}).date1904) o.push('      <table:calculation-settings table:case-sensitive=\"false\" table:search-criteria-must-apply-to-whole-cell=\"true\" table:use-wildcards=\"true\" table:use-regular-expressions=\"false\" table:automatic-find-labels=\"false\">\\n        <table:null-date table:date-value=\"1904-01-01\"/>\\n      </table:calculation-settings>\\n');\n\t\tfor(var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts, nfs, ((wb.Workbook||{}).WBProps||{}).date1904));\n\t\tif((wb.Workbook||{}).Names) o.push(write_names_ods(wb.Workbook.Names, wb.SheetNames, -1));\n\t\to.push('    </office:spreadsheet>\\n');\n\t\to.push('  </office:body>\\n');\n\t\tif(opts.bookType == \"fods\") o.push('</office:document>');\n\t\telse o.push('</office:document-content>');\n\t\treturn o.join(\"\");\n\t};\n})();\n\nfunction write_ods(wb, opts) {\n\tif(opts.bookType == \"fods\") return write_content_ods(wb, opts);\n\n\tvar zip = zip_new();\n\tvar f = \"\";\n\n\tvar manifest = [];\n\tvar rdf = [];\n\n\t/* Part 3 Section 3.3 MIME Media Type */\n\tf = \"mimetype\";\n\tzip_add_file(zip, f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n\t/* Part 1 Section 2.2 Documents */\n\tf = \"content.xml\";\n\tzip_add_file(zip, f, write_content_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"ContentFile\"]);\n\n\t/* TODO: these are hard-coded styles to satiate excel */\n\tf = \"styles.xml\";\n\tzip_add_file(zip, f, write_styles_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"StylesFile\"]);\n\n\t/* TODO: this is hard-coded to satiate excel */\n\tf = \"meta.xml\";\n\tzip_add_file(zip, f, XML_HEADER + write_meta_ods());\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"MetadataFile\"]);\n\n\t/* Part 3 Section 6 Metadata Manifest File */\n\tf = \"manifest.rdf\";\n\tzip_add_file(zip, f, write_rdf(rdf/*, opts*/));\n\tmanifest.push([f, \"application/rdf+xml\"]);\n\n\t/* Part 3 Section 4 Manifest File */\n\tf = \"META-INF/manifest.xml\";\n\tzip_add_file(zip, f, write_manifest(manifest/*, opts*/));\n\n\treturn zip;\n}\n\n/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\nvar subarray = function() {\n  try {\n    if (typeof Uint8Array == \"undefined\")\n      return \"slice\";\n    if (typeof Uint8Array.prototype.subarray == \"undefined\")\n      return \"slice\";\n    if (typeof Buffer !== \"undefined\") {\n      if (typeof Buffer.prototype.subarray == \"undefined\")\n        return \"slice\";\n      if ((typeof Buffer.from == \"function\" ? Buffer.from([72, 62]) : new Buffer([72, 62])) instanceof Uint8Array)\n        return \"subarray\";\n      return \"slice\";\n    }\n    return \"subarray\";\n  } catch (e) {\n    return \"slice\";\n  }\n}();\nfunction u8_to_dataview(array) {\n  return new DataView(array.buffer, array.byteOffset, array.byteLength);\n}\nfunction u8str(u8) {\n  return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n}\nfunction stru8(str) {\n  return typeof TextEncoder != \"undefined\" ? new TextEncoder().encode(str) : s2a(utf8write(str));\n}\nfunction u8concat(u8a) {\n  var len = 0;\n  for (var i = 0; i < u8a.length; ++i)\n    len += u8a[i].length;\n  var out = new Uint8Array(len);\n  var off = 0;\n  for (i = 0; i < u8a.length; ++i) {\n    var u8 = u8a[i], L = u8.length;\n    if (L < 250) {\n      for (var j = 0; j < L; ++j)\n        out[off++] = u8[j];\n    } else {\n      out.set(u8, off);\n      off += L;\n    }\n  }\n  return out;\n}\nfunction popcnt(x) {\n  x -= x >> 1 & 1431655765;\n  x = (x & 858993459) + (x >> 2 & 858993459);\n  return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n}\nfunction readDecimal128LE(buf, offset) {\n  var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n  var mantissa = buf[offset + 14] & 1;\n  for (var j = offset + 13; j >= offset; --j)\n    mantissa = mantissa * 256 + buf[j];\n  return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n}\nfunction writeDecimal128LE(buf, offset, value) {\n  var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 16;\n  var mantissa = value / Math.pow(10, exp - 6176);\n  buf[offset + 15] |= exp >> 7;\n  buf[offset + 14] |= (exp & 127) << 1;\n  for (var i = 0; mantissa >= 1; ++i, mantissa /= 256)\n    buf[offset + i] = mantissa & 255;\n  buf[offset + 15] |= value >= 0 ? 0 : 128;\n}\nfunction parse_varint49(buf, ptr) {\n  var l = ptr.l;\n  var usz = buf[l] & 127;\n  varint:\n    if (buf[l++] >= 128) {\n      usz |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 28);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 35);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 42);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n    }\n  ptr.l = l;\n  return usz;\n}\nfunction write_varint49(v) {\n  var usz = new Uint8Array(7);\n  usz[0] = v & 127;\n  var L = 1;\n  sz:\n    if (v > 127) {\n      usz[L - 1] |= 128;\n      usz[L] = v >> 7 & 127;\n      ++L;\n      if (v <= 16383)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 14 & 127;\n      ++L;\n      if (v <= 2097151)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 21 & 127;\n      ++L;\n      if (v <= 268435455)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 256 >>> 21 & 127;\n      ++L;\n      if (v <= 34359738367)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 65536 >>> 21 & 127;\n      ++L;\n      if (v <= 4398046511103)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 16777216 >>> 21 & 127;\n      ++L;\n    }\n  return usz[subarray](0, L);\n}\nfunction parse_packed_varints(buf) {\n  var ptr = { l: 0 };\n  var out = [];\n  while (ptr.l < buf.length)\n    out.push(parse_varint49(buf, ptr));\n  return out;\n}\nfunction write_packed_varints(nums) {\n  return u8concat(nums.map(function(x) {\n    return write_varint49(x);\n  }));\n}\nfunction varint_to_i32(buf) {\n  var l = 0, i32 = buf[l] & 127;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 127) << 7;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 127) << 14;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 127) << 21;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 15) << 28;\n  return i32;\n}\nfunction varint_to_u64(buf) {\n  var l = 0, lo = buf[l] & 127, hi = 0;\n  varint:\n    if (buf[l++] >= 128) {\n      lo |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      lo |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      lo |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      lo |= (buf[l] & 127) << 28;\n      hi = buf[l] >> 4 & 7;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 3;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 10;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 17;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 24;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 31;\n    }\n  return [lo >>> 0, hi >>> 0];\n}\nfunction parse_shallow(buf) {\n  var out = [], ptr = { l: 0 };\n  while (ptr.l < buf.length) {\n    var off = ptr.l;\n    var num = parse_varint49(buf, ptr);\n    var type = num & 7;\n    num = num / 8 | 0;\n    var data;\n    var l = ptr.l;\n    switch (type) {\n      case 0:\n        {\n          while (buf[l++] >= 128)\n            ;\n          data = buf[subarray](ptr.l, l);\n          ptr.l = l;\n        }\n        break;\n      case 1:\n        {\n          data = buf[subarray](l, l + 8);\n          ptr.l = l + 8;\n        }\n        break;\n      case 2:\n        {\n          var len = parse_varint49(buf, ptr);\n          data = buf[subarray](ptr.l, ptr.l + len);\n          ptr.l += len;\n        }\n        break;\n      case 5:\n        {\n          data = buf[subarray](l, l + 4);\n          ptr.l = l + 4;\n        }\n        break;\n      default:\n        throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n    }\n    var v = { data: data, type: type };\n    if (out[num] == null)\n      out[num] = [];\n    out[num].push(v);\n  }\n  return out;\n}\nfunction write_shallow(proto) {\n  var out = [];\n  proto.forEach(function(field, idx) {\n    if (idx == 0)\n      return;\n    field.forEach(function(item) {\n      if (!item.data)\n        return;\n      out.push(write_varint49(idx * 8 + item.type));\n      if (item.type == 2)\n        out.push(write_varint49(item.data.length));\n      out.push(item.data);\n    });\n  });\n  return u8concat(out);\n}\nfunction mappa(data, cb) {\n  return (data == null ? void 0 : data.map(function(d) {\n    return cb(d.data);\n  })) || [];\n}\nfunction parse_iwa_file(buf) {\n  var _a;\n  var out = [], ptr = { l: 0 };\n  while (ptr.l < buf.length) {\n    var len = parse_varint49(buf, ptr);\n    var ai = parse_shallow(buf[subarray](ptr.l, ptr.l + len));\n    ptr.l += len;\n    var res = {\n      id: varint_to_i32(ai[1][0].data),\n      messages: []\n    };\n    ai[2].forEach(function(b) {\n      var mi = parse_shallow(b.data);\n      var fl = varint_to_i32(mi[3][0].data);\n      res.messages.push({\n        meta: mi,\n        data: buf[subarray](ptr.l, ptr.l + fl)\n      });\n      ptr.l += fl;\n    });\n    if ((_a = ai[3]) == null ? void 0 : _a[0])\n      res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n    out.push(res);\n  }\n  return out;\n}\nfunction write_iwa_file(ias) {\n  var bufs = [];\n  ias.forEach(function(ia) {\n    var ai = [\n      [],\n      [{ data: write_varint49(ia.id), type: 0 }],\n      []\n    ];\n    if (ia.merge != null)\n      ai[3] = [{ data: write_varint49(+!!ia.merge), type: 0 }];\n    var midata = [];\n    ia.messages.forEach(function(mi) {\n      midata.push(mi.data);\n      mi.meta[3] = [{ type: 0, data: write_varint49(mi.data.length) }];\n      ai[2].push({ data: write_shallow(mi.meta), type: 2 });\n    });\n    var aipayload = write_shallow(ai);\n    bufs.push(write_varint49(aipayload.length));\n    bufs.push(aipayload);\n    midata.forEach(function(mid) {\n      return bufs.push(mid);\n    });\n  });\n  return u8concat(bufs);\n}\nfunction parse_snappy_chunk(type, buf) {\n  if (type != 0)\n    throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n  var ptr = { l: 0 };\n  var usz = parse_varint49(buf, ptr);\n  var chunks = [];\n  var l = ptr.l;\n  while (l < buf.length) {\n    var tag = buf[l] & 3;\n    if (tag == 0) {\n      var len = buf[l++] >> 2;\n      if (len < 60)\n        ++len;\n      else {\n        var c = len - 59;\n        len = buf[l];\n        if (c > 1)\n          len |= buf[l + 1] << 8;\n        if (c > 2)\n          len |= buf[l + 2] << 16;\n        if (c > 3)\n          len |= buf[l + 3] << 24;\n        len >>>= 0;\n        len++;\n        l += c;\n      }\n      chunks.push(buf[subarray](l, l + len));\n      l += len;\n      continue;\n    } else {\n      var offset = 0, length = 0;\n      if (tag == 1) {\n        length = (buf[l] >> 2 & 7) + 4;\n        offset = (buf[l++] & 224) << 3;\n        offset |= buf[l++];\n      } else {\n        length = (buf[l++] >> 2) + 1;\n        if (tag == 2) {\n          offset = buf[l] | buf[l + 1] << 8;\n          l += 2;\n        } else {\n          offset = (buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16 | buf[l + 3] << 24) >>> 0;\n          l += 4;\n        }\n      }\n      if (offset == 0)\n        throw new Error(\"Invalid offset 0\");\n      var j = chunks.length - 1, off = offset;\n      while (j >= 0 && off >= chunks[j].length) {\n        off -= chunks[j].length;\n        --j;\n      }\n      if (j < 0) {\n        if (off == 0)\n          off = chunks[j = 0].length;\n        else\n          throw new Error(\"Invalid offset beyond length\");\n      }\n      if (length < off)\n        chunks.push(chunks[j][subarray](chunks[j].length - off, chunks[j].length - off + length));\n      else {\n        if (off > 0) {\n          chunks.push(chunks[j][subarray](chunks[j].length - off));\n          length -= off;\n        }\n        ++j;\n        while (length >= chunks[j].length) {\n          chunks.push(chunks[j]);\n          length -= chunks[j].length;\n          ++j;\n        }\n        if (length)\n          chunks.push(chunks[j][subarray](0, length));\n      }\n      if (chunks.length > 25)\n        chunks = [u8concat(chunks)];\n    }\n  }\n  var clen = 0;\n  for (var u8i = 0; u8i < chunks.length; ++u8i)\n    clen += chunks[u8i].length;\n  if (clen != usz)\n    throw new Error(\"Unexpected length: \".concat(clen, \" != \").concat(usz));\n  return chunks;\n}\nfunction decompress_iwa_file(buf) {\n  if (Array.isArray(buf))\n    buf = new Uint8Array(buf);\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var t = buf[l++];\n    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n    l += 3;\n    out.push.apply(out, parse_snappy_chunk(t, buf[subarray](l, l + len)));\n    l += len;\n  }\n  if (l !== buf.length)\n    throw new Error(\"data is not a valid framed stream!\");\n  return out.length == 1 ? out[0] : u8concat(out);\n}\nfunction compress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var c = Math.min(buf.length - l, 268435455);\n    var frame = new Uint8Array(4);\n    out.push(frame);\n    var usz = write_varint49(c);\n    var L = usz.length;\n    out.push(usz);\n    if (c <= 60) {\n      L++;\n      out.push(new Uint8Array([c - 1 << 2]));\n    } else if (c <= 256) {\n      L += 2;\n      out.push(new Uint8Array([240, c - 1 & 255]));\n    } else if (c <= 65536) {\n      L += 3;\n      out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));\n    } else if (c <= 16777216) {\n      L += 4;\n      out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));\n    } else if (c <= 4294967296) {\n      L += 5;\n      out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));\n    }\n    out.push(buf[subarray](l, l + c));\n    L += c;\n    frame[0] = 0;\n    frame[1] = L & 255;\n    frame[2] = L >> 8 & 255;\n    frame[3] = L >> 16 & 255;\n    l += c;\n  }\n  return u8concat(out);\n}\nvar numbers_lut_new = function() {\n  return { sst: [], rsst: [], ofmt: [], nfmt: [], fmla: [], ferr: [], cmnt: [] };\n};\nfunction numbers_format_cell(cell, t, flags, ofmt, nfmt) {\n  var _a, _b, _c, _d;\n  var ctype = t & 255, ver = t >> 8;\n  var fmt = ver >= 5 ? nfmt : ofmt;\n  dur:\n    if (flags & (ver > 4 ? 8 : 4) && cell.t == \"n\" && ctype == 7) {\n      var dstyle = ((_a = fmt[7]) == null ? void 0 : _a[0]) ? varint_to_i32(fmt[7][0].data) : -1;\n      if (dstyle == -1)\n        break dur;\n      var dmin = ((_b = fmt[15]) == null ? void 0 : _b[0]) ? varint_to_i32(fmt[15][0].data) : -1;\n      var dmax = ((_c = fmt[16]) == null ? void 0 : _c[0]) ? varint_to_i32(fmt[16][0].data) : -1;\n      var auto = ((_d = fmt[40]) == null ? void 0 : _d[0]) ? varint_to_i32(fmt[40][0].data) : -1;\n      var d = cell.v, dd = d;\n      autodur:\n        if (auto) {\n          if (d == 0) {\n            dmin = dmax = 2;\n            break autodur;\n          }\n          if (d >= 604800)\n            dmin = 1;\n          else if (d >= 86400)\n            dmin = 2;\n          else if (d >= 3600)\n            dmin = 4;\n          else if (d >= 60)\n            dmin = 8;\n          else if (d >= 1)\n            dmin = 16;\n          else\n            dmin = 32;\n          if (Math.floor(d) != d)\n            dmax = 32;\n          else if (d % 60)\n            dmax = 16;\n          else if (d % 3600)\n            dmax = 8;\n          else if (d % 86400)\n            dmax = 4;\n          else if (d % 604800)\n            dmax = 2;\n          if (dmax < dmin)\n            dmax = dmin;\n        }\n      if (dmin == -1 || dmax == -1)\n        break dur;\n      var dstr = [], zstr = [];\n      if (dmin == 1) {\n        dd = d / 604800;\n        if (dmax == 1) {\n          zstr.push('d\"d\"');\n        } else {\n          dd |= 0;\n          d -= 604800 * dd;\n        }\n        dstr.push(dd + (dstyle == 2 ? \" week\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"w\" : \"\"));\n      }\n      if (dmin <= 2 && dmax >= 2) {\n        dd = d / 86400;\n        if (dmax > 2) {\n          dd |= 0;\n          d -= 86400 * dd;\n        }\n        zstr.push('d\"d\"');\n        dstr.push(dd + (dstyle == 2 ? \" day\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"d\" : \"\"));\n      }\n      if (dmin <= 4 && dmax >= 4) {\n        dd = d / 3600;\n        if (dmax > 4) {\n          dd |= 0;\n          d -= 3600 * dd;\n        }\n        zstr.push((dmin >= 4 ? \"[h]\" : \"h\") + '\"h\"');\n        dstr.push(dd + (dstyle == 2 ? \" hour\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"h\" : \"\"));\n      }\n      if (dmin <= 8 && dmax >= 8) {\n        dd = d / 60;\n        if (dmax > 8) {\n          dd |= 0;\n          d -= 60 * dd;\n        }\n        zstr.push((dmin >= 8 ? \"[m]\" : \"m\") + '\"m\"');\n        if (dstyle == 0)\n          dstr.push((dmin == 8 && dmax == 8 || dd >= 10 ? \"\" : \"0\") + dd);\n        else\n          dstr.push(dd + (dstyle == 2 ? \" minute\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"m\" : \"\"));\n      }\n      if (dmin <= 16 && dmax >= 16) {\n        dd = d;\n        if (dmax > 16) {\n          dd |= 0;\n          d -= dd;\n        }\n        zstr.push((dmin >= 16 ? \"[s]\" : \"s\") + '\"s\"');\n        if (dstyle == 0)\n          dstr.push((dmax == 16 && dmin == 16 || dd >= 10 ? \"\" : \"0\") + dd);\n        else\n          dstr.push(dd + (dstyle == 2 ? \" second\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"s\" : \"\"));\n      }\n      if (dmax >= 32) {\n        dd = Math.round(1e3 * d);\n        if (dmin < 32)\n          zstr.push('.000\"ms\"');\n        if (dstyle == 0)\n          dstr.push((dd >= 100 ? \"\" : dd >= 10 ? \"0\" : \"00\") + dd);\n        else\n          dstr.push(dd + (dstyle == 2 ? \" millisecond\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"ms\" : \"\"));\n      }\n      cell.w = dstr.join(dstyle == 0 ? \":\" : \" \");\n      cell.z = zstr.join(dstyle == 0 ? '\":\"' : \" \");\n      if (dstyle == 0)\n        cell.w = cell.w.replace(/:(\\d\\d\\d)$/, \".$1\");\n    }\n}\nfunction parse_old_storage(buf, lut, v, opts) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var ridx = -1, sidx = -1, zidx = -1, ieee = NaN, dc = 0, dt = new Date(Date.UTC(2001, 0, 1));\n  var doff = v > 1 ? 12 : 8;\n  if (flags & 2) {\n    zidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(flags & (v > 1 ? 3468 : 396)) * 4;\n  if (flags & 512) {\n    ridx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n  if (flags & 16) {\n    sidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  if (flags & 32) {\n    ieee = dv.getFloat64(doff, true);\n    doff += 8;\n  }\n  if (flags & 64) {\n    dt.setTime(dt.getTime() + (dc = dv.getFloat64(doff, true)) * 1e3);\n    doff += 8;\n  }\n  if (v > 1) {\n    flags = dv.getUint32(8, true) >>> 16;\n    if (flags & 255) {\n      if (zidx == -1)\n        zidx = dv.getUint32(doff, true);\n      doff += 4;\n    }\n  }\n  var ret;\n  var t = buf[v >= 4 ? 1 : 2];\n  switch (t) {\n    case 0:\n      return void 0;\n    case 2:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 3:\n      ret = { t: \"s\", v: lut.sst[sidx] };\n      break;\n    case 5:\n      {\n        if (opts == null ? void 0 : opts.cellDates)\n          ret = { t: \"d\", v: dt };\n        else\n          ret = { t: \"n\", v: dc / 86400 + 35430, z: table_fmt[14] };\n      }\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1) {\n          var rts = lut.rsst[ridx];\n          ret = { t: \"s\", v: rts.v };\n          if (rts.l)\n            ret.l = { Target: rts.l };\n        } else\n          throw new Error(\"Unsupported cell type \".concat(buf[subarray](0, 4)));\n      }\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[subarray](0, 4)));\n  }\n  if (zidx > -1)\n    numbers_format_cell(ret, t | v << 8, flags, lut.ofmt[zidx], lut.nfmt[zidx]);\n  if (t == 7)\n    ret.v /= 86400;\n  return ret;\n}\nfunction parse_new_storage(buf, lut, opts) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var fields = dv.getUint32(8, true);\n  var doff = 12;\n  var ridx = -1, sidx = -1, zidx = -1, d128 = NaN, ieee = NaN, dc = 0, dt = new Date(Date.UTC(2001, 0, 1)), eidx = -1, fidx = -1;\n  if (fields & 1) {\n    d128 = readDecimal128LE(buf, doff);\n    doff += 16;\n  }\n  if (fields & 2) {\n    ieee = dv.getFloat64(doff, true);\n    doff += 8;\n  }\n  if (fields & 4) {\n    dt.setTime(dt.getTime() + (dc = dv.getFloat64(doff, true)) * 1e3);\n    doff += 8;\n  }\n  if (fields & 8) {\n    sidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  if (fields & 16) {\n    ridx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(fields & 480) * 4;\n  if (fields & 512) {\n    fidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(fields & 1024) * 4;\n  if (fields & 2048) {\n    eidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  var ret;\n  var t = buf[1];\n  switch (t) {\n    case 0:\n      ret = { t: \"z\" };\n      break;\n    case 2:\n      ret = { t: \"n\", v: d128 };\n      break;\n    case 3:\n      ret = { t: \"s\", v: lut.sst[sidx] };\n      break;\n    case 5:\n      {\n        if (opts == null ? void 0 : opts.cellDates)\n          ret = { t: \"d\", v: dt };\n        else\n          ret = { t: \"n\", v: dc / 86400 + 35430, z: table_fmt[14] };\n      }\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1) {\n          var rts = lut.rsst[ridx];\n          ret = { t: \"s\", v: rts.v };\n          if (rts.l)\n            ret.l = { Target: rts.l };\n        } else\n          throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(fields & 31, \" : \").concat(buf[subarray](0, 4)));\n      }\n      break;\n    case 10:\n      ret = { t: \"n\", v: d128 };\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(fields & 31, \" : \").concat(buf[subarray](0, 4)));\n  }\n  doff += popcnt(fields & 4096) * 4;\n  if (fields & 516096) {\n    if (zidx == -1)\n      zidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  if (fields & 524288) {\n    var cmntidx = dv.getUint32(doff, true);\n    doff += 4;\n    if (lut.cmnt[cmntidx])\n      ret.c = iwa_to_s5s_comment(lut.cmnt[cmntidx]);\n  }\n  if (zidx > -1)\n    numbers_format_cell(ret, t | 5 << 8, fields >> 13, lut.ofmt[zidx], lut.nfmt[zidx]);\n  if (t == 7)\n    ret.v /= 86400;\n  return ret;\n}\nfunction write_new_storage(cell, lut) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, fields = 0;\n  out[0] = 5;\n  switch (cell.t) {\n    case \"n\":\n      if (cell.z && fmt_is_date(cell.z)) {\n        out[1] = 5;\n        dv.setFloat64(l, (numdate(cell.v + 1462).getTime() - Date.UTC(2001, 0, 1)) / 1e3, true);\n        fields |= 4;\n        l += 8;\n        break;\n      } else {\n        out[1] = 2;\n        writeDecimal128LE(out, l, cell.v);\n        fields |= 1;\n        l += 16;\n      }\n      break;\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      fields |= 2;\n      l += 8;\n      break;\n    case \"s\":\n      {\n        var s = cell.v == null ? \"\" : String(cell.v);\n        if (cell.l) {\n          var irsst = lut.rsst.findIndex(function(v) {\n            var _a;\n            return v.v == s && v.l == ((_a = cell.l) == null ? void 0 : _a.Target);\n          });\n          if (irsst == -1)\n            lut.rsst[irsst = lut.rsst.length] = { v: s, l: cell.l.Target };\n          out[1] = 9;\n          dv.setUint32(l, irsst, true);\n          fields |= 16;\n          l += 4;\n        } else {\n          var isst = lut.sst.indexOf(s);\n          if (isst == -1)\n            lut.sst[isst = lut.sst.length] = s;\n          out[1] = 3;\n          dv.setUint32(l, isst, true);\n          fields |= 8;\n          l += 4;\n        }\n      }\n      break;\n    case \"d\":\n      out[1] = 5;\n      dv.setFloat64(l, (cell.v.getTime() - Date.UTC(2001, 0, 1)) / 1e3, true);\n      fields |= 4;\n      l += 8;\n      break;\n    case \"z\":\n      out[1] = 0;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  if (cell.c) {\n    lut.cmnt.push(s5s_to_iwa_comment(cell.c));\n    dv.setUint32(l, lut.cmnt.length - 1, true);\n    fields |= 524288;\n    l += 4;\n  }\n  dv.setUint32(8, fields, true);\n  return out[subarray](0, l);\n}\nfunction write_old_storage(cell, lut) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, fields = 0, s = \"\";\n  out[0] = 4;\n  switch (cell.t) {\n    case \"n\":\n      break;\n    case \"b\":\n      break;\n    case \"s\":\n      {\n        s = cell.v == null ? \"\" : String(cell.v);\n        if (cell.l) {\n          var irsst = lut.rsst.findIndex(function(v) {\n            var _a;\n            return v.v == s && v.l == ((_a = cell.l) == null ? void 0 : _a.Target);\n          });\n          if (irsst == -1)\n            lut.rsst[irsst = lut.rsst.length] = { v: s, l: cell.l.Target };\n          out[1] = 9;\n          dv.setUint32(l, irsst, true);\n          fields |= 512;\n          l += 4;\n        } else {\n        }\n      }\n      break;\n    case \"d\":\n      break;\n    case \"e\":\n      break;\n    case \"z\":\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  if (cell.c) {\n    dv.setUint32(l, lut.cmnt.length - 1, true);\n    fields |= 4096;\n    l += 4;\n  }\n  switch (cell.t) {\n    case \"n\":\n      out[1] = 2;\n      dv.setFloat64(l, cell.v, true);\n      fields |= 32;\n      l += 8;\n      break;\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      fields |= 32;\n      l += 8;\n      break;\n    case \"s\":\n      {\n        s = cell.v == null ? \"\" : String(cell.v);\n        if (cell.l) {\n        } else {\n          var isst = lut.sst.indexOf(s);\n          if (isst == -1)\n            lut.sst[isst = lut.sst.length] = s;\n          out[1] = 3;\n          dv.setUint32(l, isst, true);\n          fields |= 16;\n          l += 4;\n        }\n      }\n      break;\n    case \"d\":\n      out[1] = 5;\n      dv.setFloat64(l, (cell.v.getTime() - Date.UTC(2001, 0, 1)) / 1e3, true);\n      fields |= 64;\n      l += 8;\n      break;\n    case \"z\":\n      out[1] = 0;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  dv.setUint32(8, fields, true);\n  return out[subarray](0, l);\n}\nfunction parse_cell_storage(buf, lut, opts) {\n  switch (buf[0]) {\n    case 0:\n    case 1:\n    case 2:\n    case 3:\n    case 4:\n      return parse_old_storage(buf, lut, buf[0], opts);\n    case 5:\n      return parse_new_storage(buf, lut, opts);\n    default:\n      throw new Error(\"Unsupported payload version \".concat(buf[0]));\n  }\n}\nfunction parse_TSP_Reference(buf) {\n  var pb = parse_shallow(buf);\n  return varint_to_i32(pb[1][0].data);\n}\nfunction write_TSP_Reference(idx) {\n  return write_shallow([\n    [],\n    [{ type: 0, data: write_varint49(idx) }]\n  ]);\n}\nfunction numbers_add_oref(iwa, ref) {\n  var _a;\n  var orefs = ((_a = iwa.messages[0].meta[5]) == null ? void 0 : _a[0]) ? parse_packed_varints(iwa.messages[0].meta[5][0].data) : [];\n  var orefidx = orefs.indexOf(ref);\n  if (orefidx == -1) {\n    orefs.push(ref);\n    iwa.messages[0].meta[5] = [{ type: 2, data: write_packed_varints(orefs) }];\n  }\n}\nfunction numbers_del_oref(iwa, ref) {\n  var _a;\n  var orefs = ((_a = iwa.messages[0].meta[5]) == null ? void 0 : _a[0]) ? parse_packed_varints(iwa.messages[0].meta[5][0].data) : [];\n  iwa.messages[0].meta[5] = [{ type: 2, data: write_packed_varints(orefs.filter(function(r) {\n    return r != ref;\n  })) }];\n}\nfunction parse_TST_TableDataList(M, root) {\n  var pb = parse_shallow(root.data);\n  var type = varint_to_i32(pb[1][0].data);\n  var entries = pb[3];\n  var data = [];\n  (entries || []).forEach(function(entry) {\n    var _a, _b;\n    var le = parse_shallow(entry.data);\n    if (!le[1])\n      return;\n    var key = varint_to_i32(le[1][0].data) >>> 0;\n    switch (type) {\n      case 1:\n        data[key] = u8str(le[3][0].data);\n        break;\n      case 8:\n        {\n          var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n          var rtp = parse_shallow(rt.data);\n          var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n          var mtype = varint_to_i32(rtpref.meta[1][0].data);\n          if (mtype != 2001)\n            throw new Error(\"2000 unexpected reference to \".concat(mtype));\n          var tswpsa = parse_shallow(rtpref.data);\n          var richtext = { v: tswpsa[3].map(function(x) {\n            return u8str(x.data);\n          }).join(\"\") };\n          data[key] = richtext;\n          sfields:\n            if ((_a = tswpsa == null ? void 0 : tswpsa[11]) == null ? void 0 : _a[0]) {\n              var smartfields = (_b = parse_shallow(tswpsa[11][0].data)) == null ? void 0 : _b[1];\n              if (!smartfields)\n                break sfields;\n              smartfields.forEach(function(sf) {\n                var _a2, _b2, _c;\n                var attr = parse_shallow(sf.data);\n                if ((_a2 = attr[2]) == null ? void 0 : _a2[0]) {\n                  var obj = M[parse_TSP_Reference((_b2 = attr[2]) == null ? void 0 : _b2[0].data)][0];\n                  var objtype = varint_to_i32(obj.meta[1][0].data);\n                  switch (objtype) {\n                    case 2032:\n                      var hlink = parse_shallow(obj.data);\n                      if (((_c = hlink == null ? void 0 : hlink[2]) == null ? void 0 : _c[0]) && !richtext.l)\n                        richtext.l = u8str(hlink[2][0].data);\n                      break;\n                    case 2039:\n                      break;\n                    default:\n                      console.log(\"unrecognized ObjectAttribute type \".concat(objtype));\n                  }\n                }\n              });\n            }\n        }\n        break;\n      case 2:\n        data[key] = parse_shallow(le[6][0].data);\n        break;\n      case 3:\n        data[key] = parse_shallow(le[5][0].data);\n        break;\n      case 10:\n        {\n          var cs = M[parse_TSP_Reference(le[10][0].data)][0];\n          data[key] = parse_TSD_CommentStorageArchive(M, cs.data);\n        }\n        break;\n      default:\n        throw type;\n    }\n  });\n  return data;\n}\nfunction parse_TST_TileRowInfo(u8, type) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n  var pb = parse_shallow(u8);\n  var R = varint_to_i32(pb[1][0].data) >>> 0;\n  var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n  var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n  var used_storage_u8, used_storage;\n  if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n    used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n    used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n  } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n    used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n    used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n  } else\n    throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n  var width = wide_offsets ? 4 : 1;\n  var used_storage_offsets = u8_to_dataview(used_storage_u8);\n  var offsets = [];\n  for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n    var off = used_storage_offsets.getUint16(C * 2, true);\n    if (off < 65535)\n      offsets.push([C, off]);\n  }\n  if (offsets.length != cnt)\n    throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n  var cells = [];\n  for (C = 0; C < offsets.length - 1; ++C)\n    cells[offsets[C][0]] = used_storage[subarray](offsets[C][1] * width, offsets[C + 1][1] * width);\n  if (offsets.length >= 1)\n    cells[offsets[offsets.length - 1][0]] = used_storage[subarray](offsets[offsets.length - 1][1] * width);\n  return { R: R, cells: cells };\n}\nfunction parse_TST_Tile(M, root) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var storage = -1;\n  if ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) {\n    if (varint_to_i32(pb[7][0].data) >>> 0)\n      storage = 1;\n    else\n      storage = 0;\n  }\n  var ri = mappa(pb[5], function(u8) {\n    return parse_TST_TileRowInfo(u8, storage);\n  });\n  return {\n    nrows: varint_to_i32(pb[4][0].data) >>> 0,\n    data: ri.reduce(function(acc, x) {\n      if (!acc[x.R])\n        acc[x.R] = [];\n      x.cells.forEach(function(cell, C) {\n        if (acc[x.R][C])\n          throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n        acc[x.R][C] = cell;\n      });\n      return acc;\n    }, [])\n  };\n}\nfunction parse_TSD_CommentStorageArchive(M, data) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j;\n  var out = { t: \"\", a: \"\" };\n  var csp = parse_shallow(data);\n  if ((_b = (_a = csp == null ? void 0 : csp[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data)\n    out.t = u8str((_d = (_c = csp == null ? void 0 : csp[1]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) || \"\";\n  if ((_f = (_e = csp == null ? void 0 : csp[3]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data) {\n    var as = M[parse_TSP_Reference((_h = (_g = csp == null ? void 0 : csp[3]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data)][0];\n    var asp = parse_shallow(as.data);\n    if ((_j = (_i = asp[1]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data)\n      out.a = u8str(asp[1][0].data);\n  }\n  if (csp == null ? void 0 : csp[4]) {\n    out.replies = [];\n    csp[4].forEach(function(pi) {\n      var cs = M[parse_TSP_Reference(pi.data)][0];\n      out.replies.push(parse_TSD_CommentStorageArchive(M, cs.data));\n    });\n  }\n  return out;\n}\nfunction iwa_to_s5s_comment(iwa) {\n  var out = [];\n  out.push({ t: iwa.t || \"\", a: iwa.a, T: iwa.replies && iwa.replies.length > 0 });\n  if (iwa.replies)\n    iwa.replies.forEach(function(reply) {\n      out.push({ t: reply.t || \"\", a: reply.a, T: true });\n    });\n  return out;\n}\nfunction s5s_to_iwa_comment(s5s) {\n  var out = { a: \"\", t: \"\", replies: [] };\n  for (var i = 0; i < s5s.length; ++i) {\n    if (i == 0) {\n      out.a = s5s[i].a;\n      out.t = s5s[i].t;\n    } else {\n      out.replies.push({ a: s5s[i].a, t: s5s[i].t });\n    }\n  }\n  return out;\n}\nfunction parse_TST_TableModelArchive(M, root, ws, opts) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i;\n  var pb = parse_shallow(root.data);\n  var range = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } };\n  range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n  if (range.e.r < 0)\n    throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n  range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n  if (range.e.c < 0)\n    throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n  ws[\"!ref\"] = encode_range(range);\n  var dense = ws[\"!data\"] != null, dws = ws;\n  var store = parse_shallow(pb[4][0].data);\n  var lut = numbers_lut_new();\n  if ((_a = store[4]) == null ? void 0 : _a[0])\n    lut.sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n  if ((_b = store[6]) == null ? void 0 : _b[0])\n    lut.fmla = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[6][0].data)][0]);\n  if ((_c = store[11]) == null ? void 0 : _c[0])\n    lut.ofmt = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[11][0].data)][0]);\n  if ((_d = store[12]) == null ? void 0 : _d[0])\n    lut.ferr = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[12][0].data)][0]);\n  if ((_e = store[17]) == null ? void 0 : _e[0])\n    lut.rsst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]);\n  if ((_f = store[19]) == null ? void 0 : _f[0])\n    lut.cmnt = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[19][0].data)][0]);\n  if ((_g = store[22]) == null ? void 0 : _g[0])\n    lut.nfmt = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[22][0].data)][0]);\n  var tile = parse_shallow(store[3][0].data);\n  var _R = 0;\n  tile[1].forEach(function(t) {\n    var tl = parse_shallow(t.data);\n    var ref2 = M[parse_TSP_Reference(tl[2][0].data)][0];\n    var mtype2 = varint_to_i32(ref2.meta[1][0].data);\n    if (mtype2 != 6002)\n      throw new Error(\"6001 unexpected reference to \".concat(mtype2));\n    var _tile = parse_TST_Tile(M, ref2);\n    _tile.data.forEach(function(row, R) {\n      row.forEach(function(buf, C) {\n        var res = parse_cell_storage(buf, lut, opts);\n        if (res) {\n          if (dense) {\n            if (!dws[\"!data\"][_R + R])\n              dws[\"!data\"][_R + R] = [];\n            dws[\"!data\"][_R + R][C] = res;\n          } else {\n            ws[encode_col(C) + encode_row(_R + R)] = res;\n          }\n        }\n      });\n    });\n    _R += _tile.nrows;\n  });\n  if ((_h = store[13]) == null ? void 0 : _h[0]) {\n    var ref = M[parse_TSP_Reference(store[13][0].data)][0];\n    var mtype = varint_to_i32(ref.meta[1][0].data);\n    if (mtype != 6144)\n      throw new Error(\"Expected merge type 6144, found \".concat(mtype));\n    ws[\"!merges\"] = (_i = parse_shallow(ref.data)) == null ? void 0 : _i[1].map(function(pi) {\n      var merge = parse_shallow(pi.data);\n      var origin = u8_to_dataview(parse_shallow(merge[1][0].data)[1][0].data), size = u8_to_dataview(parse_shallow(merge[2][0].data)[1][0].data);\n      return {\n        s: { r: origin.getUint16(0, true), c: origin.getUint16(2, true) },\n        e: {\n          r: origin.getUint16(0, true) + size.getUint16(0, true) - 1,\n          c: origin.getUint16(2, true) + size.getUint16(2, true) - 1\n        }\n      };\n    });\n  }\n}\nfunction parse_TST_TableInfoArchive(M, root, opts) {\n  var pb = parse_shallow(root.data);\n  var out = { \"!ref\": \"A1\" };\n  if (opts == null ? void 0 : opts.dense)\n    out[\"!data\"] = [];\n  var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n  var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n  if (mtype != 6001)\n    throw new Error(\"6000 unexpected reference to \".concat(mtype));\n  parse_TST_TableModelArchive(M, tableref[0], out, opts);\n  return out;\n}\nfunction parse_TN_SheetArchive(M, root, opts) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var out = {\n    name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n    sheets: []\n  };\n  var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n  shapeoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 6e3)\n        out.sheets.push(parse_TST_TableInfoArchive(M, m, opts));\n    });\n  });\n  return out;\n}\nfunction parse_TN_DocumentArchive(M, root, opts) {\n  var _a;\n  var out = book_new();\n  out.Workbook = { WBProps: { date1904: true } };\n  var pb = parse_shallow(root.data);\n  if ((_a = pb[2]) == null ? void 0 : _a[0])\n    throw new Error(\"Keynote presentations are not supported\");\n  var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n  sheetoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 2) {\n        var root2 = parse_TN_SheetArchive(M, m, opts);\n        root2.sheets.forEach(function(sheet, idx) {\n          book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n        });\n      }\n    });\n  });\n  if (out.SheetNames.length == 0)\n    throw new Error(\"Empty NUMBERS file\");\n  out.bookType = \"numbers\";\n  return out;\n}\nfunction parse_numbers_iwa(cfb, opts) {\n  var _a, _b, _c, _d, _e, _f, _g;\n  var M = {}, indices = [];\n  cfb.FullPaths.forEach(function(p) {\n    if (p.match(/\\.iwpv2/))\n      throw new Error(\"Unsupported password protection\");\n  });\n  cfb.FileIndex.forEach(function(s) {\n    if (!s.name.match(/\\.iwa$/))\n      return;\n    if (s.content[0] != 0)\n      return;\n    var o;\n    try {\n      o = decompress_iwa_file(s.content);\n    } catch (e) {\n      return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n    }\n    var packets;\n    try {\n      packets = parse_iwa_file(o);\n    } catch (e) {\n      return console.log(\"## \" + (e.message || e));\n    }\n    packets.forEach(function(packet) {\n      M[packet.id] = packet.messages;\n      indices.push(packet.id);\n    });\n  });\n  if (!indices.length)\n    throw new Error(\"File has no messages\");\n  if (((_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0].meta) == null ? void 0 : _b[1]) == null ? void 0 : _c[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1e4)\n    throw new Error(\"Pages documents are not supported\");\n  var docroot = ((_g = (_f = (_e = (_d = M == null ? void 0 : M[1]) == null ? void 0 : _d[0]) == null ? void 0 : _e.meta) == null ? void 0 : _f[1]) == null ? void 0 : _g[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n  if (!docroot)\n    indices.forEach(function(idx) {\n      M[idx].forEach(function(iwam) {\n        var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n        if (mtype == 1) {\n          if (!docroot)\n            docroot = iwam;\n          else\n            throw new Error(\"Document has multiple roots\");\n        }\n      });\n    });\n  if (!docroot)\n    throw new Error(\"Cannot find Document root\");\n  return parse_TN_DocumentArchive(M, docroot, opts);\n}\nfunction write_TST_TileRowInfo(data, lut, wide) {\n  var _a, _b, _c;\n  var tri = [\n    [],\n    [{ type: 0, data: write_varint49(0) }],\n    [{ type: 0, data: write_varint49(0) }],\n    [{ type: 2, data: new Uint8Array([]) }],\n    [{ type: 2, data: new Uint8Array(Array.from({ length: 510 }, function() {\n      return 255;\n    })) }],\n    [{ type: 0, data: write_varint49(5) }],\n    [{ type: 2, data: new Uint8Array([]) }],\n    [{ type: 2, data: new Uint8Array(Array.from({ length: 510 }, function() {\n      return 255;\n    })) }],\n    [{ type: 0, data: write_varint49(1) }]\n  ];\n  if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0]))\n    throw \"Mutation only works on post-BNC storages!\";\n  var cnt = 0;\n  if (tri[7][0].data.length < 2 * data.length) {\n    var new_7 = new Uint8Array(2 * data.length);\n    new_7.set(tri[7][0].data);\n    tri[7][0].data = new_7;\n  }\n  if (tri[4][0].data.length < 2 * data.length) {\n    var new_4 = new Uint8Array(2 * data.length);\n    new_4.set(tri[4][0].data);\n    tri[4][0].data = new_4;\n  }\n  var dv = u8_to_dataview(tri[7][0].data), last_offset = 0, cell_storage = [];\n  var _dv = u8_to_dataview(tri[4][0].data), _last_offset = 0, _cell_storage = [];\n  var width = wide ? 4 : 1;\n  for (var C = 0; C < data.length; ++C) {\n    if (data[C] == null || data[C].t == \"z\" && !((_c = data[C].c) == null ? void 0 : _c.length) || data[C].t == \"e\") {\n      dv.setUint16(C * 2, 65535, true);\n      _dv.setUint16(C * 2, 65535);\n      continue;\n    }\n    dv.setUint16(C * 2, last_offset / width, true);\n    _dv.setUint16(C * 2, _last_offset / width, true);\n    var celload, _celload;\n    switch (data[C].t) {\n      case \"d\":\n        if (data[C].v instanceof Date) {\n          celload = write_new_storage(data[C], lut);\n          _celload = write_old_storage(data[C], lut);\n          break;\n        }\n        celload = write_new_storage(data[C], lut);\n        _celload = write_old_storage(data[C], lut);\n        break;\n      case \"s\":\n      case \"n\":\n      case \"b\":\n      case \"z\":\n        celload = write_new_storage(data[C], lut);\n        _celload = write_old_storage(data[C], lut);\n        break;\n      default:\n        throw new Error(\"Unsupported value \" + data[C]);\n    }\n    cell_storage.push(celload);\n    last_offset += celload.length;\n    {\n      _cell_storage.push(_celload);\n      _last_offset += _celload.length;\n    }\n    ++cnt;\n  }\n  tri[2][0].data = write_varint49(cnt);\n  tri[5][0].data = write_varint49(5);\n  for (; C < tri[7][0].data.length / 2; ++C) {\n    dv.setUint16(C * 2, 65535, true);\n    _dv.setUint16(C * 2, 65535, true);\n  }\n  tri[6][0].data = u8concat(cell_storage);\n  tri[3][0].data = u8concat(_cell_storage);\n  tri[8] = [{ type: 0, data: write_varint49(wide ? 1 : 0) }];\n  return tri;\n}\nfunction write_iwam(type, payload) {\n  return {\n    meta: [\n      [],\n      [{ type: 0, data: write_varint49(type) }]\n    ],\n    data: payload\n  };\n}\nfunction get_unique_msgid(dep, dependents) {\n  if (!dependents.last)\n    dependents.last = 927262;\n  for (var i = dependents.last; i < 2e6; ++i)\n    if (!dependents[i]) {\n      dependents[dependents.last = i] = dep;\n      return i;\n    }\n  throw new Error(\"Too many messages\");\n}\nfunction build_numbers_deps(cfb) {\n  var dependents = {};\n  var indices = [];\n  cfb.FileIndex.map(function(fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function(row) {\n    var fi = row[0], fp = row[1];\n    if (fi.type != 2)\n      return;\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    if (fi.content[0] != 0)\n      return;\n    parse_iwa_file(decompress_iwa_file(fi.content)).forEach(function(packet) {\n      indices.push(packet.id);\n      dependents[packet.id] = { deps: [], location: fp, type: varint_to_i32(packet.messages[0].meta[1][0].data) };\n    });\n  });\n  cfb.FileIndex.forEach(function(fi) {\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    if (fi.content[0] != 0)\n      return;\n    parse_iwa_file(decompress_iwa_file(fi.content)).forEach(function(ia) {\n      ia.messages.forEach(function(mess) {\n        [5, 6].forEach(function(f) {\n          if (!mess.meta[f])\n            return;\n          mess.meta[f].forEach(function(x) {\n            dependents[ia.id].deps.push(varint_to_i32(x.data));\n          });\n        });\n      });\n    });\n  });\n  return dependents;\n}\nfunction write_TSP_Color_RGB(r, g, b) {\n  return write_shallow([\n    [],\n    [{ type: 0, data: write_varint49(1) }],\n    [],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([r / 255]).buffer) }],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([g / 255]).buffer) }],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([b / 255]).buffer) }],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([1]).buffer) }],\n    [],\n    [],\n    [],\n    [],\n    [],\n    [{ type: 0, data: write_varint49(1) }]\n  ]);\n}\nfunction get_author_color(n) {\n  switch (n) {\n    case 0:\n      return write_TSP_Color_RGB(99, 222, 171);\n    case 1:\n      return write_TSP_Color_RGB(162, 197, 240);\n    case 2:\n      return write_TSP_Color_RGB(255, 189, 189);\n  }\n  return write_TSP_Color_RGB(Math.random() * 255, Math.random() * 255, Math.random() * 255);\n}\nfunction write_numbers_iwa(wb, opts) {\n  if (!opts || !opts.numbers)\n    throw new Error(\"Must pass a `numbers` option -- check the README\");\n  var cfb = CFB.read(opts.numbers, { type: \"base64\" });\n  var deps = build_numbers_deps(cfb);\n  var docroot = numbers_iwa_find(cfb, deps, 1);\n  if (docroot == null)\n    throw \"Could not find message \".concat(1, \" in Numbers template\");\n  var sheetrefs = mappa(parse_shallow(docroot.messages[0].data)[1], parse_TSP_Reference);\n  if (sheetrefs.length > 1)\n    throw new Error(\"Template NUMBERS file must have exactly one sheet\");\n  wb.SheetNames.forEach(function(name, idx) {\n    if (idx >= 1) {\n      numbers_add_ws(cfb, deps, idx + 1);\n      docroot = numbers_iwa_find(cfb, deps, 1);\n      sheetrefs = mappa(parse_shallow(docroot.messages[0].data)[1], parse_TSP_Reference);\n    }\n    write_numbers_ws(cfb, deps, wb.Sheets[name], name, idx, sheetrefs[idx]);\n  });\n  return cfb;\n}\nfunction numbers_iwa_doit(cfb, deps, id, cb) {\n  var entry = CFB.find(cfb, deps[id].location);\n  if (!entry)\n    throw \"Could not find \".concat(deps[id].location, \" in Numbers template\");\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var ainfo = x.find(function(packet) {\n    return packet.id == id;\n  });\n  cb(ainfo, x);\n  entry.content = compress_iwa_file(write_iwa_file(x));\n  entry.size = entry.content.length;\n}\nfunction numbers_iwa_find(cfb, deps, id) {\n  var entry = CFB.find(cfb, deps[id].location);\n  if (!entry)\n    throw \"Could not find \".concat(deps[id].location, \" in Numbers template\");\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var ainfo = x.find(function(packet) {\n    return packet.id == id;\n  });\n  return ainfo;\n}\nfunction numbers_add_meta(mlist, newid, newloc) {\n  mlist[3].push({ type: 2, data: write_shallow([\n    [],\n    [{ type: 0, data: write_varint49(newid) }],\n    [{ type: 2, data: stru8(newloc.replace(/-.*$/, \"\")) }],\n    [{ type: 2, data: stru8(newloc) }],\n    [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n    [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n    [],\n    [],\n    [],\n    [],\n    [{ type: 0, data: write_varint49(0) }],\n    [],\n    [{ type: 0, data: write_varint49(0) }]\n  ]) });\n  mlist[1] = [{ type: 0, data: write_varint49(Math.max(newid + 1, varint_to_i32(mlist[1][0].data))) }];\n}\nfunction numbers_add_msg(cfb, type, msg, path, deps, id) {\n  if (!id)\n    id = get_unique_msgid({ deps: [], location: \"\", type: type }, deps);\n  var loc = \"\".concat(path, \"-\").concat(id, \".iwa\");\n  deps[id].location = \"Root Entry\" + loc;\n  CFB.utils.cfb_add(cfb, loc, compress_iwa_file(write_iwa_file([{\n    id: id,\n    messages: [write_iwam(type, write_shallow(msg))]\n  }])));\n  var newloc = loc.replace(/^[\\/]/, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n  numbers_iwa_doit(cfb, deps, 2, function(ai) {\n    var mlist = parse_shallow(ai.messages[0].data);\n    numbers_add_meta(mlist, id || 0, newloc);\n    ai.messages[0].data = write_shallow(mlist);\n  });\n  return id;\n}\nfunction numbers_meta_add_dep(mlist, deps, id, dep) {\n  var loc = deps[id].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n  var parentidx = mlist[3].findIndex(function(m) {\n    var _a, _b;\n    var mm = parse_shallow(m.data);\n    if ((_a = mm[3]) == null ? void 0 : _a[0])\n      return u8str(mm[3][0].data) == loc;\n    if (((_b = mm[2]) == null ? void 0 : _b[0]) && u8str(mm[2][0].data) == loc)\n      return true;\n    return false;\n  });\n  var parent = parse_shallow(mlist[3][parentidx].data);\n  if (!parent[6])\n    parent[6] = [];\n  (Array.isArray(dep) ? dep : [dep]).forEach(function(dep2) {\n    parent[6].push({\n      type: 2,\n      data: write_shallow([\n        [],\n        [{ type: 0, data: write_varint49(dep2) }]\n      ])\n    });\n  });\n  mlist[3][parentidx].data = write_shallow(parent);\n}\nfunction numbers_meta_del_dep(mlist, deps, id, dep) {\n  var loc = deps[id].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n  var parentidx = mlist[3].findIndex(function(m) {\n    var _a, _b;\n    var mm = parse_shallow(m.data);\n    if ((_a = mm[3]) == null ? void 0 : _a[0])\n      return u8str(mm[3][0].data) == loc;\n    if (((_b = mm[2]) == null ? void 0 : _b[0]) && u8str(mm[2][0].data) == loc)\n      return true;\n    return false;\n  });\n  var parent = parse_shallow(mlist[3][parentidx].data);\n  if (!parent[6])\n    parent[6] = [];\n  parent[6] = parent[6].filter(function(m) {\n    return varint_to_i32(parse_shallow(m.data)[1][0].data) != dep;\n  });\n  mlist[3][parentidx].data = write_shallow(parent);\n}\nfunction numbers_add_ws(cfb, deps, wsidx) {\n  var sheetref = -1, newsheetref = -1;\n  var remap = {};\n  numbers_iwa_doit(cfb, deps, 1, function(docroot, arch) {\n    var doc = parse_shallow(docroot.messages[0].data);\n    sheetref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);\n    newsheetref = get_unique_msgid({ deps: [1], location: deps[sheetref].location, type: 2 }, deps);\n    remap[sheetref] = newsheetref;\n    numbers_add_oref(docroot, newsheetref);\n    doc[1].push({ type: 2, data: write_TSP_Reference(newsheetref) });\n    var sheet = numbers_iwa_find(cfb, deps, sheetref);\n    sheet.id = newsheetref;\n    if (deps[1].location == deps[newsheetref].location)\n      arch.push(sheet);\n    else\n      numbers_iwa_doit(cfb, deps, newsheetref, function(_, x) {\n        return x.push(sheet);\n      });\n    docroot.messages[0].data = write_shallow(doc);\n  });\n  var tiaref = -1;\n  numbers_iwa_doit(cfb, deps, newsheetref, function(sheetroot, arch) {\n    var sa = parse_shallow(sheetroot.messages[0].data);\n    for (var i = 3; i <= 69; ++i)\n      delete sa[i];\n    var drawables = mappa(sa[2], parse_TSP_Reference);\n    drawables.forEach(function(n) {\n      return numbers_del_oref(sheetroot, n);\n    });\n    tiaref = get_unique_msgid({ deps: [newsheetref], location: deps[drawables[0]].location, type: deps[drawables[0]].type }, deps);\n    numbers_add_oref(sheetroot, tiaref);\n    remap[drawables[0]] = tiaref;\n    sa[2] = [{ type: 2, data: write_TSP_Reference(tiaref) }];\n    var tia = numbers_iwa_find(cfb, deps, drawables[0]);\n    tia.id = tiaref;\n    if (deps[drawables[0]].location == deps[newsheetref].location)\n      arch.push(tia);\n    else {\n      numbers_iwa_doit(cfb, deps, 2, function(ai) {\n        var mlist = parse_shallow(ai.messages[0].data);\n        numbers_meta_add_dep(mlist, deps, newsheetref, tiaref);\n        ai.messages[0].data = write_shallow(mlist);\n      });\n      numbers_iwa_doit(cfb, deps, tiaref, function(_, x) {\n        return x.push(tia);\n      });\n    }\n    sheetroot.messages[0].data = write_shallow(sa);\n  });\n  var tmaref = -1;\n  numbers_iwa_doit(cfb, deps, tiaref, function(tiaroot, arch) {\n    var tia = parse_shallow(tiaroot.messages[0].data);\n    var da = parse_shallow(tia[1][0].data);\n    for (var i = 3; i <= 69; ++i)\n      delete da[i];\n    var dap = parse_TSP_Reference(da[2][0].data);\n    da[2][0].data = write_TSP_Reference(remap[dap]);\n    tia[1][0].data = write_shallow(da);\n    var oldtmaref = parse_TSP_Reference(tia[2][0].data);\n    numbers_del_oref(tiaroot, oldtmaref);\n    tmaref = get_unique_msgid({ deps: [tiaref], location: deps[oldtmaref].location, type: deps[oldtmaref].type }, deps);\n    numbers_add_oref(tiaroot, tmaref);\n    remap[oldtmaref] = tmaref;\n    tia[2][0].data = write_TSP_Reference(tmaref);\n    var tma = numbers_iwa_find(cfb, deps, oldtmaref);\n    tma.id = tmaref;\n    if (deps[tiaref].location == deps[tmaref].location)\n      arch.push(tma);\n    else\n      numbers_iwa_doit(cfb, deps, tmaref, function(_, x) {\n        return x.push(tma);\n      });\n    tiaroot.messages[0].data = write_shallow(tia);\n  });\n  numbers_iwa_doit(cfb, deps, tmaref, function(tmaroot, arch) {\n    var _a, _b;\n    var tma = parse_shallow(tmaroot.messages[0].data);\n    var uuid = u8str(tma[1][0].data), new_uuid = uuid.replace(/-[A-Z0-9]*/, \"-\".concat((\"0000\" + wsidx.toString(16)).slice(-4)));\n    tma[1][0].data = stru8(new_uuid);\n    [12, 13, 29, 31, 32, 33, 39, 44, 47, 81, 82, 84].forEach(function(n) {\n      return delete tma[n];\n    });\n    if (tma[45]) {\n      var srrta = parse_shallow(tma[45][0].data);\n      var ref = parse_TSP_Reference(srrta[1][0].data);\n      numbers_del_oref(tmaroot, ref);\n      delete tma[45];\n    }\n    if (tma[70]) {\n      var hsoa = parse_shallow(tma[70][0].data);\n      (_a = hsoa[2]) == null ? void 0 : _a.forEach(function(item) {\n        var hsa = parse_shallow(item.data);\n        [2, 3].map(function(n) {\n          return hsa[n][0];\n        }).forEach(function(hseadata) {\n          var hsea = parse_shallow(hseadata.data);\n          if (!hsea[8])\n            return;\n          var ref2 = parse_TSP_Reference(hsea[8][0].data);\n          numbers_del_oref(tmaroot, ref2);\n        });\n      });\n      delete tma[70];\n    }\n    [\n      46,\n      30,\n      34,\n      35,\n      36,\n      38,\n      48,\n      49,\n      60,\n      61,\n      62,\n      63,\n      64,\n      71,\n      72,\n      73,\n      74,\n      75,\n      85,\n      86,\n      87,\n      88,\n      89\n    ].forEach(function(n) {\n      if (!tma[n])\n        return;\n      var ref2 = parse_TSP_Reference(tma[n][0].data);\n      delete tma[n];\n      numbers_del_oref(tmaroot, ref2);\n    });\n    var store = parse_shallow(tma[4][0].data);\n    {\n      [2, 4, 5, 6, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22].forEach(function(n) {\n        var _a2;\n        if (!((_a2 = store[n]) == null ? void 0 : _a2[0]))\n          return;\n        var oldref = parse_TSP_Reference(store[n][0].data);\n        var newref = get_unique_msgid({ deps: [tmaref], location: deps[oldref].location, type: deps[oldref].type }, deps);\n        numbers_del_oref(tmaroot, oldref);\n        numbers_add_oref(tmaroot, newref);\n        remap[oldref] = newref;\n        var msg = numbers_iwa_find(cfb, deps, oldref);\n        msg.id = newref;\n        if (deps[oldref].location == deps[tmaref].location)\n          arch.push(msg);\n        else {\n          deps[newref].location = deps[oldref].location.replace(oldref.toString(), newref.toString());\n          if (deps[newref].location == deps[oldref].location)\n            deps[newref].location = deps[newref].location.replace(/\\.iwa/, \"-\".concat(newref, \".iwa\"));\n          CFB.utils.cfb_add(cfb, deps[newref].location, compress_iwa_file(write_iwa_file([msg])));\n          var newloc = deps[newref].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            numbers_add_meta(mlist, newref, newloc);\n            numbers_meta_add_dep(mlist, deps, tmaref, newref);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n        }\n        store[n][0].data = write_TSP_Reference(newref);\n      });\n      var row_headers = parse_shallow(store[1][0].data);\n      {\n        (_b = row_headers[2]) == null ? void 0 : _b.forEach(function(tspref) {\n          var oldref = parse_TSP_Reference(tspref.data);\n          var newref = get_unique_msgid({ deps: [tmaref], location: deps[oldref].location, type: deps[oldref].type }, deps);\n          numbers_del_oref(tmaroot, oldref);\n          numbers_add_oref(tmaroot, newref);\n          remap[oldref] = newref;\n          var msg = numbers_iwa_find(cfb, deps, oldref);\n          msg.id = newref;\n          if (deps[oldref].location == deps[tmaref].location) {\n            arch.push(msg);\n          } else {\n            deps[newref].location = deps[oldref].location.replace(oldref.toString(), newref.toString());\n            if (deps[newref].location == deps[oldref].location)\n              deps[newref].location = deps[newref].location.replace(/\\.iwa/, \"-\".concat(newref, \".iwa\"));\n            CFB.utils.cfb_add(cfb, deps[newref].location, compress_iwa_file(write_iwa_file([msg])));\n            var newloc = deps[newref].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n            numbers_iwa_doit(cfb, deps, 2, function(ai) {\n              var mlist = parse_shallow(ai.messages[0].data);\n              numbers_add_meta(mlist, newref, newloc);\n              numbers_meta_add_dep(mlist, deps, tmaref, newref);\n              ai.messages[0].data = write_shallow(mlist);\n            });\n          }\n          tspref.data = write_TSP_Reference(newref);\n        });\n      }\n      store[1][0].data = write_shallow(row_headers);\n      var tiles = parse_shallow(store[3][0].data);\n      {\n        tiles[1].forEach(function(t) {\n          var tst = parse_shallow(t.data);\n          var oldtileref = parse_TSP_Reference(tst[2][0].data);\n          var newtileref = remap[oldtileref];\n          if (!remap[oldtileref]) {\n            newtileref = get_unique_msgid({ deps: [tmaref], location: \"\", type: deps[oldtileref].type }, deps);\n            deps[newtileref].location = \"Root Entry/Index/Tables/Tile-\".concat(newtileref, \".iwa\");\n            remap[oldtileref] = newtileref;\n            var oldtile = numbers_iwa_find(cfb, deps, oldtileref);\n            oldtile.id = newtileref;\n            numbers_del_oref(tmaroot, oldtileref);\n            numbers_add_oref(tmaroot, newtileref);\n            CFB.utils.cfb_add(cfb, \"/Index/Tables/Tile-\".concat(newtileref, \".iwa\"), compress_iwa_file(write_iwa_file([oldtile])));\n            numbers_iwa_doit(cfb, deps, 2, function(ai) {\n              var mlist = parse_shallow(ai.messages[0].data);\n              mlist[3].push({ type: 2, data: write_shallow([\n                [],\n                [{ type: 0, data: write_varint49(newtileref) }],\n                [{ type: 2, data: stru8(\"Tables/Tile\") }],\n                [{ type: 2, data: stru8(\"Tables/Tile-\".concat(newtileref)) }],\n                [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n                [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n                [],\n                [],\n                [],\n                [],\n                [{ type: 0, data: write_varint49(0) }],\n                [],\n                [{ type: 0, data: write_varint49(0) }]\n              ]) });\n              mlist[1] = [{ type: 0, data: write_varint49(Math.max(newtileref + 1, varint_to_i32(mlist[1][0].data))) }];\n              numbers_meta_add_dep(mlist, deps, tmaref, newtileref);\n              ai.messages[0].data = write_shallow(mlist);\n            });\n          }\n          tst[2][0].data = write_TSP_Reference(newtileref);\n          t.data = write_shallow(tst);\n        });\n      }\n      store[3][0].data = write_shallow(tiles);\n    }\n    tma[4][0].data = write_shallow(store);\n    tmaroot.messages[0].data = write_shallow(tma);\n  });\n}\nfunction write_numbers_ws(cfb, deps, ws, wsname, sheetidx, rootref) {\n  var drawables = [];\n  numbers_iwa_doit(cfb, deps, rootref, function(docroot) {\n    var sheetref = parse_shallow(docroot.messages[0].data);\n    {\n      sheetref[1] = [{ type: 2, data: stru8(wsname) }];\n      drawables = mappa(sheetref[2], parse_TSP_Reference);\n    }\n    docroot.messages[0].data = write_shallow(sheetref);\n  });\n  var tia = numbers_iwa_find(cfb, deps, drawables[0]);\n  var tmaref = parse_TSP_Reference(parse_shallow(tia.messages[0].data)[2][0].data);\n  numbers_iwa_doit(cfb, deps, tmaref, function(docroot, x) {\n    return write_numbers_tma(cfb, deps, ws, docroot, x, tmaref);\n  });\n}\nvar USE_WIDE_ROWS = true;\nfunction write_numbers_tma(cfb, deps, ws, tmaroot, tmafile, tmaref) {\n  var range = decode_range(ws[\"!ref\"]);\n  range.s.r = range.s.c = 0;\n  var trunc = false;\n  if (range.e.c > 999) {\n    trunc = true;\n    range.e.c = 999;\n  }\n  if (range.e.r > 999999) {\n    trunc = true;\n    range.e.r = 999999;\n  }\n  if (trunc)\n    console.error(\"Truncating to \".concat(encode_range(range)));\n  var data = [];\n  if (ws[\"!data\"])\n    data = ws[\"!data\"];\n  else {\n    var colstr = [];\n    for (var _C = 0; _C <= range.e.c; ++_C)\n      colstr[_C] = encode_col(_C);\n    for (var R_ = 0; R_ <= range.e.r; ++R_) {\n      data[R_] = [];\n      var _R = \"\" + (R_ + 1);\n      for (_C = 0; _C <= range.e.c; ++_C) {\n        var _cell = ws[colstr[_C] + _R];\n        if (!_cell)\n          continue;\n        data[R_][_C] = _cell;\n      }\n    }\n  }\n  var LUT = {\n    cmnt: [{ a: \"~54ee77S~\", t: \"... the people who are crazy enough to think they can change the world, are the ones who do.\" }],\n    ferr: [],\n    fmla: [],\n    nfmt: [],\n    ofmt: [],\n    rsst: [{ v: \"~54ee77S~\", l: \"https://sheetjs.com/\" }],\n    sst: [\"~Sh33tJ5~\"]\n  };\n  var pb = parse_shallow(tmaroot.messages[0].data);\n  {\n    pb[6][0].data = write_varint49(range.e.r + 1);\n    pb[7][0].data = write_varint49(range.e.c + 1);\n    delete pb[46];\n    var store = parse_shallow(pb[4][0].data);\n    {\n      var row_header_ref = parse_TSP_Reference(parse_shallow(store[1][0].data)[2][0].data);\n      numbers_iwa_doit(cfb, deps, row_header_ref, function(rowhead, _x) {\n        var _a;\n        var base_bucket = parse_shallow(rowhead.messages[0].data);\n        if ((_a = base_bucket == null ? void 0 : base_bucket[2]) == null ? void 0 : _a[0])\n          for (var R2 = 0; R2 < data.length; ++R2) {\n            var _bucket = parse_shallow(base_bucket[2][0].data);\n            _bucket[1][0].data = write_varint49(R2);\n            _bucket[4][0].data = write_varint49(data[R2].length);\n            base_bucket[2][R2] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n          }\n        rowhead.messages[0].data = write_shallow(base_bucket);\n      });\n      var col_header_ref = parse_TSP_Reference(store[2][0].data);\n      numbers_iwa_doit(cfb, deps, col_header_ref, function(colhead, _x) {\n        var base_bucket = parse_shallow(colhead.messages[0].data);\n        for (var C = 0; C <= range.e.c; ++C) {\n          var _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(C);\n          _bucket[4][0].data = write_varint49(range.e.r + 1);\n          base_bucket[2][C] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n        }\n        colhead.messages[0].data = write_shallow(base_bucket);\n      });\n      var rbtree = parse_shallow(store[9][0].data);\n      rbtree[1] = [];\n      var tilestore = parse_shallow(store[3][0].data);\n      {\n        var tstride = 256;\n        tilestore[2] = [{ type: 0, data: write_varint49(tstride) }];\n        var tileref = parse_TSP_Reference(parse_shallow(tilestore[1][0].data)[2][0].data);\n        var save_token = function() {\n          var metadata = numbers_iwa_find(cfb, deps, 2);\n          var mlist = parse_shallow(metadata.messages[0].data);\n          var mlst = mlist[3].filter(function(m) {\n            return varint_to_i32(parse_shallow(m.data)[1][0].data) == tileref;\n          });\n          return (mlst == null ? void 0 : mlst.length) ? varint_to_i32(parse_shallow(mlst[0].data)[12][0].data) : 0;\n        }();\n        {\n          CFB.utils.cfb_del(cfb, deps[tileref].location);\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            mlist[3] = mlist[3].filter(function(m) {\n              return varint_to_i32(parse_shallow(m.data)[1][0].data) != tileref;\n            });\n            numbers_meta_del_dep(mlist, deps, tmaref, tileref);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n          numbers_del_oref(tmaroot, tileref);\n        }\n        tilestore[1] = [];\n        var ntiles = Math.ceil((range.e.r + 1) / tstride);\n        for (var tidx = 0; tidx < ntiles; ++tidx) {\n          var newtileid = get_unique_msgid({\n            deps: [],\n            location: \"\",\n            type: 6002\n          }, deps);\n          deps[newtileid].location = \"Root Entry/Index/Tables/Tile-\".concat(newtileid, \".iwa\");\n          var tiledata = [\n            [],\n            [{ type: 0, data: write_varint49(0) }],\n            [{ type: 0, data: write_varint49(Math.min(range.e.r + 1, (tidx + 1) * tstride)) }],\n            [{ type: 0, data: write_varint49(0) }],\n            [{ type: 0, data: write_varint49(Math.min((tidx + 1) * tstride, range.e.r + 1) - tidx * tstride) }],\n            [],\n            [{ type: 0, data: write_varint49(5) }],\n            [{ type: 0, data: write_varint49(1) }],\n            [{ type: 0, data: write_varint49(USE_WIDE_ROWS ? 1 : 0) }]\n          ];\n          for (var R = tidx * tstride; R <= Math.min(range.e.r, (tidx + 1) * tstride - 1); ++R) {\n            var tilerow = write_TST_TileRowInfo(data[R], LUT, USE_WIDE_ROWS);\n            tilerow[1][0].data = write_varint49(R - tidx * tstride);\n            tiledata[5].push({ data: write_shallow(tilerow), type: 2 });\n          }\n          tilestore[1].push({ type: 2, data: write_shallow([\n            [],\n            [{ type: 0, data: write_varint49(tidx) }],\n            [{ type: 2, data: write_TSP_Reference(newtileid) }]\n          ]) });\n          var newtile = {\n            id: newtileid,\n            messages: [write_iwam(6002, write_shallow(tiledata))]\n          };\n          var tilecontent = compress_iwa_file(write_iwa_file([newtile]));\n          CFB.utils.cfb_add(cfb, \"/Index/Tables/Tile-\".concat(newtileid, \".iwa\"), tilecontent);\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            mlist[3].push({ type: 2, data: write_shallow([\n              [],\n              [{ type: 0, data: write_varint49(newtileid) }],\n              [{ type: 2, data: stru8(\"Tables/Tile\") }],\n              [{ type: 2, data: stru8(\"Tables/Tile-\".concat(newtileid)) }],\n              [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n              [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n              [],\n              [],\n              [],\n              [],\n              [{ type: 0, data: write_varint49(0) }],\n              [],\n              [{ type: 0, data: write_varint49(save_token) }]\n            ]) });\n            mlist[1] = [{ type: 0, data: write_varint49(Math.max(newtileid + 1, varint_to_i32(mlist[1][0].data))) }];\n            numbers_meta_add_dep(mlist, deps, tmaref, newtileid);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n          numbers_add_oref(tmaroot, newtileid);\n          rbtree[1].push({ type: 2, data: write_shallow([\n            [],\n            [{ type: 0, data: write_varint49(tidx * tstride) }],\n            [{ type: 0, data: write_varint49(tidx) }]\n          ]) });\n        }\n      }\n      store[3][0].data = write_shallow(tilestore);\n      store[9][0].data = write_shallow(rbtree);\n      store[10] = [{ type: 2, data: new Uint8Array([]) }];\n      if (ws[\"!merges\"]) {\n        var mergeid = get_unique_msgid({\n          type: 6144,\n          deps: [tmaref],\n          location: deps[tmaref].location\n        }, deps);\n        tmafile.push({\n          id: mergeid,\n          messages: [write_iwam(6144, write_shallow([\n            [],\n            ws[\"!merges\"].map(function(m) {\n              return { type: 2, data: write_shallow([\n                [],\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 5, data: new Uint8Array(new Uint16Array([m.s.r, m.s.c]).buffer) }]\n                ]) }],\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 5, data: new Uint8Array(new Uint16Array([m.e.r - m.s.r + 1, m.e.c - m.s.c + 1]).buffer) }]\n                ]) }]\n              ]) };\n            })\n          ]))]\n        });\n        store[13] = [{ type: 2, data: write_TSP_Reference(mergeid) }];\n        numbers_iwa_doit(cfb, deps, 2, function(ai) {\n          var mlist = parse_shallow(ai.messages[0].data);\n          numbers_meta_add_dep(mlist, deps, tmaref, mergeid);\n          ai.messages[0].data = write_shallow(mlist);\n        });\n        numbers_add_oref(tmaroot, mergeid);\n      } else\n        delete store[13];\n      var sstref = parse_TSP_Reference(store[4][0].data);\n      numbers_iwa_doit(cfb, deps, sstref, function(sstroot) {\n        var sstdata = parse_shallow(sstroot.messages[0].data);\n        {\n          sstdata[3] = [];\n          LUT.sst.forEach(function(str, i) {\n            if (i == 0)\n              return;\n            sstdata[3].push({ type: 2, data: write_shallow([\n              [],\n              [{ type: 0, data: write_varint49(i) }],\n              [{ type: 0, data: write_varint49(1) }],\n              [{ type: 2, data: stru8(str) }]\n            ]) });\n          });\n        }\n        sstroot.messages[0].data = write_shallow(sstdata);\n      });\n      var rsstref = parse_TSP_Reference(store[17][0].data);\n      numbers_iwa_doit(cfb, deps, rsstref, function(rsstroot) {\n        var rsstdata = parse_shallow(rsstroot.messages[0].data);\n        rsstdata[3] = [];\n        var style_indices = [\n          904980,\n          903835,\n          903815,\n          903845\n        ];\n        LUT.rsst.forEach(function(rsst, i) {\n          if (i == 0)\n            return;\n          var tswpsa = [\n            [],\n            [{ type: 0, data: new Uint8Array([5]) }],\n            [],\n            [{ type: 2, data: stru8(rsst.v) }]\n          ];\n          tswpsa[10] = [{ type: 0, data: new Uint8Array([1]) }];\n          tswpsa[19] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 18, 2, 101, 110]) }];\n          tswpsa[5] = [{ type: 2, data: new Uint8Array([10, 8, 8, 0, 18, 4, 8, 155, 149, 55]) }];\n          tswpsa[2] = [{ type: 2, data: new Uint8Array([8, 148, 158, 55]) }];\n          tswpsa[6] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 16, 0, 24, 0]) }];\n          tswpsa[7] = [{ type: 2, data: new Uint8Array([10, 8, 8, 0, 18, 4, 8, 135, 149, 55]) }];\n          tswpsa[8] = [{ type: 2, data: new Uint8Array([10, 8, 8, 0, 18, 4, 8, 165, 149, 55]) }];\n          tswpsa[14] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 16, 0, 24, 0]) }];\n          tswpsa[24] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 16, 0, 24, 0]) }];\n          var tswpsaid = get_unique_msgid({ deps: [], location: \"\", type: 2001 }, deps);\n          var tswpsarefs = [];\n          if (rsst.l) {\n            var newhlinkid = numbers_add_msg(cfb, 2032, [\n              [],\n              [],\n              [{ type: 2, data: stru8(rsst.l) }]\n            ], \"/Index/Tables/DataList\", deps);\n            tswpsa[11] = [];\n            var smartfield = [[], []];\n            if (!smartfield[1])\n              smartfield[1] = [];\n            smartfield[1].push({ type: 2, data: write_shallow([\n              [],\n              [{ type: 0, data: write_varint49(0) }],\n              [{ type: 2, data: write_TSP_Reference(newhlinkid) }]\n            ]) });\n            tswpsa[11][0] = { type: 2, data: write_shallow(smartfield) };\n            tswpsarefs.push(newhlinkid);\n          }\n          numbers_add_msg(cfb, 2001, tswpsa, \"/Index/Tables/DataList\", deps, tswpsaid);\n          numbers_iwa_doit(cfb, deps, tswpsaid, function(iwa) {\n            style_indices.forEach(function(ref) {\n              return numbers_add_oref(iwa, ref);\n            });\n            tswpsarefs.forEach(function(ref) {\n              return numbers_add_oref(iwa, ref);\n            });\n          });\n          var rtpaid = numbers_add_msg(cfb, 6218, [\n            [],\n            [{ type: 2, data: write_TSP_Reference(tswpsaid) }],\n            [],\n            [{ type: 2, data: new Uint8Array([13, 255, 255, 255, 0, 18, 10, 16, 255, 255, 1, 24, 255, 255, 255, 255, 7]) }]\n          ], \"/Index/Tables/DataList\", deps);\n          numbers_iwa_doit(cfb, deps, rtpaid, function(iwa) {\n            return numbers_add_oref(iwa, tswpsaid);\n          });\n          rsstdata[3].push({ type: 2, data: write_shallow([\n            [],\n            [{ type: 0, data: write_varint49(i) }],\n            [{ type: 0, data: write_varint49(1) }],\n            [],\n            [],\n            [],\n            [],\n            [],\n            [],\n            [{ type: 2, data: write_TSP_Reference(rtpaid) }]\n          ]) });\n          numbers_add_oref(rsstroot, rtpaid);\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            numbers_meta_add_dep(mlist, deps, rsstref, rtpaid);\n            numbers_meta_add_dep(mlist, deps, rtpaid, tswpsaid);\n            numbers_meta_add_dep(mlist, deps, tswpsaid, tswpsarefs);\n            numbers_meta_add_dep(mlist, deps, tswpsaid, style_indices);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n        });\n        rsstroot.messages[0].data = write_shallow(rsstdata);\n      });\n      if (LUT.cmnt.length > 1) {\n        var cmntref = parse_TSP_Reference(store[19][0].data);\n        var authors = {}, iauthor = 0;\n        numbers_iwa_doit(cfb, deps, cmntref, function(cmntroot) {\n          var cmntdata = parse_shallow(cmntroot.messages[0].data);\n          {\n            cmntdata[3] = [];\n            LUT.cmnt.forEach(function(cc, i) {\n              if (i == 0)\n                return;\n              var replies = [];\n              if (cc.replies)\n                cc.replies.forEach(function(c) {\n                  if (!authors[c.a || \"\"])\n                    authors[c.a || \"\"] = numbers_add_msg(cfb, 212, [\n                      [],\n                      [{ type: 2, data: stru8(c.a || \"\") }],\n                      [{ type: 2, data: get_author_color(++iauthor) }],\n                      [],\n                      [{ type: 0, data: write_varint49(0) }]\n                    ], \"/Index/Tables/DataList\", deps);\n                  var aaaid2 = authors[c.a || \"\"];\n                  var csaid2 = numbers_add_msg(cfb, 3056, [\n                    [],\n                    [{ type: 2, data: stru8(c.t || \"\") }],\n                    [{ type: 2, data: write_shallow([\n                      [],\n                      [{ type: 1, data: new Uint8Array([0, 0, 0, 128, 116, 109, 182, 65]) }]\n                    ]) }],\n                    [{ type: 2, data: write_TSP_Reference(aaaid2) }]\n                  ], \"/Index/Tables/DataList\", deps);\n                  numbers_iwa_doit(cfb, deps, csaid2, function(iwa) {\n                    return numbers_add_oref(iwa, aaaid2);\n                  });\n                  replies.push(csaid2);\n                  numbers_iwa_doit(cfb, deps, 2, function(ai) {\n                    var mlist = parse_shallow(ai.messages[0].data);\n                    numbers_meta_add_dep(mlist, deps, csaid2, aaaid2);\n                    ai.messages[0].data = write_shallow(mlist);\n                  });\n                });\n              if (!authors[cc.a || \"\"])\n                authors[cc.a || \"\"] = numbers_add_msg(cfb, 212, [\n                  [],\n                  [{ type: 2, data: stru8(cc.a || \"\") }],\n                  [{ type: 2, data: get_author_color(++iauthor) }],\n                  [],\n                  [{ type: 0, data: write_varint49(0) }]\n                ], \"/Index/Tables/DataList\", deps);\n              var aaaid = authors[cc.a || \"\"];\n              var csaid = numbers_add_msg(cfb, 3056, [\n                [],\n                [{ type: 2, data: stru8(cc.t || \"\") }],\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 1, data: new Uint8Array([0, 0, 0, 128, 116, 109, 182, 65]) }]\n                ]) }],\n                [{ type: 2, data: write_TSP_Reference(aaaid) }],\n                replies.map(function(r) {\n                  return { type: 2, data: write_TSP_Reference(r) };\n                }),\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 0, data: write_varint49(i) }],\n                  [{ type: 0, data: write_varint49(0) }]\n                ]) }]\n              ], \"/Index/Tables/DataList\", deps);\n              numbers_iwa_doit(cfb, deps, csaid, function(iwa) {\n                numbers_add_oref(iwa, aaaid);\n                replies.forEach(function(r) {\n                  return numbers_add_oref(iwa, r);\n                });\n              });\n              cmntdata[3].push({ type: 2, data: write_shallow([\n                [],\n                [{ type: 0, data: write_varint49(i) }],\n                [{ type: 0, data: write_varint49(1) }],\n                [],\n                [],\n                [],\n                [],\n                [],\n                [],\n                [],\n                [{ type: 2, data: write_TSP_Reference(csaid) }]\n              ]) });\n              numbers_add_oref(cmntroot, csaid);\n              numbers_iwa_doit(cfb, deps, 2, function(ai) {\n                var mlist = parse_shallow(ai.messages[0].data);\n                numbers_meta_add_dep(mlist, deps, cmntref, csaid);\n                numbers_meta_add_dep(mlist, deps, csaid, aaaid);\n                if (replies.length)\n                  numbers_meta_add_dep(mlist, deps, csaid, replies);\n                ai.messages[0].data = write_shallow(mlist);\n              });\n            });\n          }\n          cmntdata[2][0].data = write_varint49(LUT.cmnt.length + 1);\n          cmntroot.messages[0].data = write_shallow(cmntdata);\n        });\n      }\n    }\n    pb[4][0].data = write_shallow(store);\n  }\n  tmaroot.messages[0].data = write_shallow(pb);\n}\nfunction fix_opts_func(defaults) {\n\treturn function fix_opts(opts) {\n\t\tfor(var i = 0; i != defaults.length; ++i) {\n\t\t\tvar d = defaults[i];\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n\t\t}\n\t};\n}\n\nfunction fix_read_opts(opts) {\nfix_opts_func([\n\t['cellNF', false], /* emit cell number format string as .z */\n\t['cellHTML', true], /* emit html string as .h */\n\t['cellFormula', true], /* emit formulae as .f */\n\t['cellStyles', false], /* emits style/theme as .s */\n\t['cellText', true], /* emit formatted text as .w */\n\t['cellDates', false], /* emit date cells with type `d` */\n\n\t['sheetStubs', false], /* emit empty cells */\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n\t['bookDeps', false], /* parse calculation chains */\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\n\t['bookProps', false], /* only try to get properties (no Sheets) */\n\t['bookFiles', false], /* include raw file structure (keys, files, cfb) */\n\t['bookVBA', false], /* include vba raw data (vbaraw) */\n\n\t['password',''], /* password */\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\n\nfunction fix_write_opts(opts) {\nfix_opts_func([\n\t['cellDates', false], /* write date cells with type `d` */\n\n\t['bookSST', false], /* Generate Shared String Table */\n\n\t['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\n\n\t['compression', false], /* Use file compression */\n\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\nfunction get_sheet_type(n) {\n\tif(RELS.WS.indexOf(n) > -1) return \"sheet\";\n\tif(RELS.CS && n == RELS.CS) return \"chart\";\n\tif(RELS.DS && n == RELS.DS) return \"dialog\";\n\tif(RELS.MS && n == RELS.MS) return \"macro\";\n\treturn (n && n.length) ? n : \"sheet\";\n}\nfunction safe_parse_wbrels(wbrels, sheets) {\n\tif(!wbrels) return 0;\n\ttry {\n\t\twbrels = sheets.map(function pwbr(w) { if(!w.id) w.id = w.strRelID; return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)]; });\n\t} catch(e) { return null; }\n\treturn !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction parse_sheet_legacy_drawing(sheet, type, zip, path, idx, opts, wb, comments) {\n\tif(!sheet || !sheet['!legdrawel']) return;\n\tvar dfile = resolve_path(sheet['!legdrawel'].Target, path);\n\tvar draw = getzipstr(zip, dfile, true);\n\tif(draw) parse_vml(utf8read(draw), sheet, comments||[]);\n}\n\nfunction safe_parse_sheet(zip, path, relsPath, sheet, idx, sheetRels, sheets, stype, opts, wb, themes, styles) {\n\ttry {\n\t\tsheetRels[sheet]=parse_rels(getzipstr(zip, relsPath, true), path);\n\t\tvar data = getzipdata(zip, path);\n\t\tvar _ws;\n\t\tswitch(stype) {\n\t\t\tcase 'sheet':  _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'chart':  _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n\t\t\t\tif(!_ws || !_ws['!drawel']) break;\n\t\t\t\tvar dfile = resolve_path(_ws['!drawel'].Target, path);\n\t\t\t\tvar drelsp = get_rels_path(dfile);\n\t\t\t\tvar draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n\t\t\t\tvar chartp = resolve_path(draw, dfile);\n\t\t\t\tvar crelsp = get_rels_path(chartp);\n\t\t\t\t_ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n\t\t\t\tbreak;\n\t\t\tcase 'macro':  _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'dialog': _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tdefault: throw new Error(\"Unrecognized sheet type \" + stype);\n\t\t}\n\t\tsheets[sheet] = _ws;\n\n\t\t/* scan rels for comments and threaded comments */\n\t\tvar comments = [], tcomments = [];\n\t\tif(sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function(n) {\n\t\t\tvar dfile = \"\";\n\t\t\tif(sheetRels[sheet][n].Type == RELS.CMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\tcomments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n\t\t\t\tif(!comments || !comments.length) return;\n\t\t\t\tsheet_insert_comments(_ws, comments, false);\n\t\t\t}\n\t\t\tif(sheetRels[sheet][n].Type == RELS.TCMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\ttcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n\t\t\t}\n\t\t});\n\t\tif(tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n\t\tparse_sheet_legacy_drawing(_ws, stype, zip, path, idx, opts, wb, comments);\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nfunction strip_front_slash(x) { return x.charAt(0) == '/' ? x.slice(1) : x; }\n\nfunction parse_zip(zip, opts) {\n\tmake_ssf();\n\topts = opts || {};\n\tfix_read_opts(opts);\n\n\t/* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n\t/* UOC */\n\tif(safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n\t/* Numbers */\n\tif(safegetzipfile(zip, 'Index/Document.iwa')) {\n\t\tif(typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n\t\tif(typeof parse_numbers_iwa != \"undefined\") {\n\t\t\tif(zip.FileIndex) return parse_numbers_iwa(zip, opts);\n\t\t\tvar _zip = CFB.utils.cfb_new();\n\t\t\tzipentries(zip).forEach(function(e) { zip_add_file(_zip, e, getzipbin(zip, e)); });\n\t\t\treturn parse_numbers_iwa(_zip, opts);\n\t\t}\n\t\tthrow new Error('Unsupported NUMBERS file');\n\t}\n\tif(!safegetzipfile(zip, '[Content_Types].xml')) {\n\t\tif(safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n\t\tif(safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n\t\tvar index_zip = CFB.find(zip, 'Index.zip');\n\t\tif(index_zip) {\n\t\t\topts = dup(opts);\n\t\t\tdelete opts.type;\n\t\t\tif(typeof index_zip.content == \"string\") opts.type = \"binary\";\n\t\t\t// TODO: Bun buffer bug\n\t\t\tif(typeof Bun !== \"undefined\" && Buffer.isBuffer(index_zip.content)) return readSync(new Uint8Array(index_zip.content), opts);\n\t\t\treturn readSync(index_zip.content, opts);\n\t\t}\n\t\tthrow new Error('Unsupported ZIP file');\n\t}\n\n\tvar entries = zipentries(zip);\n\tvar dir = parse_ct((getzipstr(zip, '[Content_Types].xml')));\n\tvar xlsb = false;\n\tvar sheets, binname;\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.xml\";\n\t\tif(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\n\t}\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.bin\";\n\t\tif(!getzipdata(zip,binname,true)) throw new Error(\"Could not find workbook\");\n\t\tdir.workbooks.push(binname);\n\t\txlsb = true;\n\t}\n\tif(dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n\n\tvar themes = ({});\n\tvar styles = ({});\n\tif(!opts.bookSheets && !opts.bookProps) {\n\t\tstrs = [];\n\t\tif(dir.sst) try { strs=parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts); } catch(e) { if(opts.WTF) throw e; }\n\n\t\tif(opts.cellStyles && dir.themes.length) themes = parse_theme_xml(getzipstr(zip, dir.themes[0].replace(/^\\//,''), true)||\"\", opts);\n\n\t\tif(dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n\t}\n\n\t/*var externbooks = */dir.links.map(function(link) {\n\t\ttry {\n\t\t\tvar rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n\t\t\treturn parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n\t\t} catch(e) {}\n\t});\n\n\tvar wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n\n\tvar props = {}, propdata = \"\";\n\n\tif(dir.coreprops.length) {\n\t\tpropdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n\t\tif(propdata) props = parse_core_props(propdata);\n\t\tif(dir.extprops.length !== 0) {\n\t\t\tpropdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n\t\t\tif(propdata) parse_ext_props(propdata, props, opts);\n\t\t}\n\t}\n\n\tvar custprops = {};\n\tif(!opts.bookSheets || opts.bookProps) {\n\t\tif (dir.custprops.length !== 0) {\n\t\t\tpropdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n\t\t\tif(propdata) custprops = parse_cust_props(propdata, opts);\n\t\t}\n\t}\n\n\tvar out = ({});\n\tif(opts.bookSheets || opts.bookProps) {\n\t\tif(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\n\t\telse if(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\n\t\tif(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\n\t\tif(opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n\t\tif(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n\t}\n\tsheets = {};\n\n\tvar deps = {};\n\tif(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)),dir.calcchain,opts);\n\n\tvar i=0;\n\tvar sheetRels = ({});\n\tvar path, relsPath;\n\n\t{\n\t\tvar wbsheets = wb.Sheets;\n\t\tprops.Worksheets = wbsheets.length;\n\t\tprops.SheetNames = [];\n\t\tfor(var j = 0; j != wbsheets.length; ++j) {\n\t\t\tprops.SheetNames[j] = wbsheets[j].name;\n\t\t}\n\t}\n\n\tvar wbext = xlsb ? \"bin\" : \"xml\";\n\tvar wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n\tvar wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi+1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi+1) + \".rels\").replace(/^\\//,\"\");\n\tif(!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n\tvar wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n\n\tif((dir.metadata || []).length >= 1) {\n\t\t/* TODO: MDX and other types of metadata */\n\t\topts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])),dir.metadata[0],opts);\n\t}\n\n\tif((dir.people || []).length >= 1) {\n\t\topts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])),opts);\n\t}\n\n\tif(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n\n\t/* Numbers iOS hack */\n\tvar nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\n\twsloop: for(i = 0; i != props.Worksheets; ++i) {\n\t\tvar stype = \"sheet\";\n\t\tif(wbrels && wbrels[i]) {\n\t\t\tpath = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrels[i][1];\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/,\"\") + wbrels[i][1];\n\t\t\tstype = wbrels[i][2];\n\t\t} else {\n\t\t\tpath = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\n\t\t\tpath = path.replace(/sheet0\\./,\"sheet.\");\n\t\t}\n\t\trelsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n\t\tif(opts && opts.sheets != null) switch(typeof opts.sheets) {\n\t\t\tcase \"number\": if(i != opts.sheets) continue wsloop; break;\n\t\t\tcase \"string\": if(props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop; break;\n\t\t\tdefault: if(Array.isArray && Array.isArray(opts.sheets)) {\n\t\t\t\tvar snjseen = false;\n\t\t\t\tfor(var snj = 0; snj != opts.sheets.length; ++snj) {\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen=1;\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n\t\t\t\t}\n\t\t\t\tif(!snjseen) continue wsloop;\n\t\t\t}\n\t\t}\n\t\tsafe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n\t}\n\n\tout = ({\n\t\tDirectory: dir,\n\t\tWorkbook: wb,\n\t\tProps: props,\n\t\tCustprops: custprops,\n\t\tDeps: deps,\n\t\tSheets: sheets,\n\t\tSheetNames: props.SheetNames,\n\t\tStrings: strs,\n\t\tStyles: styles,\n\t\tThemes: themes,\n\t\tSSF: dup(table_fmt)\n\t});\n\tif(opts && opts.bookFiles) {\n\t\tif(zip.files) {\n\t\t\tout.keys = entries;\n\t\t\tout.files = zip.files;\n\t\t} else {\n\t\t\tout.keys = [];\n\t\t\tout.files = {};\n\t\t\tzip.FullPaths.forEach(function(p, idx) {\n\t\t\t\tp = p.replace(/^Root Entry[\\/]/, \"\");\n\t\t\t\tout.keys.push(p);\n\t\t\t\tout.files[p] = zip.FileIndex[idx];\n\t\t\t});\n\t\t}\n\t}\n\tif(opts && opts.bookVBA) {\n\t\tif(dir.vba.length > 0) out.vbaraw = getzipdata(zip,strip_front_slash(dir.vba[0]),true);\n\t\telse if(dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin',true);\n\t}\n\t// TODO: pass back content types metdata for xlsm/xlsx resolution\n\tout.bookType = xlsb ? \"xlsb\" : \"xlsx\";\n\treturn out;\n}\n\n/* [MS-OFFCRYPTO] 2.1.1 */\nfunction parse_xlsxcfb(cfb, _opts) {\n\tvar opts = _opts || {};\n\tvar f = 'Workbook', data = CFB.find(cfb, f);\n\ttry {\n\tf = '/!DataSpaces/Version';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var version = */parse_DataSpaceVersionInfo(data.content);\n\n\t/* 2.3.4.1 */\n\tf = '/!DataSpaces/DataSpaceMap';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar dsm = parse_DataSpaceMap(data.content);\n\tif(dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.2 */\n\tf = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar seds = parse_DataSpaceDefinition(data.content);\n\tif(seds.length != 1 || seds[0] != \"StrongEncryptionTransform\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.3 */\n\tf = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var hdr = */parse_Primary(data.content);\n\t} catch(e) {}\n\n\tf = '/EncryptionInfo';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar einfo = parse_EncryptionInfo(data.content);\n\n\t/* 2.3.4.4 */\n\tf = '/EncryptedPackage';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\n/*global decrypt_agile */\nif(einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n/*global decrypt_std76 */\nif(einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n\tthrow new Error(\"File is password-protected\");\n}\n\nfunction write_zip_xlsb(wb, opts) {\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = \"bin\";\n\tvar vbafmt = true;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\nf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tvar people = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws_bin(rId-1, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tvar needtc = false;\n\t\t\t\tcomments.forEach(function(carr) {\n\t\t\t\t\tcarr[1].forEach(function(c) { if(c.T == true) needtc = true; });\n\t\t\t\t});\n\t\t\t\tif(needtc) {\n\t\t\t\t\tcf = \"xl/threadedComments/threadedComment\" + rId + \".xml\";\n\t\t\t\t\tzip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".xml\", RELS.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_comments_bin(comments, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst_bin(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb_bin(wb, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tvar ww = write_theme(wb.Themes, opts);\n\tzip_add_file(zip, f, ww);\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty_bin(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta_bin());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tif(people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_file(zip, f, write_people_xml(people, opts));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n\t}\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction write_zip_xlsx(wb, opts) {\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = \"xml\";\n\tvar vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\nf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tvar people = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws_xml(rId-1, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tvar needtc = false;\n\t\t\t\tcomments.forEach(function(carr) {\n\t\t\t\t\tcarr[1].forEach(function(c) { if(c.T == true) needtc = true; });\n\t\t\t\t});\n\t\t\t\tif(needtc) {\n\t\t\t\t\tcf = \"xl/threadedComments/threadedComment\" + rId + \".xml\";\n\t\t\t\t\tzip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".xml\", RELS.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_comments_xml(comments, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst_xml(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb_xml(wb, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_file(zip, f, write_theme(wb.Themes, opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty_xml(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta_xml());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tif(people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_file(zip, f, write_people_xml(people, opts));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n\t}\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction firstbyte(f,o) {\n\tvar x = \"\";\n\tswitch((o||{}).type || \"base64\") {\n\t\tcase 'buffer': return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tcase 'base64': x = Base64_decode(f.slice(0,12)); break;\n\t\tcase 'binary': x = f; break;\n\t\tcase 'array':  return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tdefault: throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n\t}\n\treturn [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n}\n\nfunction read_cfb(cfb, opts) {\n\tif(CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n\treturn parse_xlscfb(cfb, opts);\n}\n\nfunction read_zip(data, opts) {\n\tvar zip, d = data;\n\tvar o = opts||{};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tzip = zip_read(d, o);\n\treturn parse_zip(zip, o);\n}\n\nfunction read_plaintext(data, o) {\n\tvar i = 0;\n\tmain: while(i < data.length) switch(data.charCodeAt(i)) {\n\t\tcase 0x0A: case 0x0D: case 0x20: ++i; break;\n\t\tcase 0x3C: return parse_xlml(data.slice(i),o);\n\t\tdefault: break main;\n\t}\n\treturn PRN.to_workbook(data, o);\n}\n\nfunction read_plaintext_raw(data, o) {\n\tvar str = \"\", bytes = firstbyte(data, o);\n\tswitch(o.type) {\n\t\tcase 'base64': str = Base64_decode(data); break;\n\t\tcase 'binary': str = data; break;\n\t\tcase 'buffer': str = data.toString('binary'); break;\n\t\tcase 'array': str = cc2str(data); break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n\to.type = \"binary\";\n\treturn read_plaintext(str, o);\n}\n\nfunction read_utf16(data, o) {\n\tvar d = data;\n\tif(o.type == 'base64') d = Base64_decode(d);\n\tif(typeof ArrayBuffer !== \"undefined\" && data instanceof ArrayBuffer) d = new Uint8Array(data);\n\td = typeof $cptable !== \"undefined\" ? $cptable.utils.decode(1200, d.slice(2), 'str') : (\n\t\t(has_buf && Buffer.isBuffer(data)) ? data.slice(2).toString(\"utf16le\") :\n\t\t(typeof Uint8Array !== \"undefined\" && d instanceof Uint8Array) ? (\n\t\t\ttypeof TextDecoder !== \"undefined\" ? new TextDecoder(\"utf-16le\").decode(d.slice(2)) : utf16lereadu(d.slice(2))\n\t\t) : utf16leread(d.slice(2))\n\t);\n\to.type = \"binary\";\n\treturn read_plaintext(d, o);\n}\n\nfunction bstrify(data) {\n\treturn !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n}\n\nfunction read_prn(data, d, o, str) {\n\tif(str) { o.type = \"string\"; return PRN.to_workbook(data, o); }\n\treturn PRN.to_workbook(d, o);\n}\n\nfunction readSync(data, opts) {\n\treset_cp();\n\tvar o = opts||{};\n\tif(o.codepage && typeof $cptable === \"undefined\") console.error(\"Codepage tables are not loaded.  Non-ASCII characters may not give expected results\");\n\tif(typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n\tif(typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n\tvar d = data, n = [0,0,0,0], str = false;\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\t_ssfopts = {};\n\tif(o.dateNF) _ssfopts.dateNF = o.dateNF;\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tif(o.type == \"file\") { o.type = has_buf ? \"buffer\" : \"binary\"; d = read_binary(data); if(typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\"; }\n\tif(o.type == \"string\") { str = true; o.type = \"binary\"; o.codepage = 65001; d = bstrify(data); }\n\tif(o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n\t\t// $FlowIgnore\n\t\tvar ab=new ArrayBuffer(3), vu=new Uint8Array(ab); vu.foo=\"bar\";\n\t\t// $FlowIgnore\n\t\tif(!vu.foo) {o=dup(o); o.type='array'; return readSync(ab2a(d), o);}\n\t}\n\tswitch((n = firstbyte(d, o))[0]) {\n\t\tcase 0xD0: if(n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o); break;\n\t\tcase 0x09: if(n[1] <= 0x08) return parse_xlscfb(d, o); break;\n\t\tcase 0x3C: return parse_xlml(d, o);\n\t\tcase 0x49:\n\t\t\tif(n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n\t\t\tif(n[1] === 0x44) return read_wb_ID(d, o);\n\t\t\tbreak;\n\t\tcase 0x54: if(n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o); break;\n\t\tcase 0x50: return (n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09) ? read_zip(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xEF: return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xFF:\n\t\t\tif(n[1] === 0xFE) { return read_utf16(d, o); }\n\t\t\telse if(n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\tbreak;\n\t\tcase 0x00:\n\t\t\tif(n[1] === 0x00) {\n\t\t\t\tif(n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\t\tif(n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 0x03: case 0x83: case 0x8B: case 0x8C: return DBF.to_workbook(d, o);\n\t\tcase 0x7B: if(n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return rtf_to_workbook(d, o); break;\n\t\tcase 0x0A: case 0x0D: case 0x20: return read_plaintext_raw(d, o);\n\t\tcase 0x89: if(n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\"); break;\n\t\tcase 0x08: if(n[1] === 0xE7) throw new Error(\"Unsupported Multiplan 1.x file!\"); break;\n\t\tcase 0x0C:\n\t\t\tif(n[1] === 0xEC) throw new Error(\"Unsupported Multiplan 2.x file!\");\n\t\t\tif(n[1] === 0xED) throw new Error(\"Unsupported Multiplan 3.x file!\");\n\t\t\tbreak;\n\t}\n\tif(DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n\treturn read_prn(data, d, o, str);\n}\n\nfunction readFileSync(filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\treturn readSync(filename, o);\n}\nfunction write_cfb_ctr(cfb, o) {\n\tswitch(o.type) {\n\t\tcase \"base64\": case \"binary\": break;\n\t\tcase \"buffer\": case \"array\": o.type = \"\"; break;\n\t\tcase \"file\": return write_dl(o.file, CFB.write(cfb, {type:has_buf ? 'buffer' : \"\"}));\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\treturn CFB.write(cfb, o);\n}\n\nfunction write_zip(wb, opts) {\n\tswitch(opts.bookType) {\n\t\tcase \"ods\": return write_ods(wb, opts);\n\t\tcase \"numbers\": return write_numbers_iwa(wb, opts);\n\t\tcase \"xlsb\": return write_zip_xlsb(wb, opts);\n\t\tdefault: return write_zip_xlsx(wb, opts);\n\t}\n}\n\nfunction write_zip_type(wb, opts) {\n\tvar o = dup(opts||{});\n\tvar z = write_zip(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_typeXLSX(wb, opts) {\n\tvar o = dup(opts||{});\n\tvar z = write_zip_xlsx(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_denouement(z, o) {\n\tvar oopts = {};\n\tvar ftype = has_buf ? \"nodebuffer\" : (typeof Uint8Array !== \"undefined\" ? \"array\" : \"string\");\n\tif(o.compression) oopts.compression = 'DEFLATE';\n\tif(o.password) oopts.type = ftype;\n\telse switch(o.type) {\n\t\tcase \"base64\": oopts.type = \"base64\"; break;\n\t\tcase \"binary\": oopts.type = \"string\"; break;\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tcase \"buffer\":\n\t\tcase \"file\": oopts.type = ftype; break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tvar out = z.FullPaths ? CFB.write(z, {fileType:\"zip\", type: {\"nodebuffer\": \"buffer\", \"string\": \"binary\"}[oopts.type] || oopts.type, compression: !!o.compression}) : z.generate(oopts);\n\tif(typeof Deno !== \"undefined\") {\n\t\tif(typeof out == \"string\") {\n\t\t\tif(o.type == \"binary\" || o.type == \"base64\") return out;\n\t\t\tout = new Uint8Array(s2ab(out));\n\t\t}\n\t}\n/*jshint -W083 */\n\tif(o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o); // eslint-disable-line no-undef\n/*jshint +W083 */\n\tif(o.type === \"file\") return write_dl(o.file, out);\n\treturn o.type == \"string\" ? utf8read(out) : out;\n}\n\nfunction write_cfb_type(wb, opts) {\n\tvar o = opts||{};\n\tvar cfb = write_xlscfb(wb, o);\n\treturn write_cfb_ctr(cfb, o);\n}\n\nfunction write_string_type(out, opts, bom) {\n\tif(!bom) bom = \"\";\n\tvar o = bom + out;\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode(utf8write(o));\n\t\tcase \"binary\": return utf8write(o);\n\t\tcase \"string\": return out;\n\t\tcase \"file\": return write_dl(opts.file, o, 'utf8');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(o, 'utf8');\n\t\t\telse if(typeof TextEncoder !== \"undefined\") return new TextEncoder().encode(o);\n\t\t\telse return write_string_type(o, {type:'binary'}).split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\nfunction write_stxt_type(out, opts) {\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode_pass(out);\n\t\tcase \"binary\": return out;\n\t\tcase \"string\": return out; /* override in sheet_to_txt */\n\t\tcase \"file\": return write_dl(opts.file, out, 'binary');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(out, 'binary');\n\t\t\telse return out.split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\n/* TODO: test consistency */\nfunction write_binary_type(out, opts) {\n\tswitch(opts.type) {\n\t\tcase \"string\":\n\t\tcase \"base64\":\n\t\tcase \"binary\":\n\t\t\tvar bstr = \"\";\n\t\t\t// $FlowIgnore\n\t\t\tfor(var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\n\t\t\treturn opts.type == 'base64' ? Base64_encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\n\t\tcase \"file\": return write_dl(opts.file, out);\n\t\tcase \"buffer\": return out;\n\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t}\n}\n\nfunction writeSyncXLSX(wb, opts) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out = (writeSyncXLSX(wb, o)); o.type = \"array\"; return s2ab(out); }\n\treturn write_zip_typeXLSX(wb, o);\n}\n\nfunction writeSync(wb, opts) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out = (writeSync(wb, o)); o.type = \"array\"; return s2ab(out); }\n\tvar idx = 0;\n\tif(o.sheet) {\n\t\tif(typeof o.sheet == \"number\") idx = o.sheet;\n\t\telse idx = wb.SheetNames.indexOf(o.sheet);\n\t\tif(!wb.SheetNames[idx]) throw new Error(\"Sheet not found: \" + o.sheet + \" : \" + (typeof o.sheet));\n\t}\n\tswitch(o.bookType || 'xlsb') {\n\t\tcase 'xml':\n\t\tcase 'xlml': return write_string_type(write_xlml(wb, o), o);\n\t\tcase 'slk':\n\t\tcase 'sylk': return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o, wb), o);\n\t\tcase 'htm':\n\t\tcase 'html': return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'txt': return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'csv': return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, \"\\ufeff\");\n\t\tcase 'dif': return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'dbf': return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'prn': return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'rtf': return write_string_type(sheet_to_rtf(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'eth': return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'fods': return write_string_type(write_ods(wb, o), o);\n\t\tcase 'wk1': return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'wk3': return write_binary_type(WK_.book_to_wk3(wb, o), o);\n\t\tcase 'biff2': if(!o.biff) o.biff = 2; /* falls through */\n\t\tcase 'biff3': if(!o.biff) o.biff = 3; /* falls through */\n\t\tcase 'biff4': if(!o.biff) o.biff = 4; return write_binary_type(write_biff_buf(wb, o), o);\n\t\tcase 'biff5': if(!o.biff) o.biff = 5; /* falls through */\n\t\tcase 'biff8':\n\t\tcase 'xla':\n\t\tcase 'xls': if(!o.biff) o.biff = 8; return write_cfb_type(wb, o);\n\t\tcase 'xlsx':\n\t\tcase 'xlsm':\n\t\tcase 'xlam':\n\t\tcase 'xlsb':\n\t\tcase 'numbers':\n\t\tcase 'ods': return write_zip_type(wb, o);\n\t\tdefault: throw new Error (\"Unrecognized bookType |\" + o.bookType + \"|\");\n\t}\n}\n\nfunction resolve_book_type(o) {\n\tif(o.bookType) return;\n\tvar _BT = {\n\t\t\"xls\": \"biff8\",\n\t\t\"htm\": \"html\",\n\t\t\"slk\": \"sylk\",\n\t\t\"socialcalc\": \"eth\",\n\t\t\"Sh33tJS\": \"WTF\"\n\t};\n\tvar ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\n\tif(ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\n\to.bookType = _BT[o.bookType] || o.bookType;\n}\n\nfunction writeFileSync(wb, filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSync(wb, o);\n}\n\nfunction writeFileSyncXLSX(wb, filename, opts) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSyncXLSX(wb, o);\n}\n\n\nfunction writeFileAsync(filename, wb, opts, cb) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\to.type = 'buffer';\n\tvar _cb = cb; if(!(_cb instanceof Function)) _cb = (opts);\n\treturn _fs.writeFile(filename, writeSync(wb, o), _cb);\n}\nfunction make_json_row(sheet, r, R, cols, header, hdr, o) {\n\tvar rr = encode_row(R);\n\tvar defval = o.defval, raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n\tvar isempty = true, dense = (sheet[\"!data\"] != null);\n\tvar row = (header === 1) ? [] : {};\n\tif(header !== 1) {\n\t\tif(Object.defineProperty) try { Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false}); } catch(e) { row.__rowNum__ = R; }\n\t\telse row.__rowNum__ = R;\n\t}\n\tif(!dense || sheet[\"!data\"][R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar val = dense ? (sheet[\"!data\"][R]||[])[C] : sheet[cols[C] + rr];\n\t\tif(val == null || val.t === undefined) {\n\t\t\tif(defval === undefined) continue;\n\t\t\tif(hdr[C] != null) { row[hdr[C]] = defval; }\n\t\t\tcontinue;\n\t\t}\n\t\tvar v = val.v;\n\t\tswitch(val.t){\n\t\t\tcase 'z': if(v == null) break; continue;\n\t\t\tcase 'e': v = (v == 0 ? null : void 0); break;\n\t\t\tcase 's': case 'b':\n\t\t\tcase 'n': if(!val.z || !fmt_is_date(val.z)) break;\n\t\t\tv = numdate(v); // TODO: date1904 setting should also be stored in worksheet object\n\t\t\tif(typeof v == \"number\") break;\n\t\t\t/* falls through */\n\t\t\tcase 'd': if(!(o && o.UTC)) v = utc_to_local(v); break;\n\t\t\tdefault: throw new Error('unrecognized type ' + val.t);\n\t\t}\n\t\tif(hdr[C] != null) {\n\t\t\tif(v == null) {\n\t\t\t\tif(val.t == \"e\" && v === null) row[hdr[C]] = null;\n\t\t\t\telse if(defval !== undefined) row[hdr[C]] = defval;\n\t\t\t\telse if(raw && v === null) row[hdr[C]] = null;\n\t\t\t\telse continue;\n\t\t\t} else {\n\t\t\t\trow[hdr[C]] = raw && (val.t !== \"n\" || (val.t === \"n\" && o.rawNumbers !== false)) ? v : format_cell(val,v,o);\n\t\t\t}\n\t\t\tif(v != null) isempty = false;\n\t\t}\n\t}\n\treturn { row: row, isempty: isempty };\n}\n\n\nfunction sheet_to_json(sheet, opts) {\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\telse if(o.header == null) header = 0;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols = [];\n\tvar out = [];\n\tvar outi = 0, counter = 0;\n\tvar dense = sheet[\"!data\"] != null;\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[\"!data\"][R]) sheet[\"!data\"][R] = [];\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[\"!data\"][R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, o);\n\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\nvar qreg = /\"/g;\nfunction make_csv_row(sheet, r, R, cols, fs, rs, FS, o) {\n\tvar isempty = true;\n\tvar row = [], txt = \"\", rr = encode_row(R);\n\tvar dense = sheet[\"!data\"] != null;\n\tvar datarow = dense && sheet[\"!data\"][R] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tif (!cols[C]) continue;\n\t\tvar val = dense ? datarow[C]: sheet[cols[C] + rr];\n\t\tif(val == null) txt = \"\";\n\t\telse if(val.v != null) {\n\t\t\tisempty = false;\n\t\t\ttxt = ''+(o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n\t\t\tfor(var i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\n\t\t\tif(txt == \"ID\") txt = '\"ID\"';\n\t\t} else if(val.f != null && !val.F) {\n\t\t\tisempty = false;\n\t\t\ttxt = '=' + val.f; if(txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n\t\t} else txt = \"\";\n\t\t/* NOTE: Excel CSV does not support array formulae */\n\t\trow.push(txt);\n\t}\n\tif(o.blankrows === false && isempty) return null;\n\treturn row.join(FS);\n}\n\nfunction sheet_to_csv(sheet, opts) {\n\tvar out = [];\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\n\tvar row = \"\", cols = [];\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar w = 0;\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\trow = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\n\t\tif(row == null) { continue; }\n\t\tif(o.strip) row = row.replace(endregex,\"\");\n\t\tif(row || (o.blankrows !== false)) out.push((w++ ? RS : \"\") + row);\n\t}\n\treturn out.join(\"\");\n}\n\nfunction sheet_to_txt(sheet, opts) {\n\tif(!opts) opts = {}; opts.FS = \"\\t\"; opts.RS = \"\\n\";\n\tvar s = sheet_to_csv(sheet, opts);\n\tif(typeof $cptable == 'undefined' || opts.type == 'string') return s;\n\tvar o = $cptable.utils.encode(1200, s, 'str');\n\treturn String.fromCharCode(255) + String.fromCharCode(254) + o;\n}\n\nfunction sheet_to_formulae(sheet) {\n\tvar y = \"\", x, val=\"\";\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\n\tvar cmds = [];\n\tvar dense = sheet[\"!data\"] != null;\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\ty = cols[C] + rr;\n\t\t\tx = dense ? (sheet[\"!data\"][R]||[])[C] : sheet[y];\n\t\t\tval = \"\";\n\t\t\tif(x === undefined) continue;\n\t\t\telse if(x.F != null) {\n\t\t\t\ty = x.F;\n\t\t\t\tif(!x.f) continue;\n\t\t\t\tval = x.f;\n\t\t\t\tif(y.indexOf(\":\") == -1) y = y + \":\" + y;\n\t\t\t}\n\t\t\tif(x.f != null) val = x.f;\n\t\t\telse if(x.t == 'z') continue;\n\t\t\telse if(x.t == 'n' && x.v != null) val = \"\" + x.v;\n\t\t\telse if(x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if(x.v === undefined) continue;\n\t\t\telse if(x.t == 's') val = \"'\" + x.v;\n\t\t\telse val = \"\"+x.v;\n\t\t\tcmds[cmds.length] = y + \"=\" + val;\n\t\t}\n\t}\n\treturn cmds;\n}\n\nfunction sheet_add_json(_ws, js, opts) {\n\tvar o = opts || {};\n\tvar dense = _ws ? (_ws[\"!data\"] != null) : o.dense;\n\tif(DENSE != null && dense == null) dense = DENSE;\n\tvar offset = +!o.skipHeader;\n\tvar ws = _ws || ({});\n\tif(!_ws && dense) ws[\"!data\"] = [];\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t}\n\tvar range = ({s: {c:0, r:0}, e: {c:_C, r:_R + js.length - 1 + offset}});\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) { _R = _range.e.r + 1; range.e.r = _R + js.length - 1 + offset; }\n\t} else {\n\t\tif(_R == -1) { _R = 0; range.e.r = js.length - 1 + offset; }\n\t}\n\tvar hdr = o.header || [], C = 0;\n\tvar ROW = [];\n\tjs.forEach(function (JS, R) {\n\t\tif(dense && !ws[\"!data\"][_R + R + offset]) ws[\"!data\"][_R + R + offset] = [];\n\t\tif(dense) ROW = ws[\"!data\"][_R + R + offset];\n\t\tkeys(JS).forEach(function(k) {\n\t\t\tif((C=hdr.indexOf(k)) == -1) hdr[C=hdr.length] = k;\n\t\t\tvar v = JS[k];\n\t\t\tvar t = 'z';\n\t\t\tvar z = \"\";\n\t\t\tvar ref = dense ? \"\" : (encode_col(_C + C) + encode_row(_R + R + offset));\n\t\t\tvar cell = dense ? ROW[_C + C] : ws[ref];\n\t\t\tif(v && typeof v === 'object' && !(v instanceof Date)){\n\t\t\t\tif(dense) ROW[_C + C] = v;\n\t\t\t\telse ws[ref] = v;\n\t\t\t} else {\n\t\t\t\tif(typeof v == 'number') t = 'n';\n\t\t\t\telse if(typeof v == 'boolean') t = 'b';\n\t\t\t\telse if(typeof v == 'string') t = 's';\n\t\t\t\telse if(v instanceof Date) {\n\t\t\t\t\tt = 'd';\n\t\t\t\t\tif(!o.UTC) v = local_to_utc(v);\n\t\t\t\t\tif(!o.cellDates) { t = 'n'; v = datenum(v); }\n\t\t\t\t\tz = (cell != null && cell.z && fmt_is_date(cell.z)) ? cell.z : (o.dateNF || table_fmt[14]);\n\t\t\t\t}\n\t\t\t\telse if(v === null && o.nullError) { t = 'e'; v = 0; }\n\t\t\t\tif(!cell) {\n\t\t\t\t\tif(!dense) ws[ref] = cell = ({t:t, v:v});\n\t\t\t\t\telse ROW[_C + C] = cell = ({t:t, v:v});\n\t\t\t\t} else {\n\t\t\t\t\tcell.t = t; cell.v = v;\n\t\t\t\t\tdelete cell.w; delete cell.R;\n\t\t\t\t\tif(z) cell.z = z;\n\t\t\t\t}\n\t\t\t\tif(z) cell.z = z;\n\t\t\t}\n\t\t});\n\t});\n\trange.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\tvar __R = encode_row(_R);\n\tif(dense && !ws[\"!data\"][_R]) ws[\"!data\"][_R] = [];\n\tif(offset) for(C = 0; C < hdr.length; ++C) {\n\t\tif(dense) ws[\"!data\"][_R][C + _C] = {t:'s', v:hdr[C]};\n\t\telse ws[encode_col(C + _C) + __R] = {t:'s', v:hdr[C]};\n\t}\n\tws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction json_to_sheet(js, opts) { return sheet_add_json(null, js, opts); }\n\n/* get cell, creating a stub if necessary */\nfunction ws_get_cell_stub(ws, R, C) {\n\t/* A1 cell address */\n\tif(typeof R == \"string\") {\n\t\tif(ws[\"!data\"] != null) {\n\t\t\tvar RC = decode_cell(R);\n\t\t\tif(!ws[\"!data\"][RC.r]) ws[\"!data\"][RC.r] = [];\n\t\t\treturn ws[\"!data\"][RC.r][RC.c] || (ws[\"!data\"][RC.r][RC.c] = {t:'z'});\n\t\t}\n\t\treturn ws[R] || (ws[R] = {t:'z'});\n\t}\n\t/* cell address object */\n\tif(typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n\t/* R and C are 0-based indices */\n\treturn ws_get_cell_stub(ws, encode_col(C||0) + encode_row(R));\n}\n\n/* find sheet index for given name / validate index */\nfunction wb_sheet_idx(wb, sh) {\n\tif(typeof sh == \"number\") {\n\t\tif(sh >= 0 && wb.SheetNames.length > sh) return sh;\n\t\tthrow new Error(\"Cannot find sheet # \" + sh);\n\t} else if(typeof sh == \"string\") {\n\t\tvar idx = wb.SheetNames.indexOf(sh);\n\t\tif(idx > -1) return idx;\n\t\tthrow new Error(\"Cannot find sheet name |\" + sh + \"|\");\n\t} else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n\n/* simple blank workbook object */\nfunction book_new() {\n\treturn { SheetNames: [], Sheets: {} };\n}\n\n/* add a worksheet to the end of a given workbook */\nfunction book_append_sheet(wb, ws, name, roll) {\n\tvar i = 1;\n\tif(!name) for(; i <= 0xFFFF; ++i, name = undefined) if(wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n\tif(!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n\tif(roll && wb.SheetNames.indexOf(name) >= 0) {\n\t\tvar m = name.match(/(^.*?)(\\d+)$/);\n\t\ti = m && +m[2] || 0;\n\t\tvar root = m && m[1] || name;\n\t\tfor(++i; i <= 0xFFFF; ++i) if(wb.SheetNames.indexOf(name = root + i) == -1) break;\n\t}\n\tcheck_ws_name(name);\n\tif(wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n\n\twb.SheetNames.push(name);\n\twb.Sheets[name] = ws;\n\treturn name;\n}\n\n/* set sheet visibility (visible/hidden/very hidden) */\nfunction book_set_sheet_visibility(wb, sh, vis) {\n\tif(!wb.Workbook) wb.Workbook = {};\n\tif(!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n\n\tvar idx = wb_sheet_idx(wb, sh);\n\t// $FlowIgnore\n\tif(!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n\tswitch(vis) {\n\t\tcase 0: case 1: case 2: break;\n\t\tdefault: throw new Error(\"Bad sheet visibility setting \" + vis);\n\t}\n\t// $FlowIgnore\n\twb.Workbook.Sheets[idx].Hidden = vis;\n}\n\n/* set number format */\nfunction cell_set_number_format(cell, fmt) {\n\tcell.z = fmt;\n\treturn cell;\n}\n\n/* set cell hyperlink */\nfunction cell_set_hyperlink(cell, target, tooltip) {\n\tif(!target) {\n\t\tdelete cell.l;\n\t} else {\n\t\tcell.l = ({ Target: target });\n\t\tif(tooltip) cell.l.Tooltip = tooltip;\n\t}\n\treturn cell;\n}\nfunction cell_set_internal_link(cell, range, tooltip) { return cell_set_hyperlink(cell, \"#\" + range, tooltip); }\n\n/* add to cell comments */\nfunction cell_add_comment(cell, text, author) {\n\tif(!cell.c) cell.c = [];\n\tcell.c.push({t:text, a:author||\"SheetJS\"});\n}\n\n/* set array formula and flush related cells */\nfunction sheet_set_array_formula(ws, range, formula, dynamic) {\n\tvar rng = typeof range != \"string\" ? range : safe_decode_range(range);\n\tvar rngstr = typeof range == \"string\" ? range : encode_range(range);\n\tfor(var R = rng.s.r; R <= rng.e.r; ++R) for(var C = rng.s.c; C <= rng.e.c; ++C) {\n\t\tvar cell = ws_get_cell_stub(ws, R, C);\n\t\tcell.t = 'n';\n\t\tcell.F = rngstr;\n\t\tdelete cell.v;\n\t\tif(R == rng.s.r && C == rng.s.c) {\n\t\t\tcell.f = formula;\n\t\t\tif(dynamic) cell.D = true;\n\t\t}\n\t}\n\tvar wsr = decode_range(ws[\"!ref\"]);\n\tif(wsr.s.r > rng.s.r) wsr.s.r = rng.s.r;\n\tif(wsr.s.c > rng.s.c) wsr.s.c = rng.s.c;\n\tif(wsr.e.r < rng.e.r) wsr.e.r = rng.e.r;\n\tif(wsr.e.c < rng.e.c) wsr.e.c = rng.e.c;\n\tws[\"!ref\"] = encode_range(wsr);\n\treturn ws;\n}\n\nvar utils = {\n\tencode_col: encode_col,\n\tencode_row: encode_row,\n\tencode_cell: encode_cell,\n\tencode_range: encode_range,\n\tdecode_col: decode_col,\n\tdecode_row: decode_row,\n\tsplit_cell: split_cell,\n\tdecode_cell: decode_cell,\n\tdecode_range: decode_range,\n\tformat_cell: format_cell,\n\tsheet_add_aoa: sheet_add_aoa,\n\tsheet_add_json: sheet_add_json,\n\tsheet_add_dom: sheet_add_dom,\n\taoa_to_sheet: aoa_to_sheet,\n\tjson_to_sheet: json_to_sheet,\n\ttable_to_sheet: parse_dom_table,\n\ttable_to_book: table_to_book,\n\tsheet_to_csv: sheet_to_csv,\n\tsheet_to_txt: sheet_to_txt,\n\tsheet_to_json: sheet_to_json,\n\tsheet_to_html: sheet_to_html,\n\tsheet_to_formulae: sheet_to_formulae,\n\tsheet_to_row_object_array: sheet_to_json,\n\tsheet_get_cell: ws_get_cell_stub,\n\tbook_new: book_new,\n\tbook_append_sheet: book_append_sheet,\n\tbook_set_sheet_visibility: book_set_sheet_visibility,\n\tcell_set_number_format: cell_set_number_format,\n\tcell_set_hyperlink: cell_set_hyperlink,\n\tcell_set_internal_link: cell_set_internal_link,\n\tcell_add_comment: cell_add_comment,\n\tsheet_set_array_formula: sheet_set_array_formula,\n\tconsts: {\n\t\tSHEET_VISIBLE: 0,\n\t\tSHEET_HIDDEN: 1,\n\t\tSHEET_VERY_HIDDEN: 2\n\t}\n};\n\nvar _Readable;\nfunction set_readable(R) { _Readable = R; }\n\nfunction write_csv_stream(sheet, opts) {\n\tvar stream = _Readable();\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\n\tvar row = \"\", cols = [];\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar R = r.s.r;\n\tvar BOM = false, w = 0;\n\tstream._read = function() {\n\t\tif(!BOM) { BOM = true; return stream.push(\"\\uFEFF\"); }\n\t\twhile(R <= r.e.r) {\n\t\t\t++R;\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\trow = make_csv_row(sheet, r, R-1, cols, fs, rs, FS, o);\n\t\t\tif(row != null) {\n\t\t\t\tif(o.strip) row = row.replace(endregex,\"\");\n\t\t\t\tif(row || (o.blankrows !== false)) return stream.push((w++ ? RS : \"\") + row);\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nfunction write_html_stream(ws, opts) {\n\tvar stream = _Readable();\n\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tstream.push(header);\n\tvar r = decode_range(ws['!ref']);\n\tstream.push(make_html_preamble(ws, r, o));\n\tvar R = r.s.r;\n\tvar end = false;\n\tstream._read = function() {\n\t\tif(R > r.e.r) {\n\t\t\tif(!end) { end = true; stream.push(\"</table>\" + footer); }\n\t\t\treturn stream.push(null);\n\t\t}\n\t\twhile(R <= r.e.r) {\n\t\t\tstream.push(make_html_row(ws, r, R, o));\n\t\t\t++R;\n\t\t\tbreak;\n\t\t}\n\t};\n\treturn stream;\n}\n\nfunction write_json_stream(sheet, opts) {\n\tvar stream = _Readable({objectMode:true});\n\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols = [];\n\tvar counter = 0;\n\tvar dense = sheet[\"!data\"] != null;\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[\"!data\"][R]) sheet[\"!data\"][R] = [];\n\tvar colinfo = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[\"!data\"][R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tR = r.s.r + offset;\n\tstream._read = function() {\n\t\twhile(R <= r.e.r) {\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, o);\n\t\t\t++R;\n\t\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\n\t\t\t\tstream.push(row.row);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nvar __stream = {\n\tto_json: write_json_stream,\n\tto_html: write_html_stream,\n\tto_csv: write_csv_stream,\n\tset_readable: set_readable\n};\nif(typeof parse_xlscfb !== \"undefined\") XLSX.parse_xlscfb = parse_xlscfb;\nXLSX.parse_zip = parse_zip;\nXLSX.read = readSync; //xlsread\nXLSX.readFile = readFileSync; //readFile\nXLSX.readFileSync = readFileSync;\nXLSX.write = writeSync;\nXLSX.writeFile = writeFileSync;\nXLSX.writeFileSync = writeFileSync;\nXLSX.writeFileAsync = writeFileAsync;\nXLSX.utils = utils;\nXLSX.writeXLSX = writeSyncXLSX;\nXLSX.writeFileXLSX = writeFileSyncXLSX;\nXLSX.set_fs = set_fs;\nXLSX.set_cptable = set_cptable;\nXLSX.SSF = SSF;\nif(typeof __stream !== \"undefined\") XLSX.stream = __stream;\nif(typeof CFB !== \"undefined\") XLSX.CFB = CFB;\nif(typeof require !== \"undefined\") {\n  var strmod = require('stream');\n  if((strmod||{}).Readable) set_readable(strmod.Readable);\n\ttry { _fs = require('fs'); } catch(e) {}\n}\n}\n/*global define */\nif(typeof exports !== 'undefined') make_xlsx_lib(exports);\nelse if(typeof module !== 'undefined' && module.exports) make_xlsx_lib(module.exports);\nelse if(typeof define === 'function' && define.amd) define('xlsx', function() { if(!XLSX.version) make_xlsx_lib(XLSX); return XLSX; });\nelse make_xlsx_lib(XLSX);\n/* NOTE: the following extra line is needed for \"Lightning Locker Service\" */\nif(typeof window !== 'undefined' && !window.XLSX) try { window.XLSX = XLSX; } catch(e) {}\n","/*!\n * assertion-error\n * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>\n * MIT Licensed\n */\n\n/*!\n * Return a function that will copy properties from\n * one object to another excluding any originally\n * listed. Returned function will create a new `{}`.\n *\n * @param {String} excluded properties ...\n * @return {Function}\n */\n\nfunction exclude () {\n  var excludes = [].slice.call(arguments);\n\n  function excludeProps (res, obj) {\n    Object.keys(obj).forEach(function (key) {\n      if (!~excludes.indexOf(key)) res[key] = obj[key];\n    });\n  }\n\n  return function extendExclude () {\n    var args = [].slice.call(arguments)\n      , i = 0\n      , res = {};\n\n    for (; i < args.length; i++) {\n      excludeProps(res, args[i]);\n    }\n\n    return res;\n  };\n};\n\n/*!\n * Primary Exports\n */\n\nmodule.exports = AssertionError;\n\n/**\n * ### AssertionError\n *\n * An extension of the JavaScript `Error` constructor for\n * assertion and validation scenarios.\n *\n * @param {String} message\n * @param {Object} properties to include (optional)\n * @param {callee} start stack function (optional)\n */\n\nfunction AssertionError (message, _props, ssf) {\n  var extend = exclude('name', 'message', 'stack', 'constructor', 'toJSON')\n    , props = extend(_props || {});\n\n  // default values\n  this.message = message || 'Unspecified AssertionError';\n  this.showDiff = false;\n\n  // copy from properties\n  for (var key in props) {\n    this[key] = props[key];\n  }\n\n  // capture stack trace\n  ssf = ssf || AssertionError;\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, ssf);\n  } else {\n    try {\n      throw new Error();\n    } catch(e) {\n      this.stack = e.stack;\n    }\n  }\n}\n\n/*!\n * Inherit from Error.prototype\n */\n\nAssertionError.prototype = Object.create(Error.prototype);\n\n/*!\n * Statically set name\n */\n\nAssertionError.prototype.name = 'AssertionError';\n\n/*!\n * Ensure correct constructor\n */\n\nAssertionError.prototype.constructor = AssertionError;\n\n/**\n * Allow errors to be converted to JSON for static transfer.\n *\n * @param {Boolean} include stack (default: `true`)\n * @return {Object} object that can be `JSON.stringify`\n */\n\nAssertionError.prototype.toJSON = function (stack) {\n  var extend = exclude('constructor', 'toJSON', 'stack')\n    , props = extend({ name: this.name }, this);\n\n  // include stack if exists and not turned off\n  if (false !== stack && this.stack) {\n    props.stack = this.stack;\n  }\n\n  return props;\n};\n","module.exports = require('./lib/chai');\n","/*!\n * chai\n * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar used = [];\n\n/*!\n * Chai version\n */\n\nexports.version = '4.3.8';\n\n/*!\n * Assertion Error\n */\n\nexports.AssertionError = require('assertion-error');\n\n/*!\n * Utils for plugins (not exported)\n */\n\nvar util = require('./chai/utils');\n\n/**\n * # .use(function)\n *\n * Provides a way to extend the internals of Chai.\n *\n * @param {Function}\n * @returns {this} for chaining\n * @api public\n */\n\nexports.use = function (fn) {\n  if (!~used.indexOf(fn)) {\n    fn(exports, util);\n    used.push(fn);\n  }\n\n  return exports;\n};\n\n/*!\n * Utility Functions\n */\n\nexports.util = util;\n\n/*!\n * Configuration\n */\n\nvar config = require('./chai/config');\nexports.config = config;\n\n/*!\n * Primary `Assertion` prototype\n */\n\nvar assertion = require('./chai/assertion');\nexports.use(assertion);\n\n/*!\n * Core Assertions\n */\n\nvar core = require('./chai/core/assertions');\nexports.use(core);\n\n/*!\n * Expect interface\n */\n\nvar expect = require('./chai/interface/expect');\nexports.use(expect);\n\n/*!\n * Should interface\n */\n\nvar should = require('./chai/interface/should');\nexports.use(should);\n\n/*!\n * Assert interface\n */\n\nvar assert = require('./chai/interface/assert');\nexports.use(assert);\n","/*!\n * chai\n * http://chaijs.com\n * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar config = require('./config');\n\nmodule.exports = function (_chai, util) {\n  /*!\n   * Module dependencies.\n   */\n\n  var AssertionError = _chai.AssertionError\n    , flag = util.flag;\n\n  /*!\n   * Module export.\n   */\n\n  _chai.Assertion = Assertion;\n\n  /*!\n   * Assertion Constructor\n   *\n   * Creates object for chaining.\n   *\n   * `Assertion` objects contain metadata in the form of flags. Three flags can\n   * be assigned during instantiation by passing arguments to this constructor:\n   *\n   * - `object`: This flag contains the target of the assertion. For example, in\n   *   the assertion `expect(numKittens).to.equal(7);`, the `object` flag will\n   *   contain `numKittens` so that the `equal` assertion can reference it when\n   *   needed.\n   *\n   * - `message`: This flag contains an optional custom error message to be\n   *   prepended to the error message that's generated by the assertion when it\n   *   fails.\n   *\n   * - `ssfi`: This flag stands for \"start stack function indicator\". It\n   *   contains a function reference that serves as the starting point for\n   *   removing frames from the stack trace of the error that's created by the\n   *   assertion when it fails. The goal is to provide a cleaner stack trace to\n   *   end users by removing Chai's internal functions. Note that it only works\n   *   in environments that support `Error.captureStackTrace`, and only when\n   *   `Chai.config.includeStack` hasn't been set to `false`.\n   *\n   * - `lockSsfi`: This flag controls whether or not the given `ssfi` flag\n   *   should retain its current value, even as assertions are chained off of\n   *   this object. This is usually set to `true` when creating a new assertion\n   *   from within another assertion. It's also temporarily set to `true` before\n   *   an overwritten assertion gets called by the overwriting assertion.\n   *\n   * @param {Mixed} obj target of the assertion\n   * @param {String} msg (optional) custom error message\n   * @param {Function} ssfi (optional) starting point for removing stack frames\n   * @param {Boolean} lockSsfi (optional) whether or not the ssfi flag is locked\n   * @api private\n   */\n\n  function Assertion (obj, msg, ssfi, lockSsfi) {\n    flag(this, 'ssfi', ssfi || Assertion);\n    flag(this, 'lockSsfi', lockSsfi);\n    flag(this, 'object', obj);\n    flag(this, 'message', msg);\n\n    return util.proxify(this);\n  }\n\n  Object.defineProperty(Assertion, 'includeStack', {\n    get: function() {\n      console.warn('Assertion.includeStack is deprecated, use chai.config.includeStack instead.');\n      return config.includeStack;\n    },\n    set: function(value) {\n      console.warn('Assertion.includeStack is deprecated, use chai.config.includeStack instead.');\n      config.includeStack = value;\n    }\n  });\n\n  Object.defineProperty(Assertion, 'showDiff', {\n    get: function() {\n      console.warn('Assertion.showDiff is deprecated, use chai.config.showDiff instead.');\n      return config.showDiff;\n    },\n    set: function(value) {\n      console.warn('Assertion.showDiff is deprecated, use chai.config.showDiff instead.');\n      config.showDiff = value;\n    }\n  });\n\n  Assertion.addProperty = function (name, fn) {\n    util.addProperty(this.prototype, name, fn);\n  };\n\n  Assertion.addMethod = function (name, fn) {\n    util.addMethod(this.prototype, name, fn);\n  };\n\n  Assertion.addChainableMethod = function (name, fn, chainingBehavior) {\n    util.addChainableMethod(this.prototype, name, fn, chainingBehavior);\n  };\n\n  Assertion.overwriteProperty = function (name, fn) {\n    util.overwriteProperty(this.prototype, name, fn);\n  };\n\n  Assertion.overwriteMethod = function (name, fn) {\n    util.overwriteMethod(this.prototype, name, fn);\n  };\n\n  Assertion.overwriteChainableMethod = function (name, fn, chainingBehavior) {\n    util.overwriteChainableMethod(this.prototype, name, fn, chainingBehavior);\n  };\n\n  /**\n   * ### .assert(expression, message, negateMessage, expected, actual, showDiff)\n   *\n   * Executes an expression and check expectations. Throws AssertionError for reporting if test doesn't pass.\n   *\n   * @name assert\n   * @param {Philosophical} expression to be tested\n   * @param {String|Function} message or function that returns message to display if expression fails\n   * @param {String|Function} negatedMessage or function that returns negatedMessage to display if negated expression fails\n   * @param {Mixed} expected value (remember to check for negation)\n   * @param {Mixed} actual (optional) will default to `this.obj`\n   * @param {Boolean} showDiff (optional) when set to `true`, assert will display a diff in addition to the message if expression fails\n   * @api private\n   */\n\n  Assertion.prototype.assert = function (expr, msg, negateMsg, expected, _actual, showDiff) {\n    var ok = util.test(this, arguments);\n    if (false !== showDiff) showDiff = true;\n    if (undefined === expected && undefined === _actual) showDiff = false;\n    if (true !== config.showDiff) showDiff = false;\n\n    if (!ok) {\n      msg = util.getMessage(this, arguments);\n      var actual = util.getActual(this, arguments);\n      var assertionErrorObjectProperties = {\n          actual: actual\n        , expected: expected\n        , showDiff: showDiff\n      };\n\n      var operator = util.getOperator(this, arguments);\n      if (operator) {\n        assertionErrorObjectProperties.operator = operator;\n      }\n\n      throw new AssertionError(\n        msg,\n        assertionErrorObjectProperties,\n        (config.includeStack) ? this.assert : flag(this, 'ssfi'));\n    }\n  };\n\n  /*!\n   * ### ._obj\n   *\n   * Quick reference to stored `actual` value for plugin developers.\n   *\n   * @api private\n   */\n\n  Object.defineProperty(Assertion.prototype, '_obj',\n    { get: function () {\n        return flag(this, 'object');\n      }\n    , set: function (val) {\n        flag(this, 'object', val);\n      }\n  });\n};\n","module.exports = {\n\n  /**\n   * ### config.includeStack\n   *\n   * User configurable property, influences whether stack trace\n   * is included in Assertion error message. Default of false\n   * suppresses stack trace in the error message.\n   *\n   *     chai.config.includeStack = true;  // enable stack on error\n   *\n   * @param {Boolean}\n   * @api public\n   */\n\n  includeStack: false,\n\n  /**\n   * ### config.showDiff\n   *\n   * User configurable property, influences whether or not\n   * the `showDiff` flag should be included in the thrown\n   * AssertionErrors. `false` will always be `false`; `true`\n   * will be true when the assertion has requested a diff\n   * be shown.\n   *\n   * @param {Boolean}\n   * @api public\n   */\n\n  showDiff: true,\n\n  /**\n   * ### config.truncateThreshold\n   *\n   * User configurable property, sets length threshold for actual and\n   * expected values in assertion errors. If this threshold is exceeded, for\n   * example for large data structures, the value is replaced with something\n   * like `[ Array(3) ]` or `{ Object (prop1, prop2) }`.\n   *\n   * Set it to zero if you want to disable truncating altogether.\n   *\n   * This is especially userful when doing assertions on arrays: having this\n   * set to a reasonable large value makes the failure messages readily\n   * inspectable.\n   *\n   *     chai.config.truncateThreshold = 0;  // disable truncating\n   *\n   * @param {Number}\n   * @api public\n   */\n\n  truncateThreshold: 40,\n\n  /**\n   * ### config.useProxy\n   *\n   * User configurable property, defines if chai will use a Proxy to throw\n   * an error when a non-existent property is read, which protects users\n   * from typos when using property-based assertions.\n   *\n   * Set it to false if you want to disable this feature.\n   *\n   *     chai.config.useProxy = false;  // disable use of Proxy\n   *\n   * This feature is automatically disabled regardless of this config value\n   * in environments that don't support proxies.\n   *\n   * @param {Boolean}\n   * @api public\n   */\n\n  useProxy: true,\n\n  /**\n   * ### config.proxyExcludedKeys\n   *\n   * User configurable property, defines which properties should be ignored\n   * instead of throwing an error if they do not exist on the assertion.\n   * This is only applied if the environment Chai is running in supports proxies and\n   * if the `useProxy` configuration setting is enabled.\n   * By default, `then` and `inspect` will not throw an error if they do not exist on the\n   * assertion object because the `.inspect` property is read by `util.inspect` (for example, when\n   * using `console.log` on the assertion object) and `.then` is necessary for promise type-checking.\n   *\n   *     // By default these keys will not throw an error if they do not exist on the assertion object\n   *     chai.config.proxyExcludedKeys = ['then', 'inspect'];\n   *\n   * @param {Array}\n   * @api public\n   */\n\n  proxyExcludedKeys: ['then', 'catch', 'inspect', 'toJSON']\n};\n","/*!\n * chai\n * http://chaijs.com\n * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nmodule.exports = function (chai, _) {\n  var Assertion = chai.Assertion\n    , AssertionError = chai.AssertionError\n    , flag = _.flag;\n\n  /**\n   * ### Language Chains\n   *\n   * The following are provided as chainable getters to improve the readability\n   * of your assertions.\n   *\n   * **Chains**\n   *\n   * - to\n   * - be\n   * - been\n   * - is\n   * - that\n   * - which\n   * - and\n   * - has\n   * - have\n   * - with\n   * - at\n   * - of\n   * - same\n   * - but\n   * - does\n   * - still\n   * - also\n   *\n   * @name language chains\n   * @namespace BDD\n   * @api public\n   */\n\n  [ 'to', 'be', 'been', 'is'\n  , 'and', 'has', 'have', 'with'\n  , 'that', 'which', 'at', 'of'\n  , 'same', 'but', 'does', 'still', \"also\" ].forEach(function (chain) {\n    Assertion.addProperty(chain);\n  });\n\n  /**\n   * ### .not\n   *\n   * Negates all assertions that follow in the chain.\n   *\n   *     expect(function () {}).to.not.throw();\n   *     expect({a: 1}).to.not.have.property('b');\n   *     expect([1, 2]).to.be.an('array').that.does.not.include(3);\n   *\n   * Just because you can negate any assertion with `.not` doesn't mean you\n   * should. With great power comes great responsibility. It's often best to\n   * assert that the one expected output was produced, rather than asserting\n   * that one of countless unexpected outputs wasn't produced. See individual\n   * assertions for specific guidance.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(2).to.not.equal(1); // Not recommended\n   *\n   * @name not\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('not', function () {\n    flag(this, 'negate', true);\n  });\n\n  /**\n   * ### .deep\n   *\n   * Causes all `.equal`, `.include`, `.members`, `.keys`, and `.property`\n   * assertions that follow in the chain to use deep equality instead of strict\n   * (`===`) equality. See the `deep-eql` project page for info on the deep\n   * equality algorithm: https://github.com/chaijs/deep-eql.\n   *\n   *     // Target object deeply (but not strictly) equals `{a: 1}`\n   *     expect({a: 1}).to.deep.equal({a: 1});\n   *     expect({a: 1}).to.not.equal({a: 1});\n   *\n   *     // Target array deeply (but not strictly) includes `{a: 1}`\n   *     expect([{a: 1}]).to.deep.include({a: 1});\n   *     expect([{a: 1}]).to.not.include({a: 1});\n   *\n   *     // Target object deeply (but not strictly) includes `x: {a: 1}`\n   *     expect({x: {a: 1}}).to.deep.include({x: {a: 1}});\n   *     expect({x: {a: 1}}).to.not.include({x: {a: 1}});\n   *\n   *     // Target array deeply (but not strictly) has member `{a: 1}`\n   *     expect([{a: 1}]).to.have.deep.members([{a: 1}]);\n   *     expect([{a: 1}]).to.not.have.members([{a: 1}]);\n   *\n   *     // Target set deeply (but not strictly) has key `{a: 1}`\n   *     expect(new Set([{a: 1}])).to.have.deep.keys([{a: 1}]);\n   *     expect(new Set([{a: 1}])).to.not.have.keys([{a: 1}]);\n   *\n   *     // Target object deeply (but not strictly) has property `x: {a: 1}`\n   *     expect({x: {a: 1}}).to.have.deep.property('x', {a: 1});\n   *     expect({x: {a: 1}}).to.not.have.property('x', {a: 1});\n   *\n   * @name deep\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('deep', function () {\n    flag(this, 'deep', true);\n  });\n\n  /**\n   * ### .nested\n   *\n   * Enables dot- and bracket-notation in all `.property` and `.include`\n   * assertions that follow in the chain.\n   *\n   *     expect({a: {b: ['x', 'y']}}).to.have.nested.property('a.b[1]');\n   *     expect({a: {b: ['x', 'y']}}).to.nested.include({'a.b[1]': 'y'});\n   *\n   * If `.` or `[]` are part of an actual property name, they can be escaped by\n   * adding two backslashes before them.\n   *\n   *     expect({'.a': {'[b]': 'x'}}).to.have.nested.property('\\\\.a.\\\\[b\\\\]');\n   *     expect({'.a': {'[b]': 'x'}}).to.nested.include({'\\\\.a.\\\\[b\\\\]': 'x'});\n   *\n   * `.nested` cannot be combined with `.own`.\n   *\n   * @name nested\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('nested', function () {\n    flag(this, 'nested', true);\n  });\n\n  /**\n   * ### .own\n   *\n   * Causes all `.property` and `.include` assertions that follow in the chain\n   * to ignore inherited properties.\n   *\n   *     Object.prototype.b = 2;\n   *\n   *     expect({a: 1}).to.have.own.property('a');\n   *     expect({a: 1}).to.have.property('b');\n   *     expect({a: 1}).to.not.have.own.property('b');\n   *\n   *     expect({a: 1}).to.own.include({a: 1});\n   *     expect({a: 1}).to.include({b: 2}).but.not.own.include({b: 2});\n   *\n   * `.own` cannot be combined with `.nested`.\n   *\n   * @name own\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('own', function () {\n    flag(this, 'own', true);\n  });\n\n  /**\n   * ### .ordered\n   *\n   * Causes all `.members` assertions that follow in the chain to require that\n   * members be in the same order.\n   *\n   *     expect([1, 2]).to.have.ordered.members([1, 2])\n   *       .but.not.have.ordered.members([2, 1]);\n   *\n   * When `.include` and `.ordered` are combined, the ordering begins at the\n   * start of both arrays.\n   *\n   *     expect([1, 2, 3]).to.include.ordered.members([1, 2])\n   *       .but.not.include.ordered.members([2, 3]);\n   *\n   * @name ordered\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('ordered', function () {\n    flag(this, 'ordered', true);\n  });\n\n  /**\n   * ### .any\n   *\n   * Causes all `.keys` assertions that follow in the chain to only require that\n   * the target have at least one of the given keys. This is the opposite of\n   * `.all`, which requires that the target have all of the given keys.\n   *\n   *     expect({a: 1, b: 2}).to.not.have.any.keys('c', 'd');\n   *\n   * See the `.keys` doc for guidance on when to use `.any` or `.all`.\n   *\n   * @name any\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('any', function () {\n    flag(this, 'any', true);\n    flag(this, 'all', false);\n  });\n\n  /**\n   * ### .all\n   *\n   * Causes all `.keys` assertions that follow in the chain to require that the\n   * target have all of the given keys. This is the opposite of `.any`, which\n   * only requires that the target have at least one of the given keys.\n   *\n   *     expect({a: 1, b: 2}).to.have.all.keys('a', 'b');\n   *\n   * Note that `.all` is used by default when neither `.all` nor `.any` are\n   * added earlier in the chain. However, it's often best to add `.all` anyway\n   * because it improves readability.\n   *\n   * See the `.keys` doc for guidance on when to use `.any` or `.all`.\n   *\n   * @name all\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('all', function () {\n    flag(this, 'all', true);\n    flag(this, 'any', false);\n  });\n\n  /**\n   * ### .a(type[, msg])\n   *\n   * Asserts that the target's type is equal to the given string `type`. Types\n   * are case insensitive. See the `type-detect` project page for info on the\n   * type detection algorithm: https://github.com/chaijs/type-detect.\n   *\n   *     expect('foo').to.be.a('string');\n   *     expect({a: 1}).to.be.an('object');\n   *     expect(null).to.be.a('null');\n   *     expect(undefined).to.be.an('undefined');\n   *     expect(new Error).to.be.an('error');\n   *     expect(Promise.resolve()).to.be.a('promise');\n   *     expect(new Float32Array).to.be.a('float32array');\n   *     expect(Symbol()).to.be.a('symbol');\n   *\n   * `.a` supports objects that have a custom type set via `Symbol.toStringTag`.\n   *\n   *     var myObj = {\n   *       [Symbol.toStringTag]: 'myCustomType'\n   *     };\n   *\n   *     expect(myObj).to.be.a('myCustomType').but.not.an('object');\n   *\n   * It's often best to use `.a` to check a target's type before making more\n   * assertions on the same target. That way, you avoid unexpected behavior from\n   * any assertion that does different things based on the target's type.\n   *\n   *     expect([1, 2, 3]).to.be.an('array').that.includes(2);\n   *     expect([]).to.be.an('array').that.is.empty;\n   *\n   * Add `.not` earlier in the chain to negate `.a`. However, it's often best to\n   * assert that the target is the expected type, rather than asserting that it\n   * isn't one of many unexpected types.\n   *\n   *     expect('foo').to.be.a('string'); // Recommended\n   *     expect('foo').to.not.be.an('array'); // Not recommended\n   *\n   * `.a` accepts an optional `msg` argument which is a custom error message to\n   * show when the assertion fails. The message can also be given as the second\n   * argument to `expect`.\n   *\n   *     expect(1).to.be.a('string', 'nooo why fail??');\n   *     expect(1, 'nooo why fail??').to.be.a('string');\n   *\n   * `.a` can also be used as a language chain to improve the readability of\n   * your assertions.\n   *\n   *     expect({b: 2}).to.have.a.property('b');\n   *\n   * The alias `.an` can be used interchangeably with `.a`.\n   *\n   * @name a\n   * @alias an\n   * @param {String} type\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function an (type, msg) {\n    if (msg) flag(this, 'message', msg);\n    type = type.toLowerCase();\n    var obj = flag(this, 'object')\n      , article = ~[ 'a', 'e', 'i', 'o', 'u' ].indexOf(type.charAt(0)) ? 'an ' : 'a ';\n\n    this.assert(\n        type === _.type(obj).toLowerCase()\n      , 'expected #{this} to be ' + article + type\n      , 'expected #{this} not to be ' + article + type\n    );\n  }\n\n  Assertion.addChainableMethod('an', an);\n  Assertion.addChainableMethod('a', an);\n\n  /**\n   * ### .include(val[, msg])\n   *\n   * When the target is a string, `.include` asserts that the given string `val`\n   * is a substring of the target.\n   *\n   *     expect('foobar').to.include('foo');\n   *\n   * When the target is an array, `.include` asserts that the given `val` is a\n   * member of the target.\n   *\n   *     expect([1, 2, 3]).to.include(2);\n   *\n   * When the target is an object, `.include` asserts that the given object\n   * `val`'s properties are a subset of the target's properties.\n   *\n   *     expect({a: 1, b: 2, c: 3}).to.include({a: 1, b: 2});\n   *\n   * When the target is a Set or WeakSet, `.include` asserts that the given `val` is a\n   * member of the target. SameValueZero equality algorithm is used.\n   *\n   *     expect(new Set([1, 2])).to.include(2);\n   *\n   * When the target is a Map, `.include` asserts that the given `val` is one of\n   * the values of the target. SameValueZero equality algorithm is used.\n   *\n   *     expect(new Map([['a', 1], ['b', 2]])).to.include(2);\n   *\n   * Because `.include` does different things based on the target's type, it's\n   * important to check the target's type before using `.include`. See the `.a`\n   * doc for info on testing a target's type.\n   *\n   *     expect([1, 2, 3]).to.be.an('array').that.includes(2);\n   *\n   * By default, strict (`===`) equality is used to compare array members and\n   * object properties. Add `.deep` earlier in the chain to use deep equality\n   * instead (WeakSet targets are not supported). See the `deep-eql` project\n   * page for info on the deep equality algorithm: https://github.com/chaijs/deep-eql.\n   *\n   *     // Target array deeply (but not strictly) includes `{a: 1}`\n   *     expect([{a: 1}]).to.deep.include({a: 1});\n   *     expect([{a: 1}]).to.not.include({a: 1});\n   *\n   *     // Target object deeply (but not strictly) includes `x: {a: 1}`\n   *     expect({x: {a: 1}}).to.deep.include({x: {a: 1}});\n   *     expect({x: {a: 1}}).to.not.include({x: {a: 1}});\n   *\n   * By default, all of the target's properties are searched when working with\n   * objects. This includes properties that are inherited and/or non-enumerable.\n   * Add `.own` earlier in the chain to exclude the target's inherited\n   * properties from the search.\n   *\n   *     Object.prototype.b = 2;\n   *\n   *     expect({a: 1}).to.own.include({a: 1});\n   *     expect({a: 1}).to.include({b: 2}).but.not.own.include({b: 2});\n   *\n   * Note that a target object is always only searched for `val`'s own\n   * enumerable properties.\n   *\n   * `.deep` and `.own` can be combined.\n   *\n   *     expect({a: {b: 2}}).to.deep.own.include({a: {b: 2}});\n   *\n   * Add `.nested` earlier in the chain to enable dot- and bracket-notation when\n   * referencing nested properties.\n   *\n   *     expect({a: {b: ['x', 'y']}}).to.nested.include({'a.b[1]': 'y'});\n   *\n   * If `.` or `[]` are part of an actual property name, they can be escaped by\n   * adding two backslashes before them.\n   *\n   *     expect({'.a': {'[b]': 2}}).to.nested.include({'\\\\.a.\\\\[b\\\\]': 2});\n   *\n   * `.deep` and `.nested` can be combined.\n   *\n   *     expect({a: {b: [{c: 3}]}}).to.deep.nested.include({'a.b[0]': {c: 3}});\n   *\n   * `.own` and `.nested` cannot be combined.\n   *\n   * Add `.not` earlier in the chain to negate `.include`.\n   *\n   *     expect('foobar').to.not.include('taco');\n   *     expect([1, 2, 3]).to.not.include(4);\n   *\n   * However, it's dangerous to negate `.include` when the target is an object.\n   * The problem is that it creates uncertain expectations by asserting that the\n   * target object doesn't have all of `val`'s key/value pairs but may or may\n   * not have some of them. It's often best to identify the exact output that's\n   * expected, and then write an assertion that only accepts that exact output.\n   *\n   * When the target object isn't even expected to have `val`'s keys, it's\n   * often best to assert exactly that.\n   *\n   *     expect({c: 3}).to.not.have.any.keys('a', 'b'); // Recommended\n   *     expect({c: 3}).to.not.include({a: 1, b: 2}); // Not recommended\n   *\n   * When the target object is expected to have `val`'s keys, it's often best to\n   * assert that each of the properties has its expected value, rather than\n   * asserting that each property doesn't have one of many unexpected values.\n   *\n   *     expect({a: 3, b: 4}).to.include({a: 3, b: 4}); // Recommended\n   *     expect({a: 3, b: 4}).to.not.include({a: 1, b: 2}); // Not recommended\n   *\n   * `.include` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect([1, 2, 3]).to.include(4, 'nooo why fail??');\n   *     expect([1, 2, 3], 'nooo why fail??').to.include(4);\n   *\n   * `.include` can also be used as a language chain, causing all `.members` and\n   * `.keys` assertions that follow in the chain to require the target to be a\n   * superset of the expected set, rather than an identical set. Note that\n   * `.members` ignores duplicates in the subset when `.include` is added.\n   *\n   *     // Target object's keys are a superset of ['a', 'b'] but not identical\n   *     expect({a: 1, b: 2, c: 3}).to.include.all.keys('a', 'b');\n   *     expect({a: 1, b: 2, c: 3}).to.not.have.all.keys('a', 'b');\n   *\n   *     // Target array is a superset of [1, 2] but not identical\n   *     expect([1, 2, 3]).to.include.members([1, 2]);\n   *     expect([1, 2, 3]).to.not.have.members([1, 2]);\n   *\n   *     // Duplicates in the subset are ignored\n   *     expect([1, 2, 3]).to.include.members([1, 2, 2, 2]);\n   *\n   * Note that adding `.any` earlier in the chain causes the `.keys` assertion\n   * to ignore `.include`.\n   *\n   *     // Both assertions are identical\n   *     expect({a: 1}).to.include.any.keys('a', 'b');\n   *     expect({a: 1}).to.have.any.keys('a', 'b');\n   *\n   * The aliases `.includes`, `.contain`, and `.contains` can be used\n   * interchangeably with `.include`.\n   *\n   * @name include\n   * @alias contain\n   * @alias includes\n   * @alias contains\n   * @param {Mixed} val\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function SameValueZero(a, b) {\n    return (_.isNaN(a) && _.isNaN(b)) || a === b;\n  }\n\n  function includeChainingBehavior () {\n    flag(this, 'contains', true);\n  }\n\n  function include (val, msg) {\n    if (msg) flag(this, 'message', msg);\n\n    var obj = flag(this, 'object')\n      , objType = _.type(obj).toLowerCase()\n      , flagMsg = flag(this, 'message')\n      , negate = flag(this, 'negate')\n      , ssfi = flag(this, 'ssfi')\n      , isDeep = flag(this, 'deep')\n      , descriptor = isDeep ? 'deep ' : '';\n\n    flagMsg = flagMsg ? flagMsg + ': ' : '';\n\n    var included = false;\n\n    switch (objType) {\n      case 'string':\n        included = obj.indexOf(val) !== -1;\n        break;\n\n      case 'weakset':\n        if (isDeep) {\n          throw new AssertionError(\n            flagMsg + 'unable to use .deep.include with WeakSet',\n            undefined,\n            ssfi\n          );\n        }\n\n        included = obj.has(val);\n        break;\n\n      case 'map':\n        var isEql = isDeep ? _.eql : SameValueZero;\n        obj.forEach(function (item) {\n          included = included || isEql(item, val);\n        });\n        break;\n\n      case 'set':\n        if (isDeep) {\n          obj.forEach(function (item) {\n            included = included || _.eql(item, val);\n          });\n        } else {\n          included = obj.has(val);\n        }\n        break;\n\n      case 'array':\n        if (isDeep) {\n          included = obj.some(function (item) {\n            return _.eql(item, val);\n          })\n        } else {\n          included = obj.indexOf(val) !== -1;\n        }\n        break;\n\n      default:\n        // This block is for asserting a subset of properties in an object.\n        // `_.expectTypes` isn't used here because `.include` should work with\n        // objects with a custom `@@toStringTag`.\n        if (val !== Object(val)) {\n          throw new AssertionError(\n            flagMsg + 'the given combination of arguments ('\n            + objType + ' and '\n            + _.type(val).toLowerCase() + ')'\n            + ' is invalid for this assertion. '\n            + 'You can use an array, a map, an object, a set, a string, '\n            + 'or a weakset instead of a '\n            + _.type(val).toLowerCase(),\n            undefined,\n            ssfi\n          );\n        }\n\n        var props = Object.keys(val)\n          , firstErr = null\n          , numErrs = 0;\n\n        props.forEach(function (prop) {\n          var propAssertion = new Assertion(obj);\n          _.transferFlags(this, propAssertion, true);\n          flag(propAssertion, 'lockSsfi', true);\n\n          if (!negate || props.length === 1) {\n            propAssertion.property(prop, val[prop]);\n            return;\n          }\n\n          try {\n            propAssertion.property(prop, val[prop]);\n          } catch (err) {\n            if (!_.checkError.compatibleConstructor(err, AssertionError)) {\n              throw err;\n            }\n            if (firstErr === null) firstErr = err;\n            numErrs++;\n          }\n        }, this);\n\n        // When validating .not.include with multiple properties, we only want\n        // to throw an assertion error if all of the properties are included,\n        // in which case we throw the first property assertion error that we\n        // encountered.\n        if (negate && props.length > 1 && numErrs === props.length) {\n          throw firstErr;\n        }\n        return;\n    }\n\n    // Assert inclusion in collection or substring in a string.\n    this.assert(\n      included\n      , 'expected #{this} to ' + descriptor + 'include ' + _.inspect(val)\n      , 'expected #{this} to not ' + descriptor + 'include ' + _.inspect(val));\n  }\n\n  Assertion.addChainableMethod('include', include, includeChainingBehavior);\n  Assertion.addChainableMethod('contain', include, includeChainingBehavior);\n  Assertion.addChainableMethod('contains', include, includeChainingBehavior);\n  Assertion.addChainableMethod('includes', include, includeChainingBehavior);\n\n  /**\n   * ### .ok\n   *\n   * Asserts that the target is a truthy value (considered `true` in boolean context).\n   * However, it's often best to assert that the target is strictly (`===`) or\n   * deeply equal to its expected value.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.be.ok; // Not recommended\n   *\n   *     expect(true).to.be.true; // Recommended\n   *     expect(true).to.be.ok; // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.ok`.\n   *\n   *     expect(0).to.equal(0); // Recommended\n   *     expect(0).to.not.be.ok; // Not recommended\n   *\n   *     expect(false).to.be.false; // Recommended\n   *     expect(false).to.not.be.ok; // Not recommended\n   *\n   *     expect(null).to.be.null; // Recommended\n   *     expect(null).to.not.be.ok; // Not recommended\n   *\n   *     expect(undefined).to.be.undefined; // Recommended\n   *     expect(undefined).to.not.be.ok; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(false, 'nooo why fail??').to.be.ok;\n   *\n   * @name ok\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('ok', function () {\n    this.assert(\n        flag(this, 'object')\n      , 'expected #{this} to be truthy'\n      , 'expected #{this} to be falsy');\n  });\n\n  /**\n   * ### .true\n   *\n   * Asserts that the target is strictly (`===`) equal to `true`.\n   *\n   *     expect(true).to.be.true;\n   *\n   * Add `.not` earlier in the chain to negate `.true`. However, it's often best\n   * to assert that the target is equal to its expected value, rather than not\n   * equal to `true`.\n   *\n   *     expect(false).to.be.false; // Recommended\n   *     expect(false).to.not.be.true; // Not recommended\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.true; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(false, 'nooo why fail??').to.be.true;\n   *\n   * @name true\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('true', function () {\n    this.assert(\n        true === flag(this, 'object')\n      , 'expected #{this} to be true'\n      , 'expected #{this} to be false'\n      , flag(this, 'negate') ? false : true\n    );\n  });\n\n  /**\n   * ### .false\n   *\n   * Asserts that the target is strictly (`===`) equal to `false`.\n   *\n   *     expect(false).to.be.false;\n   *\n   * Add `.not` earlier in the chain to negate `.false`. However, it's often\n   * best to assert that the target is equal to its expected value, rather than\n   * not equal to `false`.\n   *\n   *     expect(true).to.be.true; // Recommended\n   *     expect(true).to.not.be.false; // Not recommended\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.false; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(true, 'nooo why fail??').to.be.false;\n   *\n   * @name false\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('false', function () {\n    this.assert(\n        false === flag(this, 'object')\n      , 'expected #{this} to be false'\n      , 'expected #{this} to be true'\n      , flag(this, 'negate') ? true : false\n    );\n  });\n\n  /**\n   * ### .null\n   *\n   * Asserts that the target is strictly (`===`) equal to `null`.\n   *\n   *     expect(null).to.be.null;\n   *\n   * Add `.not` earlier in the chain to negate `.null`. However, it's often best\n   * to assert that the target is equal to its expected value, rather than not\n   * equal to `null`.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.null; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(42, 'nooo why fail??').to.be.null;\n   *\n   * @name null\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('null', function () {\n    this.assert(\n        null === flag(this, 'object')\n      , 'expected #{this} to be null'\n      , 'expected #{this} not to be null'\n    );\n  });\n\n  /**\n   * ### .undefined\n   *\n   * Asserts that the target is strictly (`===`) equal to `undefined`.\n   *\n   *     expect(undefined).to.be.undefined;\n   *\n   * Add `.not` earlier in the chain to negate `.undefined`. However, it's often\n   * best to assert that the target is equal to its expected value, rather than\n   * not equal to `undefined`.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.undefined; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(42, 'nooo why fail??').to.be.undefined;\n   *\n   * @name undefined\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('undefined', function () {\n    this.assert(\n        undefined === flag(this, 'object')\n      , 'expected #{this} to be undefined'\n      , 'expected #{this} not to be undefined'\n    );\n  });\n\n  /**\n   * ### .NaN\n   *\n   * Asserts that the target is exactly `NaN`.\n   *\n   *     expect(NaN).to.be.NaN;\n   *\n   * Add `.not` earlier in the chain to negate `.NaN`. However, it's often best\n   * to assert that the target is equal to its expected value, rather than not\n   * equal to `NaN`.\n   *\n   *     expect('foo').to.equal('foo'); // Recommended\n   *     expect('foo').to.not.be.NaN; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(42, 'nooo why fail??').to.be.NaN;\n   *\n   * @name NaN\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('NaN', function () {\n    this.assert(\n        _.isNaN(flag(this, 'object'))\n        , 'expected #{this} to be NaN'\n        , 'expected #{this} not to be NaN'\n    );\n  });\n\n  /**\n   * ### .exist\n   *\n   * Asserts that the target is not strictly (`===`) equal to either `null` or\n   * `undefined`. However, it's often best to assert that the target is equal to\n   * its expected value.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.exist; // Not recommended\n   *\n   *     expect(0).to.equal(0); // Recommended\n   *     expect(0).to.exist; // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.exist`.\n   *\n   *     expect(null).to.be.null; // Recommended\n   *     expect(null).to.not.exist; // Not recommended\n   *\n   *     expect(undefined).to.be.undefined; // Recommended\n   *     expect(undefined).to.not.exist; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(null, 'nooo why fail??').to.exist;\n   *\n   * The alias `.exists` can be used interchangeably with `.exist`.\n   *\n   * @name exist\n   * @alias exists\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertExist () {\n    var val = flag(this, 'object');\n    this.assert(\n        val !== null && val !== undefined\n      , 'expected #{this} to exist'\n      , 'expected #{this} to not exist'\n    );\n  }\n\n  Assertion.addProperty('exist', assertExist);\n  Assertion.addProperty('exists', assertExist);\n\n  /**\n   * ### .empty\n   *\n   * When the target is a string or array, `.empty` asserts that the target's\n   * `length` property is strictly (`===`) equal to `0`.\n   *\n   *     expect([]).to.be.empty;\n   *     expect('').to.be.empty;\n   *\n   * When the target is a map or set, `.empty` asserts that the target's `size`\n   * property is strictly equal to `0`.\n   *\n   *     expect(new Set()).to.be.empty;\n   *     expect(new Map()).to.be.empty;\n   *\n   * When the target is a non-function object, `.empty` asserts that the target\n   * doesn't have any own enumerable properties. Properties with Symbol-based\n   * keys are excluded from the count.\n   *\n   *     expect({}).to.be.empty;\n   *\n   * Because `.empty` does different things based on the target's type, it's\n   * important to check the target's type before using `.empty`. See the `.a`\n   * doc for info on testing a target's type.\n   *\n   *     expect([]).to.be.an('array').that.is.empty;\n   *\n   * Add `.not` earlier in the chain to negate `.empty`. However, it's often\n   * best to assert that the target contains its expected number of values,\n   * rather than asserting that it's not empty.\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(3); // Recommended\n   *     expect([1, 2, 3]).to.not.be.empty; // Not recommended\n   *\n   *     expect(new Set([1, 2, 3])).to.have.property('size', 3); // Recommended\n   *     expect(new Set([1, 2, 3])).to.not.be.empty; // Not recommended\n   *\n   *     expect(Object.keys({a: 1})).to.have.lengthOf(1); // Recommended\n   *     expect({a: 1}).to.not.be.empty; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect([1, 2, 3], 'nooo why fail??').to.be.empty;\n   *\n   * @name empty\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('empty', function () {\n    var val = flag(this, 'object')\n      , ssfi = flag(this, 'ssfi')\n      , flagMsg = flag(this, 'message')\n      , itemsCount;\n\n    flagMsg = flagMsg ? flagMsg + ': ' : '';\n\n    switch (_.type(val).toLowerCase()) {\n      case 'array':\n      case 'string':\n        itemsCount = val.length;\n        break;\n      case 'map':\n      case 'set':\n        itemsCount = val.size;\n        break;\n      case 'weakmap':\n      case 'weakset':\n        throw new AssertionError(\n          flagMsg + '.empty was passed a weak collection',\n          undefined,\n          ssfi\n        );\n      case 'function':\n        var msg = flagMsg + '.empty was passed a function ' + _.getName(val);\n        throw new AssertionError(msg.trim(), undefined, ssfi);\n      default:\n        if (val !== Object(val)) {\n          throw new AssertionError(\n            flagMsg + '.empty was passed non-string primitive ' + _.inspect(val),\n            undefined,\n            ssfi\n          );\n        }\n        itemsCount = Object.keys(val).length;\n    }\n\n    this.assert(\n        0 === itemsCount\n      , 'expected #{this} to be empty'\n      , 'expected #{this} not to be empty'\n    );\n  });\n\n  /**\n   * ### .arguments\n   *\n   * Asserts that the target is an `arguments` object.\n   *\n   *     function test () {\n   *       expect(arguments).to.be.arguments;\n   *     }\n   *\n   *     test();\n   *\n   * Add `.not` earlier in the chain to negate `.arguments`. However, it's often\n   * best to assert which type the target is expected to be, rather than\n   * asserting that its not an `arguments` object.\n   *\n   *     expect('foo').to.be.a('string'); // Recommended\n   *     expect('foo').to.not.be.arguments; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect({}, 'nooo why fail??').to.be.arguments;\n   *\n   * The alias `.Arguments` can be used interchangeably with `.arguments`.\n   *\n   * @name arguments\n   * @alias Arguments\n   * @namespace BDD\n   * @api public\n   */\n\n  function checkArguments () {\n    var obj = flag(this, 'object')\n      , type = _.type(obj);\n    this.assert(\n        'Arguments' === type\n      , 'expected #{this} to be arguments but got ' + type\n      , 'expected #{this} to not be arguments'\n    );\n  }\n\n  Assertion.addProperty('arguments', checkArguments);\n  Assertion.addProperty('Arguments', checkArguments);\n\n  /**\n   * ### .equal(val[, msg])\n   *\n   * Asserts that the target is strictly (`===`) equal to the given `val`.\n   *\n   *     expect(1).to.equal(1);\n   *     expect('foo').to.equal('foo');\n   *\n   * Add `.deep` earlier in the chain to use deep equality instead. See the\n   * `deep-eql` project page for info on the deep equality algorithm:\n   * https://github.com/chaijs/deep-eql.\n   *\n   *     // Target object deeply (but not strictly) equals `{a: 1}`\n   *     expect({a: 1}).to.deep.equal({a: 1});\n   *     expect({a: 1}).to.not.equal({a: 1});\n   *\n   *     // Target array deeply (but not strictly) equals `[1, 2]`\n   *     expect([1, 2]).to.deep.equal([1, 2]);\n   *     expect([1, 2]).to.not.equal([1, 2]);\n   *\n   * Add `.not` earlier in the chain to negate `.equal`. However, it's often\n   * best to assert that the target is equal to its expected value, rather than\n   * not equal to one of countless unexpected values.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.equal(2); // Not recommended\n   *\n   * `.equal` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect(1).to.equal(2, 'nooo why fail??');\n   *     expect(1, 'nooo why fail??').to.equal(2);\n   *\n   * The aliases `.equals` and `eq` can be used interchangeably with `.equal`.\n   *\n   * @name equal\n   * @alias equals\n   * @alias eq\n   * @param {Mixed} val\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertEqual (val, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object');\n    if (flag(this, 'deep')) {\n      var prevLockSsfi = flag(this, 'lockSsfi');\n      flag(this, 'lockSsfi', true);\n      this.eql(val);\n      flag(this, 'lockSsfi', prevLockSsfi);\n    } else {\n      this.assert(\n          val === obj\n        , 'expected #{this} to equal #{exp}'\n        , 'expected #{this} to not equal #{exp}'\n        , val\n        , this._obj\n        , true\n      );\n    }\n  }\n\n  Assertion.addMethod('equal', assertEqual);\n  Assertion.addMethod('equals', assertEqual);\n  Assertion.addMethod('eq', assertEqual);\n\n  /**\n   * ### .eql(obj[, msg])\n   *\n   * Asserts that the target is deeply equal to the given `obj`. See the\n   * `deep-eql` project page for info on the deep equality algorithm:\n   * https://github.com/chaijs/deep-eql.\n   *\n   *     // Target object is deeply (but not strictly) equal to {a: 1}\n   *     expect({a: 1}).to.eql({a: 1}).but.not.equal({a: 1});\n   *\n   *     // Target array is deeply (but not strictly) equal to [1, 2]\n   *     expect([1, 2]).to.eql([1, 2]).but.not.equal([1, 2]);\n   *\n   * Add `.not` earlier in the chain to negate `.eql`. However, it's often best\n   * to assert that the target is deeply equal to its expected value, rather\n   * than not deeply equal to one of countless unexpected values.\n   *\n   *     expect({a: 1}).to.eql({a: 1}); // Recommended\n   *     expect({a: 1}).to.not.eql({b: 2}); // Not recommended\n   *\n   * `.eql` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect({a: 1}).to.eql({b: 2}, 'nooo why fail??');\n   *     expect({a: 1}, 'nooo why fail??').to.eql({b: 2});\n   *\n   * The alias `.eqls` can be used interchangeably with `.eql`.\n   *\n   * The `.deep.equal` assertion is almost identical to `.eql` but with one\n   * difference: `.deep.equal` causes deep equality comparisons to also be used\n   * for any other assertions that follow in the chain.\n   *\n   * @name eql\n   * @alias eqls\n   * @param {Mixed} obj\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertEql(obj, msg) {\n    if (msg) flag(this, 'message', msg);\n    this.assert(\n        _.eql(obj, flag(this, 'object'))\n      , 'expected #{this} to deeply equal #{exp}'\n      , 'expected #{this} to not deeply equal #{exp}'\n      , obj\n      , this._obj\n      , true\n    );\n  }\n\n  Assertion.addMethod('eql', assertEql);\n  Assertion.addMethod('eqls', assertEql);\n\n  /**\n   * ### .above(n[, msg])\n   *\n   * Asserts that the target is a number or a date greater than the given number or date `n` respectively.\n   * However, it's often best to assert that the target is equal to its expected\n   * value.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(2).to.be.above(1); // Not recommended\n   *\n   * Add `.lengthOf` earlier in the chain to assert that the target's `length`\n   * or `size` is greater than the given number `n`.\n   *\n   *     expect('foo').to.have.lengthOf(3); // Recommended\n   *     expect('foo').to.have.lengthOf.above(2); // Not recommended\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(3); // Recommended\n   *     expect([1, 2, 3]).to.have.lengthOf.above(2); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.above`.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(1).to.not.be.above(2); // Not recommended\n   *\n   * `.above` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect(1).to.be.above(2, 'nooo why fail??');\n   *     expect(1, 'nooo why fail??').to.be.above(2);\n   *\n   * The aliases `.gt` and `.greaterThan` can be used interchangeably with\n   * `.above`.\n   *\n   * @name above\n   * @alias gt\n   * @alias greaterThan\n   * @param {Number} n\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertAbove (n, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , doLength = flag(this, 'doLength')\n      , flagMsg = flag(this, 'message')\n      , msgPrefix = ((flagMsg) ? flagMsg + ': ' : '')\n      , ssfi = flag(this, 'ssfi')\n      , objType = _.type(obj).toLowerCase()\n      , nType = _.type(n).toLowerCase()\n      , errorMessage\n      , shouldThrow = true;\n\n    if (doLength && objType !== 'map' && objType !== 'set') {\n      new Assertion(obj, flagMsg, ssfi, true).to.have.property('length');\n    }\n\n    if (!doLength && (objType === 'date' && nType !== 'date')) {\n      errorMessage = msgPrefix + 'the argument to above must be a date';\n    } else if (nType !== 'number' && (doLength || objType === 'number')) {\n      errorMessage = msgPrefix + 'the argument to above must be a number';\n    } else if (!doLength && (objType !== 'date' && objType !== 'number')) {\n      var printObj = (objType === 'string') ? \"'\" + obj + \"'\" : obj;\n      errorMessage = msgPrefix + 'expected ' + printObj + ' to be a number or a date';\n    } else {\n      shouldThrow = false;\n    }\n\n    if (shouldThrow) {\n      throw new AssertionError(errorMessage, undefined, ssfi);\n    }\n\n    if (doLength) {\n      var descriptor = 'length'\n        , itemsCount;\n      if (objType === 'map' || objType === 'set') {\n        descriptor = 'size';\n        itemsCount = obj.size;\n      } else {\n        itemsCount = obj.length;\n      }\n      this.assert(\n          itemsCount > n\n        , 'expected #{this} to have a ' + descriptor + ' above #{exp} but got #{act}'\n        , 'expected #{this} to not have a ' + descriptor + ' above #{exp}'\n        , n\n        , itemsCount\n      );\n    } else {\n      this.assert(\n          obj > n\n        , 'expected #{this} to be above #{exp}'\n        , 'expected #{this} to be at most #{exp}'\n        , n\n      );\n    }\n  }\n\n  Assertion.addMethod('above', assertAbove);\n  Assertion.addMethod('gt', assertAbove);\n  Assertion.addMethod('greaterThan', assertAbove);\n\n  /**\n   * ### .least(n[, msg])\n   *\n   * Asserts that the target is a number or a date greater than or equal to the given\n   * number or date `n` respectively. However, it's often best to assert that the target is equal to\n   * its expected value.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(2).to.be.at.least(1); // Not recommended\n   *     expect(2).to.be.at.least(2); // Not recommended\n   *\n   * Add `.lengthOf` earlier in the chain to assert that the target's `length`\n   * or `size` is greater than or equal to the given number `n`.\n   *\n   *     expect('foo').to.have.lengthOf(3); // Recommended\n   *     expect('foo').to.have.lengthOf.at.least(2); // Not recommended\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(3); // Recommended\n   *     expect([1, 2, 3]).to.have.lengthOf.at.least(2); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.least`.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.at.least(2); // Not recommended\n   *\n   * `.least` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect(1).to.be.at.least(2, 'nooo why fail??');\n   *     expect(1, 'nooo why fail??').to.be.at.least(2);\n   *\n   * The aliases `.gte` and `.greaterThanOrEqual` can be used interchangeably with\n   * `.least`.\n   *\n   * @name least\n   * @alias gte\n   * @alias greaterThanOrEqual\n   * @param {Number} n\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertLeast (n, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , doLength = flag(this, 'doLength')\n      , flagMsg = flag(this, 'message')\n      , msgPrefix = ((flagMsg) ? flagMsg + ': ' : '')\n      , ssfi = flag(this, 'ssfi')\n      , objType = _.type(obj).toLowerCase()\n      , nType = _.type(n).toLowerCase()\n      , errorMessage\n      , shouldThrow = true;\n\n    if (doLength && objType !== 'map' && objType !== 'set') {\n      new Assertion(obj, flagMsg, ssfi, true).to.have.property('length');\n    }\n\n    if (!doLength && (objType === 'date' && nType !== 'date')) {\n      errorMessage = msgPrefix + 'the argument to least must be a date';\n    } else if (nType !== 'number' && (doLength || objType === 'number')) {\n      errorMessage = msgPrefix + 'the argument to least must be a number';\n    } else if (!doLength && (objType !== 'date' && objType !== 'number')) {\n      var printObj = (objType === 'string') ? \"'\" + obj + \"'\" : obj;\n      errorMessage = msgPrefix + 'expected ' + printObj + ' to be a number or a date';\n    } else {\n      shouldThrow = false;\n    }\n\n    if (shouldThrow) {\n      throw new AssertionError(errorMessage, undefined, ssfi);\n    }\n\n    if (doLength) {\n      var descriptor = 'length'\n        , itemsCount;\n      if (objType === 'map' || objType === 'set') {\n        descriptor = 'size';\n        itemsCount = obj.size;\n      } else {\n        itemsCount = obj.length;\n      }\n      this.assert(\n          itemsCount >= n\n        , 'expected #{this} to have a ' + descriptor + ' at least #{exp} but got #{act}'\n        , 'expected #{this} to have a ' + descriptor + ' below #{exp}'\n        , n\n        , itemsCount\n      );\n    } else {\n      this.assert(\n          obj >= n\n        , 'expected #{this} to be at least #{exp}'\n        , 'expected #{this} to be below #{exp}'\n        , n\n      );\n    }\n  }\n\n  Assertion.addMethod('least', assertLeast);\n  Assertion.addMethod('gte', assertLeast);\n  Assertion.addMethod('greaterThanOrEqual', assertLeast);\n\n  /**\n   * ### .below(n[, msg])\n   *\n   * Asserts that the target is a number or a date less than the given number or date `n` respectively.\n   * However, it's often best to assert that the target is equal to its expected\n   * value.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.be.below(2); // Not recommended\n   *\n   * Add `.lengthOf` earlier in the chain to assert that the target's `length`\n   * or `size` is less than the given number `n`.\n   *\n   *     expect('foo').to.have.lengthOf(3); // Recommended\n   *     expect('foo').to.have.lengthOf.below(4); // Not recommended\n   *\n   *     expect([1, 2, 3]).to.have.length(3); // Recommended\n   *     expect([1, 2, 3]).to.have.lengthOf.below(4); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.below`.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(2).to.not.be.below(1); // Not recommended\n   *\n   * `.below` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect(2).to.be.below(1, 'nooo why fail??');\n   *     expect(2, 'nooo why fail??').to.be.below(1);\n   *\n   * The aliases `.lt` and `.lessThan` can be used interchangeably with\n   * `.below`.\n   *\n   * @name below\n   * @alias lt\n   * @alias lessThan\n   * @param {Number} n\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertBelow (n, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , doLength = flag(this, 'doLength')\n      , flagMsg = flag(this, 'message')\n      , msgPrefix = ((flagMsg) ? flagMsg + ': ' : '')\n      , ssfi = flag(this, 'ssfi')\n      , objType = _.type(obj).toLowerCase()\n      , nType = _.type(n).toLowerCase()\n      , errorMessage\n      , shouldThrow = true;\n\n    if (doLength && objType !== 'map' && objType !== 'set') {\n      new Assertion(obj, flagMsg, ssfi, true).to.have.property('length');\n    }\n\n    if (!doLength && (objType === 'date' && nType !== 'date')) {\n      errorMessage = msgPrefix + 'the argument to below must be a date';\n    } else if (nType !== 'number' && (doLength || objType === 'number')) {\n      errorMessage = msgPrefix + 'the argument to below must be a number';\n    } else if (!doLength && (objType !== 'date' && objType !== 'number')) {\n      var printObj = (objType === 'string') ? \"'\" + obj + \"'\" : obj;\n      errorMessage = msgPrefix + 'expected ' + printObj + ' to be a number or a date';\n    } else {\n      shouldThrow = false;\n    }\n\n    if (shouldThrow) {\n      throw new AssertionError(errorMessage, undefined, ssfi);\n    }\n\n    if (doLength) {\n      var descriptor = 'length'\n        , itemsCount;\n      if (objType === 'map' || objType === 'set') {\n        descriptor = 'size';\n        itemsCount = obj.size;\n      } else {\n        itemsCount = obj.length;\n      }\n      this.assert(\n          itemsCount < n\n        , 'expected #{this} to have a ' + descriptor + ' below #{exp} but got #{act}'\n        , 'expected #{this} to not have a ' + descriptor + ' below #{exp}'\n        , n\n        , itemsCount\n      );\n    } else {\n      this.assert(\n          obj < n\n        , 'expected #{this} to be below #{exp}'\n        , 'expected #{this} to be at least #{exp}'\n        , n\n      );\n    }\n  }\n\n  Assertion.addMethod('below', assertBelow);\n  Assertion.addMethod('lt', assertBelow);\n  Assertion.addMethod('lessThan', assertBelow);\n\n  /**\n   * ### .most(n[, msg])\n   *\n   * Asserts that the target is a number or a date less than or equal to the given number\n   * or date `n` respectively. However, it's often best to assert that the target is equal to its\n   * expected value.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.be.at.most(2); // Not recommended\n   *     expect(1).to.be.at.most(1); // Not recommended\n   *\n   * Add `.lengthOf` earlier in the chain to assert that the target's `length`\n   * or `size` is less than or equal to the given number `n`.\n   *\n   *     expect('foo').to.have.lengthOf(3); // Recommended\n   *     expect('foo').to.have.lengthOf.at.most(4); // Not recommended\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(3); // Recommended\n   *     expect([1, 2, 3]).to.have.lengthOf.at.most(4); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.most`.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(2).to.not.be.at.most(1); // Not recommended\n   *\n   * `.most` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect(2).to.be.at.most(1, 'nooo why fail??');\n   *     expect(2, 'nooo why fail??').to.be.at.most(1);\n   *\n   * The aliases `.lte` and `.lessThanOrEqual` can be used interchangeably with\n   * `.most`.\n   *\n   * @name most\n   * @alias lte\n   * @alias lessThanOrEqual\n   * @param {Number} n\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertMost (n, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , doLength = flag(this, 'doLength')\n      , flagMsg = flag(this, 'message')\n      , msgPrefix = ((flagMsg) ? flagMsg + ': ' : '')\n      , ssfi = flag(this, 'ssfi')\n      , objType = _.type(obj).toLowerCase()\n      , nType = _.type(n).toLowerCase()\n      , errorMessage\n      , shouldThrow = true;\n\n    if (doLength && objType !== 'map' && objType !== 'set') {\n      new Assertion(obj, flagMsg, ssfi, true).to.have.property('length');\n    }\n\n    if (!doLength && (objType === 'date' && nType !== 'date')) {\n      errorMessage = msgPrefix + 'the argument to most must be a date';\n    } else if (nType !== 'number' && (doLength || objType === 'number')) {\n      errorMessage = msgPrefix + 'the argument to most must be a number';\n    } else if (!doLength && (objType !== 'date' && objType !== 'number')) {\n      var printObj = (objType === 'string') ? \"'\" + obj + \"'\" : obj;\n      errorMessage = msgPrefix + 'expected ' + printObj + ' to be a number or a date';\n    } else {\n      shouldThrow = false;\n    }\n\n    if (shouldThrow) {\n      throw new AssertionError(errorMessage, undefined, ssfi);\n    }\n\n    if (doLength) {\n      var descriptor = 'length'\n        , itemsCount;\n      if (objType === 'map' || objType === 'set') {\n        descriptor = 'size';\n        itemsCount = obj.size;\n      } else {\n        itemsCount = obj.length;\n      }\n      this.assert(\n          itemsCount <= n\n        , 'expected #{this} to have a ' + descriptor + ' at most #{exp} but got #{act}'\n        , 'expected #{this} to have a ' + descriptor + ' above #{exp}'\n        , n\n        , itemsCount\n      );\n    } else {\n      this.assert(\n          obj <= n\n        , 'expected #{this} to be at most #{exp}'\n        , 'expected #{this} to be above #{exp}'\n        , n\n      );\n    }\n  }\n\n  Assertion.addMethod('most', assertMost);\n  Assertion.addMethod('lte', assertMost);\n  Assertion.addMethod('lessThanOrEqual', assertMost);\n\n  /**\n   * ### .within(start, finish[, msg])\n   *\n   * Asserts that the target is a number or a date greater than or equal to the given\n   * number or date `start`, and less than or equal to the given number or date `finish` respectively.\n   * However, it's often best to assert that the target is equal to its expected\n   * value.\n   *\n   *     expect(2).to.equal(2); // Recommended\n   *     expect(2).to.be.within(1, 3); // Not recommended\n   *     expect(2).to.be.within(2, 3); // Not recommended\n   *     expect(2).to.be.within(1, 2); // Not recommended\n   *\n   * Add `.lengthOf` earlier in the chain to assert that the target's `length`\n   * or `size` is greater than or equal to the given number `start`, and less\n   * than or equal to the given number `finish`.\n   *\n   *     expect('foo').to.have.lengthOf(3); // Recommended\n   *     expect('foo').to.have.lengthOf.within(2, 4); // Not recommended\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(3); // Recommended\n   *     expect([1, 2, 3]).to.have.lengthOf.within(2, 4); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.within`.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.within(2, 4); // Not recommended\n   *\n   * `.within` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect(4).to.be.within(1, 3, 'nooo why fail??');\n   *     expect(4, 'nooo why fail??').to.be.within(1, 3);\n   *\n   * @name within\n   * @param {Number} start lower bound inclusive\n   * @param {Number} finish upper bound inclusive\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addMethod('within', function (start, finish, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , doLength = flag(this, 'doLength')\n      , flagMsg = flag(this, 'message')\n      , msgPrefix = ((flagMsg) ? flagMsg + ': ' : '')\n      , ssfi = flag(this, 'ssfi')\n      , objType = _.type(obj).toLowerCase()\n      , startType = _.type(start).toLowerCase()\n      , finishType = _.type(finish).toLowerCase()\n      , errorMessage\n      , shouldThrow = true\n      , range = (startType === 'date' && finishType === 'date')\n          ? start.toISOString() + '..' + finish.toISOString()\n          : start + '..' + finish;\n\n    if (doLength && objType !== 'map' && objType !== 'set') {\n      new Assertion(obj, flagMsg, ssfi, true).to.have.property('length');\n    }\n\n    if (!doLength && (objType === 'date' && (startType !== 'date' || finishType !== 'date'))) {\n      errorMessage = msgPrefix + 'the arguments to within must be dates';\n    } else if ((startType !== 'number' || finishType !== 'number') && (doLength || objType === 'number')) {\n      errorMessage = msgPrefix + 'the arguments to within must be numbers';\n    } else if (!doLength && (objType !== 'date' && objType !== 'number')) {\n      var printObj = (objType === 'string') ? \"'\" + obj + \"'\" : obj;\n      errorMessage = msgPrefix + 'expected ' + printObj + ' to be a number or a date';\n    } else {\n      shouldThrow = false;\n    }\n\n    if (shouldThrow) {\n      throw new AssertionError(errorMessage, undefined, ssfi);\n    }\n\n    if (doLength) {\n      var descriptor = 'length'\n        , itemsCount;\n      if (objType === 'map' || objType === 'set') {\n        descriptor = 'size';\n        itemsCount = obj.size;\n      } else {\n        itemsCount = obj.length;\n      }\n      this.assert(\n          itemsCount >= start && itemsCount <= finish\n        , 'expected #{this} to have a ' + descriptor + ' within ' + range\n        , 'expected #{this} to not have a ' + descriptor + ' within ' + range\n      );\n    } else {\n      this.assert(\n          obj >= start && obj <= finish\n        , 'expected #{this} to be within ' + range\n        , 'expected #{this} to not be within ' + range\n      );\n    }\n  });\n\n  /**\n   * ### .instanceof(constructor[, msg])\n   *\n   * Asserts that the target is an instance of the given `constructor`.\n   *\n   *     function Cat () { }\n   *\n   *     expect(new Cat()).to.be.an.instanceof(Cat);\n   *     expect([1, 2]).to.be.an.instanceof(Array);\n   *\n   * Add `.not` earlier in the chain to negate `.instanceof`.\n   *\n   *     expect({a: 1}).to.not.be.an.instanceof(Array);\n   *\n   * `.instanceof` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect(1).to.be.an.instanceof(Array, 'nooo why fail??');\n   *     expect(1, 'nooo why fail??').to.be.an.instanceof(Array);\n   *\n   * Due to limitations in ES5, `.instanceof` may not always work as expected\n   * when using a transpiler such as Babel or TypeScript. In particular, it may\n   * produce unexpected results when subclassing built-in object such as\n   * `Array`, `Error`, and `Map`. See your transpiler's docs for details:\n   *\n   * - ([Babel](https://babeljs.io/docs/usage/caveats/#classes))\n   * - ([TypeScript](https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work))\n   *\n   * The alias `.instanceOf` can be used interchangeably with `.instanceof`.\n   *\n   * @name instanceof\n   * @param {Constructor} constructor\n   * @param {String} msg _optional_\n   * @alias instanceOf\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertInstanceOf (constructor, msg) {\n    if (msg) flag(this, 'message', msg);\n\n    var target = flag(this, 'object')\n    var ssfi = flag(this, 'ssfi');\n    var flagMsg = flag(this, 'message');\n\n    try {\n      var isInstanceOf = target instanceof constructor;\n    } catch (err) {\n      if (err instanceof TypeError) {\n        flagMsg = flagMsg ? flagMsg + ': ' : '';\n        throw new AssertionError(\n          flagMsg + 'The instanceof assertion needs a constructor but '\n            + _.type(constructor) + ' was given.',\n          undefined,\n          ssfi\n        );\n      }\n      throw err;\n    }\n\n    var name = _.getName(constructor);\n    if (name === null) {\n      name = 'an unnamed constructor';\n    }\n\n    this.assert(\n        isInstanceOf\n      , 'expected #{this} to be an instance of ' + name\n      , 'expected #{this} to not be an instance of ' + name\n    );\n  };\n\n  Assertion.addMethod('instanceof', assertInstanceOf);\n  Assertion.addMethod('instanceOf', assertInstanceOf);\n\n  /**\n   * ### .property(name[, val[, msg]])\n   *\n   * Asserts that the target has a property with the given key `name`.\n   *\n   *     expect({a: 1}).to.have.property('a');\n   *\n   * When `val` is provided, `.property` also asserts that the property's value\n   * is equal to the given `val`.\n   *\n   *     expect({a: 1}).to.have.property('a', 1);\n   *\n   * By default, strict (`===`) equality is used. Add `.deep` earlier in the\n   * chain to use deep equality instead. See the `deep-eql` project page for\n   * info on the deep equality algorithm: https://github.com/chaijs/deep-eql.\n   *\n   *     // Target object deeply (but not strictly) has property `x: {a: 1}`\n   *     expect({x: {a: 1}}).to.have.deep.property('x', {a: 1});\n   *     expect({x: {a: 1}}).to.not.have.property('x', {a: 1});\n   *\n   * The target's enumerable and non-enumerable properties are always included\n   * in the search. By default, both own and inherited properties are included.\n   * Add `.own` earlier in the chain to exclude inherited properties from the\n   * search.\n   *\n   *     Object.prototype.b = 2;\n   *\n   *     expect({a: 1}).to.have.own.property('a');\n   *     expect({a: 1}).to.have.own.property('a', 1);\n   *     expect({a: 1}).to.have.property('b');\n   *     expect({a: 1}).to.not.have.own.property('b');\n   *\n   * `.deep` and `.own` can be combined.\n   *\n   *     expect({x: {a: 1}}).to.have.deep.own.property('x', {a: 1});\n   *\n   * Add `.nested` earlier in the chain to enable dot- and bracket-notation when\n   * referencing nested properties.\n   *\n   *     expect({a: {b: ['x', 'y']}}).to.have.nested.property('a.b[1]');\n   *     expect({a: {b: ['x', 'y']}}).to.have.nested.property('a.b[1]', 'y');\n   *\n   * If `.` or `[]` are part of an actual property name, they can be escaped by\n   * adding two backslashes before them.\n   *\n   *     expect({'.a': {'[b]': 'x'}}).to.have.nested.property('\\\\.a.\\\\[b\\\\]');\n   *\n   * `.deep` and `.nested` can be combined.\n   *\n   *     expect({a: {b: [{c: 3}]}})\n   *       .to.have.deep.nested.property('a.b[0]', {c: 3});\n   *\n   * `.own` and `.nested` cannot be combined.\n   *\n   * Add `.not` earlier in the chain to negate `.property`.\n   *\n   *     expect({a: 1}).to.not.have.property('b');\n   *\n   * However, it's dangerous to negate `.property` when providing `val`. The\n   * problem is that it creates uncertain expectations by asserting that the\n   * target either doesn't have a property with the given key `name`, or that it\n   * does have a property with the given key `name` but its value isn't equal to\n   * the given `val`. It's often best to identify the exact output that's\n   * expected, and then write an assertion that only accepts that exact output.\n   *\n   * When the target isn't expected to have a property with the given key\n   * `name`, it's often best to assert exactly that.\n   *\n   *     expect({b: 2}).to.not.have.property('a'); // Recommended\n   *     expect({b: 2}).to.not.have.property('a', 1); // Not recommended\n   *\n   * When the target is expected to have a property with the given key `name`,\n   * it's often best to assert that the property has its expected value, rather\n   * than asserting that it doesn't have one of many unexpected values.\n   *\n   *     expect({a: 3}).to.have.property('a', 3); // Recommended\n   *     expect({a: 3}).to.not.have.property('a', 1); // Not recommended\n   *\n   * `.property` changes the target of any assertions that follow in the chain\n   * to be the value of the property from the original target object.\n   *\n   *     expect({a: 1}).to.have.property('a').that.is.a('number');\n   *\n   * `.property` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`. When not providing `val`, only use the\n   * second form.\n   *\n   *     // Recommended\n   *     expect({a: 1}).to.have.property('a', 2, 'nooo why fail??');\n   *     expect({a: 1}, 'nooo why fail??').to.have.property('a', 2);\n   *     expect({a: 1}, 'nooo why fail??').to.have.property('b');\n   *\n   *     // Not recommended\n   *     expect({a: 1}).to.have.property('b', undefined, 'nooo why fail??');\n   *\n   * The above assertion isn't the same thing as not providing `val`. Instead,\n   * it's asserting that the target object has a `b` property that's equal to\n   * `undefined`.\n   *\n   * The assertions `.ownProperty` and `.haveOwnProperty` can be used\n   * interchangeably with `.own.property`.\n   *\n   * @name property\n   * @param {String} name\n   * @param {Mixed} val (optional)\n   * @param {String} msg _optional_\n   * @returns value of property for chaining\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertProperty (name, val, msg) {\n    if (msg) flag(this, 'message', msg);\n\n    var isNested = flag(this, 'nested')\n      , isOwn = flag(this, 'own')\n      , flagMsg = flag(this, 'message')\n      , obj = flag(this, 'object')\n      , ssfi = flag(this, 'ssfi')\n      , nameType = typeof name;\n\n    flagMsg = flagMsg ? flagMsg + ': ' : '';\n\n    if (isNested) {\n      if (nameType !== 'string') {\n        throw new AssertionError(\n          flagMsg + 'the argument to property must be a string when using nested syntax',\n          undefined,\n          ssfi\n        );\n      }\n    } else {\n      if (nameType !== 'string' && nameType !== 'number' && nameType !== 'symbol') {\n        throw new AssertionError(\n          flagMsg + 'the argument to property must be a string, number, or symbol',\n          undefined,\n          ssfi\n        );\n      }\n    }\n\n    if (isNested && isOwn) {\n      throw new AssertionError(\n        flagMsg + 'The \"nested\" and \"own\" flags cannot be combined.',\n        undefined,\n        ssfi\n      );\n    }\n\n    if (obj === null || obj === undefined) {\n      throw new AssertionError(\n        flagMsg + 'Target cannot be null or undefined.',\n        undefined,\n        ssfi\n      );\n    }\n\n    var isDeep = flag(this, 'deep')\n      , negate = flag(this, 'negate')\n      , pathInfo = isNested ? _.getPathInfo(obj, name) : null\n      , value = isNested ? pathInfo.value : obj[name];\n\n    var descriptor = '';\n    if (isDeep) descriptor += 'deep ';\n    if (isOwn) descriptor += 'own ';\n    if (isNested) descriptor += 'nested ';\n    descriptor += 'property ';\n\n    var hasProperty;\n    if (isOwn) hasProperty = Object.prototype.hasOwnProperty.call(obj, name);\n    else if (isNested) hasProperty = pathInfo.exists;\n    else hasProperty = _.hasProperty(obj, name);\n\n    // When performing a negated assertion for both name and val, merely having\n    // a property with the given name isn't enough to cause the assertion to\n    // fail. It must both have a property with the given name, and the value of\n    // that property must equal the given val. Therefore, skip this assertion in\n    // favor of the next.\n    if (!negate || arguments.length === 1) {\n      this.assert(\n          hasProperty\n        , 'expected #{this} to have ' + descriptor + _.inspect(name)\n        , 'expected #{this} to not have ' + descriptor + _.inspect(name));\n    }\n\n    if (arguments.length > 1) {\n      this.assert(\n          hasProperty && (isDeep ? _.eql(val, value) : val === value)\n        , 'expected #{this} to have ' + descriptor + _.inspect(name) + ' of #{exp}, but got #{act}'\n        , 'expected #{this} to not have ' + descriptor + _.inspect(name) + ' of #{act}'\n        , val\n        , value\n      );\n    }\n\n    flag(this, 'object', value);\n  }\n\n  Assertion.addMethod('property', assertProperty);\n\n  function assertOwnProperty (name, value, msg) {\n    flag(this, 'own', true);\n    assertProperty.apply(this, arguments);\n  }\n\n  Assertion.addMethod('ownProperty', assertOwnProperty);\n  Assertion.addMethod('haveOwnProperty', assertOwnProperty);\n\n  /**\n   * ### .ownPropertyDescriptor(name[, descriptor[, msg]])\n   *\n   * Asserts that the target has its own property descriptor with the given key\n   * `name`. Enumerable and non-enumerable properties are included in the\n   * search.\n   *\n   *     expect({a: 1}).to.have.ownPropertyDescriptor('a');\n   *\n   * When `descriptor` is provided, `.ownPropertyDescriptor` also asserts that\n   * the property's descriptor is deeply equal to the given `descriptor`. See\n   * the `deep-eql` project page for info on the deep equality algorithm:\n   * https://github.com/chaijs/deep-eql.\n   *\n   *     expect({a: 1}).to.have.ownPropertyDescriptor('a', {\n   *       configurable: true,\n   *       enumerable: true,\n   *       writable: true,\n   *       value: 1,\n   *     });\n   *\n   * Add `.not` earlier in the chain to negate `.ownPropertyDescriptor`.\n   *\n   *     expect({a: 1}).to.not.have.ownPropertyDescriptor('b');\n   *\n   * However, it's dangerous to negate `.ownPropertyDescriptor` when providing\n   * a `descriptor`. The problem is that it creates uncertain expectations by\n   * asserting that the target either doesn't have a property descriptor with\n   * the given key `name`, or that it does have a property descriptor with the\n   * given key `name` but its not deeply equal to the given `descriptor`. It's\n   * often best to identify the exact output that's expected, and then write an\n   * assertion that only accepts that exact output.\n   *\n   * When the target isn't expected to have a property descriptor with the given\n   * key `name`, it's often best to assert exactly that.\n   *\n   *     // Recommended\n   *     expect({b: 2}).to.not.have.ownPropertyDescriptor('a');\n   *\n   *     // Not recommended\n   *     expect({b: 2}).to.not.have.ownPropertyDescriptor('a', {\n   *       configurable: true,\n   *       enumerable: true,\n   *       writable: true,\n   *       value: 1,\n   *     });\n   *\n   * When the target is expected to have a property descriptor with the given\n   * key `name`, it's often best to assert that the property has its expected\n   * descriptor, rather than asserting that it doesn't have one of many\n   * unexpected descriptors.\n   *\n   *     // Recommended\n   *     expect({a: 3}).to.have.ownPropertyDescriptor('a', {\n   *       configurable: true,\n   *       enumerable: true,\n   *       writable: true,\n   *       value: 3,\n   *     });\n   *\n   *     // Not recommended\n   *     expect({a: 3}).to.not.have.ownPropertyDescriptor('a', {\n   *       configurable: true,\n   *       enumerable: true,\n   *       writable: true,\n   *       value: 1,\n   *     });\n   *\n   * `.ownPropertyDescriptor` changes the target of any assertions that follow\n   * in the chain to be the value of the property descriptor from the original\n   * target object.\n   *\n   *     expect({a: 1}).to.have.ownPropertyDescriptor('a')\n   *       .that.has.property('enumerable', true);\n   *\n   * `.ownPropertyDescriptor` accepts an optional `msg` argument which is a\n   * custom error message to show when the assertion fails. The message can also\n   * be given as the second argument to `expect`. When not providing\n   * `descriptor`, only use the second form.\n   *\n   *     // Recommended\n   *     expect({a: 1}).to.have.ownPropertyDescriptor('a', {\n   *       configurable: true,\n   *       enumerable: true,\n   *       writable: true,\n   *       value: 2,\n   *     }, 'nooo why fail??');\n   *\n   *     // Recommended\n   *     expect({a: 1}, 'nooo why fail??').to.have.ownPropertyDescriptor('a', {\n   *       configurable: true,\n   *       enumerable: true,\n   *       writable: true,\n   *       value: 2,\n   *     });\n   *\n   *     // Recommended\n   *     expect({a: 1}, 'nooo why fail??').to.have.ownPropertyDescriptor('b');\n   *\n   *     // Not recommended\n   *     expect({a: 1})\n   *       .to.have.ownPropertyDescriptor('b', undefined, 'nooo why fail??');\n   *\n   * The above assertion isn't the same thing as not providing `descriptor`.\n   * Instead, it's asserting that the target object has a `b` property\n   * descriptor that's deeply equal to `undefined`.\n   *\n   * The alias `.haveOwnPropertyDescriptor` can be used interchangeably with\n   * `.ownPropertyDescriptor`.\n   *\n   * @name ownPropertyDescriptor\n   * @alias haveOwnPropertyDescriptor\n   * @param {String} name\n   * @param {Object} descriptor _optional_\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertOwnPropertyDescriptor (name, descriptor, msg) {\n    if (typeof descriptor === 'string') {\n      msg = descriptor;\n      descriptor = null;\n    }\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object');\n    var actualDescriptor = Object.getOwnPropertyDescriptor(Object(obj), name);\n    if (actualDescriptor && descriptor) {\n      this.assert(\n          _.eql(descriptor, actualDescriptor)\n        , 'expected the own property descriptor for ' + _.inspect(name) + ' on #{this} to match ' + _.inspect(descriptor) + ', got ' + _.inspect(actualDescriptor)\n        , 'expected the own property descriptor for ' + _.inspect(name) + ' on #{this} to not match ' + _.inspect(descriptor)\n        , descriptor\n        , actualDescriptor\n        , true\n      );\n    } else {\n      this.assert(\n          actualDescriptor\n        , 'expected #{this} to have an own property descriptor for ' + _.inspect(name)\n        , 'expected #{this} to not have an own property descriptor for ' + _.inspect(name)\n      );\n    }\n    flag(this, 'object', actualDescriptor);\n  }\n\n  Assertion.addMethod('ownPropertyDescriptor', assertOwnPropertyDescriptor);\n  Assertion.addMethod('haveOwnPropertyDescriptor', assertOwnPropertyDescriptor);\n\n  /**\n   * ### .lengthOf(n[, msg])\n   *\n   * Asserts that the target's `length` or `size` is equal to the given number\n   * `n`.\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(3);\n   *     expect('foo').to.have.lengthOf(3);\n   *     expect(new Set([1, 2, 3])).to.have.lengthOf(3);\n   *     expect(new Map([['a', 1], ['b', 2], ['c', 3]])).to.have.lengthOf(3);\n   *\n   * Add `.not` earlier in the chain to negate `.lengthOf`. However, it's often\n   * best to assert that the target's `length` property is equal to its expected\n   * value, rather than not equal to one of many unexpected values.\n   *\n   *     expect('foo').to.have.lengthOf(3); // Recommended\n   *     expect('foo').to.not.have.lengthOf(4); // Not recommended\n   *\n   * `.lengthOf` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect([1, 2, 3]).to.have.lengthOf(2, 'nooo why fail??');\n   *     expect([1, 2, 3], 'nooo why fail??').to.have.lengthOf(2);\n   *\n   * `.lengthOf` can also be used as a language chain, causing all `.above`,\n   * `.below`, `.least`, `.most`, and `.within` assertions that follow in the\n   * chain to use the target's `length` property as the target. However, it's\n   * often best to assert that the target's `length` property is equal to its\n   * expected length, rather than asserting that its `length` property falls\n   * within some range of values.\n   *\n   *     // Recommended\n   *     expect([1, 2, 3]).to.have.lengthOf(3);\n   *\n   *     // Not recommended\n   *     expect([1, 2, 3]).to.have.lengthOf.above(2);\n   *     expect([1, 2, 3]).to.have.lengthOf.below(4);\n   *     expect([1, 2, 3]).to.have.lengthOf.at.least(3);\n   *     expect([1, 2, 3]).to.have.lengthOf.at.most(3);\n   *     expect([1, 2, 3]).to.have.lengthOf.within(2,4);\n   *\n   * Due to a compatibility issue, the alias `.length` can't be chained directly\n   * off of an uninvoked method such as `.a`. Therefore, `.length` can't be used\n   * interchangeably with `.lengthOf` in every situation. It's recommended to\n   * always use `.lengthOf` instead of `.length`.\n   *\n   *     expect([1, 2, 3]).to.have.a.length(3); // incompatible; throws error\n   *     expect([1, 2, 3]).to.have.a.lengthOf(3);  // passes as expected\n   *\n   * @name lengthOf\n   * @alias length\n   * @param {Number} n\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertLengthChain () {\n    flag(this, 'doLength', true);\n  }\n\n  function assertLength (n, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , objType = _.type(obj).toLowerCase()\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi')\n      , descriptor = 'length'\n      , itemsCount;\n\n    switch (objType) {\n      case 'map':\n      case 'set':\n        descriptor = 'size';\n        itemsCount = obj.size;\n        break;\n      default:\n        new Assertion(obj, flagMsg, ssfi, true).to.have.property('length');\n        itemsCount = obj.length;\n    }\n\n    this.assert(\n        itemsCount == n\n      , 'expected #{this} to have a ' + descriptor + ' of #{exp} but got #{act}'\n      , 'expected #{this} to not have a ' + descriptor + ' of #{act}'\n      , n\n      , itemsCount\n    );\n  }\n\n  Assertion.addChainableMethod('length', assertLength, assertLengthChain);\n  Assertion.addChainableMethod('lengthOf', assertLength, assertLengthChain);\n\n  /**\n   * ### .match(re[, msg])\n   *\n   * Asserts that the target matches the given regular expression `re`.\n   *\n   *     expect('foobar').to.match(/^foo/);\n   *\n   * Add `.not` earlier in the chain to negate `.match`.\n   *\n   *     expect('foobar').to.not.match(/taco/);\n   *\n   * `.match` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect('foobar').to.match(/taco/, 'nooo why fail??');\n   *     expect('foobar', 'nooo why fail??').to.match(/taco/);\n   *\n   * The alias `.matches` can be used interchangeably with `.match`.\n   *\n   * @name match\n   * @alias matches\n   * @param {RegExp} re\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n  function assertMatch(re, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object');\n    this.assert(\n        re.exec(obj)\n      , 'expected #{this} to match ' + re\n      , 'expected #{this} not to match ' + re\n    );\n  }\n\n  Assertion.addMethod('match', assertMatch);\n  Assertion.addMethod('matches', assertMatch);\n\n  /**\n   * ### .string(str[, msg])\n   *\n   * Asserts that the target string contains the given substring `str`.\n   *\n   *     expect('foobar').to.have.string('bar');\n   *\n   * Add `.not` earlier in the chain to negate `.string`.\n   *\n   *     expect('foobar').to.not.have.string('taco');\n   *\n   * `.string` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect('foobar').to.have.string('taco', 'nooo why fail??');\n   *     expect('foobar', 'nooo why fail??').to.have.string('taco');\n   *\n   * @name string\n   * @param {String} str\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addMethod('string', function (str, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi');\n    new Assertion(obj, flagMsg, ssfi, true).is.a('string');\n\n    this.assert(\n        ~obj.indexOf(str)\n      , 'expected #{this} to contain ' + _.inspect(str)\n      , 'expected #{this} to not contain ' + _.inspect(str)\n    );\n  });\n\n  /**\n   * ### .keys(key1[, key2[, ...]])\n   *\n   * Asserts that the target object, array, map, or set has the given keys. Only\n   * the target's own inherited properties are included in the search.\n   *\n   * When the target is an object or array, keys can be provided as one or more\n   * string arguments, a single array argument, or a single object argument. In\n   * the latter case, only the keys in the given object matter; the values are\n   * ignored.\n   *\n   *     expect({a: 1, b: 2}).to.have.all.keys('a', 'b');\n   *     expect(['x', 'y']).to.have.all.keys(0, 1);\n   *\n   *     expect({a: 1, b: 2}).to.have.all.keys(['a', 'b']);\n   *     expect(['x', 'y']).to.have.all.keys([0, 1]);\n   *\n   *     expect({a: 1, b: 2}).to.have.all.keys({a: 4, b: 5}); // ignore 4 and 5\n   *     expect(['x', 'y']).to.have.all.keys({0: 4, 1: 5}); // ignore 4 and 5\n   *\n   * When the target is a map or set, each key must be provided as a separate\n   * argument.\n   *\n   *     expect(new Map([['a', 1], ['b', 2]])).to.have.all.keys('a', 'b');\n   *     expect(new Set(['a', 'b'])).to.have.all.keys('a', 'b');\n   *\n   * Because `.keys` does different things based on the target's type, it's\n   * important to check the target's type before using `.keys`. See the `.a` doc\n   * for info on testing a target's type.\n   *\n   *     expect({a: 1, b: 2}).to.be.an('object').that.has.all.keys('a', 'b');\n   *\n   * By default, strict (`===`) equality is used to compare keys of maps and\n   * sets. Add `.deep` earlier in the chain to use deep equality instead. See\n   * the `deep-eql` project page for info on the deep equality algorithm:\n   * https://github.com/chaijs/deep-eql.\n   *\n   *     // Target set deeply (but not strictly) has key `{a: 1}`\n   *     expect(new Set([{a: 1}])).to.have.all.deep.keys([{a: 1}]);\n   *     expect(new Set([{a: 1}])).to.not.have.all.keys([{a: 1}]);\n   *\n   * By default, the target must have all of the given keys and no more. Add\n   * `.any` earlier in the chain to only require that the target have at least\n   * one of the given keys. Also, add `.not` earlier in the chain to negate\n   * `.keys`. It's often best to add `.any` when negating `.keys`, and to use\n   * `.all` when asserting `.keys` without negation.\n   *\n   * When negating `.keys`, `.any` is preferred because `.not.any.keys` asserts\n   * exactly what's expected of the output, whereas `.not.all.keys` creates\n   * uncertain expectations.\n   *\n   *     // Recommended; asserts that target doesn't have any of the given keys\n   *     expect({a: 1, b: 2}).to.not.have.any.keys('c', 'd');\n   *\n   *     // Not recommended; asserts that target doesn't have all of the given\n   *     // keys but may or may not have some of them\n   *     expect({a: 1, b: 2}).to.not.have.all.keys('c', 'd');\n   *\n   * When asserting `.keys` without negation, `.all` is preferred because\n   * `.all.keys` asserts exactly what's expected of the output, whereas\n   * `.any.keys` creates uncertain expectations.\n   *\n   *     // Recommended; asserts that target has all the given keys\n   *     expect({a: 1, b: 2}).to.have.all.keys('a', 'b');\n   *\n   *     // Not recommended; asserts that target has at least one of the given\n   *     // keys but may or may not have more of them\n   *     expect({a: 1, b: 2}).to.have.any.keys('a', 'b');\n   *\n   * Note that `.all` is used by default when neither `.all` nor `.any` appear\n   * earlier in the chain. However, it's often best to add `.all` anyway because\n   * it improves readability.\n   *\n   *     // Both assertions are identical\n   *     expect({a: 1, b: 2}).to.have.all.keys('a', 'b'); // Recommended\n   *     expect({a: 1, b: 2}).to.have.keys('a', 'b'); // Not recommended\n   *\n   * Add `.include` earlier in the chain to require that the target's keys be a\n   * superset of the expected keys, rather than identical sets.\n   *\n   *     // Target object's keys are a superset of ['a', 'b'] but not identical\n   *     expect({a: 1, b: 2, c: 3}).to.include.all.keys('a', 'b');\n   *     expect({a: 1, b: 2, c: 3}).to.not.have.all.keys('a', 'b');\n   *\n   * However, if `.any` and `.include` are combined, only the `.any` takes\n   * effect. The `.include` is ignored in this case.\n   *\n   *     // Both assertions are identical\n   *     expect({a: 1}).to.have.any.keys('a', 'b');\n   *     expect({a: 1}).to.include.any.keys('a', 'b');\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect({a: 1}, 'nooo why fail??').to.have.key('b');\n   *\n   * The alias `.key` can be used interchangeably with `.keys`.\n   *\n   * @name keys\n   * @alias key\n   * @param {...String|Array|Object} keys\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertKeys (keys) {\n    var obj = flag(this, 'object')\n      , objType = _.type(obj)\n      , keysType = _.type(keys)\n      , ssfi = flag(this, 'ssfi')\n      , isDeep = flag(this, 'deep')\n      , str\n      , deepStr = ''\n      , actual\n      , ok = true\n      , flagMsg = flag(this, 'message');\n\n    flagMsg = flagMsg ? flagMsg + ': ' : '';\n    var mixedArgsMsg = flagMsg + 'when testing keys against an object or an array you must give a single Array|Object|String argument or multiple String arguments';\n\n    if (objType === 'Map' || objType === 'Set') {\n      deepStr = isDeep ? 'deeply ' : '';\n      actual = [];\n\n      // Map and Set '.keys' aren't supported in IE 11. Therefore, use .forEach.\n      obj.forEach(function (val, key) { actual.push(key) });\n\n      if (keysType !== 'Array') {\n        keys = Array.prototype.slice.call(arguments);\n      }\n    } else {\n      actual = _.getOwnEnumerableProperties(obj);\n\n      switch (keysType) {\n        case 'Array':\n          if (arguments.length > 1) {\n            throw new AssertionError(mixedArgsMsg, undefined, ssfi);\n          }\n          break;\n        case 'Object':\n          if (arguments.length > 1) {\n            throw new AssertionError(mixedArgsMsg, undefined, ssfi);\n          }\n          keys = Object.keys(keys);\n          break;\n        default:\n          keys = Array.prototype.slice.call(arguments);\n      }\n\n      // Only stringify non-Symbols because Symbols would become \"Symbol()\"\n      keys = keys.map(function (val) {\n        return typeof val === 'symbol' ? val : String(val);\n      });\n    }\n\n    if (!keys.length) {\n      throw new AssertionError(flagMsg + 'keys required', undefined, ssfi);\n    }\n\n    var len = keys.length\n      , any = flag(this, 'any')\n      , all = flag(this, 'all')\n      , expected = keys;\n\n    if (!any && !all) {\n      all = true;\n    }\n\n    // Has any\n    if (any) {\n      ok = expected.some(function(expectedKey) {\n        return actual.some(function(actualKey) {\n          if (isDeep) {\n            return _.eql(expectedKey, actualKey);\n          } else {\n            return expectedKey === actualKey;\n          }\n        });\n      });\n    }\n\n    // Has all\n    if (all) {\n      ok = expected.every(function(expectedKey) {\n        return actual.some(function(actualKey) {\n          if (isDeep) {\n            return _.eql(expectedKey, actualKey);\n          } else {\n            return expectedKey === actualKey;\n          }\n        });\n      });\n\n      if (!flag(this, 'contains')) {\n        ok = ok && keys.length == actual.length;\n      }\n    }\n\n    // Key string\n    if (len > 1) {\n      keys = keys.map(function(key) {\n        return _.inspect(key);\n      });\n      var last = keys.pop();\n      if (all) {\n        str = keys.join(', ') + ', and ' + last;\n      }\n      if (any) {\n        str = keys.join(', ') + ', or ' + last;\n      }\n    } else {\n      str = _.inspect(keys[0]);\n    }\n\n    // Form\n    str = (len > 1 ? 'keys ' : 'key ') + str;\n\n    // Have / include\n    str = (flag(this, 'contains') ? 'contain ' : 'have ') + str;\n\n    // Assertion\n    this.assert(\n        ok\n      , 'expected #{this} to ' + deepStr + str\n      , 'expected #{this} to not ' + deepStr + str\n      , expected.slice(0).sort(_.compareByInspect)\n      , actual.sort(_.compareByInspect)\n      , true\n    );\n  }\n\n  Assertion.addMethod('keys', assertKeys);\n  Assertion.addMethod('key', assertKeys);\n\n  /**\n   * ### .throw([errorLike], [errMsgMatcher], [msg])\n   *\n   * When no arguments are provided, `.throw` invokes the target function and\n   * asserts that an error is thrown.\n   *\n   *     var badFn = function () { throw new TypeError('Illegal salmon!'); };\n   *\n   *     expect(badFn).to.throw();\n   *\n   * When one argument is provided, and it's an error constructor, `.throw`\n   * invokes the target function and asserts that an error is thrown that's an\n   * instance of that error constructor.\n   *\n   *     var badFn = function () { throw new TypeError('Illegal salmon!'); };\n   *\n   *     expect(badFn).to.throw(TypeError);\n   *\n   * When one argument is provided, and it's an error instance, `.throw` invokes\n   * the target function and asserts that an error is thrown that's strictly\n   * (`===`) equal to that error instance.\n   *\n   *     var err = new TypeError('Illegal salmon!');\n   *     var badFn = function () { throw err; };\n   *\n   *     expect(badFn).to.throw(err);\n   *\n   * When one argument is provided, and it's a string, `.throw` invokes the\n   * target function and asserts that an error is thrown with a message that\n   * contains that string.\n   *\n   *     var badFn = function () { throw new TypeError('Illegal salmon!'); };\n   *\n   *     expect(badFn).to.throw('salmon');\n   *\n   * When one argument is provided, and it's a regular expression, `.throw`\n   * invokes the target function and asserts that an error is thrown with a\n   * message that matches that regular expression.\n   *\n   *     var badFn = function () { throw new TypeError('Illegal salmon!'); };\n   *\n   *     expect(badFn).to.throw(/salmon/);\n   *\n   * When two arguments are provided, and the first is an error instance or\n   * constructor, and the second is a string or regular expression, `.throw`\n   * invokes the function and asserts that an error is thrown that fulfills both\n   * conditions as described above.\n   *\n   *     var err = new TypeError('Illegal salmon!');\n   *     var badFn = function () { throw err; };\n   *\n   *     expect(badFn).to.throw(TypeError, 'salmon');\n   *     expect(badFn).to.throw(TypeError, /salmon/);\n   *     expect(badFn).to.throw(err, 'salmon');\n   *     expect(badFn).to.throw(err, /salmon/);\n   *\n   * Add `.not` earlier in the chain to negate `.throw`.\n   *\n   *     var goodFn = function () {};\n   *\n   *     expect(goodFn).to.not.throw();\n   *\n   * However, it's dangerous to negate `.throw` when providing any arguments.\n   * The problem is that it creates uncertain expectations by asserting that the\n   * target either doesn't throw an error, or that it throws an error but of a\n   * different type than the given type, or that it throws an error of the given\n   * type but with a message that doesn't include the given string. It's often\n   * best to identify the exact output that's expected, and then write an\n   * assertion that only accepts that exact output.\n   *\n   * When the target isn't expected to throw an error, it's often best to assert\n   * exactly that.\n   *\n   *     var goodFn = function () {};\n   *\n   *     expect(goodFn).to.not.throw(); // Recommended\n   *     expect(goodFn).to.not.throw(ReferenceError, 'x'); // Not recommended\n   *\n   * When the target is expected to throw an error, it's often best to assert\n   * that the error is of its expected type, and has a message that includes an\n   * expected string, rather than asserting that it doesn't have one of many\n   * unexpected types, and doesn't have a message that includes some string.\n   *\n   *     var badFn = function () { throw new TypeError('Illegal salmon!'); };\n   *\n   *     expect(badFn).to.throw(TypeError, 'salmon'); // Recommended\n   *     expect(badFn).to.not.throw(ReferenceError, 'x'); // Not recommended\n   *\n   * `.throw` changes the target of any assertions that follow in the chain to\n   * be the error object that's thrown.\n   *\n   *     var err = new TypeError('Illegal salmon!');\n   *     err.code = 42;\n   *     var badFn = function () { throw err; };\n   *\n   *     expect(badFn).to.throw(TypeError).with.property('code', 42);\n   *\n   * `.throw` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`. When not providing two arguments, always use\n   * the second form.\n   *\n   *     var goodFn = function () {};\n   *\n   *     expect(goodFn).to.throw(TypeError, 'x', 'nooo why fail??');\n   *     expect(goodFn, 'nooo why fail??').to.throw();\n   *\n   * Due to limitations in ES5, `.throw` may not always work as expected when\n   * using a transpiler such as Babel or TypeScript. In particular, it may\n   * produce unexpected results when subclassing the built-in `Error` object and\n   * then passing the subclassed constructor to `.throw`. See your transpiler's\n   * docs for details:\n   *\n   * - ([Babel](https://babeljs.io/docs/usage/caveats/#classes))\n   * - ([TypeScript](https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work))\n   *\n   * Beware of some common mistakes when using the `throw` assertion. One common\n   * mistake is to accidentally invoke the function yourself instead of letting\n   * the `throw` assertion invoke the function for you. For example, when\n   * testing if a function named `fn` throws, provide `fn` instead of `fn()` as\n   * the target for the assertion.\n   *\n   *     expect(fn).to.throw();     // Good! Tests `fn` as desired\n   *     expect(fn()).to.throw();   // Bad! Tests result of `fn()`, not `fn`\n   *\n   * If you need to assert that your function `fn` throws when passed certain\n   * arguments, then wrap a call to `fn` inside of another function.\n   *\n   *     expect(function () { fn(42); }).to.throw();  // Function expression\n   *     expect(() => fn(42)).to.throw();             // ES6 arrow function\n   *\n   * Another common mistake is to provide an object method (or any stand-alone\n   * function that relies on `this`) as the target of the assertion. Doing so is\n   * problematic because the `this` context will be lost when the function is\n   * invoked by `.throw`; there's no way for it to know what `this` is supposed\n   * to be. There are two ways around this problem. One solution is to wrap the\n   * method or function call inside of another function. Another solution is to\n   * use `bind`.\n   *\n   *     expect(function () { cat.meow(); }).to.throw();  // Function expression\n   *     expect(() => cat.meow()).to.throw();             // ES6 arrow function\n   *     expect(cat.meow.bind(cat)).to.throw();           // Bind\n   *\n   * Finally, it's worth mentioning that it's a best practice in JavaScript to\n   * only throw `Error` and derivatives of `Error` such as `ReferenceError`,\n   * `TypeError`, and user-defined objects that extend `Error`. No other type of\n   * value will generate a stack trace when initialized. With that said, the\n   * `throw` assertion does technically support any type of value being thrown,\n   * not just `Error` and its derivatives.\n   *\n   * The aliases `.throws` and `.Throw` can be used interchangeably with\n   * `.throw`.\n   *\n   * @name throw\n   * @alias throws\n   * @alias Throw\n   * @param {Error|ErrorConstructor} errorLike\n   * @param {String|RegExp} errMsgMatcher error message\n   * @param {String} msg _optional_\n   * @see https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error#Error_types\n   * @returns error for chaining (null if no error)\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertThrows (errorLike, errMsgMatcher, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , ssfi = flag(this, 'ssfi')\n      , flagMsg = flag(this, 'message')\n      , negate = flag(this, 'negate') || false;\n    new Assertion(obj, flagMsg, ssfi, true).is.a('function');\n\n    if (errorLike instanceof RegExp || typeof errorLike === 'string') {\n      errMsgMatcher = errorLike;\n      errorLike = null;\n    }\n\n    var caughtErr;\n    try {\n      obj();\n    } catch (err) {\n      caughtErr = err;\n    }\n\n    // If we have the negate flag enabled and at least one valid argument it means we do expect an error\n    // but we want it to match a given set of criteria\n    var everyArgIsUndefined = errorLike === undefined && errMsgMatcher === undefined;\n\n    // If we've got the negate flag enabled and both args, we should only fail if both aren't compatible\n    // See Issue #551 and PR #683@GitHub\n    var everyArgIsDefined = Boolean(errorLike && errMsgMatcher);\n    var errorLikeFail = false;\n    var errMsgMatcherFail = false;\n\n    // Checking if error was thrown\n    if (everyArgIsUndefined || !everyArgIsUndefined && !negate) {\n      // We need this to display results correctly according to their types\n      var errorLikeString = 'an error';\n      if (errorLike instanceof Error) {\n        errorLikeString = '#{exp}';\n      } else if (errorLike) {\n        errorLikeString = _.checkError.getConstructorName(errorLike);\n      }\n\n      this.assert(\n          caughtErr\n        , 'expected #{this} to throw ' + errorLikeString\n        , 'expected #{this} to not throw an error but #{act} was thrown'\n        , errorLike && errorLike.toString()\n        , (caughtErr instanceof Error ?\n            caughtErr.toString() : (typeof caughtErr === 'string' ? caughtErr : caughtErr &&\n                                    _.checkError.getConstructorName(caughtErr)))\n      );\n    }\n\n    if (errorLike && caughtErr) {\n      // We should compare instances only if `errorLike` is an instance of `Error`\n      if (errorLike instanceof Error) {\n        var isCompatibleInstance = _.checkError.compatibleInstance(caughtErr, errorLike);\n\n        if (isCompatibleInstance === negate) {\n          // These checks were created to ensure we won't fail too soon when we've got both args and a negate\n          // See Issue #551 and PR #683@GitHub\n          if (everyArgIsDefined && negate) {\n            errorLikeFail = true;\n          } else {\n            this.assert(\n                negate\n              , 'expected #{this} to throw #{exp} but #{act} was thrown'\n              , 'expected #{this} to not throw #{exp}' + (caughtErr && !negate ? ' but #{act} was thrown' : '')\n              , errorLike.toString()\n              , caughtErr.toString()\n            );\n          }\n        }\n      }\n\n      var isCompatibleConstructor = _.checkError.compatibleConstructor(caughtErr, errorLike);\n      if (isCompatibleConstructor === negate) {\n        if (everyArgIsDefined && negate) {\n            errorLikeFail = true;\n        } else {\n          this.assert(\n              negate\n            , 'expected #{this} to throw #{exp} but #{act} was thrown'\n            , 'expected #{this} to not throw #{exp}' + (caughtErr ? ' but #{act} was thrown' : '')\n            , (errorLike instanceof Error ? errorLike.toString() : errorLike && _.checkError.getConstructorName(errorLike))\n            , (caughtErr instanceof Error ? caughtErr.toString() : caughtErr && _.checkError.getConstructorName(caughtErr))\n          );\n        }\n      }\n    }\n\n    if (caughtErr && errMsgMatcher !== undefined && errMsgMatcher !== null) {\n      // Here we check compatible messages\n      var placeholder = 'including';\n      if (errMsgMatcher instanceof RegExp) {\n        placeholder = 'matching'\n      }\n\n      var isCompatibleMessage = _.checkError.compatibleMessage(caughtErr, errMsgMatcher);\n      if (isCompatibleMessage === negate) {\n        if (everyArgIsDefined && negate) {\n            errMsgMatcherFail = true;\n        } else {\n          this.assert(\n            negate\n            , 'expected #{this} to throw error ' + placeholder + ' #{exp} but got #{act}'\n            , 'expected #{this} to throw error not ' + placeholder + ' #{exp}'\n            ,  errMsgMatcher\n            ,  _.checkError.getMessage(caughtErr)\n          );\n        }\n      }\n    }\n\n    // If both assertions failed and both should've matched we throw an error\n    if (errorLikeFail && errMsgMatcherFail) {\n      this.assert(\n        negate\n        , 'expected #{this} to throw #{exp} but #{act} was thrown'\n        , 'expected #{this} to not throw #{exp}' + (caughtErr ? ' but #{act} was thrown' : '')\n        , (errorLike instanceof Error ? errorLike.toString() : errorLike && _.checkError.getConstructorName(errorLike))\n        , (caughtErr instanceof Error ? caughtErr.toString() : caughtErr && _.checkError.getConstructorName(caughtErr))\n      );\n    }\n\n    flag(this, 'object', caughtErr);\n  };\n\n  Assertion.addMethod('throw', assertThrows);\n  Assertion.addMethod('throws', assertThrows);\n  Assertion.addMethod('Throw', assertThrows);\n\n  /**\n   * ### .respondTo(method[, msg])\n   *\n   * When the target is a non-function object, `.respondTo` asserts that the\n   * target has a method with the given name `method`. The method can be own or\n   * inherited, and it can be enumerable or non-enumerable.\n   *\n   *     function Cat () {}\n   *     Cat.prototype.meow = function () {};\n   *\n   *     expect(new Cat()).to.respondTo('meow');\n   *\n   * When the target is a function, `.respondTo` asserts that the target's\n   * `prototype` property has a method with the given name `method`. Again, the\n   * method can be own or inherited, and it can be enumerable or non-enumerable.\n   *\n   *     function Cat () {}\n   *     Cat.prototype.meow = function () {};\n   *\n   *     expect(Cat).to.respondTo('meow');\n   *\n   * Add `.itself` earlier in the chain to force `.respondTo` to treat the\n   * target as a non-function object, even if it's a function. Thus, it asserts\n   * that the target has a method with the given name `method`, rather than\n   * asserting that the target's `prototype` property has a method with the\n   * given name `method`.\n   *\n   *     function Cat () {}\n   *     Cat.prototype.meow = function () {};\n   *     Cat.hiss = function () {};\n   *\n   *     expect(Cat).itself.to.respondTo('hiss').but.not.respondTo('meow');\n   *\n   * When not adding `.itself`, it's important to check the target's type before\n   * using `.respondTo`. See the `.a` doc for info on checking a target's type.\n   *\n   *     function Cat () {}\n   *     Cat.prototype.meow = function () {};\n   *\n   *     expect(new Cat()).to.be.an('object').that.respondsTo('meow');\n   *\n   * Add `.not` earlier in the chain to negate `.respondTo`.\n   *\n   *     function Dog () {}\n   *     Dog.prototype.bark = function () {};\n   *\n   *     expect(new Dog()).to.not.respondTo('meow');\n   *\n   * `.respondTo` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect({}).to.respondTo('meow', 'nooo why fail??');\n   *     expect({}, 'nooo why fail??').to.respondTo('meow');\n   *\n   * The alias `.respondsTo` can be used interchangeably with `.respondTo`.\n   *\n   * @name respondTo\n   * @alias respondsTo\n   * @param {String} method\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function respondTo (method, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , itself = flag(this, 'itself')\n      , context = ('function' === typeof obj && !itself)\n        ? obj.prototype[method]\n        : obj[method];\n\n    this.assert(\n        'function' === typeof context\n      , 'expected #{this} to respond to ' + _.inspect(method)\n      , 'expected #{this} to not respond to ' + _.inspect(method)\n    );\n  }\n\n  Assertion.addMethod('respondTo', respondTo);\n  Assertion.addMethod('respondsTo', respondTo);\n\n  /**\n   * ### .itself\n   *\n   * Forces all `.respondTo` assertions that follow in the chain to behave as if\n   * the target is a non-function object, even if it's a function. Thus, it\n   * causes `.respondTo` to assert that the target has a method with the given\n   * name, rather than asserting that the target's `prototype` property has a\n   * method with the given name.\n   *\n   *     function Cat () {}\n   *     Cat.prototype.meow = function () {};\n   *     Cat.hiss = function () {};\n   *\n   *     expect(Cat).itself.to.respondTo('hiss').but.not.respondTo('meow');\n   *\n   * @name itself\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('itself', function () {\n    flag(this, 'itself', true);\n  });\n\n  /**\n   * ### .satisfy(matcher[, msg])\n   *\n   * Invokes the given `matcher` function with the target being passed as the\n   * first argument, and asserts that the value returned is truthy.\n   *\n   *     expect(1).to.satisfy(function(num) {\n   *       return num > 0;\n   *     });\n   *\n   * Add `.not` earlier in the chain to negate `.satisfy`.\n   *\n   *     expect(1).to.not.satisfy(function(num) {\n   *       return num > 2;\n   *     });\n   *\n   * `.satisfy` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect(1).to.satisfy(function(num) {\n   *       return num > 2;\n   *     }, 'nooo why fail??');\n   *\n   *     expect(1, 'nooo why fail??').to.satisfy(function(num) {\n   *       return num > 2;\n   *     });\n   *\n   * The alias `.satisfies` can be used interchangeably with `.satisfy`.\n   *\n   * @name satisfy\n   * @alias satisfies\n   * @param {Function} matcher\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function satisfy (matcher, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object');\n    var result = matcher(obj);\n    this.assert(\n        result\n      , 'expected #{this} to satisfy ' + _.objDisplay(matcher)\n      , 'expected #{this} to not satisfy' + _.objDisplay(matcher)\n      , flag(this, 'negate') ? false : true\n      , result\n    );\n  }\n\n  Assertion.addMethod('satisfy', satisfy);\n  Assertion.addMethod('satisfies', satisfy);\n\n  /**\n   * ### .closeTo(expected, delta[, msg])\n   *\n   * Asserts that the target is a number that's within a given +/- `delta` range\n   * of the given number `expected`. However, it's often best to assert that the\n   * target is equal to its expected value.\n   *\n   *     // Recommended\n   *     expect(1.5).to.equal(1.5);\n   *\n   *     // Not recommended\n   *     expect(1.5).to.be.closeTo(1, 0.5);\n   *     expect(1.5).to.be.closeTo(2, 0.5);\n   *     expect(1.5).to.be.closeTo(1, 1);\n   *\n   * Add `.not` earlier in the chain to negate `.closeTo`.\n   *\n   *     expect(1.5).to.equal(1.5); // Recommended\n   *     expect(1.5).to.not.be.closeTo(3, 1); // Not recommended\n   *\n   * `.closeTo` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect(1.5).to.be.closeTo(3, 1, 'nooo why fail??');\n   *     expect(1.5, 'nooo why fail??').to.be.closeTo(3, 1);\n   *\n   * The alias `.approximately` can be used interchangeably with `.closeTo`.\n   *\n   * @name closeTo\n   * @alias approximately\n   * @param {Number} expected\n   * @param {Number} delta\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function closeTo(expected, delta, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi');\n\n    new Assertion(obj, flagMsg, ssfi, true).is.a('number');\n    if (typeof expected !== 'number' || typeof delta !== 'number') {\n      flagMsg = flagMsg ? flagMsg + ': ' : '';\n      var deltaMessage = delta === undefined ? \", and a delta is required\" : \"\";\n      throw new AssertionError(\n          flagMsg + 'the arguments to closeTo or approximately must be numbers' + deltaMessage,\n          undefined,\n          ssfi\n      );\n    }\n\n    this.assert(\n        Math.abs(obj - expected) <= delta\n      , 'expected #{this} to be close to ' + expected + ' +/- ' + delta\n      , 'expected #{this} not to be close to ' + expected + ' +/- ' + delta\n    );\n  }\n\n  Assertion.addMethod('closeTo', closeTo);\n  Assertion.addMethod('approximately', closeTo);\n\n  // Note: Duplicates are ignored if testing for inclusion instead of sameness.\n  function isSubsetOf(subset, superset, cmp, contains, ordered) {\n    if (!contains) {\n      if (subset.length !== superset.length) return false;\n      superset = superset.slice();\n    }\n\n    return subset.every(function(elem, idx) {\n      if (ordered) return cmp ? cmp(elem, superset[idx]) : elem === superset[idx];\n\n      if (!cmp) {\n        var matchIdx = superset.indexOf(elem);\n        if (matchIdx === -1) return false;\n\n        // Remove match from superset so not counted twice if duplicate in subset.\n        if (!contains) superset.splice(matchIdx, 1);\n        return true;\n      }\n\n      return superset.some(function(elem2, matchIdx) {\n        if (!cmp(elem, elem2)) return false;\n\n        // Remove match from superset so not counted twice if duplicate in subset.\n        if (!contains) superset.splice(matchIdx, 1);\n        return true;\n      });\n    });\n  }\n\n  /**\n   * ### .members(set[, msg])\n   *\n   * Asserts that the target array has the same members as the given array\n   * `set`.\n   *\n   *     expect([1, 2, 3]).to.have.members([2, 1, 3]);\n   *     expect([1, 2, 2]).to.have.members([2, 1, 2]);\n   *\n   * By default, members are compared using strict (`===`) equality. Add `.deep`\n   * earlier in the chain to use deep equality instead. See the `deep-eql`\n   * project page for info on the deep equality algorithm:\n   * https://github.com/chaijs/deep-eql.\n   *\n   *     // Target array deeply (but not strictly) has member `{a: 1}`\n   *     expect([{a: 1}]).to.have.deep.members([{a: 1}]);\n   *     expect([{a: 1}]).to.not.have.members([{a: 1}]);\n   *\n   * By default, order doesn't matter. Add `.ordered` earlier in the chain to\n   * require that members appear in the same order.\n   *\n   *     expect([1, 2, 3]).to.have.ordered.members([1, 2, 3]);\n   *     expect([1, 2, 3]).to.have.members([2, 1, 3])\n   *       .but.not.ordered.members([2, 1, 3]);\n   *\n   * By default, both arrays must be the same size. Add `.include` earlier in\n   * the chain to require that the target's members be a superset of the\n   * expected members. Note that duplicates are ignored in the subset when\n   * `.include` is added.\n   *\n   *     // Target array is a superset of [1, 2] but not identical\n   *     expect([1, 2, 3]).to.include.members([1, 2]);\n   *     expect([1, 2, 3]).to.not.have.members([1, 2]);\n   *\n   *     // Duplicates in the subset are ignored\n   *     expect([1, 2, 3]).to.include.members([1, 2, 2, 2]);\n   *\n   * `.deep`, `.ordered`, and `.include` can all be combined. However, if\n   * `.include` and `.ordered` are combined, the ordering begins at the start of\n   * both arrays.\n   *\n   *     expect([{a: 1}, {b: 2}, {c: 3}])\n   *       .to.include.deep.ordered.members([{a: 1}, {b: 2}])\n   *       .but.not.include.deep.ordered.members([{b: 2}, {c: 3}]);\n   *\n   * Add `.not` earlier in the chain to negate `.members`. However, it's\n   * dangerous to do so. The problem is that it creates uncertain expectations\n   * by asserting that the target array doesn't have all of the same members as\n   * the given array `set` but may or may not have some of them. It's often best\n   * to identify the exact output that's expected, and then write an assertion\n   * that only accepts that exact output.\n   *\n   *     expect([1, 2]).to.not.include(3).and.not.include(4); // Recommended\n   *     expect([1, 2]).to.not.have.members([3, 4]); // Not recommended\n   *\n   * `.members` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`.\n   *\n   *     expect([1, 2]).to.have.members([1, 2, 3], 'nooo why fail??');\n   *     expect([1, 2], 'nooo why fail??').to.have.members([1, 2, 3]);\n   *\n   * @name members\n   * @param {Array} set\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addMethod('members', function (subset, msg) {\n    if (msg) flag(this, 'message', msg);\n    var obj = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi');\n\n    new Assertion(obj, flagMsg, ssfi, true).to.be.an('array');\n    new Assertion(subset, flagMsg, ssfi, true).to.be.an('array');\n\n    var contains = flag(this, 'contains');\n    var ordered = flag(this, 'ordered');\n\n    var subject, failMsg, failNegateMsg;\n\n    if (contains) {\n      subject = ordered ? 'an ordered superset' : 'a superset';\n      failMsg = 'expected #{this} to be ' + subject + ' of #{exp}';\n      failNegateMsg = 'expected #{this} to not be ' + subject + ' of #{exp}';\n    } else {\n      subject = ordered ? 'ordered members' : 'members';\n      failMsg = 'expected #{this} to have the same ' + subject + ' as #{exp}';\n      failNegateMsg = 'expected #{this} to not have the same ' + subject + ' as #{exp}';\n    }\n\n    var cmp = flag(this, 'deep') ? _.eql : undefined;\n\n    this.assert(\n        isSubsetOf(subset, obj, cmp, contains, ordered)\n      , failMsg\n      , failNegateMsg\n      , subset\n      , obj\n      , true\n    );\n  });\n\n  /**\n   * ### .oneOf(list[, msg])\n   *\n   * Asserts that the target is a member of the given array `list`. However,\n   * it's often best to assert that the target is equal to its expected value.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.be.oneOf([1, 2, 3]); // Not recommended\n   *\n   * Comparisons are performed using strict (`===`) equality.\n   *\n   * Add `.not` earlier in the chain to negate `.oneOf`.\n   *\n   *     expect(1).to.equal(1); // Recommended\n   *     expect(1).to.not.be.oneOf([2, 3, 4]); // Not recommended\n   *\n   * It can also be chained with `.contain` or `.include`, which will work with\n   * both arrays and strings:\n   *\n   *     expect('Today is sunny').to.contain.oneOf(['sunny', 'cloudy'])\n   *     expect('Today is rainy').to.not.contain.oneOf(['sunny', 'cloudy'])\n   *     expect([1,2,3]).to.contain.oneOf([3,4,5])\n   *     expect([1,2,3]).to.not.contain.oneOf([4,5,6])\n   *\n   * `.oneOf` accepts an optional `msg` argument which is a custom error message\n   * to show when the assertion fails. The message can also be given as the\n   * second argument to `expect`.\n   *\n   *     expect(1).to.be.oneOf([2, 3, 4], 'nooo why fail??');\n   *     expect(1, 'nooo why fail??').to.be.oneOf([2, 3, 4]);\n   *\n   * @name oneOf\n   * @param {Array<*>} list\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function oneOf (list, msg) {\n    if (msg) flag(this, 'message', msg);\n    var expected = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi')\n      , contains = flag(this, 'contains')\n      , isDeep = flag(this, 'deep');\n    new Assertion(list, flagMsg, ssfi, true).to.be.an('array');\n\n    if (contains) {\n      this.assert(\n        list.some(function(possibility) { return expected.indexOf(possibility) > -1 })\n        , 'expected #{this} to contain one of #{exp}'\n        , 'expected #{this} to not contain one of #{exp}'\n        , list\n        , expected\n      );\n    } else {\n      if (isDeep) {\n        this.assert(\n          list.some(function(possibility) { return _.eql(expected, possibility) })\n          , 'expected #{this} to deeply equal one of #{exp}'\n          , 'expected #{this} to deeply equal one of #{exp}'\n          , list\n          , expected\n        );\n      } else {\n        this.assert(\n          list.indexOf(expected) > -1\n          , 'expected #{this} to be one of #{exp}'\n          , 'expected #{this} to not be one of #{exp}'\n          , list\n          , expected\n        );\n      }\n    }\n  }\n\n  Assertion.addMethod('oneOf', oneOf);\n\n  /**\n   * ### .change(subject[, prop[, msg]])\n   *\n   * When one argument is provided, `.change` asserts that the given function\n   * `subject` returns a different value when it's invoked before the target\n   * function compared to when it's invoked afterward. However, it's often best\n   * to assert that `subject` is equal to its expected value.\n   *\n   *     var dots = ''\n   *       , addDot = function () { dots += '.'; }\n   *       , getDots = function () { return dots; };\n   *\n   *     // Recommended\n   *     expect(getDots()).to.equal('');\n   *     addDot();\n   *     expect(getDots()).to.equal('.');\n   *\n   *     // Not recommended\n   *     expect(addDot).to.change(getDots);\n   *\n   * When two arguments are provided, `.change` asserts that the value of the\n   * given object `subject`'s `prop` property is different before invoking the\n   * target function compared to afterward.\n   *\n   *     var myObj = {dots: ''}\n   *       , addDot = function () { myObj.dots += '.'; };\n   *\n   *     // Recommended\n   *     expect(myObj).to.have.property('dots', '');\n   *     addDot();\n   *     expect(myObj).to.have.property('dots', '.');\n   *\n   *     // Not recommended\n   *     expect(addDot).to.change(myObj, 'dots');\n   *\n   * Strict (`===`) equality is used to compare before and after values.\n   *\n   * Add `.not` earlier in the chain to negate `.change`.\n   *\n   *     var dots = ''\n   *       , noop = function () {}\n   *       , getDots = function () { return dots; };\n   *\n   *     expect(noop).to.not.change(getDots);\n   *\n   *     var myObj = {dots: ''}\n   *       , noop = function () {};\n   *\n   *     expect(noop).to.not.change(myObj, 'dots');\n   *\n   * `.change` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`. When not providing two arguments, always\n   * use the second form.\n   *\n   *     var myObj = {dots: ''}\n   *       , addDot = function () { myObj.dots += '.'; };\n   *\n   *     expect(addDot).to.not.change(myObj, 'dots', 'nooo why fail??');\n   *\n   *     var dots = ''\n   *       , addDot = function () { dots += '.'; }\n   *       , getDots = function () { return dots; };\n   *\n   *     expect(addDot, 'nooo why fail??').to.not.change(getDots);\n   *\n   * `.change` also causes all `.by` assertions that follow in the chain to\n   * assert how much a numeric subject was increased or decreased by. However,\n   * it's dangerous to use `.change.by`. The problem is that it creates\n   * uncertain expectations by asserting that the subject either increases by\n   * the given delta, or that it decreases by the given delta. It's often best\n   * to identify the exact output that's expected, and then write an assertion\n   * that only accepts that exact output.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; }\n   *       , subtractTwo = function () { myObj.val -= 2; };\n   *\n   *     expect(addTwo).to.increase(myObj, 'val').by(2); // Recommended\n   *     expect(addTwo).to.change(myObj, 'val').by(2); // Not recommended\n   *\n   *     expect(subtractTwo).to.decrease(myObj, 'val').by(2); // Recommended\n   *     expect(subtractTwo).to.change(myObj, 'val').by(2); // Not recommended\n   *\n   * The alias `.changes` can be used interchangeably with `.change`.\n   *\n   * @name change\n   * @alias changes\n   * @param {String} subject\n   * @param {String} prop name _optional_\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertChanges (subject, prop, msg) {\n    if (msg) flag(this, 'message', msg);\n    var fn = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi');\n    new Assertion(fn, flagMsg, ssfi, true).is.a('function');\n\n    var initial;\n    if (!prop) {\n      new Assertion(subject, flagMsg, ssfi, true).is.a('function');\n      initial = subject();\n    } else {\n      new Assertion(subject, flagMsg, ssfi, true).to.have.property(prop);\n      initial = subject[prop];\n    }\n\n    fn();\n\n    var final = prop === undefined || prop === null ? subject() : subject[prop];\n    var msgObj = prop === undefined || prop === null ? initial : '.' + prop;\n\n    // This gets flagged because of the .by(delta) assertion\n    flag(this, 'deltaMsgObj', msgObj);\n    flag(this, 'initialDeltaValue', initial);\n    flag(this, 'finalDeltaValue', final);\n    flag(this, 'deltaBehavior', 'change');\n    flag(this, 'realDelta', final !== initial);\n\n    this.assert(\n      initial !== final\n      , 'expected ' + msgObj + ' to change'\n      , 'expected ' + msgObj + ' to not change'\n    );\n  }\n\n  Assertion.addMethod('change', assertChanges);\n  Assertion.addMethod('changes', assertChanges);\n\n  /**\n   * ### .increase(subject[, prop[, msg]])\n   *\n   * When one argument is provided, `.increase` asserts that the given function\n   * `subject` returns a greater number when it's invoked after invoking the\n   * target function compared to when it's invoked beforehand. `.increase` also\n   * causes all `.by` assertions that follow in the chain to assert how much\n   * greater of a number is returned. It's often best to assert that the return\n   * value increased by the expected amount, rather than asserting it increased\n   * by any amount.\n   *\n   *     var val = 1\n   *       , addTwo = function () { val += 2; }\n   *       , getVal = function () { return val; };\n   *\n   *     expect(addTwo).to.increase(getVal).by(2); // Recommended\n   *     expect(addTwo).to.increase(getVal); // Not recommended\n   *\n   * When two arguments are provided, `.increase` asserts that the value of the\n   * given object `subject`'s `prop` property is greater after invoking the\n   * target function compared to beforehand.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; };\n   *\n   *     expect(addTwo).to.increase(myObj, 'val').by(2); // Recommended\n   *     expect(addTwo).to.increase(myObj, 'val'); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.increase`. However, it's\n   * dangerous to do so. The problem is that it creates uncertain expectations\n   * by asserting that the subject either decreases, or that it stays the same.\n   * It's often best to identify the exact output that's expected, and then\n   * write an assertion that only accepts that exact output.\n   *\n   * When the subject is expected to decrease, it's often best to assert that it\n   * decreased by the expected amount.\n   *\n   *     var myObj = {val: 1}\n   *       , subtractTwo = function () { myObj.val -= 2; };\n   *\n   *     expect(subtractTwo).to.decrease(myObj, 'val').by(2); // Recommended\n   *     expect(subtractTwo).to.not.increase(myObj, 'val'); // Not recommended\n   *\n   * When the subject is expected to stay the same, it's often best to assert\n   * exactly that.\n   *\n   *     var myObj = {val: 1}\n   *       , noop = function () {};\n   *\n   *     expect(noop).to.not.change(myObj, 'val'); // Recommended\n   *     expect(noop).to.not.increase(myObj, 'val'); // Not recommended\n   *\n   * `.increase` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`. When not providing two arguments, always\n   * use the second form.\n   *\n   *     var myObj = {val: 1}\n   *       , noop = function () {};\n   *\n   *     expect(noop).to.increase(myObj, 'val', 'nooo why fail??');\n   *\n   *     var val = 1\n   *       , noop = function () {}\n   *       , getVal = function () { return val; };\n   *\n   *     expect(noop, 'nooo why fail??').to.increase(getVal);\n   *\n   * The alias `.increases` can be used interchangeably with `.increase`.\n   *\n   * @name increase\n   * @alias increases\n   * @param {String|Function} subject\n   * @param {String} prop name _optional_\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertIncreases (subject, prop, msg) {\n    if (msg) flag(this, 'message', msg);\n    var fn = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi');\n    new Assertion(fn, flagMsg, ssfi, true).is.a('function');\n\n    var initial;\n    if (!prop) {\n      new Assertion(subject, flagMsg, ssfi, true).is.a('function');\n      initial = subject();\n    } else {\n      new Assertion(subject, flagMsg, ssfi, true).to.have.property(prop);\n      initial = subject[prop];\n    }\n\n    // Make sure that the target is a number\n    new Assertion(initial, flagMsg, ssfi, true).is.a('number');\n\n    fn();\n\n    var final = prop === undefined || prop === null ? subject() : subject[prop];\n    var msgObj = prop === undefined || prop === null ? initial : '.' + prop;\n\n    flag(this, 'deltaMsgObj', msgObj);\n    flag(this, 'initialDeltaValue', initial);\n    flag(this, 'finalDeltaValue', final);\n    flag(this, 'deltaBehavior', 'increase');\n    flag(this, 'realDelta', final - initial);\n\n    this.assert(\n      final - initial > 0\n      , 'expected ' + msgObj + ' to increase'\n      , 'expected ' + msgObj + ' to not increase'\n    );\n  }\n\n  Assertion.addMethod('increase', assertIncreases);\n  Assertion.addMethod('increases', assertIncreases);\n\n  /**\n   * ### .decrease(subject[, prop[, msg]])\n   *\n   * When one argument is provided, `.decrease` asserts that the given function\n   * `subject` returns a lesser number when it's invoked after invoking the\n   * target function compared to when it's invoked beforehand. `.decrease` also\n   * causes all `.by` assertions that follow in the chain to assert how much\n   * lesser of a number is returned. It's often best to assert that the return\n   * value decreased by the expected amount, rather than asserting it decreased\n   * by any amount.\n   *\n   *     var val = 1\n   *       , subtractTwo = function () { val -= 2; }\n   *       , getVal = function () { return val; };\n   *\n   *     expect(subtractTwo).to.decrease(getVal).by(2); // Recommended\n   *     expect(subtractTwo).to.decrease(getVal); // Not recommended\n   *\n   * When two arguments are provided, `.decrease` asserts that the value of the\n   * given object `subject`'s `prop` property is lesser after invoking the\n   * target function compared to beforehand.\n   *\n   *     var myObj = {val: 1}\n   *       , subtractTwo = function () { myObj.val -= 2; };\n   *\n   *     expect(subtractTwo).to.decrease(myObj, 'val').by(2); // Recommended\n   *     expect(subtractTwo).to.decrease(myObj, 'val'); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.decrease`. However, it's\n   * dangerous to do so. The problem is that it creates uncertain expectations\n   * by asserting that the subject either increases, or that it stays the same.\n   * It's often best to identify the exact output that's expected, and then\n   * write an assertion that only accepts that exact output.\n   *\n   * When the subject is expected to increase, it's often best to assert that it\n   * increased by the expected amount.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; };\n   *\n   *     expect(addTwo).to.increase(myObj, 'val').by(2); // Recommended\n   *     expect(addTwo).to.not.decrease(myObj, 'val'); // Not recommended\n   *\n   * When the subject is expected to stay the same, it's often best to assert\n   * exactly that.\n   *\n   *     var myObj = {val: 1}\n   *       , noop = function () {};\n   *\n   *     expect(noop).to.not.change(myObj, 'val'); // Recommended\n   *     expect(noop).to.not.decrease(myObj, 'val'); // Not recommended\n   *\n   * `.decrease` accepts an optional `msg` argument which is a custom error\n   * message to show when the assertion fails. The message can also be given as\n   * the second argument to `expect`. When not providing two arguments, always\n   * use the second form.\n   *\n   *     var myObj = {val: 1}\n   *       , noop = function () {};\n   *\n   *     expect(noop).to.decrease(myObj, 'val', 'nooo why fail??');\n   *\n   *     var val = 1\n   *       , noop = function () {}\n   *       , getVal = function () { return val; };\n   *\n   *     expect(noop, 'nooo why fail??').to.decrease(getVal);\n   *\n   * The alias `.decreases` can be used interchangeably with `.decrease`.\n   *\n   * @name decrease\n   * @alias decreases\n   * @param {String|Function} subject\n   * @param {String} prop name _optional_\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertDecreases (subject, prop, msg) {\n    if (msg) flag(this, 'message', msg);\n    var fn = flag(this, 'object')\n      , flagMsg = flag(this, 'message')\n      , ssfi = flag(this, 'ssfi');\n    new Assertion(fn, flagMsg, ssfi, true).is.a('function');\n\n    var initial;\n    if (!prop) {\n      new Assertion(subject, flagMsg, ssfi, true).is.a('function');\n      initial = subject();\n    } else {\n      new Assertion(subject, flagMsg, ssfi, true).to.have.property(prop);\n      initial = subject[prop];\n    }\n\n    // Make sure that the target is a number\n    new Assertion(initial, flagMsg, ssfi, true).is.a('number');\n\n    fn();\n\n    var final = prop === undefined || prop === null ? subject() : subject[prop];\n    var msgObj = prop === undefined || prop === null ? initial : '.' + prop;\n\n    flag(this, 'deltaMsgObj', msgObj);\n    flag(this, 'initialDeltaValue', initial);\n    flag(this, 'finalDeltaValue', final);\n    flag(this, 'deltaBehavior', 'decrease');\n    flag(this, 'realDelta', initial - final);\n\n    this.assert(\n      final - initial < 0\n      , 'expected ' + msgObj + ' to decrease'\n      , 'expected ' + msgObj + ' to not decrease'\n    );\n  }\n\n  Assertion.addMethod('decrease', assertDecreases);\n  Assertion.addMethod('decreases', assertDecreases);\n\n  /**\n   * ### .by(delta[, msg])\n   *\n   * When following an `.increase` assertion in the chain, `.by` asserts that\n   * the subject of the `.increase` assertion increased by the given `delta`.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; };\n   *\n   *     expect(addTwo).to.increase(myObj, 'val').by(2);\n   *\n   * When following a `.decrease` assertion in the chain, `.by` asserts that the\n   * subject of the `.decrease` assertion decreased by the given `delta`.\n   *\n   *     var myObj = {val: 1}\n   *       , subtractTwo = function () { myObj.val -= 2; };\n   *\n   *     expect(subtractTwo).to.decrease(myObj, 'val').by(2);\n   *\n   * When following a `.change` assertion in the chain, `.by` asserts that the\n   * subject of the `.change` assertion either increased or decreased by the\n   * given `delta`. However, it's dangerous to use `.change.by`. The problem is\n   * that it creates uncertain expectations. It's often best to identify the\n   * exact output that's expected, and then write an assertion that only accepts\n   * that exact output.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; }\n   *       , subtractTwo = function () { myObj.val -= 2; };\n   *\n   *     expect(addTwo).to.increase(myObj, 'val').by(2); // Recommended\n   *     expect(addTwo).to.change(myObj, 'val').by(2); // Not recommended\n   *\n   *     expect(subtractTwo).to.decrease(myObj, 'val').by(2); // Recommended\n   *     expect(subtractTwo).to.change(myObj, 'val').by(2); // Not recommended\n   *\n   * Add `.not` earlier in the chain to negate `.by`. However, it's often best\n   * to assert that the subject changed by its expected delta, rather than\n   * asserting that it didn't change by one of countless unexpected deltas.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; };\n   *\n   *     // Recommended\n   *     expect(addTwo).to.increase(myObj, 'val').by(2);\n   *\n   *     // Not recommended\n   *     expect(addTwo).to.increase(myObj, 'val').but.not.by(3);\n   *\n   * `.by` accepts an optional `msg` argument which is a custom error message to\n   * show when the assertion fails. The message can also be given as the second\n   * argument to `expect`.\n   *\n   *     var myObj = {val: 1}\n   *       , addTwo = function () { myObj.val += 2; };\n   *\n   *     expect(addTwo).to.increase(myObj, 'val').by(3, 'nooo why fail??');\n   *     expect(addTwo, 'nooo why fail??').to.increase(myObj, 'val').by(3);\n   *\n   * @name by\n   * @param {Number} delta\n   * @param {String} msg _optional_\n   * @namespace BDD\n   * @api public\n   */\n\n  function assertDelta(delta, msg) {\n    if (msg) flag(this, 'message', msg);\n\n    var msgObj = flag(this, 'deltaMsgObj');\n    var initial = flag(this, 'initialDeltaValue');\n    var final = flag(this, 'finalDeltaValue');\n    var behavior = flag(this, 'deltaBehavior');\n    var realDelta = flag(this, 'realDelta');\n\n    var expression;\n    if (behavior === 'change') {\n      expression = Math.abs(final - initial) === Math.abs(delta);\n    } else {\n      expression = realDelta === Math.abs(delta);\n    }\n\n    this.assert(\n      expression\n      , 'expected ' + msgObj + ' to ' + behavior + ' by ' + delta\n      , 'expected ' + msgObj + ' to not ' + behavior + ' by ' + delta\n    );\n  }\n\n  Assertion.addMethod('by', assertDelta);\n\n  /**\n   * ### .extensible\n   *\n   * Asserts that the target is extensible, which means that new properties can\n   * be added to it. Primitives are never extensible.\n   *\n   *     expect({a: 1}).to.be.extensible;\n   *\n   * Add `.not` earlier in the chain to negate `.extensible`.\n   *\n   *     var nonExtensibleObject = Object.preventExtensions({})\n   *       , sealedObject = Object.seal({})\n   *       , frozenObject = Object.freeze({});\n   *\n   *     expect(nonExtensibleObject).to.not.be.extensible;\n   *     expect(sealedObject).to.not.be.extensible;\n   *     expect(frozenObject).to.not.be.extensible;\n   *     expect(1).to.not.be.extensible;\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect(1, 'nooo why fail??').to.be.extensible;\n   *\n   * @name extensible\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('extensible', function() {\n    var obj = flag(this, 'object');\n\n    // In ES5, if the argument to this method is a primitive, then it will cause a TypeError.\n    // In ES6, a non-object argument will be treated as if it was a non-extensible ordinary object, simply return false.\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isExtensible\n    // The following provides ES6 behavior for ES5 environments.\n\n    var isExtensible = obj === Object(obj) && Object.isExtensible(obj);\n\n    this.assert(\n      isExtensible\n      , 'expected #{this} to be extensible'\n      , 'expected #{this} to not be extensible'\n    );\n  });\n\n  /**\n   * ### .sealed\n   *\n   * Asserts that the target is sealed, which means that new properties can't be\n   * added to it, and its existing properties can't be reconfigured or deleted.\n   * However, it's possible that its existing properties can still be reassigned\n   * to different values. Primitives are always sealed.\n   *\n   *     var sealedObject = Object.seal({});\n   *     var frozenObject = Object.freeze({});\n   *\n   *     expect(sealedObject).to.be.sealed;\n   *     expect(frozenObject).to.be.sealed;\n   *     expect(1).to.be.sealed;\n   *\n   * Add `.not` earlier in the chain to negate `.sealed`.\n   *\n   *     expect({a: 1}).to.not.be.sealed;\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect({a: 1}, 'nooo why fail??').to.be.sealed;\n   *\n   * @name sealed\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('sealed', function() {\n    var obj = flag(this, 'object');\n\n    // In ES5, if the argument to this method is a primitive, then it will cause a TypeError.\n    // In ES6, a non-object argument will be treated as if it was a sealed ordinary object, simply return true.\n    // See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isSealed\n    // The following provides ES6 behavior for ES5 environments.\n\n    var isSealed = obj === Object(obj) ? Object.isSealed(obj) : true;\n\n    this.assert(\n      isSealed\n      , 'expected #{this} to be sealed'\n      , 'expected #{this} to not be sealed'\n    );\n  });\n\n  /**\n   * ### .frozen\n   *\n   * Asserts that the target is frozen, which means that new properties can't be\n   * added to it, and its existing properties can't be reassigned to different\n   * values, reconfigured, or deleted. Primitives are always frozen.\n   *\n   *     var frozenObject = Object.freeze({});\n   *\n   *     expect(frozenObject).to.be.frozen;\n   *     expect(1).to.be.frozen;\n   *\n   * Add `.not` earlier in the chain to negate `.frozen`.\n   *\n   *     expect({a: 1}).to.not.be.frozen;\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect({a: 1}, 'nooo why fail??').to.be.frozen;\n   *\n   * @name frozen\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('frozen', function() {\n    var obj = flag(this, 'object');\n\n    // In ES5, if the argument to this method is a primitive, then it will cause a TypeError.\n    // In ES6, a non-object argument will be treated as if it was a frozen ordinary object, simply return true.\n    // See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isFrozen\n    // The following provides ES6 behavior for ES5 environments.\n\n    var isFrozen = obj === Object(obj) ? Object.isFrozen(obj) : true;\n\n    this.assert(\n      isFrozen\n      , 'expected #{this} to be frozen'\n      , 'expected #{this} to not be frozen'\n    );\n  });\n\n  /**\n   * ### .finite\n   *\n   * Asserts that the target is a number, and isn't `NaN` or positive/negative\n   * `Infinity`.\n   *\n   *     expect(1).to.be.finite;\n   *\n   * Add `.not` earlier in the chain to negate `.finite`. However, it's\n   * dangerous to do so. The problem is that it creates uncertain expectations\n   * by asserting that the subject either isn't a number, or that it's `NaN`, or\n   * that it's positive `Infinity`, or that it's negative `Infinity`. It's often\n   * best to identify the exact output that's expected, and then write an\n   * assertion that only accepts that exact output.\n   *\n   * When the target isn't expected to be a number, it's often best to assert\n   * that it's the expected type, rather than asserting that it isn't one of\n   * many unexpected types.\n   *\n   *     expect('foo').to.be.a('string'); // Recommended\n   *     expect('foo').to.not.be.finite; // Not recommended\n   *\n   * When the target is expected to be `NaN`, it's often best to assert exactly\n   * that.\n   *\n   *     expect(NaN).to.be.NaN; // Recommended\n   *     expect(NaN).to.not.be.finite; // Not recommended\n   *\n   * When the target is expected to be positive infinity, it's often best to\n   * assert exactly that.\n   *\n   *     expect(Infinity).to.equal(Infinity); // Recommended\n   *     expect(Infinity).to.not.be.finite; // Not recommended\n   *\n   * When the target is expected to be negative infinity, it's often best to\n   * assert exactly that.\n   *\n   *     expect(-Infinity).to.equal(-Infinity); // Recommended\n   *     expect(-Infinity).to.not.be.finite; // Not recommended\n   *\n   * A custom error message can be given as the second argument to `expect`.\n   *\n   *     expect('foo', 'nooo why fail??').to.be.finite;\n   *\n   * @name finite\n   * @namespace BDD\n   * @api public\n   */\n\n  Assertion.addProperty('finite', function(msg) {\n    var obj = flag(this, 'object');\n\n    this.assert(\n        typeof obj === 'number' && isFinite(obj)\n      , 'expected #{this} to be a finite number'\n      , 'expected #{this} to not be a finite number'\n    );\n  });\n};\n","/*!\n * chai\n * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nmodule.exports = function (chai, util) {\n  /*!\n   * Chai dependencies.\n   */\n\n  var Assertion = chai.Assertion\n    , flag = util.flag;\n\n  /*!\n   * Module export.\n   */\n\n  /**\n   * ### assert(expression, message)\n   *\n   * Write your own test expressions.\n   *\n   *     assert('foo' !== 'bar', 'foo is not bar');\n   *     assert(Array.isArray([]), 'empty arrays are arrays');\n   *\n   * @param {Mixed} expression to test for truthiness\n   * @param {String} message to display on error\n   * @name assert\n   * @namespace Assert\n   * @api public\n   */\n\n  var assert = chai.assert = function (express, errmsg) {\n    var test = new Assertion(null, null, chai.assert, true);\n    test.assert(\n        express\n      , errmsg\n      , '[ negation message unavailable ]'\n    );\n  };\n\n  /**\n   * ### .fail([message])\n   * ### .fail(actual, expected, [message], [operator])\n   *\n   * Throw a failure. Node.js `assert` module-compatible.\n   *\n   *     assert.fail();\n   *     assert.fail(\"custom error message\");\n   *     assert.fail(1, 2);\n   *     assert.fail(1, 2, \"custom error message\");\n   *     assert.fail(1, 2, \"custom error message\", \">\");\n   *     assert.fail(1, 2, undefined, \">\");\n   *\n   * @name fail\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @param {String} operator\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.fail = function (actual, expected, message, operator) {\n    if (arguments.length < 2) {\n        // Comply with Node's fail([message]) interface\n\n        message = actual;\n        actual = undefined;\n    }\n\n    message = message || 'assert.fail()';\n    throw new chai.AssertionError(message, {\n        actual: actual\n      , expected: expected\n      , operator: operator\n    }, assert.fail);\n  };\n\n  /**\n   * ### .isOk(object, [message])\n   *\n   * Asserts that `object` is truthy.\n   *\n   *     assert.isOk('everything', 'everything is ok');\n   *     assert.isOk(false, 'this will fail');\n   *\n   * @name isOk\n   * @alias ok\n   * @param {Mixed} object to test\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isOk = function (val, msg) {\n    new Assertion(val, msg, assert.isOk, true).is.ok;\n  };\n\n  /**\n   * ### .isNotOk(object, [message])\n   *\n   * Asserts that `object` is falsy.\n   *\n   *     assert.isNotOk('everything', 'this will fail');\n   *     assert.isNotOk(false, 'this will pass');\n   *\n   * @name isNotOk\n   * @alias notOk\n   * @param {Mixed} object to test\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotOk = function (val, msg) {\n    new Assertion(val, msg, assert.isNotOk, true).is.not.ok;\n  };\n\n  /**\n   * ### .equal(actual, expected, [message])\n   *\n   * Asserts non-strict equality (`==`) of `actual` and `expected`.\n   *\n   *     assert.equal(3, '3', '== coerces values to strings');\n   *\n   * @name equal\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.equal = function (act, exp, msg) {\n    var test = new Assertion(act, msg, assert.equal, true);\n\n    test.assert(\n        exp == flag(test, 'object')\n      , 'expected #{this} to equal #{exp}'\n      , 'expected #{this} to not equal #{act}'\n      , exp\n      , act\n      , true\n    );\n  };\n\n  /**\n   * ### .notEqual(actual, expected, [message])\n   *\n   * Asserts non-strict inequality (`!=`) of `actual` and `expected`.\n   *\n   *     assert.notEqual(3, 4, 'these numbers are not equal');\n   *\n   * @name notEqual\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notEqual = function (act, exp, msg) {\n    var test = new Assertion(act, msg, assert.notEqual, true);\n\n    test.assert(\n        exp != flag(test, 'object')\n      , 'expected #{this} to not equal #{exp}'\n      , 'expected #{this} to equal #{act}'\n      , exp\n      , act\n      , true\n    );\n  };\n\n  /**\n   * ### .strictEqual(actual, expected, [message])\n   *\n   * Asserts strict equality (`===`) of `actual` and `expected`.\n   *\n   *     assert.strictEqual(true, true, 'these booleans are strictly equal');\n   *\n   * @name strictEqual\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.strictEqual = function (act, exp, msg) {\n    new Assertion(act, msg, assert.strictEqual, true).to.equal(exp);\n  };\n\n  /**\n   * ### .notStrictEqual(actual, expected, [message])\n   *\n   * Asserts strict inequality (`!==`) of `actual` and `expected`.\n   *\n   *     assert.notStrictEqual(3, '3', 'no coercion for strict equality');\n   *\n   * @name notStrictEqual\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notStrictEqual = function (act, exp, msg) {\n    new Assertion(act, msg, assert.notStrictEqual, true).to.not.equal(exp);\n  };\n\n  /**\n   * ### .deepEqual(actual, expected, [message])\n   *\n   * Asserts that `actual` is deeply equal to `expected`.\n   *\n   *     assert.deepEqual({ tea: 'green' }, { tea: 'green' });\n   *\n   * @name deepEqual\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @alias deepStrictEqual\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.deepEqual = assert.deepStrictEqual = function (act, exp, msg) {\n    new Assertion(act, msg, assert.deepEqual, true).to.eql(exp);\n  };\n\n  /**\n   * ### .notDeepEqual(actual, expected, [message])\n   *\n   * Assert that `actual` is not deeply equal to `expected`.\n   *\n   *     assert.notDeepEqual({ tea: 'green' }, { tea: 'jasmine' });\n   *\n   * @name notDeepEqual\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notDeepEqual = function (act, exp, msg) {\n    new Assertion(act, msg, assert.notDeepEqual, true).to.not.eql(exp);\n  };\n\n   /**\n   * ### .isAbove(valueToCheck, valueToBeAbove, [message])\n   *\n   * Asserts `valueToCheck` is strictly greater than (>) `valueToBeAbove`.\n   *\n   *     assert.isAbove(5, 2, '5 is strictly greater than 2');\n   *\n   * @name isAbove\n   * @param {Mixed} valueToCheck\n   * @param {Mixed} valueToBeAbove\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isAbove = function (val, abv, msg) {\n    new Assertion(val, msg, assert.isAbove, true).to.be.above(abv);\n  };\n\n   /**\n   * ### .isAtLeast(valueToCheck, valueToBeAtLeast, [message])\n   *\n   * Asserts `valueToCheck` is greater than or equal to (>=) `valueToBeAtLeast`.\n   *\n   *     assert.isAtLeast(5, 2, '5 is greater or equal to 2');\n   *     assert.isAtLeast(3, 3, '3 is greater or equal to 3');\n   *\n   * @name isAtLeast\n   * @param {Mixed} valueToCheck\n   * @param {Mixed} valueToBeAtLeast\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isAtLeast = function (val, atlst, msg) {\n    new Assertion(val, msg, assert.isAtLeast, true).to.be.least(atlst);\n  };\n\n   /**\n   * ### .isBelow(valueToCheck, valueToBeBelow, [message])\n   *\n   * Asserts `valueToCheck` is strictly less than (<) `valueToBeBelow`.\n   *\n   *     assert.isBelow(3, 6, '3 is strictly less than 6');\n   *\n   * @name isBelow\n   * @param {Mixed} valueToCheck\n   * @param {Mixed} valueToBeBelow\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isBelow = function (val, blw, msg) {\n    new Assertion(val, msg, assert.isBelow, true).to.be.below(blw);\n  };\n\n   /**\n   * ### .isAtMost(valueToCheck, valueToBeAtMost, [message])\n   *\n   * Asserts `valueToCheck` is less than or equal to (<=) `valueToBeAtMost`.\n   *\n   *     assert.isAtMost(3, 6, '3 is less than or equal to 6');\n   *     assert.isAtMost(4, 4, '4 is less than or equal to 4');\n   *\n   * @name isAtMost\n   * @param {Mixed} valueToCheck\n   * @param {Mixed} valueToBeAtMost\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isAtMost = function (val, atmst, msg) {\n    new Assertion(val, msg, assert.isAtMost, true).to.be.most(atmst);\n  };\n\n  /**\n   * ### .isTrue(value, [message])\n   *\n   * Asserts that `value` is true.\n   *\n   *     var teaServed = true;\n   *     assert.isTrue(teaServed, 'the tea has been served');\n   *\n   * @name isTrue\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isTrue = function (val, msg) {\n    new Assertion(val, msg, assert.isTrue, true).is['true'];\n  };\n\n  /**\n   * ### .isNotTrue(value, [message])\n   *\n   * Asserts that `value` is not true.\n   *\n   *     var tea = 'tasty chai';\n   *     assert.isNotTrue(tea, 'great, time for tea!');\n   *\n   * @name isNotTrue\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotTrue = function (val, msg) {\n    new Assertion(val, msg, assert.isNotTrue, true).to.not.equal(true);\n  };\n\n  /**\n   * ### .isFalse(value, [message])\n   *\n   * Asserts that `value` is false.\n   *\n   *     var teaServed = false;\n   *     assert.isFalse(teaServed, 'no tea yet? hmm...');\n   *\n   * @name isFalse\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isFalse = function (val, msg) {\n    new Assertion(val, msg, assert.isFalse, true).is['false'];\n  };\n\n  /**\n   * ### .isNotFalse(value, [message])\n   *\n   * Asserts that `value` is not false.\n   *\n   *     var tea = 'tasty chai';\n   *     assert.isNotFalse(tea, 'great, time for tea!');\n   *\n   * @name isNotFalse\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotFalse = function (val, msg) {\n    new Assertion(val, msg, assert.isNotFalse, true).to.not.equal(false);\n  };\n\n  /**\n   * ### .isNull(value, [message])\n   *\n   * Asserts that `value` is null.\n   *\n   *     assert.isNull(err, 'there was no error');\n   *\n   * @name isNull\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNull = function (val, msg) {\n    new Assertion(val, msg, assert.isNull, true).to.equal(null);\n  };\n\n  /**\n   * ### .isNotNull(value, [message])\n   *\n   * Asserts that `value` is not null.\n   *\n   *     var tea = 'tasty chai';\n   *     assert.isNotNull(tea, 'great, time for tea!');\n   *\n   * @name isNotNull\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotNull = function (val, msg) {\n    new Assertion(val, msg, assert.isNotNull, true).to.not.equal(null);\n  };\n\n  /**\n   * ### .isNaN\n   *\n   * Asserts that value is NaN.\n   *\n   *     assert.isNaN(NaN, 'NaN is NaN');\n   *\n   * @name isNaN\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNaN = function (val, msg) {\n    new Assertion(val, msg, assert.isNaN, true).to.be.NaN;\n  };\n\n  /**\n   * ### .isNotNaN\n   *\n   * Asserts that value is not NaN.\n   *\n   *     assert.isNotNaN(4, '4 is not NaN');\n   *\n   * @name isNotNaN\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n  assert.isNotNaN = function (val, msg) {\n    new Assertion(val, msg, assert.isNotNaN, true).not.to.be.NaN;\n  };\n\n  /**\n   * ### .exists\n   *\n   * Asserts that the target is neither `null` nor `undefined`.\n   *\n   *     var foo = 'hi';\n   *\n   *     assert.exists(foo, 'foo is neither `null` nor `undefined`');\n   *\n   * @name exists\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.exists = function (val, msg) {\n    new Assertion(val, msg, assert.exists, true).to.exist;\n  };\n\n  /**\n   * ### .notExists\n   *\n   * Asserts that the target is either `null` or `undefined`.\n   *\n   *     var bar = null\n   *       , baz;\n   *\n   *     assert.notExists(bar);\n   *     assert.notExists(baz, 'baz is either null or undefined');\n   *\n   * @name notExists\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notExists = function (val, msg) {\n    new Assertion(val, msg, assert.notExists, true).to.not.exist;\n  };\n\n  /**\n   * ### .isUndefined(value, [message])\n   *\n   * Asserts that `value` is `undefined`.\n   *\n   *     var tea;\n   *     assert.isUndefined(tea, 'no tea defined');\n   *\n   * @name isUndefined\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isUndefined = function (val, msg) {\n    new Assertion(val, msg, assert.isUndefined, true).to.equal(undefined);\n  };\n\n  /**\n   * ### .isDefined(value, [message])\n   *\n   * Asserts that `value` is not `undefined`.\n   *\n   *     var tea = 'cup of chai';\n   *     assert.isDefined(tea, 'tea has been defined');\n   *\n   * @name isDefined\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isDefined = function (val, msg) {\n    new Assertion(val, msg, assert.isDefined, true).to.not.equal(undefined);\n  };\n\n  /**\n   * ### .isFunction(value, [message])\n   *\n   * Asserts that `value` is a function.\n   *\n   *     function serveTea() { return 'cup of tea'; };\n   *     assert.isFunction(serveTea, 'great, we can have tea now');\n   *\n   * @name isFunction\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isFunction = function (val, msg) {\n    new Assertion(val, msg, assert.isFunction, true).to.be.a('function');\n  };\n\n  /**\n   * ### .isNotFunction(value, [message])\n   *\n   * Asserts that `value` is _not_ a function.\n   *\n   *     var serveTea = [ 'heat', 'pour', 'sip' ];\n   *     assert.isNotFunction(serveTea, 'great, we have listed the steps');\n   *\n   * @name isNotFunction\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotFunction = function (val, msg) {\n    new Assertion(val, msg, assert.isNotFunction, true).to.not.be.a('function');\n  };\n\n  /**\n   * ### .isObject(value, [message])\n   *\n   * Asserts that `value` is an object of type 'Object' (as revealed by `Object.prototype.toString`).\n   * _The assertion does not match subclassed objects._\n   *\n   *     var selection = { name: 'Chai', serve: 'with spices' };\n   *     assert.isObject(selection, 'tea selection is an object');\n   *\n   * @name isObject\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isObject = function (val, msg) {\n    new Assertion(val, msg, assert.isObject, true).to.be.a('object');\n  };\n\n  /**\n   * ### .isNotObject(value, [message])\n   *\n   * Asserts that `value` is _not_ an object of type 'Object' (as revealed by `Object.prototype.toString`).\n   *\n   *     var selection = 'chai'\n   *     assert.isNotObject(selection, 'tea selection is not an object');\n   *     assert.isNotObject(null, 'null is not an object');\n   *\n   * @name isNotObject\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotObject = function (val, msg) {\n    new Assertion(val, msg, assert.isNotObject, true).to.not.be.a('object');\n  };\n\n  /**\n   * ### .isArray(value, [message])\n   *\n   * Asserts that `value` is an array.\n   *\n   *     var menu = [ 'green', 'chai', 'oolong' ];\n   *     assert.isArray(menu, 'what kind of tea do we want?');\n   *\n   * @name isArray\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isArray = function (val, msg) {\n    new Assertion(val, msg, assert.isArray, true).to.be.an('array');\n  };\n\n  /**\n   * ### .isNotArray(value, [message])\n   *\n   * Asserts that `value` is _not_ an array.\n   *\n   *     var menu = 'green|chai|oolong';\n   *     assert.isNotArray(menu, 'what kind of tea do we want?');\n   *\n   * @name isNotArray\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotArray = function (val, msg) {\n    new Assertion(val, msg, assert.isNotArray, true).to.not.be.an('array');\n  };\n\n  /**\n   * ### .isString(value, [message])\n   *\n   * Asserts that `value` is a string.\n   *\n   *     var teaOrder = 'chai';\n   *     assert.isString(teaOrder, 'order placed');\n   *\n   * @name isString\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isString = function (val, msg) {\n    new Assertion(val, msg, assert.isString, true).to.be.a('string');\n  };\n\n  /**\n   * ### .isNotString(value, [message])\n   *\n   * Asserts that `value` is _not_ a string.\n   *\n   *     var teaOrder = 4;\n   *     assert.isNotString(teaOrder, 'order placed');\n   *\n   * @name isNotString\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotString = function (val, msg) {\n    new Assertion(val, msg, assert.isNotString, true).to.not.be.a('string');\n  };\n\n  /**\n   * ### .isNumber(value, [message])\n   *\n   * Asserts that `value` is a number.\n   *\n   *     var cups = 2;\n   *     assert.isNumber(cups, 'how many cups');\n   *\n   * @name isNumber\n   * @param {Number} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNumber = function (val, msg) {\n    new Assertion(val, msg, assert.isNumber, true).to.be.a('number');\n  };\n\n  /**\n   * ### .isNotNumber(value, [message])\n   *\n   * Asserts that `value` is _not_ a number.\n   *\n   *     var cups = '2 cups please';\n   *     assert.isNotNumber(cups, 'how many cups');\n   *\n   * @name isNotNumber\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotNumber = function (val, msg) {\n    new Assertion(val, msg, assert.isNotNumber, true).to.not.be.a('number');\n  };\n\n   /**\n   * ### .isFinite(value, [message])\n   *\n   * Asserts that `value` is a finite number. Unlike `.isNumber`, this will fail for `NaN` and `Infinity`.\n   *\n   *     var cups = 2;\n   *     assert.isFinite(cups, 'how many cups');\n   *\n   *     assert.isFinite(NaN); // throws\n   *\n   * @name isFinite\n   * @param {Number} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isFinite = function (val, msg) {\n    new Assertion(val, msg, assert.isFinite, true).to.be.finite;\n  };\n\n  /**\n   * ### .isBoolean(value, [message])\n   *\n   * Asserts that `value` is a boolean.\n   *\n   *     var teaReady = true\n   *       , teaServed = false;\n   *\n   *     assert.isBoolean(teaReady, 'is the tea ready');\n   *     assert.isBoolean(teaServed, 'has tea been served');\n   *\n   * @name isBoolean\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isBoolean = function (val, msg) {\n    new Assertion(val, msg, assert.isBoolean, true).to.be.a('boolean');\n  };\n\n  /**\n   * ### .isNotBoolean(value, [message])\n   *\n   * Asserts that `value` is _not_ a boolean.\n   *\n   *     var teaReady = 'yep'\n   *       , teaServed = 'nope';\n   *\n   *     assert.isNotBoolean(teaReady, 'is the tea ready');\n   *     assert.isNotBoolean(teaServed, 'has tea been served');\n   *\n   * @name isNotBoolean\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotBoolean = function (val, msg) {\n    new Assertion(val, msg, assert.isNotBoolean, true).to.not.be.a('boolean');\n  };\n\n  /**\n   * ### .typeOf(value, name, [message])\n   *\n   * Asserts that `value`'s type is `name`, as determined by\n   * `Object.prototype.toString`.\n   *\n   *     assert.typeOf({ tea: 'chai' }, 'object', 'we have an object');\n   *     assert.typeOf(['chai', 'jasmine'], 'array', 'we have an array');\n   *     assert.typeOf('tea', 'string', 'we have a string');\n   *     assert.typeOf(/tea/, 'regexp', 'we have a regular expression');\n   *     assert.typeOf(null, 'null', 'we have a null');\n   *     assert.typeOf(undefined, 'undefined', 'we have an undefined');\n   *\n   * @name typeOf\n   * @param {Mixed} value\n   * @param {String} name\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.typeOf = function (val, type, msg) {\n    new Assertion(val, msg, assert.typeOf, true).to.be.a(type);\n  };\n\n  /**\n   * ### .notTypeOf(value, name, [message])\n   *\n   * Asserts that `value`'s type is _not_ `name`, as determined by\n   * `Object.prototype.toString`.\n   *\n   *     assert.notTypeOf('tea', 'number', 'strings are not numbers');\n   *\n   * @name notTypeOf\n   * @param {Mixed} value\n   * @param {String} typeof name\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notTypeOf = function (val, type, msg) {\n    new Assertion(val, msg, assert.notTypeOf, true).to.not.be.a(type);\n  };\n\n  /**\n   * ### .instanceOf(object, constructor, [message])\n   *\n   * Asserts that `value` is an instance of `constructor`.\n   *\n   *     var Tea = function (name) { this.name = name; }\n   *       , chai = new Tea('chai');\n   *\n   *     assert.instanceOf(chai, Tea, 'chai is an instance of tea');\n   *\n   * @name instanceOf\n   * @param {Object} object\n   * @param {Constructor} constructor\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.instanceOf = function (val, type, msg) {\n    new Assertion(val, msg, assert.instanceOf, true).to.be.instanceOf(type);\n  };\n\n  /**\n   * ### .notInstanceOf(object, constructor, [message])\n   *\n   * Asserts `value` is not an instance of `constructor`.\n   *\n   *     var Tea = function (name) { this.name = name; }\n   *       , chai = new String('chai');\n   *\n   *     assert.notInstanceOf(chai, Tea, 'chai is not an instance of tea');\n   *\n   * @name notInstanceOf\n   * @param {Object} object\n   * @param {Constructor} constructor\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notInstanceOf = function (val, type, msg) {\n    new Assertion(val, msg, assert.notInstanceOf, true)\n      .to.not.be.instanceOf(type);\n  };\n\n  /**\n   * ### .include(haystack, needle, [message])\n   *\n   * Asserts that `haystack` includes `needle`. Can be used to assert the\n   * inclusion of a value in an array, a substring in a string, or a subset of\n   * properties in an object.\n   *\n   *     assert.include([1,2,3], 2, 'array contains value');\n   *     assert.include('foobar', 'foo', 'string contains substring');\n   *     assert.include({ foo: 'bar', hello: 'universe' }, { foo: 'bar' }, 'object contains property');\n   *\n   * Strict equality (===) is used. When asserting the inclusion of a value in\n   * an array, the array is searched for an element that's strictly equal to the\n   * given value. When asserting a subset of properties in an object, the object\n   * is searched for the given property keys, checking that each one is present\n   * and strictly equal to the given property value. For instance:\n   *\n   *     var obj1 = {a: 1}\n   *       , obj2 = {b: 2};\n   *     assert.include([obj1, obj2], obj1);\n   *     assert.include({foo: obj1, bar: obj2}, {foo: obj1});\n   *     assert.include({foo: obj1, bar: obj2}, {foo: obj1, bar: obj2});\n   *\n   * @name include\n   * @param {Array|String} haystack\n   * @param {Mixed} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.include = function (exp, inc, msg) {\n    new Assertion(exp, msg, assert.include, true).include(inc);\n  };\n\n  /**\n   * ### .notInclude(haystack, needle, [message])\n   *\n   * Asserts that `haystack` does not include `needle`. Can be used to assert\n   * the absence of a value in an array, a substring in a string, or a subset of\n   * properties in an object.\n   *\n   *     assert.notInclude([1,2,3], 4, \"array doesn't contain value\");\n   *     assert.notInclude('foobar', 'baz', \"string doesn't contain substring\");\n   *     assert.notInclude({ foo: 'bar', hello: 'universe' }, { foo: 'baz' }, 'object doesn't contain property');\n   *\n   * Strict equality (===) is used. When asserting the absence of a value in an\n   * array, the array is searched to confirm the absence of an element that's\n   * strictly equal to the given value. When asserting a subset of properties in\n   * an object, the object is searched to confirm that at least one of the given\n   * property keys is either not present or not strictly equal to the given\n   * property value. For instance:\n   *\n   *     var obj1 = {a: 1}\n   *       , obj2 = {b: 2};\n   *     assert.notInclude([obj1, obj2], {a: 1});\n   *     assert.notInclude({foo: obj1, bar: obj2}, {foo: {a: 1}});\n   *     assert.notInclude({foo: obj1, bar: obj2}, {foo: obj1, bar: {b: 2}});\n   *\n   * @name notInclude\n   * @param {Array|String} haystack\n   * @param {Mixed} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notInclude = function (exp, inc, msg) {\n    new Assertion(exp, msg, assert.notInclude, true).not.include(inc);\n  };\n\n  /**\n   * ### .deepInclude(haystack, needle, [message])\n   *\n   * Asserts that `haystack` includes `needle`. Can be used to assert the\n   * inclusion of a value in an array or a subset of properties in an object.\n   * Deep equality is used.\n   *\n   *     var obj1 = {a: 1}\n   *       , obj2 = {b: 2};\n   *     assert.deepInclude([obj1, obj2], {a: 1});\n   *     assert.deepInclude({foo: obj1, bar: obj2}, {foo: {a: 1}});\n   *     assert.deepInclude({foo: obj1, bar: obj2}, {foo: {a: 1}, bar: {b: 2}});\n   *\n   * @name deepInclude\n   * @param {Array|String} haystack\n   * @param {Mixed} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.deepInclude = function (exp, inc, msg) {\n    new Assertion(exp, msg, assert.deepInclude, true).deep.include(inc);\n  };\n\n  /**\n   * ### .notDeepInclude(haystack, needle, [message])\n   *\n   * Asserts that `haystack` does not include `needle`. Can be used to assert\n   * the absence of a value in an array or a subset of properties in an object.\n   * Deep equality is used.\n   *\n   *     var obj1 = {a: 1}\n   *       , obj2 = {b: 2};\n   *     assert.notDeepInclude([obj1, obj2], {a: 9});\n   *     assert.notDeepInclude({foo: obj1, bar: obj2}, {foo: {a: 9}});\n   *     assert.notDeepInclude({foo: obj1, bar: obj2}, {foo: {a: 1}, bar: {b: 9}});\n   *\n   * @name notDeepInclude\n   * @param {Array|String} haystack\n   * @param {Mixed} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notDeepInclude = function (exp, inc, msg) {\n    new Assertion(exp, msg, assert.notDeepInclude, true).not.deep.include(inc);\n  };\n\n  /**\n   * ### .nestedInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' includes 'needle'.\n   * Can be used to assert the inclusion of a subset of properties in an\n   * object.\n   * Enables the use of dot- and bracket-notation for referencing nested\n   * properties.\n   * '[]' and '.' in property names can be escaped using double backslashes.\n   *\n   *     assert.nestedInclude({'.a': {'b': 'x'}}, {'\\\\.a.[b]': 'x'});\n   *     assert.nestedInclude({'a': {'[b]': 'x'}}, {'a.\\\\[b\\\\]': 'x'});\n   *\n   * @name nestedInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.nestedInclude = function (exp, inc, msg) {\n    new Assertion(exp, msg, assert.nestedInclude, true).nested.include(inc);\n  };\n\n  /**\n   * ### .notNestedInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' does not include 'needle'.\n   * Can be used to assert the absence of a subset of properties in an\n   * object.\n   * Enables the use of dot- and bracket-notation for referencing nested\n   * properties.\n   * '[]' and '.' in property names can be escaped using double backslashes.\n   *\n   *     assert.notNestedInclude({'.a': {'b': 'x'}}, {'\\\\.a.b': 'y'});\n   *     assert.notNestedInclude({'a': {'[b]': 'x'}}, {'a.\\\\[b\\\\]': 'y'});\n   *\n   * @name notNestedInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notNestedInclude = function (exp, inc, msg) {\n    new Assertion(exp, msg, assert.notNestedInclude, true)\n      .not.nested.include(inc);\n  };\n\n  /**\n   * ### .deepNestedInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' includes 'needle'.\n   * Can be used to assert the inclusion of a subset of properties in an\n   * object while checking for deep equality.\n   * Enables the use of dot- and bracket-notation for referencing nested\n   * properties.\n   * '[]' and '.' in property names can be escaped using double backslashes.\n   *\n   *     assert.deepNestedInclude({a: {b: [{x: 1}]}}, {'a.b[0]': {x: 1}});\n   *     assert.deepNestedInclude({'.a': {'[b]': {x: 1}}}, {'\\\\.a.\\\\[b\\\\]': {x: 1}});\n   *\n   * @name deepNestedInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.deepNestedInclude = function(exp, inc, msg) {\n    new Assertion(exp, msg, assert.deepNestedInclude, true)\n      .deep.nested.include(inc);\n  };\n\n  /**\n   * ### .notDeepNestedInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' does not include 'needle'.\n   * Can be used to assert the absence of a subset of properties in an\n   * object while checking for deep equality.\n   * Enables the use of dot- and bracket-notation for referencing nested\n   * properties.\n   * '[]' and '.' in property names can be escaped using double backslashes.\n   *\n   *     assert.notDeepNestedInclude({a: {b: [{x: 1}]}}, {'a.b[0]': {y: 1}})\n   *     assert.notDeepNestedInclude({'.a': {'[b]': {x: 1}}}, {'\\\\.a.\\\\[b\\\\]': {y: 2}});\n   *\n   * @name notDeepNestedInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notDeepNestedInclude = function(exp, inc, msg) {\n    new Assertion(exp, msg, assert.notDeepNestedInclude, true)\n      .not.deep.nested.include(inc);\n  };\n\n  /**\n   * ### .ownInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' includes 'needle'.\n   * Can be used to assert the inclusion of a subset of properties in an\n   * object while ignoring inherited properties.\n   *\n   *     assert.ownInclude({ a: 1 }, { a: 1 });\n   *\n   * @name ownInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.ownInclude = function(exp, inc, msg) {\n    new Assertion(exp, msg, assert.ownInclude, true).own.include(inc);\n  };\n\n  /**\n   * ### .notOwnInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' includes 'needle'.\n   * Can be used to assert the absence of a subset of properties in an\n   * object while ignoring inherited properties.\n   *\n   *     Object.prototype.b = 2;\n   *\n   *     assert.notOwnInclude({ a: 1 }, { b: 2 });\n   *\n   * @name notOwnInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notOwnInclude = function(exp, inc, msg) {\n    new Assertion(exp, msg, assert.notOwnInclude, true).not.own.include(inc);\n  };\n\n  /**\n   * ### .deepOwnInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' includes 'needle'.\n   * Can be used to assert the inclusion of a subset of properties in an\n   * object while ignoring inherited properties and checking for deep equality.\n   *\n   *      assert.deepOwnInclude({a: {b: 2}}, {a: {b: 2}});\n   *\n   * @name deepOwnInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.deepOwnInclude = function(exp, inc, msg) {\n    new Assertion(exp, msg, assert.deepOwnInclude, true)\n      .deep.own.include(inc);\n  };\n\n   /**\n   * ### .notDeepOwnInclude(haystack, needle, [message])\n   *\n   * Asserts that 'haystack' includes 'needle'.\n   * Can be used to assert the absence of a subset of properties in an\n   * object while ignoring inherited properties and checking for deep equality.\n   *\n   *      assert.notDeepOwnInclude({a: {b: 2}}, {a: {c: 3}});\n   *\n   * @name notDeepOwnInclude\n   * @param {Object} haystack\n   * @param {Object} needle\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notDeepOwnInclude = function(exp, inc, msg) {\n    new Assertion(exp, msg, assert.notDeepOwnInclude, true)\n      .not.deep.own.include(inc);\n  };\n\n  /**\n   * ### .match(value, regexp, [message])\n   *\n   * Asserts that `value` matches the regular expression `regexp`.\n   *\n   *     assert.match('foobar', /^foo/, 'regexp matches');\n   *\n   * @name match\n   * @param {Mixed} value\n   * @param {RegExp} regexp\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.match = function (exp, re, msg) {\n    new Assertion(exp, msg, assert.match, true).to.match(re);\n  };\n\n  /**\n   * ### .notMatch(value, regexp, [message])\n   *\n   * Asserts that `value` does not match the regular expression `regexp`.\n   *\n   *     assert.notMatch('foobar', /^foo/, 'regexp does not match');\n   *\n   * @name notMatch\n   * @param {Mixed} value\n   * @param {RegExp} regexp\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notMatch = function (exp, re, msg) {\n    new Assertion(exp, msg, assert.notMatch, true).to.not.match(re);\n  };\n\n  /**\n   * ### .property(object, property, [message])\n   *\n   * Asserts that `object` has a direct or inherited property named by\n   * `property`.\n   *\n   *     assert.property({ tea: { green: 'matcha' }}, 'tea');\n   *     assert.property({ tea: { green: 'matcha' }}, 'toString');\n   *\n   * @name property\n   * @param {Object} object\n   * @param {String} property\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.property = function (obj, prop, msg) {\n    new Assertion(obj, msg, assert.property, true).to.have.property(prop);\n  };\n\n  /**\n   * ### .notProperty(object, property, [message])\n   *\n   * Asserts that `object` does _not_ have a direct or inherited property named\n   * by `property`.\n   *\n   *     assert.notProperty({ tea: { green: 'matcha' }}, 'coffee');\n   *\n   * @name notProperty\n   * @param {Object} object\n   * @param {String} property\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notProperty = function (obj, prop, msg) {\n    new Assertion(obj, msg, assert.notProperty, true)\n      .to.not.have.property(prop);\n  };\n\n  /**\n   * ### .propertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` has a direct or inherited property named by\n   * `property` with a value given by `value`. Uses a strict equality check\n   * (===).\n   *\n   *     assert.propertyVal({ tea: 'is good' }, 'tea', 'is good');\n   *\n   * @name propertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.propertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.propertyVal, true)\n      .to.have.property(prop, val);\n  };\n\n  /**\n   * ### .notPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` does _not_ have a direct or inherited property named\n   * by `property` with value given by `value`. Uses a strict equality check\n   * (===).\n   *\n   *     assert.notPropertyVal({ tea: 'is good' }, 'tea', 'is bad');\n   *     assert.notPropertyVal({ tea: 'is good' }, 'coffee', 'is good');\n   *\n   * @name notPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.notPropertyVal, true)\n      .to.not.have.property(prop, val);\n  };\n\n  /**\n   * ### .deepPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` has a direct or inherited property named by\n   * `property` with a value given by `value`. Uses a deep equality check.\n   *\n   *     assert.deepPropertyVal({ tea: { green: 'matcha' } }, 'tea', { green: 'matcha' });\n   *\n   * @name deepPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.deepPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.deepPropertyVal, true)\n      .to.have.deep.property(prop, val);\n  };\n\n  /**\n   * ### .notDeepPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` does _not_ have a direct or inherited property named\n   * by `property` with value given by `value`. Uses a deep equality check.\n   *\n   *     assert.notDeepPropertyVal({ tea: { green: 'matcha' } }, 'tea', { black: 'matcha' });\n   *     assert.notDeepPropertyVal({ tea: { green: 'matcha' } }, 'tea', { green: 'oolong' });\n   *     assert.notDeepPropertyVal({ tea: { green: 'matcha' } }, 'coffee', { green: 'matcha' });\n   *\n   * @name notDeepPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notDeepPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.notDeepPropertyVal, true)\n      .to.not.have.deep.property(prop, val);\n  };\n\n  /**\n   * ### .ownProperty(object, property, [message])\n   *\n   * Asserts that `object` has a direct property named by `property`. Inherited\n   * properties aren't checked.\n   *\n   *     assert.ownProperty({ tea: { green: 'matcha' }}, 'tea');\n   *\n   * @name ownProperty\n   * @param {Object} object\n   * @param {String} property\n   * @param {String} message\n   * @api public\n   */\n\n  assert.ownProperty = function (obj, prop, msg) {\n    new Assertion(obj, msg, assert.ownProperty, true)\n      .to.have.own.property(prop);\n  };\n\n  /**\n   * ### .notOwnProperty(object, property, [message])\n   *\n   * Asserts that `object` does _not_ have a direct property named by\n   * `property`. Inherited properties aren't checked.\n   *\n   *     assert.notOwnProperty({ tea: { green: 'matcha' }}, 'coffee');\n   *     assert.notOwnProperty({}, 'toString');\n   *\n   * @name notOwnProperty\n   * @param {Object} object\n   * @param {String} property\n   * @param {String} message\n   * @api public\n   */\n\n  assert.notOwnProperty = function (obj, prop, msg) {\n    new Assertion(obj, msg, assert.notOwnProperty, true)\n      .to.not.have.own.property(prop);\n  };\n\n  /**\n   * ### .ownPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` has a direct property named by `property` and a value\n   * equal to the provided `value`. Uses a strict equality check (===).\n   * Inherited properties aren't checked.\n   *\n   *     assert.ownPropertyVal({ coffee: 'is good'}, 'coffee', 'is good');\n   *\n   * @name ownPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @api public\n   */\n\n  assert.ownPropertyVal = function (obj, prop, value, msg) {\n    new Assertion(obj, msg, assert.ownPropertyVal, true)\n      .to.have.own.property(prop, value);\n  };\n\n  /**\n   * ### .notOwnPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` does _not_ have a direct property named by `property`\n   * with a value equal to the provided `value`. Uses a strict equality check\n   * (===). Inherited properties aren't checked.\n   *\n   *     assert.notOwnPropertyVal({ tea: 'is better'}, 'tea', 'is worse');\n   *     assert.notOwnPropertyVal({}, 'toString', Object.prototype.toString);\n   *\n   * @name notOwnPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @api public\n   */\n\n  assert.notOwnPropertyVal = function (obj, prop, value, msg) {\n    new Assertion(obj, msg, assert.notOwnPropertyVal, true)\n      .to.not.have.own.property(prop, value);\n  };\n\n  /**\n   * ### .deepOwnPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` has a direct property named by `property` and a value\n   * equal to the provided `value`. Uses a deep equality check. Inherited\n   * properties aren't checked.\n   *\n   *     assert.deepOwnPropertyVal({ tea: { green: 'matcha' } }, 'tea', { green: 'matcha' });\n   *\n   * @name deepOwnPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @api public\n   */\n\n  assert.deepOwnPropertyVal = function (obj, prop, value, msg) {\n    new Assertion(obj, msg, assert.deepOwnPropertyVal, true)\n      .to.have.deep.own.property(prop, value);\n  };\n\n  /**\n   * ### .notDeepOwnPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` does _not_ have a direct property named by `property`\n   * with a value equal to the provided `value`. Uses a deep equality check.\n   * Inherited properties aren't checked.\n   *\n   *     assert.notDeepOwnPropertyVal({ tea: { green: 'matcha' } }, 'tea', { black: 'matcha' });\n   *     assert.notDeepOwnPropertyVal({ tea: { green: 'matcha' } }, 'tea', { green: 'oolong' });\n   *     assert.notDeepOwnPropertyVal({ tea: { green: 'matcha' } }, 'coffee', { green: 'matcha' });\n   *     assert.notDeepOwnPropertyVal({}, 'toString', Object.prototype.toString);\n   *\n   * @name notDeepOwnPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @api public\n   */\n\n  assert.notDeepOwnPropertyVal = function (obj, prop, value, msg) {\n    new Assertion(obj, msg, assert.notDeepOwnPropertyVal, true)\n      .to.not.have.deep.own.property(prop, value);\n  };\n\n  /**\n   * ### .nestedProperty(object, property, [message])\n   *\n   * Asserts that `object` has a direct or inherited property named by\n   * `property`, which can be a string using dot- and bracket-notation for\n   * nested reference.\n   *\n   *     assert.nestedProperty({ tea: { green: 'matcha' }}, 'tea.green');\n   *\n   * @name nestedProperty\n   * @param {Object} object\n   * @param {String} property\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.nestedProperty = function (obj, prop, msg) {\n    new Assertion(obj, msg, assert.nestedProperty, true)\n      .to.have.nested.property(prop);\n  };\n\n  /**\n   * ### .notNestedProperty(object, property, [message])\n   *\n   * Asserts that `object` does _not_ have a property named by `property`, which\n   * can be a string using dot- and bracket-notation for nested reference. The\n   * property cannot exist on the object nor anywhere in its prototype chain.\n   *\n   *     assert.notNestedProperty({ tea: { green: 'matcha' }}, 'tea.oolong');\n   *\n   * @name notNestedProperty\n   * @param {Object} object\n   * @param {String} property\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notNestedProperty = function (obj, prop, msg) {\n    new Assertion(obj, msg, assert.notNestedProperty, true)\n      .to.not.have.nested.property(prop);\n  };\n\n  /**\n   * ### .nestedPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` has a property named by `property` with value given\n   * by `value`. `property` can use dot- and bracket-notation for nested\n   * reference. Uses a strict equality check (===).\n   *\n   *     assert.nestedPropertyVal({ tea: { green: 'matcha' }}, 'tea.green', 'matcha');\n   *\n   * @name nestedPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.nestedPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.nestedPropertyVal, true)\n      .to.have.nested.property(prop, val);\n  };\n\n  /**\n   * ### .notNestedPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` does _not_ have a property named by `property` with\n   * value given by `value`. `property` can use dot- and bracket-notation for\n   * nested reference. Uses a strict equality check (===).\n   *\n   *     assert.notNestedPropertyVal({ tea: { green: 'matcha' }}, 'tea.green', 'konacha');\n   *     assert.notNestedPropertyVal({ tea: { green: 'matcha' }}, 'coffee.green', 'matcha');\n   *\n   * @name notNestedPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notNestedPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.notNestedPropertyVal, true)\n      .to.not.have.nested.property(prop, val);\n  };\n\n  /**\n   * ### .deepNestedPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` has a property named by `property` with a value given\n   * by `value`. `property` can use dot- and bracket-notation for nested\n   * reference. Uses a deep equality check.\n   *\n   *     assert.deepNestedPropertyVal({ tea: { green: { matcha: 'yum' } } }, 'tea.green', { matcha: 'yum' });\n   *\n   * @name deepNestedPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.deepNestedPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.deepNestedPropertyVal, true)\n      .to.have.deep.nested.property(prop, val);\n  };\n\n  /**\n   * ### .notDeepNestedPropertyVal(object, property, value, [message])\n   *\n   * Asserts that `object` does _not_ have a property named by `property` with\n   * value given by `value`. `property` can use dot- and bracket-notation for\n   * nested reference. Uses a deep equality check.\n   *\n   *     assert.notDeepNestedPropertyVal({ tea: { green: { matcha: 'yum' } } }, 'tea.green', { oolong: 'yum' });\n   *     assert.notDeepNestedPropertyVal({ tea: { green: { matcha: 'yum' } } }, 'tea.green', { matcha: 'yuck' });\n   *     assert.notDeepNestedPropertyVal({ tea: { green: { matcha: 'yum' } } }, 'tea.black', { matcha: 'yum' });\n   *\n   * @name notDeepNestedPropertyVal\n   * @param {Object} object\n   * @param {String} property\n   * @param {Mixed} value\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notDeepNestedPropertyVal = function (obj, prop, val, msg) {\n    new Assertion(obj, msg, assert.notDeepNestedPropertyVal, true)\n      .to.not.have.deep.nested.property(prop, val);\n  }\n\n  /**\n   * ### .lengthOf(object, length, [message])\n   *\n   * Asserts that `object` has a `length` or `size` with the expected value.\n   *\n   *     assert.lengthOf([1,2,3], 3, 'array has length of 3');\n   *     assert.lengthOf('foobar', 6, 'string has length of 6');\n   *     assert.lengthOf(new Set([1,2,3]), 3, 'set has size of 3');\n   *     assert.lengthOf(new Map([['a',1],['b',2],['c',3]]), 3, 'map has size of 3');\n   *\n   * @name lengthOf\n   * @param {Mixed} object\n   * @param {Number} length\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.lengthOf = function (exp, len, msg) {\n    new Assertion(exp, msg, assert.lengthOf, true).to.have.lengthOf(len);\n  };\n\n  /**\n   * ### .hasAnyKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has at least one of the `keys` provided.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.hasAnyKeys({foo: 1, bar: 2, baz: 3}, ['foo', 'iDontExist', 'baz']);\n   *     assert.hasAnyKeys({foo: 1, bar: 2, baz: 3}, {foo: 30, iDontExist: 99, baz: 1337});\n   *     assert.hasAnyKeys(new Map([[{foo: 1}, 'bar'], ['key', 'value']]), [{foo: 1}, 'key']);\n   *     assert.hasAnyKeys(new Set([{foo: 'bar'}, 'anotherKey']), [{foo: 'bar'}, 'anotherKey']);\n   *\n   * @name hasAnyKeys\n   * @param {Mixed} object\n   * @param {Array|Object} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.hasAnyKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.hasAnyKeys, true).to.have.any.keys(keys);\n  }\n\n  /**\n   * ### .hasAllKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has all and only all of the `keys` provided.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.hasAllKeys({foo: 1, bar: 2, baz: 3}, ['foo', 'bar', 'baz']);\n   *     assert.hasAllKeys({foo: 1, bar: 2, baz: 3}, {foo: 30, bar: 99, baz: 1337]);\n   *     assert.hasAllKeys(new Map([[{foo: 1}, 'bar'], ['key', 'value']]), [{foo: 1}, 'key']);\n   *     assert.hasAllKeys(new Set([{foo: 'bar'}, 'anotherKey'], [{foo: 'bar'}, 'anotherKey']);\n   *\n   * @name hasAllKeys\n   * @param {Mixed} object\n   * @param {String[]} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.hasAllKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.hasAllKeys, true).to.have.all.keys(keys);\n  }\n\n  /**\n   * ### .containsAllKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has all of the `keys` provided but may have more keys not listed.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.containsAllKeys({foo: 1, bar: 2, baz: 3}, ['foo', 'baz']);\n   *     assert.containsAllKeys({foo: 1, bar: 2, baz: 3}, ['foo', 'bar', 'baz']);\n   *     assert.containsAllKeys({foo: 1, bar: 2, baz: 3}, {foo: 30, baz: 1337});\n   *     assert.containsAllKeys({foo: 1, bar: 2, baz: 3}, {foo: 30, bar: 99, baz: 1337});\n   *     assert.containsAllKeys(new Map([[{foo: 1}, 'bar'], ['key', 'value']]), [{foo: 1}]);\n   *     assert.containsAllKeys(new Map([[{foo: 1}, 'bar'], ['key', 'value']]), [{foo: 1}, 'key']);\n   *     assert.containsAllKeys(new Set([{foo: 'bar'}, 'anotherKey'], [{foo: 'bar'}]);\n   *     assert.containsAllKeys(new Set([{foo: 'bar'}, 'anotherKey'], [{foo: 'bar'}, 'anotherKey']);\n   *\n   * @name containsAllKeys\n   * @param {Mixed} object\n   * @param {String[]} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.containsAllKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.containsAllKeys, true)\n      .to.contain.all.keys(keys);\n  }\n\n  /**\n   * ### .doesNotHaveAnyKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has none of the `keys` provided.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.doesNotHaveAnyKeys({foo: 1, bar: 2, baz: 3}, ['one', 'two', 'example']);\n   *     assert.doesNotHaveAnyKeys({foo: 1, bar: 2, baz: 3}, {one: 1, two: 2, example: 'foo'});\n   *     assert.doesNotHaveAnyKeys(new Map([[{foo: 1}, 'bar'], ['key', 'value']]), [{one: 'two'}, 'example']);\n   *     assert.doesNotHaveAnyKeys(new Set([{foo: 'bar'}, 'anotherKey'], [{one: 'two'}, 'example']);\n   *\n   * @name doesNotHaveAnyKeys\n   * @param {Mixed} object\n   * @param {String[]} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotHaveAnyKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.doesNotHaveAnyKeys, true)\n      .to.not.have.any.keys(keys);\n  }\n\n  /**\n   * ### .doesNotHaveAllKeys(object, [keys], [message])\n   *\n   * Asserts that `object` does not have at least one of the `keys` provided.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.doesNotHaveAllKeys({foo: 1, bar: 2, baz: 3}, ['one', 'two', 'example']);\n   *     assert.doesNotHaveAllKeys({foo: 1, bar: 2, baz: 3}, {one: 1, two: 2, example: 'foo'});\n   *     assert.doesNotHaveAllKeys(new Map([[{foo: 1}, 'bar'], ['key', 'value']]), [{one: 'two'}, 'example']);\n   *     assert.doesNotHaveAllKeys(new Set([{foo: 'bar'}, 'anotherKey'], [{one: 'two'}, 'example']);\n   *\n   * @name doesNotHaveAllKeys\n   * @param {Mixed} object\n   * @param {String[]} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotHaveAllKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.doesNotHaveAllKeys, true)\n      .to.not.have.all.keys(keys);\n  }\n\n  /**\n   * ### .hasAnyDeepKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has at least one of the `keys` provided.\n   * Since Sets and Maps can have objects as keys you can use this assertion to perform\n   * a deep comparison.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.hasAnyDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [1, 2]]), {one: 'one'});\n   *     assert.hasAnyDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [1, 2]]), [{one: 'one'}, {two: 'two'}]);\n   *     assert.hasAnyDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [{two: 'two'}, 'valueTwo']]), [{one: 'one'}, {two: 'two'}]);\n   *     assert.hasAnyDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), {one: 'one'});\n   *     assert.hasAnyDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), [{one: 'one'}, {three: 'three'}]);\n   *     assert.hasAnyDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), [{one: 'one'}, {two: 'two'}]);\n   *\n   * @name hasAnyDeepKeys\n   * @param {Mixed} object\n   * @param {Array|Object} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.hasAnyDeepKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.hasAnyDeepKeys, true)\n      .to.have.any.deep.keys(keys);\n  }\n\n /**\n   * ### .hasAllDeepKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has all and only all of the `keys` provided.\n   * Since Sets and Maps can have objects as keys you can use this assertion to perform\n   * a deep comparison.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.hasAllDeepKeys(new Map([[{one: 'one'}, 'valueOne']]), {one: 'one'});\n   *     assert.hasAllDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [{two: 'two'}, 'valueTwo']]), [{one: 'one'}, {two: 'two'}]);\n   *     assert.hasAllDeepKeys(new Set([{one: 'one'}]), {one: 'one'});\n   *     assert.hasAllDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), [{one: 'one'}, {two: 'two'}]);\n   *\n   * @name hasAllDeepKeys\n   * @param {Mixed} object\n   * @param {Array|Object} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.hasAllDeepKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.hasAllDeepKeys, true)\n      .to.have.all.deep.keys(keys);\n  }\n\n /**\n   * ### .containsAllDeepKeys(object, [keys], [message])\n   *\n   * Asserts that `object` contains all of the `keys` provided.\n   * Since Sets and Maps can have objects as keys you can use this assertion to perform\n   * a deep comparison.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.containsAllDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [1, 2]]), {one: 'one'});\n   *     assert.containsAllDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [{two: 'two'}, 'valueTwo']]), [{one: 'one'}, {two: 'two'}]);\n   *     assert.containsAllDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), {one: 'one'});\n   *     assert.containsAllDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), [{one: 'one'}, {two: 'two'}]);\n   *\n   * @name containsAllDeepKeys\n   * @param {Mixed} object\n   * @param {Array|Object} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.containsAllDeepKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.containsAllDeepKeys, true)\n      .to.contain.all.deep.keys(keys);\n  }\n\n /**\n   * ### .doesNotHaveAnyDeepKeys(object, [keys], [message])\n   *\n   * Asserts that `object` has none of the `keys` provided.\n   * Since Sets and Maps can have objects as keys you can use this assertion to perform\n   * a deep comparison.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.doesNotHaveAnyDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [1, 2]]), {thisDoesNot: 'exist'});\n   *     assert.doesNotHaveAnyDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [{two: 'two'}, 'valueTwo']]), [{twenty: 'twenty'}, {fifty: 'fifty'}]);\n   *     assert.doesNotHaveAnyDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), {twenty: 'twenty'});\n   *     assert.doesNotHaveAnyDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), [{twenty: 'twenty'}, {fifty: 'fifty'}]);\n   *\n   * @name doesNotHaveAnyDeepKeys\n   * @param {Mixed} object\n   * @param {Array|Object} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotHaveAnyDeepKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.doesNotHaveAnyDeepKeys, true)\n      .to.not.have.any.deep.keys(keys);\n  }\n\n /**\n   * ### .doesNotHaveAllDeepKeys(object, [keys], [message])\n   *\n   * Asserts that `object` does not have at least one of the `keys` provided.\n   * Since Sets and Maps can have objects as keys you can use this assertion to perform\n   * a deep comparison.\n   * You can also provide a single object instead of a `keys` array and its keys\n   * will be used as the expected set of keys.\n   *\n   *     assert.doesNotHaveAllDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [1, 2]]), {thisDoesNot: 'exist'});\n   *     assert.doesNotHaveAllDeepKeys(new Map([[{one: 'one'}, 'valueOne'], [{two: 'two'}, 'valueTwo']]), [{twenty: 'twenty'}, {one: 'one'}]);\n   *     assert.doesNotHaveAllDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), {twenty: 'twenty'});\n   *     assert.doesNotHaveAllDeepKeys(new Set([{one: 'one'}, {two: 'two'}]), [{one: 'one'}, {fifty: 'fifty'}]);\n   *\n   * @name doesNotHaveAllDeepKeys\n   * @param {Mixed} object\n   * @param {Array|Object} keys\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotHaveAllDeepKeys = function (obj, keys, msg) {\n    new Assertion(obj, msg, assert.doesNotHaveAllDeepKeys, true)\n      .to.not.have.all.deep.keys(keys);\n  }\n\n /**\n   * ### .throws(fn, [errorLike/string/regexp], [string/regexp], [message])\n   *\n   * If `errorLike` is an `Error` constructor, asserts that `fn` will throw an error that is an\n   * instance of `errorLike`.\n   * If `errorLike` is an `Error` instance, asserts that the error thrown is the same\n   * instance as `errorLike`.\n   * If `errMsgMatcher` is provided, it also asserts that the error thrown will have a\n   * message matching `errMsgMatcher`.\n   *\n   *     assert.throws(fn, 'Error thrown must have this msg');\n   *     assert.throws(fn, /Error thrown must have a msg that matches this/);\n   *     assert.throws(fn, ReferenceError);\n   *     assert.throws(fn, errorInstance);\n   *     assert.throws(fn, ReferenceError, 'Error thrown must be a ReferenceError and have this msg');\n   *     assert.throws(fn, errorInstance, 'Error thrown must be the same errorInstance and have this msg');\n   *     assert.throws(fn, ReferenceError, /Error thrown must be a ReferenceError and match this/);\n   *     assert.throws(fn, errorInstance, /Error thrown must be the same errorInstance and match this/);\n   *\n   * @name throws\n   * @alias throw\n   * @alias Throw\n   * @param {Function} fn\n   * @param {ErrorConstructor|Error} errorLike\n   * @param {RegExp|String} errMsgMatcher\n   * @param {String} message\n   * @see https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error#Error_types\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.throws = function (fn, errorLike, errMsgMatcher, msg) {\n    if ('string' === typeof errorLike || errorLike instanceof RegExp) {\n      errMsgMatcher = errorLike;\n      errorLike = null;\n    }\n\n    var assertErr = new Assertion(fn, msg, assert.throws, true)\n      .to.throw(errorLike, errMsgMatcher);\n    return flag(assertErr, 'object');\n  };\n\n  /**\n   * ### .doesNotThrow(fn, [errorLike/string/regexp], [string/regexp], [message])\n   *\n   * If `errorLike` is an `Error` constructor, asserts that `fn` will _not_ throw an error that is an\n   * instance of `errorLike`.\n   * If `errorLike` is an `Error` instance, asserts that the error thrown is _not_ the same\n   * instance as `errorLike`.\n   * If `errMsgMatcher` is provided, it also asserts that the error thrown will _not_ have a\n   * message matching `errMsgMatcher`.\n   *\n   *     assert.doesNotThrow(fn, 'Any Error thrown must not have this message');\n   *     assert.doesNotThrow(fn, /Any Error thrown must not match this/);\n   *     assert.doesNotThrow(fn, Error);\n   *     assert.doesNotThrow(fn, errorInstance);\n   *     assert.doesNotThrow(fn, Error, 'Error must not have this message');\n   *     assert.doesNotThrow(fn, errorInstance, 'Error must not have this message');\n   *     assert.doesNotThrow(fn, Error, /Error must not match this/);\n   *     assert.doesNotThrow(fn, errorInstance, /Error must not match this/);\n   *\n   * @name doesNotThrow\n   * @param {Function} fn\n   * @param {ErrorConstructor} errorLike\n   * @param {RegExp|String} errMsgMatcher\n   * @param {String} message\n   * @see https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error#Error_types\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotThrow = function (fn, errorLike, errMsgMatcher, msg) {\n    if ('string' === typeof errorLike || errorLike instanceof RegExp) {\n      errMsgMatcher = errorLike;\n      errorLike = null;\n    }\n\n    new Assertion(fn, msg, assert.doesNotThrow, true)\n      .to.not.throw(errorLike, errMsgMatcher);\n  };\n\n  /**\n   * ### .operator(val1, operator, val2, [message])\n   *\n   * Compares two values using `operator`.\n   *\n   *     assert.operator(1, '<', 2, 'everything is ok');\n   *     assert.operator(1, '>', 2, 'this will fail');\n   *\n   * @name operator\n   * @param {Mixed} val1\n   * @param {String} operator\n   * @param {Mixed} val2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.operator = function (val, operator, val2, msg) {\n    var ok;\n    switch(operator) {\n      case '==':\n        ok = val == val2;\n        break;\n      case '===':\n        ok = val === val2;\n        break;\n      case '>':\n        ok = val > val2;\n        break;\n      case '>=':\n        ok = val >= val2;\n        break;\n      case '<':\n        ok = val < val2;\n        break;\n      case '<=':\n        ok = val <= val2;\n        break;\n      case '!=':\n        ok = val != val2;\n        break;\n      case '!==':\n        ok = val !== val2;\n        break;\n      default:\n        msg = msg ? msg + ': ' : msg;\n        throw new chai.AssertionError(\n          msg + 'Invalid operator \"' + operator + '\"',\n          undefined,\n          assert.operator\n        );\n    }\n    var test = new Assertion(ok, msg, assert.operator, true);\n    test.assert(\n        true === flag(test, 'object')\n      , 'expected ' + util.inspect(val) + ' to be ' + operator + ' ' + util.inspect(val2)\n      , 'expected ' + util.inspect(val) + ' to not be ' + operator + ' ' + util.inspect(val2) );\n  };\n\n  /**\n   * ### .closeTo(actual, expected, delta, [message])\n   *\n   * Asserts that the target is equal `expected`, to within a +/- `delta` range.\n   *\n   *     assert.closeTo(1.5, 1, 0.5, 'numbers are close');\n   *\n   * @name closeTo\n   * @param {Number} actual\n   * @param {Number} expected\n   * @param {Number} delta\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.closeTo = function (act, exp, delta, msg) {\n    new Assertion(act, msg, assert.closeTo, true).to.be.closeTo(exp, delta);\n  };\n\n  /**\n   * ### .approximately(actual, expected, delta, [message])\n   *\n   * Asserts that the target is equal `expected`, to within a +/- `delta` range.\n   *\n   *     assert.approximately(1.5, 1, 0.5, 'numbers are close');\n   *\n   * @name approximately\n   * @param {Number} actual\n   * @param {Number} expected\n   * @param {Number} delta\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.approximately = function (act, exp, delta, msg) {\n    new Assertion(act, msg, assert.approximately, true)\n      .to.be.approximately(exp, delta);\n  };\n\n  /**\n   * ### .sameMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` have the same members in any order. Uses a\n   * strict equality check (===).\n   *\n   *     assert.sameMembers([ 1, 2, 3 ], [ 2, 1, 3 ], 'same members');\n   *\n   * @name sameMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.sameMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.sameMembers, true)\n      .to.have.same.members(set2);\n  }\n\n  /**\n   * ### .notSameMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` don't have the same members in any order.\n   * Uses a strict equality check (===).\n   *\n   *     assert.notSameMembers([ 1, 2, 3 ], [ 5, 1, 3 ], 'not same members');\n   *\n   * @name notSameMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notSameMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.notSameMembers, true)\n      .to.not.have.same.members(set2);\n  }\n\n  /**\n   * ### .sameDeepMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` have the same members in any order. Uses a\n   * deep equality check.\n   *\n   *     assert.sameDeepMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [{ b: 2 }, { a: 1 }, { c: 3 }], 'same deep members');\n   *\n   * @name sameDeepMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.sameDeepMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.sameDeepMembers, true)\n      .to.have.same.deep.members(set2);\n  }\n\n  /**\n   * ### .notSameDeepMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` don't have the same members in any order.\n   * Uses a deep equality check.\n   *\n   *     assert.notSameDeepMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [{ b: 2 }, { a: 1 }, { f: 5 }], 'not same deep members');\n   *\n   * @name notSameDeepMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notSameDeepMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.notSameDeepMembers, true)\n      .to.not.have.same.deep.members(set2);\n  }\n\n  /**\n   * ### .sameOrderedMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` have the same members in the same order.\n   * Uses a strict equality check (===).\n   *\n   *     assert.sameOrderedMembers([ 1, 2, 3 ], [ 1, 2, 3 ], 'same ordered members');\n   *\n   * @name sameOrderedMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.sameOrderedMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.sameOrderedMembers, true)\n      .to.have.same.ordered.members(set2);\n  }\n\n  /**\n   * ### .notSameOrderedMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` don't have the same members in the same\n   * order. Uses a strict equality check (===).\n   *\n   *     assert.notSameOrderedMembers([ 1, 2, 3 ], [ 2, 1, 3 ], 'not same ordered members');\n   *\n   * @name notSameOrderedMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notSameOrderedMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.notSameOrderedMembers, true)\n      .to.not.have.same.ordered.members(set2);\n  }\n\n  /**\n   * ### .sameDeepOrderedMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` have the same members in the same order.\n   * Uses a deep equality check.\n   *\n   *     assert.sameDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { a: 1 }, { b: 2 }, { c: 3 } ], 'same deep ordered members');\n   *\n   * @name sameDeepOrderedMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.sameDeepOrderedMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.sameDeepOrderedMembers, true)\n      .to.have.same.deep.ordered.members(set2);\n  }\n\n  /**\n   * ### .notSameDeepOrderedMembers(set1, set2, [message])\n   *\n   * Asserts that `set1` and `set2` don't have the same members in the same\n   * order. Uses a deep equality check.\n   *\n   *     assert.notSameDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { a: 1 }, { b: 2 }, { z: 5 } ], 'not same deep ordered members');\n   *     assert.notSameDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { b: 2 }, { a: 1 }, { c: 3 } ], 'not same deep ordered members');\n   *\n   * @name notSameDeepOrderedMembers\n   * @param {Array} set1\n   * @param {Array} set2\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notSameDeepOrderedMembers = function (set1, set2, msg) {\n    new Assertion(set1, msg, assert.notSameDeepOrderedMembers, true)\n      .to.not.have.same.deep.ordered.members(set2);\n  }\n\n  /**\n   * ### .includeMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` is included in `superset` in any order. Uses a\n   * strict equality check (===). Duplicates are ignored.\n   *\n   *     assert.includeMembers([ 1, 2, 3 ], [ 2, 1, 2 ], 'include members');\n   *\n   * @name includeMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.includeMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.includeMembers, true)\n      .to.include.members(subset);\n  }\n\n  /**\n   * ### .notIncludeMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` isn't included in `superset` in any order. Uses a\n   * strict equality check (===). Duplicates are ignored.\n   *\n   *     assert.notIncludeMembers([ 1, 2, 3 ], [ 5, 1 ], 'not include members');\n   *\n   * @name notIncludeMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notIncludeMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.notIncludeMembers, true)\n      .to.not.include.members(subset);\n  }\n\n  /**\n   * ### .includeDeepMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` is included in `superset` in any order. Uses a deep\n   * equality check. Duplicates are ignored.\n   *\n   *     assert.includeDeepMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { b: 2 }, { a: 1 }, { b: 2 } ], 'include deep members');\n   *\n   * @name includeDeepMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.includeDeepMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.includeDeepMembers, true)\n      .to.include.deep.members(subset);\n  }\n\n  /**\n   * ### .notIncludeDeepMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` isn't included in `superset` in any order. Uses a\n   * deep equality check. Duplicates are ignored.\n   *\n   *     assert.notIncludeDeepMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { b: 2 }, { f: 5 } ], 'not include deep members');\n   *\n   * @name notIncludeDeepMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notIncludeDeepMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.notIncludeDeepMembers, true)\n      .to.not.include.deep.members(subset);\n  }\n\n  /**\n   * ### .includeOrderedMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` is included in `superset` in the same order\n   * beginning with the first element in `superset`. Uses a strict equality\n   * check (===).\n   *\n   *     assert.includeOrderedMembers([ 1, 2, 3 ], [ 1, 2 ], 'include ordered members');\n   *\n   * @name includeOrderedMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.includeOrderedMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.includeOrderedMembers, true)\n      .to.include.ordered.members(subset);\n  }\n\n  /**\n   * ### .notIncludeOrderedMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` isn't included in `superset` in the same order\n   * beginning with the first element in `superset`. Uses a strict equality\n   * check (===).\n   *\n   *     assert.notIncludeOrderedMembers([ 1, 2, 3 ], [ 2, 1 ], 'not include ordered members');\n   *     assert.notIncludeOrderedMembers([ 1, 2, 3 ], [ 2, 3 ], 'not include ordered members');\n   *\n   * @name notIncludeOrderedMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notIncludeOrderedMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.notIncludeOrderedMembers, true)\n      .to.not.include.ordered.members(subset);\n  }\n\n  /**\n   * ### .includeDeepOrderedMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` is included in `superset` in the same order\n   * beginning with the first element in `superset`. Uses a deep equality\n   * check.\n   *\n   *     assert.includeDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { a: 1 }, { b: 2 } ], 'include deep ordered members');\n   *\n   * @name includeDeepOrderedMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.includeDeepOrderedMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.includeDeepOrderedMembers, true)\n      .to.include.deep.ordered.members(subset);\n  }\n\n  /**\n   * ### .notIncludeDeepOrderedMembers(superset, subset, [message])\n   *\n   * Asserts that `subset` isn't included in `superset` in the same order\n   * beginning with the first element in `superset`. Uses a deep equality\n   * check.\n   *\n   *     assert.notIncludeDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { a: 1 }, { f: 5 } ], 'not include deep ordered members');\n   *     assert.notIncludeDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { b: 2 }, { a: 1 } ], 'not include deep ordered members');\n   *     assert.notIncludeDeepOrderedMembers([ { a: 1 }, { b: 2 }, { c: 3 } ], [ { b: 2 }, { c: 3 } ], 'not include deep ordered members');\n   *\n   * @name notIncludeDeepOrderedMembers\n   * @param {Array} superset\n   * @param {Array} subset\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.notIncludeDeepOrderedMembers = function (superset, subset, msg) {\n    new Assertion(superset, msg, assert.notIncludeDeepOrderedMembers, true)\n      .to.not.include.deep.ordered.members(subset);\n  }\n\n  /**\n   * ### .oneOf(inList, list, [message])\n   *\n   * Asserts that non-object, non-array value `inList` appears in the flat array `list`.\n   *\n   *     assert.oneOf(1, [ 2, 1 ], 'Not found in list');\n   *\n   * @name oneOf\n   * @param {*} inList\n   * @param {Array<*>} list\n   * @param {String} message\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.oneOf = function (inList, list, msg) {\n    new Assertion(inList, msg, assert.oneOf, true).to.be.oneOf(list);\n  }\n\n  /**\n   * ### .changes(function, object, property, [message])\n   *\n   * Asserts that a function changes the value of a property.\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 22 };\n   *     assert.changes(fn, obj, 'val');\n   *\n   * @name changes\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.changes = function (fn, obj, prop, msg) {\n    if (arguments.length === 3 && typeof obj === 'function') {\n      msg = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.changes, true).to.change(obj, prop);\n  }\n\n   /**\n   * ### .changesBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function changes the value of a property by an amount (delta).\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val += 2 };\n   *     assert.changesBy(fn, obj, 'val', 2);\n   *\n   * @name changesBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.changesBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.changesBy, true)\n      .to.change(obj, prop).by(delta);\n  }\n\n   /**\n   * ### .doesNotChange(function, object, property, [message])\n   *\n   * Asserts that a function does not change the value of a property.\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { console.log('foo'); };\n   *     assert.doesNotChange(fn, obj, 'val');\n   *\n   * @name doesNotChange\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotChange = function (fn, obj, prop, msg) {\n    if (arguments.length === 3 && typeof obj === 'function') {\n      msg = prop;\n      prop = null;\n    }\n\n    return new Assertion(fn, msg, assert.doesNotChange, true)\n      .to.not.change(obj, prop);\n  }\n\n  /**\n   * ### .changesButNotBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function does not change the value of a property or of a function's return value by an amount (delta)\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val += 10 };\n   *     assert.changesButNotBy(fn, obj, 'val', 5);\n   *\n   * @name changesButNotBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.changesButNotBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.changesButNotBy, true)\n      .to.change(obj, prop).but.not.by(delta);\n  }\n\n  /**\n   * ### .increases(function, object, property, [message])\n   *\n   * Asserts that a function increases a numeric object property.\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 13 };\n   *     assert.increases(fn, obj, 'val');\n   *\n   * @name increases\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.increases = function (fn, obj, prop, msg) {\n    if (arguments.length === 3 && typeof obj === 'function') {\n      msg = prop;\n      prop = null;\n    }\n\n    return new Assertion(fn, msg, assert.increases, true)\n      .to.increase(obj, prop);\n  }\n\n  /**\n   * ### .increasesBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function increases a numeric object property or a function's return value by an amount (delta).\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val += 10 };\n   *     assert.increasesBy(fn, obj, 'val', 10);\n   *\n   * @name increasesBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.increasesBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.increasesBy, true)\n      .to.increase(obj, prop).by(delta);\n  }\n\n  /**\n   * ### .doesNotIncrease(function, object, property, [message])\n   *\n   * Asserts that a function does not increase a numeric object property.\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 8 };\n   *     assert.doesNotIncrease(fn, obj, 'val');\n   *\n   * @name doesNotIncrease\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotIncrease = function (fn, obj, prop, msg) {\n    if (arguments.length === 3 && typeof obj === 'function') {\n      msg = prop;\n      prop = null;\n    }\n\n    return new Assertion(fn, msg, assert.doesNotIncrease, true)\n      .to.not.increase(obj, prop);\n  }\n\n  /**\n   * ### .increasesButNotBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function does not increase a numeric object property or function's return value by an amount (delta).\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 15 };\n   *     assert.increasesButNotBy(fn, obj, 'val', 10);\n   *\n   * @name increasesButNotBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.increasesButNotBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.increasesButNotBy, true)\n      .to.increase(obj, prop).but.not.by(delta);\n  }\n\n  /**\n   * ### .decreases(function, object, property, [message])\n   *\n   * Asserts that a function decreases a numeric object property.\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 5 };\n   *     assert.decreases(fn, obj, 'val');\n   *\n   * @name decreases\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.decreases = function (fn, obj, prop, msg) {\n    if (arguments.length === 3 && typeof obj === 'function') {\n      msg = prop;\n      prop = null;\n    }\n\n    return new Assertion(fn, msg, assert.decreases, true)\n      .to.decrease(obj, prop);\n  }\n\n  /**\n   * ### .decreasesBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function decreases a numeric object property or a function's return value by an amount (delta)\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val -= 5 };\n   *     assert.decreasesBy(fn, obj, 'val', 5);\n   *\n   * @name decreasesBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.decreasesBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.decreasesBy, true)\n      .to.decrease(obj, prop).by(delta);\n  }\n\n  /**\n   * ### .doesNotDecrease(function, object, property, [message])\n   *\n   * Asserts that a function does not decreases a numeric object property.\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 15 };\n   *     assert.doesNotDecrease(fn, obj, 'val');\n   *\n   * @name doesNotDecrease\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotDecrease = function (fn, obj, prop, msg) {\n    if (arguments.length === 3 && typeof obj === 'function') {\n      msg = prop;\n      prop = null;\n    }\n\n    return new Assertion(fn, msg, assert.doesNotDecrease, true)\n      .to.not.decrease(obj, prop);\n  }\n\n  /**\n   * ### .doesNotDecreaseBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function does not decreases a numeric object property or a function's return value by an amount (delta)\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 5 };\n   *     assert.doesNotDecreaseBy(fn, obj, 'val', 1);\n   *\n   * @name doesNotDecreaseBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.doesNotDecreaseBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    return new Assertion(fn, msg, assert.doesNotDecreaseBy, true)\n      .to.not.decrease(obj, prop).by(delta);\n  }\n\n  /**\n   * ### .decreasesButNotBy(function, object, property, delta, [message])\n   *\n   * Asserts that a function does not decreases a numeric object property or a function's return value by an amount (delta)\n   *\n   *     var obj = { val: 10 };\n   *     var fn = function() { obj.val = 5 };\n   *     assert.decreasesButNotBy(fn, obj, 'val', 1);\n   *\n   * @name decreasesButNotBy\n   * @param {Function} modifier function\n   * @param {Object} object or getter function\n   * @param {String} property name _optional_\n   * @param {Number} change amount (delta)\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.decreasesButNotBy = function (fn, obj, prop, delta, msg) {\n    if (arguments.length === 4 && typeof obj === 'function') {\n      var tmpMsg = delta;\n      delta = prop;\n      msg = tmpMsg;\n    } else if (arguments.length === 3) {\n      delta = prop;\n      prop = null;\n    }\n\n    new Assertion(fn, msg, assert.decreasesButNotBy, true)\n      .to.decrease(obj, prop).but.not.by(delta);\n  }\n\n  /*!\n   * ### .ifError(object)\n   *\n   * Asserts if value is not a false value, and throws if it is a true value.\n   * This is added to allow for chai to be a drop-in replacement for Node's\n   * assert class.\n   *\n   *     var err = new Error('I am a custom error');\n   *     assert.ifError(err); // Rethrows err!\n   *\n   * @name ifError\n   * @param {Object} object\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.ifError = function (val) {\n    if (val) {\n      throw(val);\n    }\n  };\n\n  /**\n   * ### .isExtensible(object)\n   *\n   * Asserts that `object` is extensible (can have new properties added to it).\n   *\n   *     assert.isExtensible({});\n   *\n   * @name isExtensible\n   * @alias extensible\n   * @param {Object} object\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isExtensible = function (obj, msg) {\n    new Assertion(obj, msg, assert.isExtensible, true).to.be.extensible;\n  };\n\n  /**\n   * ### .isNotExtensible(object)\n   *\n   * Asserts that `object` is _not_ extensible.\n   *\n   *     var nonExtensibleObject = Object.preventExtensions({});\n   *     var sealedObject = Object.seal({});\n   *     var frozenObject = Object.freeze({});\n   *\n   *     assert.isNotExtensible(nonExtensibleObject);\n   *     assert.isNotExtensible(sealedObject);\n   *     assert.isNotExtensible(frozenObject);\n   *\n   * @name isNotExtensible\n   * @alias notExtensible\n   * @param {Object} object\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotExtensible = function (obj, msg) {\n    new Assertion(obj, msg, assert.isNotExtensible, true).to.not.be.extensible;\n  };\n\n  /**\n   * ### .isSealed(object)\n   *\n   * Asserts that `object` is sealed (cannot have new properties added to it\n   * and its existing properties cannot be removed).\n   *\n   *     var sealedObject = Object.seal({});\n   *     var frozenObject = Object.seal({});\n   *\n   *     assert.isSealed(sealedObject);\n   *     assert.isSealed(frozenObject);\n   *\n   * @name isSealed\n   * @alias sealed\n   * @param {Object} object\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isSealed = function (obj, msg) {\n    new Assertion(obj, msg, assert.isSealed, true).to.be.sealed;\n  };\n\n  /**\n   * ### .isNotSealed(object)\n   *\n   * Asserts that `object` is _not_ sealed.\n   *\n   *     assert.isNotSealed({});\n   *\n   * @name isNotSealed\n   * @alias notSealed\n   * @param {Object} object\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotSealed = function (obj, msg) {\n    new Assertion(obj, msg, assert.isNotSealed, true).to.not.be.sealed;\n  };\n\n  /**\n   * ### .isFrozen(object)\n   *\n   * Asserts that `object` is frozen (cannot have new properties added to it\n   * and its existing properties cannot be modified).\n   *\n   *     var frozenObject = Object.freeze({});\n   *     assert.frozen(frozenObject);\n   *\n   * @name isFrozen\n   * @alias frozen\n   * @param {Object} object\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isFrozen = function (obj, msg) {\n    new Assertion(obj, msg, assert.isFrozen, true).to.be.frozen;\n  };\n\n  /**\n   * ### .isNotFrozen(object)\n   *\n   * Asserts that `object` is _not_ frozen.\n   *\n   *     assert.isNotFrozen({});\n   *\n   * @name isNotFrozen\n   * @alias notFrozen\n   * @param {Object} object\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotFrozen = function (obj, msg) {\n    new Assertion(obj, msg, assert.isNotFrozen, true).to.not.be.frozen;\n  };\n\n  /**\n   * ### .isEmpty(target)\n   *\n   * Asserts that the target does not contain any values.\n   * For arrays and strings, it checks the `length` property.\n   * For `Map` and `Set` instances, it checks the `size` property.\n   * For non-function objects, it gets the count of own\n   * enumerable string keys.\n   *\n   *     assert.isEmpty([]);\n   *     assert.isEmpty('');\n   *     assert.isEmpty(new Map);\n   *     assert.isEmpty({});\n   *\n   * @name isEmpty\n   * @alias empty\n   * @param {Object|Array|String|Map|Set} target\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isEmpty = function(val, msg) {\n    new Assertion(val, msg, assert.isEmpty, true).to.be.empty;\n  };\n\n  /**\n   * ### .isNotEmpty(target)\n   *\n   * Asserts that the target contains values.\n   * For arrays and strings, it checks the `length` property.\n   * For `Map` and `Set` instances, it checks the `size` property.\n   * For non-function objects, it gets the count of own\n   * enumerable string keys.\n   *\n   *     assert.isNotEmpty([1, 2]);\n   *     assert.isNotEmpty('34');\n   *     assert.isNotEmpty(new Set([5, 6]));\n   *     assert.isNotEmpty({ key: 7 });\n   *\n   * @name isNotEmpty\n   * @alias notEmpty\n   * @param {Object|Array|String|Map|Set} target\n   * @param {String} message _optional_\n   * @namespace Assert\n   * @api public\n   */\n\n  assert.isNotEmpty = function(val, msg) {\n    new Assertion(val, msg, assert.isNotEmpty, true).to.not.be.empty;\n  };\n\n  /*!\n   * Aliases.\n   */\n\n  (function alias(name, as){\n    assert[as] = assert[name];\n    return alias;\n  })\n  ('isOk', 'ok')\n  ('isNotOk', 'notOk')\n  ('throws', 'throw')\n  ('throws', 'Throw')\n  ('isExtensible', 'extensible')\n  ('isNotExtensible', 'notExtensible')\n  ('isSealed', 'sealed')\n  ('isNotSealed', 'notSealed')\n  ('isFrozen', 'frozen')\n  ('isNotFrozen', 'notFrozen')\n  ('isEmpty', 'empty')\n  ('isNotEmpty', 'notEmpty');\n};\n","/*!\n * chai\n * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nmodule.exports = function (chai, util) {\n  chai.expect = function (val, message) {\n    return new chai.Assertion(val, message);\n  };\n\n  /**\n   * ### .fail([message])\n   * ### .fail(actual, expected, [message], [operator])\n   *\n   * Throw a failure.\n   *\n   *     expect.fail();\n   *     expect.fail(\"custom error message\");\n   *     expect.fail(1, 2);\n   *     expect.fail(1, 2, \"custom error message\");\n   *     expect.fail(1, 2, \"custom error message\", \">\");\n   *     expect.fail(1, 2, undefined, \">\");\n   *\n   * @name fail\n   * @param {Mixed} actual\n   * @param {Mixed} expected\n   * @param {String} message\n   * @param {String} operator\n   * @namespace BDD\n   * @api public\n   */\n\n  chai.expect.fail = function (actual, expected, message, operator) {\n    if (arguments.length < 2) {\n        message = actual;\n        actual = undefined;\n    }\n\n    message = message || 'expect.fail()';\n    throw new chai.AssertionError(message, {\n        actual: actual\n      , expected: expected\n      , operator: operator\n    }, chai.expect.fail);\n  };\n};\n","/*!\n * chai\n * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nmodule.exports = function (chai, util) {\n  var Assertion = chai.Assertion;\n\n  function loadShould () {\n    // explicitly define this method as function as to have it's name to include as `ssfi`\n    function shouldGetter() {\n      if (this instanceof String\n          || this instanceof Number\n          || this instanceof Boolean\n          || typeof Symbol === 'function' && this instanceof Symbol\n          || typeof BigInt === 'function' && this instanceof BigInt) {\n        return new Assertion(this.valueOf(), null, shouldGetter);\n      }\n      return new Assertion(this, null, shouldGetter);\n    }\n    function shouldSetter(value) {\n      // See https://github.com/chaijs/chai/issues/86: this makes\n      // `whatever.should = someValue` actually set `someValue`, which is\n      // especially useful for `global.should = require('chai').should()`.\n      //\n      // Note that we have to use [[DefineProperty]] instead of [[Put]]\n      // since otherwise we would trigger this very setter!\n      Object.defineProperty(this, 'should', {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    }\n    // modify Object.prototype to have `should`\n    Object.defineProperty(Object.prototype, 'should', {\n      set: shouldSetter\n      , get: shouldGetter\n      , configurable: true\n    });\n\n    var should = {};\n\n    /**\n     * ### .fail([message])\n     * ### .fail(actual, expected, [message], [operator])\n     *\n     * Throw a failure.\n     *\n     *     should.fail();\n     *     should.fail(\"custom error message\");\n     *     should.fail(1, 2);\n     *     should.fail(1, 2, \"custom error message\");\n     *     should.fail(1, 2, \"custom error message\", \">\");\n     *     should.fail(1, 2, undefined, \">\");\n     *\n     *\n     * @name fail\n     * @param {Mixed} actual\n     * @param {Mixed} expected\n     * @param {String} message\n     * @param {String} operator\n     * @namespace BDD\n     * @api public\n     */\n\n    should.fail = function (actual, expected, message, operator) {\n      if (arguments.length < 2) {\n          message = actual;\n          actual = undefined;\n      }\n\n      message = message || 'should.fail()';\n      throw new chai.AssertionError(message, {\n          actual: actual\n        , expected: expected\n        , operator: operator\n      }, should.fail);\n    };\n\n    /**\n     * ### .equal(actual, expected, [message])\n     *\n     * Asserts non-strict equality (`==`) of `actual` and `expected`.\n     *\n     *     should.equal(3, '3', '== coerces values to strings');\n     *\n     * @name equal\n     * @param {Mixed} actual\n     * @param {Mixed} expected\n     * @param {String} message\n     * @namespace Should\n     * @api public\n     */\n\n    should.equal = function (val1, val2, msg) {\n      new Assertion(val1, msg).to.equal(val2);\n    };\n\n    /**\n     * ### .throw(function, [constructor/string/regexp], [string/regexp], [message])\n     *\n     * Asserts that `function` will throw an error that is an instance of\n     * `constructor`, or alternately that it will throw an error with message\n     * matching `regexp`.\n     *\n     *     should.throw(fn, 'function throws a reference error');\n     *     should.throw(fn, /function throws a reference error/);\n     *     should.throw(fn, ReferenceError);\n     *     should.throw(fn, ReferenceError, 'function throws a reference error');\n     *     should.throw(fn, ReferenceError, /function throws a reference error/);\n     *\n     * @name throw\n     * @alias Throw\n     * @param {Function} function\n     * @param {ErrorConstructor} constructor\n     * @param {RegExp} regexp\n     * @param {String} message\n     * @see https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error#Error_types\n     * @namespace Should\n     * @api public\n     */\n\n    should.Throw = function (fn, errt, errs, msg) {\n      new Assertion(fn, msg).to.Throw(errt, errs);\n    };\n\n    /**\n     * ### .exist\n     *\n     * Asserts that the target is neither `null` nor `undefined`.\n     *\n     *     var foo = 'hi';\n     *\n     *     should.exist(foo, 'foo exists');\n     *\n     * @name exist\n     * @namespace Should\n     * @api public\n     */\n\n    should.exist = function (val, msg) {\n      new Assertion(val, msg).to.exist;\n    }\n\n    // negation\n    should.not = {}\n\n    /**\n     * ### .not.equal(actual, expected, [message])\n     *\n     * Asserts non-strict inequality (`!=`) of `actual` and `expected`.\n     *\n     *     should.not.equal(3, 4, 'these numbers are not equal');\n     *\n     * @name not.equal\n     * @param {Mixed} actual\n     * @param {Mixed} expected\n     * @param {String} message\n     * @namespace Should\n     * @api public\n     */\n\n    should.not.equal = function (val1, val2, msg) {\n      new Assertion(val1, msg).to.not.equal(val2);\n    };\n\n    /**\n     * ### .throw(function, [constructor/regexp], [message])\n     *\n     * Asserts that `function` will _not_ throw an error that is an instance of\n     * `constructor`, or alternately that it will not throw an error with message\n     * matching `regexp`.\n     *\n     *     should.not.throw(fn, Error, 'function does not throw');\n     *\n     * @name not.throw\n     * @alias not.Throw\n     * @param {Function} function\n     * @param {ErrorConstructor} constructor\n     * @param {RegExp} regexp\n     * @param {String} message\n     * @see https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error#Error_types\n     * @namespace Should\n     * @api public\n     */\n\n    should.not.Throw = function (fn, errt, errs, msg) {\n      new Assertion(fn, msg).to.not.Throw(errt, errs);\n    };\n\n    /**\n     * ### .not.exist\n     *\n     * Asserts that the target is neither `null` nor `undefined`.\n     *\n     *     var bar = null;\n     *\n     *     should.not.exist(bar, 'bar does not exist');\n     *\n     * @name not.exist\n     * @namespace Should\n     * @api public\n     */\n\n    should.not.exist = function (val, msg) {\n      new Assertion(val, msg).to.not.exist;\n    }\n\n    should['throw'] = should['Throw'];\n    should.not['throw'] = should.not['Throw'];\n\n    return should;\n  };\n\n  chai.should = loadShould;\n  chai.Should = loadShould;\n};\n","/*!\n * Chai - addChainingMethod utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Module dependencies\n */\n\nvar addLengthGuard = require('./addLengthGuard');\nvar chai = require('../../chai');\nvar flag = require('./flag');\nvar proxify = require('./proxify');\nvar transferFlags = require('./transferFlags');\n\n/*!\n * Module variables\n */\n\n// Check whether `Object.setPrototypeOf` is supported\nvar canSetPrototype = typeof Object.setPrototypeOf === 'function';\n\n// Without `Object.setPrototypeOf` support, this module will need to add properties to a function.\n// However, some of functions' own props are not configurable and should be skipped.\nvar testFn = function() {};\nvar excludeNames = Object.getOwnPropertyNames(testFn).filter(function(name) {\n  var propDesc = Object.getOwnPropertyDescriptor(testFn, name);\n\n  // Note: PhantomJS 1.x includes `callee` as one of `testFn`'s own properties,\n  // but then returns `undefined` as the property descriptor for `callee`. As a\n  // workaround, we perform an otherwise unnecessary type-check for `propDesc`,\n  // and then filter it out if it's not an object as it should be.\n  if (typeof propDesc !== 'object')\n    return true;\n\n  return !propDesc.configurable;\n});\n\n// Cache `Function` properties\nvar call  = Function.prototype.call,\n    apply = Function.prototype.apply;\n\n/**\n * ### .addChainableMethod(ctx, name, method, chainingBehavior)\n *\n * Adds a method to an object, such that the method can also be chained.\n *\n *     utils.addChainableMethod(chai.Assertion.prototype, 'foo', function (str) {\n *       var obj = utils.flag(this, 'object');\n *       new chai.Assertion(obj).to.be.equal(str);\n *     });\n *\n * Can also be accessed directly from `chai.Assertion`.\n *\n *     chai.Assertion.addChainableMethod('foo', fn, chainingBehavior);\n *\n * The result can then be used as both a method assertion, executing both `method` and\n * `chainingBehavior`, or as a language chain, which only executes `chainingBehavior`.\n *\n *     expect(fooStr).to.be.foo('bar');\n *     expect(fooStr).to.be.foo.equal('foo');\n *\n * @param {Object} ctx object to which the method is added\n * @param {String} name of method to add\n * @param {Function} method function to be used for `name`, when called\n * @param {Function} chainingBehavior function to be called every time the property is accessed\n * @namespace Utils\n * @name addChainableMethod\n * @api public\n */\n\nmodule.exports = function addChainableMethod(ctx, name, method, chainingBehavior) {\n  if (typeof chainingBehavior !== 'function') {\n    chainingBehavior = function () { };\n  }\n\n  var chainableBehavior = {\n      method: method\n    , chainingBehavior: chainingBehavior\n  };\n\n  // save the methods so we can overwrite them later, if we need to.\n  if (!ctx.__methods) {\n    ctx.__methods = {};\n  }\n  ctx.__methods[name] = chainableBehavior;\n\n  Object.defineProperty(ctx, name,\n    { get: function chainableMethodGetter() {\n        chainableBehavior.chainingBehavior.call(this);\n\n        var chainableMethodWrapper = function () {\n          // Setting the `ssfi` flag to `chainableMethodWrapper` causes this\n          // function to be the starting point for removing implementation\n          // frames from the stack trace of a failed assertion.\n          //\n          // However, we only want to use this function as the starting point if\n          // the `lockSsfi` flag isn't set.\n          //\n          // If the `lockSsfi` flag is set, then this assertion is being\n          // invoked from inside of another assertion. In this case, the `ssfi`\n          // flag has already been set by the outer assertion.\n          //\n          // Note that overwriting a chainable method merely replaces the saved\n          // methods in `ctx.__methods` instead of completely replacing the\n          // overwritten assertion. Therefore, an overwriting assertion won't\n          // set the `ssfi` or `lockSsfi` flags.\n          if (!flag(this, 'lockSsfi')) {\n            flag(this, 'ssfi', chainableMethodWrapper);\n          }\n\n          var result = chainableBehavior.method.apply(this, arguments);\n          if (result !== undefined) {\n            return result;\n          }\n\n          var newAssertion = new chai.Assertion();\n          transferFlags(this, newAssertion);\n          return newAssertion;\n        };\n\n        addLengthGuard(chainableMethodWrapper, name, true);\n\n        // Use `Object.setPrototypeOf` if available\n        if (canSetPrototype) {\n          // Inherit all properties from the object by replacing the `Function` prototype\n          var prototype = Object.create(this);\n          // Restore the `call` and `apply` methods from `Function`\n          prototype.call = call;\n          prototype.apply = apply;\n          Object.setPrototypeOf(chainableMethodWrapper, prototype);\n        }\n        // Otherwise, redefine all properties (slow!)\n        else {\n          var asserterNames = Object.getOwnPropertyNames(ctx);\n          asserterNames.forEach(function (asserterName) {\n            if (excludeNames.indexOf(asserterName) !== -1) {\n              return;\n            }\n\n            var pd = Object.getOwnPropertyDescriptor(ctx, asserterName);\n            Object.defineProperty(chainableMethodWrapper, asserterName, pd);\n          });\n        }\n\n        transferFlags(this, chainableMethodWrapper);\n        return proxify(chainableMethodWrapper);\n      }\n    , configurable: true\n  });\n};\n","var fnLengthDesc = Object.getOwnPropertyDescriptor(function () {}, 'length');\n\n/*!\n * Chai - addLengthGuard utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .addLengthGuard(fn, assertionName, isChainable)\n *\n * Define `length` as a getter on the given uninvoked method assertion. The\n * getter acts as a guard against chaining `length` directly off of an uninvoked\n * method assertion, which is a problem because it references `function`'s\n * built-in `length` property instead of Chai's `length` assertion. When the\n * getter catches the user making this mistake, it throws an error with a\n * helpful message.\n *\n * There are two ways in which this mistake can be made. The first way is by\n * chaining the `length` assertion directly off of an uninvoked chainable\n * method. In this case, Chai suggests that the user use `lengthOf` instead. The\n * second way is by chaining the `length` assertion directly off of an uninvoked\n * non-chainable method. Non-chainable methods must be invoked prior to\n * chaining. In this case, Chai suggests that the user consult the docs for the\n * given assertion.\n *\n * If the `length` property of functions is unconfigurable, then return `fn`\n * without modification.\n *\n * Note that in ES6, the function's `length` property is configurable, so once\n * support for legacy environments is dropped, Chai's `length` property can\n * replace the built-in function's `length` property, and this length guard will\n * no longer be necessary. In the mean time, maintaining consistency across all\n * environments is the priority.\n *\n * @param {Function} fn\n * @param {String} assertionName\n * @param {Boolean} isChainable\n * @namespace Utils\n * @name addLengthGuard\n */\n\nmodule.exports = function addLengthGuard (fn, assertionName, isChainable) {\n  if (!fnLengthDesc.configurable) return fn;\n\n  Object.defineProperty(fn, 'length', {\n    get: function () {\n      if (isChainable) {\n        throw Error('Invalid Chai property: ' + assertionName + '.length. Due' +\n          ' to a compatibility issue, \"length\" cannot directly follow \"' +\n          assertionName + '\". Use \"' + assertionName + '.lengthOf\" instead.');\n      }\n\n      throw Error('Invalid Chai property: ' + assertionName + '.length. See' +\n        ' docs for proper usage of \"' + assertionName + '\".');\n    }\n  });\n\n  return fn;\n};\n","/*!\n * Chai - addMethod utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar addLengthGuard = require('./addLengthGuard');\nvar chai = require('../../chai');\nvar flag = require('./flag');\nvar proxify = require('./proxify');\nvar transferFlags = require('./transferFlags');\n\n/**\n * ### .addMethod(ctx, name, method)\n *\n * Adds a method to the prototype of an object.\n *\n *     utils.addMethod(chai.Assertion.prototype, 'foo', function (str) {\n *       var obj = utils.flag(this, 'object');\n *       new chai.Assertion(obj).to.be.equal(str);\n *     });\n *\n * Can also be accessed directly from `chai.Assertion`.\n *\n *     chai.Assertion.addMethod('foo', fn);\n *\n * Then can be used as any other assertion.\n *\n *     expect(fooStr).to.be.foo('bar');\n *\n * @param {Object} ctx object to which the method is added\n * @param {String} name of method to add\n * @param {Function} method function to be used for name\n * @namespace Utils\n * @name addMethod\n * @api public\n */\n\nmodule.exports = function addMethod(ctx, name, method) {\n  var methodWrapper = function () {\n    // Setting the `ssfi` flag to `methodWrapper` causes this function to be the\n    // starting point for removing implementation frames from the stack trace of\n    // a failed assertion.\n    //\n    // However, we only want to use this function as the starting point if the\n    // `lockSsfi` flag isn't set.\n    //\n    // If the `lockSsfi` flag is set, then either this assertion has been\n    // overwritten by another assertion, or this assertion is being invoked from\n    // inside of another assertion. In the first case, the `ssfi` flag has\n    // already been set by the overwriting assertion. In the second case, the\n    // `ssfi` flag has already been set by the outer assertion.\n    if (!flag(this, 'lockSsfi')) {\n      flag(this, 'ssfi', methodWrapper);\n    }\n\n    var result = method.apply(this, arguments);\n    if (result !== undefined)\n      return result;\n\n    var newAssertion = new chai.Assertion();\n    transferFlags(this, newAssertion);\n    return newAssertion;\n  };\n\n  addLengthGuard(methodWrapper, name, false);\n  ctx[name] = proxify(methodWrapper, name);\n};\n","/*!\n * Chai - addProperty utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar chai = require('../../chai');\nvar flag = require('./flag');\nvar isProxyEnabled = require('./isProxyEnabled');\nvar transferFlags = require('./transferFlags');\n\n/**\n * ### .addProperty(ctx, name, getter)\n *\n * Adds a property to the prototype of an object.\n *\n *     utils.addProperty(chai.Assertion.prototype, 'foo', function () {\n *       var obj = utils.flag(this, 'object');\n *       new chai.Assertion(obj).to.be.instanceof(Foo);\n *     });\n *\n * Can also be accessed directly from `chai.Assertion`.\n *\n *     chai.Assertion.addProperty('foo', fn);\n *\n * Then can be used as any other assertion.\n *\n *     expect(myFoo).to.be.foo;\n *\n * @param {Object} ctx object to which the property is added\n * @param {String} name of property to add\n * @param {Function} getter function to be used for name\n * @namespace Utils\n * @name addProperty\n * @api public\n */\n\nmodule.exports = function addProperty(ctx, name, getter) {\n  getter = getter === undefined ? function () {} : getter;\n\n  Object.defineProperty(ctx, name,\n    { get: function propertyGetter() {\n        // Setting the `ssfi` flag to `propertyGetter` causes this function to\n        // be the starting point for removing implementation frames from the\n        // stack trace of a failed assertion.\n        //\n        // However, we only want to use this function as the starting point if\n        // the `lockSsfi` flag isn't set and proxy protection is disabled.\n        //\n        // If the `lockSsfi` flag is set, then either this assertion has been\n        // overwritten by another assertion, or this assertion is being invoked\n        // from inside of another assertion. In the first case, the `ssfi` flag\n        // has already been set by the overwriting assertion. In the second\n        // case, the `ssfi` flag has already been set by the outer assertion.\n        //\n        // If proxy protection is enabled, then the `ssfi` flag has already been\n        // set by the proxy getter.\n        if (!isProxyEnabled() && !flag(this, 'lockSsfi')) {\n          flag(this, 'ssfi', propertyGetter);\n        }\n\n        var result = getter.call(this);\n        if (result !== undefined)\n          return result;\n\n        var newAssertion = new chai.Assertion();\n        transferFlags(this, newAssertion);\n        return newAssertion;\n      }\n    , configurable: true\n  });\n};\n","/*!\n * Chai - compareByInspect utility\n * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Module dependencies\n */\n\nvar inspect = require('./inspect');\n\n/**\n * ### .compareByInspect(mixed, mixed)\n *\n * To be used as a compareFunction with Array.prototype.sort. Compares elements\n * using inspect instead of default behavior of using toString so that Symbols\n * and objects with irregular/missing toString can still be sorted without a\n * TypeError.\n *\n * @param {Mixed} first element to compare\n * @param {Mixed} second element to compare\n * @returns {Number} -1 if 'a' should come before 'b'; otherwise 1\n * @name compareByInspect\n * @namespace Utils\n * @api public\n */\n\nmodule.exports = function compareByInspect(a, b) {\n  return inspect(a) < inspect(b) ? -1 : 1;\n};\n","/*!\n * Chai - expectTypes utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .expectTypes(obj, types)\n *\n * Ensures that the object being tested against is of a valid type.\n *\n *     utils.expectTypes(this, ['array', 'object', 'string']);\n *\n * @param {Mixed} obj constructed Assertion\n * @param {Array} type A list of allowed types for this assertion\n * @namespace Utils\n * @name expectTypes\n * @api public\n */\n\nvar AssertionError = require('assertion-error');\nvar flag = require('./flag');\nvar type = require('type-detect');\n\nmodule.exports = function expectTypes(obj, types) {\n  var flagMsg = flag(obj, 'message');\n  var ssfi = flag(obj, 'ssfi');\n\n  flagMsg = flagMsg ? flagMsg + ': ' : '';\n\n  obj = flag(obj, 'object');\n  types = types.map(function (t) { return t.toLowerCase(); });\n  types.sort();\n\n  // Transforms ['lorem', 'ipsum'] into 'a lorem, or an ipsum'\n  var str = types.map(function (t, index) {\n    var art = ~[ 'a', 'e', 'i', 'o', 'u' ].indexOf(t.charAt(0)) ? 'an' : 'a';\n    var or = types.length > 1 && index === types.length - 1 ? 'or ' : '';\n    return or + art + ' ' + t;\n  }).join(', ');\n\n  var objType = type(obj).toLowerCase();\n\n  if (!types.some(function (expected) { return objType === expected; })) {\n    throw new AssertionError(\n      flagMsg + 'object tested must be ' + str + ', but ' + objType + ' given',\n      undefined,\n      ssfi\n    );\n  }\n};\n","/*!\n * Chai - flag utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .flag(object, key, [value])\n *\n * Get or set a flag value on an object. If a\n * value is provided it will be set, else it will\n * return the currently set value or `undefined` if\n * the value is not set.\n *\n *     utils.flag(this, 'foo', 'bar'); // setter\n *     utils.flag(this, 'foo'); // getter, returns `bar`\n *\n * @param {Object} object constructed Assertion\n * @param {String} key\n * @param {Mixed} value (optional)\n * @namespace Utils\n * @name flag\n * @api private\n */\n\nmodule.exports = function flag(obj, key, value) {\n  var flags = obj.__flags || (obj.__flags = Object.create(null));\n  if (arguments.length === 3) {\n    flags[key] = value;\n  } else {\n    return flags[key];\n  }\n};\n","/*!\n * Chai - getActual utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .getActual(object, [actual])\n *\n * Returns the `actual` value for an Assertion.\n *\n * @param {Object} object (constructed Assertion)\n * @param {Arguments} chai.Assertion.prototype.assert arguments\n * @namespace Utils\n * @name getActual\n */\n\nmodule.exports = function getActual(obj, args) {\n  return args.length > 4 ? args[4] : obj._obj;\n};\n","/*!\n * Chai - message composition utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Module dependencies\n */\n\nvar flag = require('./flag')\n  , getActual = require('./getActual')\n  , objDisplay = require('./objDisplay');\n\n/**\n * ### .getMessage(object, message, negateMessage)\n *\n * Construct the error message based on flags\n * and template tags. Template tags will return\n * a stringified inspection of the object referenced.\n *\n * Message template tags:\n * - `#{this}` current asserted object\n * - `#{act}` actual value\n * - `#{exp}` expected value\n *\n * @param {Object} object (constructed Assertion)\n * @param {Arguments} chai.Assertion.prototype.assert arguments\n * @namespace Utils\n * @name getMessage\n * @api public\n */\n\nmodule.exports = function getMessage(obj, args) {\n  var negate = flag(obj, 'negate')\n    , val = flag(obj, 'object')\n    , expected = args[3]\n    , actual = getActual(obj, args)\n    , msg = negate ? args[2] : args[1]\n    , flagMsg = flag(obj, 'message');\n\n  if(typeof msg === \"function\") msg = msg();\n  msg = msg || '';\n  msg = msg\n    .replace(/#\\{this\\}/g, function () { return objDisplay(val); })\n    .replace(/#\\{act\\}/g, function () { return objDisplay(actual); })\n    .replace(/#\\{exp\\}/g, function () { return objDisplay(expected); });\n\n  return flagMsg ? flagMsg + ': ' + msg : msg;\n};\n","var type = require('type-detect');\n\nvar flag = require('./flag');\n\nfunction isObjectType(obj) {\n  var objectType = type(obj);\n  var objectTypes = ['Array', 'Object', 'function'];\n\n  return objectTypes.indexOf(objectType) !== -1;\n}\n\n/**\n * ### .getOperator(message)\n *\n * Extract the operator from error message.\n * Operator defined is based on below link\n * https://nodejs.org/api/assert.html#assert_assert.\n *\n * Returns the `operator` or `undefined` value for an Assertion.\n *\n * @param {Object} object (constructed Assertion)\n * @param {Arguments} chai.Assertion.prototype.assert arguments\n * @namespace Utils\n * @name getOperator\n * @api public\n */\n\nmodule.exports = function getOperator(obj, args) {\n  var operator = flag(obj, 'operator');\n  var negate = flag(obj, 'negate');\n  var expected = args[3];\n  var msg = negate ? args[2] : args[1];\n\n  if (operator) {\n    return operator;\n  }\n\n  if (typeof msg === 'function') msg = msg();\n\n  msg = msg || '';\n  if (!msg) {\n    return undefined;\n  }\n\n  if (/\\shave\\s/.test(msg)) {\n    return undefined;\n  }\n\n  var isObject = isObjectType(expected);\n  if (/\\snot\\s/.test(msg)) {\n    return isObject ? 'notDeepStrictEqual' : 'notStrictEqual';\n  }\n\n  return isObject ? 'deepStrictEqual' : 'strictEqual';\n};\n","/*!\n * Chai - getOwnEnumerableProperties utility\n * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Module dependencies\n */\n\nvar getOwnEnumerablePropertySymbols = require('./getOwnEnumerablePropertySymbols');\n\n/**\n * ### .getOwnEnumerableProperties(object)\n *\n * This allows the retrieval of directly-owned enumerable property names and\n * symbols of an object. This function is necessary because Object.keys only\n * returns enumerable property names, not enumerable property symbols.\n *\n * @param {Object} object\n * @returns {Array}\n * @namespace Utils\n * @name getOwnEnumerableProperties\n * @api public\n */\n\nmodule.exports = function getOwnEnumerableProperties(obj) {\n  return Object.keys(obj).concat(getOwnEnumerablePropertySymbols(obj));\n};\n","/*!\n * Chai - getOwnEnumerablePropertySymbols utility\n * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .getOwnEnumerablePropertySymbols(object)\n *\n * This allows the retrieval of directly-owned enumerable property symbols of an\n * object. This function is necessary because Object.getOwnPropertySymbols\n * returns both enumerable and non-enumerable property symbols.\n *\n * @param {Object} object\n * @returns {Array}\n * @namespace Utils\n * @name getOwnEnumerablePropertySymbols\n * @api public\n */\n\nmodule.exports = function getOwnEnumerablePropertySymbols(obj) {\n  if (typeof Object.getOwnPropertySymbols !== 'function') return [];\n\n  return Object.getOwnPropertySymbols(obj).filter(function (sym) {\n    return Object.getOwnPropertyDescriptor(obj, sym).enumerable;\n  });\n};\n","/*!\n * Chai - getProperties utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .getProperties(object)\n *\n * This allows the retrieval of property names of an object, enumerable or not,\n * inherited or not.\n *\n * @param {Object} object\n * @returns {Array}\n * @namespace Utils\n * @name getProperties\n * @api public\n */\n\nmodule.exports = function getProperties(object) {\n  var result = Object.getOwnPropertyNames(object);\n\n  function addProperty(property) {\n    if (result.indexOf(property) === -1) {\n      result.push(property);\n    }\n  }\n\n  var proto = Object.getPrototypeOf(object);\n  while (proto !== null) {\n    Object.getOwnPropertyNames(proto).forEach(addProperty);\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return result;\n};\n","/*!\n * chai\n * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Dependencies that are used for multiple exports are required here only once\n */\n\nvar pathval = require('pathval');\n\n/*!\n * test utility\n */\n\nexports.test = require('./test');\n\n/*!\n * type utility\n */\n\nexports.type = require('type-detect');\n\n/*!\n * expectTypes utility\n */\nexports.expectTypes = require('./expectTypes');\n\n/*!\n * message utility\n */\n\nexports.getMessage = require('./getMessage');\n\n/*!\n * actual utility\n */\n\nexports.getActual = require('./getActual');\n\n/*!\n * Inspect util\n */\n\nexports.inspect = require('./inspect');\n\n/*!\n * Object Display util\n */\n\nexports.objDisplay = require('./objDisplay');\n\n/*!\n * Flag utility\n */\n\nexports.flag = require('./flag');\n\n/*!\n * Flag transferring utility\n */\n\nexports.transferFlags = require('./transferFlags');\n\n/*!\n * Deep equal utility\n */\n\nexports.eql = require('deep-eql');\n\n/*!\n * Deep path info\n */\n\nexports.getPathInfo = pathval.getPathInfo;\n\n/*!\n * Check if a property exists\n */\n\nexports.hasProperty = pathval.hasProperty;\n\n/*!\n * Function name\n */\n\nexports.getName = require('get-func-name');\n\n/*!\n * add Property\n */\n\nexports.addProperty = require('./addProperty');\n\n/*!\n * add Method\n */\n\nexports.addMethod = require('./addMethod');\n\n/*!\n * overwrite Property\n */\n\nexports.overwriteProperty = require('./overwriteProperty');\n\n/*!\n * overwrite Method\n */\n\nexports.overwriteMethod = require('./overwriteMethod');\n\n/*!\n * Add a chainable method\n */\n\nexports.addChainableMethod = require('./addChainableMethod');\n\n/*!\n * Overwrite chainable method\n */\n\nexports.overwriteChainableMethod = require('./overwriteChainableMethod');\n\n/*!\n * Compare by inspect method\n */\n\nexports.compareByInspect = require('./compareByInspect');\n\n/*!\n * Get own enumerable property symbols method\n */\n\nexports.getOwnEnumerablePropertySymbols = require('./getOwnEnumerablePropertySymbols');\n\n/*!\n * Get own enumerable properties method\n */\n\nexports.getOwnEnumerableProperties = require('./getOwnEnumerableProperties');\n\n/*!\n * Checks error against a given set of criteria\n */\n\nexports.checkError = require('check-error');\n\n/*!\n * Proxify util\n */\n\nexports.proxify = require('./proxify');\n\n/*!\n * addLengthGuard util\n */\n\nexports.addLengthGuard = require('./addLengthGuard');\n\n/*!\n * isProxyEnabled helper\n */\n\nexports.isProxyEnabled = require('./isProxyEnabled');\n\n/*!\n * isNaN method\n */\n\nexports.isNaN = require('./isNaN');\n\n/*!\n * getOperator method\n */\n\nexports.getOperator = require('./getOperator');","// This is (almost) directly from Node.js utils\n// https://github.com/joyent/node/blob/f8c335d0caf47f16d31413f89aa28eda3878e3aa/lib/util.js\n\nvar getName = require('get-func-name');\nvar loupe = require('loupe');\nvar config = require('../config');\n\nmodule.exports = inspect;\n\n/**\n * ### .inspect(obj, [showHidden], [depth], [colors])\n *\n * Echoes the value of a value. Tries to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Boolean} showHidden Flag that shows hidden (not enumerable)\n *    properties of objects. Default is false.\n * @param {Number} depth Depth in which to descend in object. Default is 2.\n * @param {Boolean} colors Flag to turn on ANSI escape codes to color the\n *    output. Default is false (no coloring).\n * @namespace Utils\n * @name inspect\n */\nfunction inspect(obj, showHidden, depth, colors) {\n  var options = {\n    colors: colors,\n    depth: (typeof depth === 'undefined' ? 2 : depth),\n    showHidden: showHidden,\n    truncate: config.truncateThreshold ? config.truncateThreshold : Infinity,\n  };\n  return loupe.inspect(obj, options);\n}\n","/*!\n * Chai - isNaN utility\n * Copyright(c) 2012-2015 Sakthipriyan Vairamani <thechargingvolcano@gmail.com>\n * MIT Licensed\n */\n\n/**\n * ### .isNaN(value)\n *\n * Checks if the given value is NaN or not.\n *\n *     utils.isNaN(NaN); // true\n *\n * @param {Value} The value which has to be checked if it is NaN\n * @name isNaN\n * @api private\n */\n\nfunction isNaN(value) {\n  // Refer http://www.ecma-international.org/ecma-262/6.0/#sec-isnan-number\n  // section's NOTE.\n  return value !== value;\n}\n\n// If ECMAScript 6's Number.isNaN is present, prefer that.\nmodule.exports = Number.isNaN || isNaN;\n","var config = require('../config');\n\n/*!\n * Chai - isProxyEnabled helper\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .isProxyEnabled()\n *\n * Helper function to check if Chai's proxy protection feature is enabled. If\n * proxies are unsupported or disabled via the user's Chai config, then return\n * false. Otherwise, return true.\n *\n * @namespace Utils\n * @name isProxyEnabled\n */\n\nmodule.exports = function isProxyEnabled() {\n  return config.useProxy &&\n    typeof Proxy !== 'undefined' &&\n    typeof Reflect !== 'undefined';\n};\n","/*!\n * Chai - flag utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Module dependencies\n */\n\nvar inspect = require('./inspect');\nvar config = require('../config');\n\n/**\n * ### .objDisplay(object)\n *\n * Determines if an object or an array matches\n * criteria to be inspected in-line for error\n * messages or should be truncated.\n *\n * @param {Mixed} javascript object to inspect\n * @returns {string} stringified object\n * @name objDisplay\n * @namespace Utils\n * @api public\n */\n\nmodule.exports = function objDisplay(obj) {\n  var str = inspect(obj)\n    , type = Object.prototype.toString.call(obj);\n\n  if (config.truncateThreshold && str.length >= config.truncateThreshold) {\n    if (type === '[object Function]') {\n      return !obj.name || obj.name === ''\n        ? '[Function]'\n        : '[Function: ' + obj.name + ']';\n    } else if (type === '[object Array]') {\n      return '[ Array(' + obj.length + ') ]';\n    } else if (type === '[object Object]') {\n      var keys = Object.keys(obj)\n        , kstr = keys.length > 2\n          ? keys.splice(0, 2).join(', ') + ', ...'\n          : keys.join(', ');\n      return '{ Object (' + kstr + ') }';\n    } else {\n      return str;\n    }\n  } else {\n    return str;\n  }\n};\n","/*!\n * Chai - overwriteChainableMethod utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar chai = require('../../chai');\nvar transferFlags = require('./transferFlags');\n\n/**\n * ### .overwriteChainableMethod(ctx, name, method, chainingBehavior)\n *\n * Overwrites an already existing chainable method\n * and provides access to the previous function or\n * property.  Must return functions to be used for\n * name.\n *\n *     utils.overwriteChainableMethod(chai.Assertion.prototype, 'lengthOf',\n *       function (_super) {\n *       }\n *     , function (_super) {\n *       }\n *     );\n *\n * Can also be accessed directly from `chai.Assertion`.\n *\n *     chai.Assertion.overwriteChainableMethod('foo', fn, fn);\n *\n * Then can be used as any other assertion.\n *\n *     expect(myFoo).to.have.lengthOf(3);\n *     expect(myFoo).to.have.lengthOf.above(3);\n *\n * @param {Object} ctx object whose method / property is to be overwritten\n * @param {String} name of method / property to overwrite\n * @param {Function} method function that returns a function to be used for name\n * @param {Function} chainingBehavior function that returns a function to be used for property\n * @namespace Utils\n * @name overwriteChainableMethod\n * @api public\n */\n\nmodule.exports = function overwriteChainableMethod(ctx, name, method, chainingBehavior) {\n  var chainableBehavior = ctx.__methods[name];\n\n  var _chainingBehavior = chainableBehavior.chainingBehavior;\n  chainableBehavior.chainingBehavior = function overwritingChainableMethodGetter() {\n    var result = chainingBehavior(_chainingBehavior).call(this);\n    if (result !== undefined) {\n      return result;\n    }\n\n    var newAssertion = new chai.Assertion();\n    transferFlags(this, newAssertion);\n    return newAssertion;\n  };\n\n  var _method = chainableBehavior.method;\n  chainableBehavior.method = function overwritingChainableMethodWrapper() {\n    var result = method(_method).apply(this, arguments);\n    if (result !== undefined) {\n      return result;\n    }\n\n    var newAssertion = new chai.Assertion();\n    transferFlags(this, newAssertion);\n    return newAssertion;\n  };\n};\n","/*!\n * Chai - overwriteMethod utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar addLengthGuard = require('./addLengthGuard');\nvar chai = require('../../chai');\nvar flag = require('./flag');\nvar proxify = require('./proxify');\nvar transferFlags = require('./transferFlags');\n\n/**\n * ### .overwriteMethod(ctx, name, fn)\n *\n * Overwrites an already existing method and provides\n * access to previous function. Must return function\n * to be used for name.\n *\n *     utils.overwriteMethod(chai.Assertion.prototype, 'equal', function (_super) {\n *       return function (str) {\n *         var obj = utils.flag(this, 'object');\n *         if (obj instanceof Foo) {\n *           new chai.Assertion(obj.value).to.equal(str);\n *         } else {\n *           _super.apply(this, arguments);\n *         }\n *       }\n *     });\n *\n * Can also be accessed directly from `chai.Assertion`.\n *\n *     chai.Assertion.overwriteMethod('foo', fn);\n *\n * Then can be used as any other assertion.\n *\n *     expect(myFoo).to.equal('bar');\n *\n * @param {Object} ctx object whose method is to be overwritten\n * @param {String} name of method to overwrite\n * @param {Function} method function that returns a function to be used for name\n * @namespace Utils\n * @name overwriteMethod\n * @api public\n */\n\nmodule.exports = function overwriteMethod(ctx, name, method) {\n  var _method = ctx[name]\n    , _super = function () {\n      throw new Error(name + ' is not a function');\n    };\n\n  if (_method && 'function' === typeof _method)\n    _super = _method;\n\n  var overwritingMethodWrapper = function () {\n    // Setting the `ssfi` flag to `overwritingMethodWrapper` causes this\n    // function to be the starting point for removing implementation frames from\n    // the stack trace of a failed assertion.\n    //\n    // However, we only want to use this function as the starting point if the\n    // `lockSsfi` flag isn't set.\n    //\n    // If the `lockSsfi` flag is set, then either this assertion has been\n    // overwritten by another assertion, or this assertion is being invoked from\n    // inside of another assertion. In the first case, the `ssfi` flag has\n    // already been set by the overwriting assertion. In the second case, the\n    // `ssfi` flag has already been set by the outer assertion.\n    if (!flag(this, 'lockSsfi')) {\n      flag(this, 'ssfi', overwritingMethodWrapper);\n    }\n\n    // Setting the `lockSsfi` flag to `true` prevents the overwritten assertion\n    // from changing the `ssfi` flag. By this point, the `ssfi` flag is already\n    // set to the correct starting point for this assertion.\n    var origLockSsfi = flag(this, 'lockSsfi');\n    flag(this, 'lockSsfi', true);\n    var result = method(_super).apply(this, arguments);\n    flag(this, 'lockSsfi', origLockSsfi);\n\n    if (result !== undefined) {\n      return result;\n    }\n\n    var newAssertion = new chai.Assertion();\n    transferFlags(this, newAssertion);\n    return newAssertion;\n  }\n\n  addLengthGuard(overwritingMethodWrapper, name, false);\n  ctx[name] = proxify(overwritingMethodWrapper, name);\n};\n","/*!\n * Chai - overwriteProperty utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar chai = require('../../chai');\nvar flag = require('./flag');\nvar isProxyEnabled = require('./isProxyEnabled');\nvar transferFlags = require('./transferFlags');\n\n/**\n * ### .overwriteProperty(ctx, name, fn)\n *\n * Overwrites an already existing property getter and provides\n * access to previous value. Must return function to use as getter.\n *\n *     utils.overwriteProperty(chai.Assertion.prototype, 'ok', function (_super) {\n *       return function () {\n *         var obj = utils.flag(this, 'object');\n *         if (obj instanceof Foo) {\n *           new chai.Assertion(obj.name).to.equal('bar');\n *         } else {\n *           _super.call(this);\n *         }\n *       }\n *     });\n *\n *\n * Can also be accessed directly from `chai.Assertion`.\n *\n *     chai.Assertion.overwriteProperty('foo', fn);\n *\n * Then can be used as any other assertion.\n *\n *     expect(myFoo).to.be.ok;\n *\n * @param {Object} ctx object whose property is to be overwritten\n * @param {String} name of property to overwrite\n * @param {Function} getter function that returns a getter function to be used for name\n * @namespace Utils\n * @name overwriteProperty\n * @api public\n */\n\nmodule.exports = function overwriteProperty(ctx, name, getter) {\n  var _get = Object.getOwnPropertyDescriptor(ctx, name)\n    , _super = function () {};\n\n  if (_get && 'function' === typeof _get.get)\n    _super = _get.get\n\n  Object.defineProperty(ctx, name,\n    { get: function overwritingPropertyGetter() {\n        // Setting the `ssfi` flag to `overwritingPropertyGetter` causes this\n        // function to be the starting point for removing implementation frames\n        // from the stack trace of a failed assertion.\n        //\n        // However, we only want to use this function as the starting point if\n        // the `lockSsfi` flag isn't set and proxy protection is disabled.\n        //\n        // If the `lockSsfi` flag is set, then either this assertion has been\n        // overwritten by another assertion, or this assertion is being invoked\n        // from inside of another assertion. In the first case, the `ssfi` flag\n        // has already been set by the overwriting assertion. In the second\n        // case, the `ssfi` flag has already been set by the outer assertion.\n        //\n        // If proxy protection is enabled, then the `ssfi` flag has already been\n        // set by the proxy getter.\n        if (!isProxyEnabled() && !flag(this, 'lockSsfi')) {\n          flag(this, 'ssfi', overwritingPropertyGetter);\n        }\n\n        // Setting the `lockSsfi` flag to `true` prevents the overwritten\n        // assertion from changing the `ssfi` flag. By this point, the `ssfi`\n        // flag is already set to the correct starting point for this assertion.\n        var origLockSsfi = flag(this, 'lockSsfi');\n        flag(this, 'lockSsfi', true);\n        var result = getter(_super).call(this);\n        flag(this, 'lockSsfi', origLockSsfi);\n\n        if (result !== undefined) {\n          return result;\n        }\n\n        var newAssertion = new chai.Assertion();\n        transferFlags(this, newAssertion);\n        return newAssertion;\n      }\n    , configurable: true\n  });\n};\n","var config = require('../config');\nvar flag = require('./flag');\nvar getProperties = require('./getProperties');\nvar isProxyEnabled = require('./isProxyEnabled');\n\n/*!\n * Chai - proxify utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .proxify(object)\n *\n * Return a proxy of given object that throws an error when a non-existent\n * property is read. By default, the root cause is assumed to be a misspelled\n * property, and thus an attempt is made to offer a reasonable suggestion from\n * the list of existing properties. However, if a nonChainableMethodName is\n * provided, then the root cause is instead a failure to invoke a non-chainable\n * method prior to reading the non-existent property.\n *\n * If proxies are unsupported or disabled via the user's Chai config, then\n * return object without modification.\n *\n * @param {Object} obj\n * @param {String} nonChainableMethodName\n * @namespace Utils\n * @name proxify\n */\n\nvar builtins = ['__flags', '__methods', '_obj', 'assert'];\n\nmodule.exports = function proxify(obj, nonChainableMethodName) {\n  if (!isProxyEnabled()) return obj;\n\n  return new Proxy(obj, {\n    get: function proxyGetter(target, property) {\n      // This check is here because we should not throw errors on Symbol properties\n      // such as `Symbol.toStringTag`.\n      // The values for which an error should be thrown can be configured using\n      // the `config.proxyExcludedKeys` setting.\n      if (typeof property === 'string' &&\n          config.proxyExcludedKeys.indexOf(property) === -1 &&\n          !Reflect.has(target, property)) {\n        // Special message for invalid property access of non-chainable methods.\n        if (nonChainableMethodName) {\n          throw Error('Invalid Chai property: ' + nonChainableMethodName + '.' +\n            property + '. See docs for proper usage of \"' +\n            nonChainableMethodName + '\".');\n        }\n\n        // If the property is reasonably close to an existing Chai property,\n        // suggest that property to the user. Only suggest properties with a\n        // distance less than 4.\n        var suggestion = null;\n        var suggestionDistance = 4;\n        getProperties(target).forEach(function(prop) {\n          if (\n            !Object.prototype.hasOwnProperty(prop) &&\n            builtins.indexOf(prop) === -1\n          ) {\n            var dist = stringDistanceCapped(\n              property,\n              prop,\n              suggestionDistance\n            );\n            if (dist < suggestionDistance) {\n              suggestion = prop;\n              suggestionDistance = dist;\n            }\n          }\n        });\n\n        if (suggestion !== null) {\n          throw Error('Invalid Chai property: ' + property +\n            '. Did you mean \"' + suggestion + '\"?');\n        } else {\n          throw Error('Invalid Chai property: ' + property);\n        }\n      }\n\n      // Use this proxy getter as the starting point for removing implementation\n      // frames from the stack trace of a failed assertion. For property\n      // assertions, this prevents the proxy getter from showing up in the stack\n      // trace since it's invoked before the property getter. For method and\n      // chainable method assertions, this flag will end up getting changed to\n      // the method wrapper, which is good since this frame will no longer be in\n      // the stack once the method is invoked. Note that Chai builtin assertion\n      // properties such as `__flags` are skipped since this is only meant to\n      // capture the starting point of an assertion. This step is also skipped\n      // if the `lockSsfi` flag is set, thus indicating that this assertion is\n      // being called from within another assertion. In that case, the `ssfi`\n      // flag is already set to the outer assertion's starting point.\n      if (builtins.indexOf(property) === -1 && !flag(target, 'lockSsfi')) {\n        flag(target, 'ssfi', proxyGetter);\n      }\n\n      return Reflect.get(target, property);\n    }\n  });\n};\n\n/**\n * # stringDistanceCapped(strA, strB, cap)\n * Return the Levenshtein distance between two strings, but no more than cap.\n * @param {string} strA\n * @param {string} strB\n * @param {number} number\n * @return {number} min(string distance between strA and strB, cap)\n * @api private\n */\n\nfunction stringDistanceCapped(strA, strB, cap) {\n  if (Math.abs(strA.length - strB.length) >= cap) {\n    return cap;\n  }\n\n  var memo = [];\n  // `memo` is a two-dimensional array containing distances.\n  // memo[i][j] is the distance between strA.slice(0, i) and\n  // strB.slice(0, j).\n  for (var i = 0; i <= strA.length; i++) {\n    memo[i] = Array(strB.length + 1).fill(0);\n    memo[i][0] = i;\n  }\n  for (var j = 0; j < strB.length; j++) {\n    memo[0][j] = j;\n  }\n\n  for (var i = 1; i <= strA.length; i++) {\n    var ch = strA.charCodeAt(i - 1);\n    for (var j = 1; j <= strB.length; j++) {\n      if (Math.abs(i - j) >= cap) {\n        memo[i][j] = cap;\n        continue;\n      }\n      memo[i][j] = Math.min(\n        memo[i - 1][j] + 1,\n        memo[i][j - 1] + 1,\n        memo[i - 1][j - 1] +\n          (ch === strB.charCodeAt(j - 1) ? 0 : 1)\n      );\n    }\n  }\n\n  return memo[strA.length][strB.length];\n}\n","/*!\n * Chai - test utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/*!\n * Module dependencies\n */\n\nvar flag = require('./flag');\n\n/**\n * ### .test(object, expression)\n *\n * Test an object for expression.\n *\n * @param {Object} object (constructed Assertion)\n * @param {Arguments} chai.Assertion.prototype.assert arguments\n * @namespace Utils\n * @name test\n */\n\nmodule.exports = function test(obj, args) {\n  var negate = flag(obj, 'negate')\n    , expr = args[0];\n  return negate ? !expr : expr;\n};\n","/*!\n * Chai - transferFlags utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .transferFlags(assertion, object, includeAll = true)\n *\n * Transfer all the flags for `assertion` to `object`. If\n * `includeAll` is set to `false`, then the base Chai\n * assertion flags (namely `object`, `ssfi`, `lockSsfi`,\n * and `message`) will not be transferred.\n *\n *\n *     var newAssertion = new Assertion();\n *     utils.transferFlags(assertion, newAssertion);\n *\n *     var anotherAssertion = new Assertion(myObj);\n *     utils.transferFlags(assertion, anotherAssertion, false);\n *\n * @param {Assertion} assertion the assertion to transfer the flags from\n * @param {Object} object the object to transfer the flags to; usually a new assertion\n * @param {Boolean} includeAll\n * @namespace Utils\n * @name transferFlags\n * @api private\n */\n\nmodule.exports = function transferFlags(assertion, object, includeAll) {\n  var flags = assertion.__flags || (assertion.__flags = Object.create(null));\n\n  if (!object.__flags) {\n    object.__flags = Object.create(null);\n  }\n\n  includeAll = arguments.length === 3 ? includeAll : true;\n\n  for (var flag in flags) {\n    if (includeAll ||\n        (flag !== 'object' && flag !== 'ssfi' && flag !== 'lockSsfi' && flag != 'message')) {\n      object.__flags[flag] = flags[flag];\n    }\n  }\n};\n","'use strict';\n\n/* !\n * Chai - checkError utility\n * Copyright(c) 2012-2016 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar getFunctionName = require('get-func-name');\n/**\n * ### .checkError\n *\n * Checks that an error conforms to a given set of criteria and/or retrieves information about it.\n *\n * @api public\n */\n\n/**\n * ### .compatibleInstance(thrown, errorLike)\n *\n * Checks if two instances are compatible (strict equal).\n * Returns false if errorLike is not an instance of Error, because instances\n * can only be compatible if they're both error instances.\n *\n * @name compatibleInstance\n * @param {Error} thrown error\n * @param {Error|ErrorConstructor} errorLike object to compare against\n * @namespace Utils\n * @api public\n */\n\nfunction compatibleInstance(thrown, errorLike) {\n  return errorLike instanceof Error && thrown === errorLike;\n}\n\n/**\n * ### .compatibleConstructor(thrown, errorLike)\n *\n * Checks if two constructors are compatible.\n * This function can receive either an error constructor or\n * an error instance as the `errorLike` argument.\n * Constructors are compatible if they're the same or if one is\n * an instance of another.\n *\n * @name compatibleConstructor\n * @param {Error} thrown error\n * @param {Error|ErrorConstructor} errorLike object to compare against\n * @namespace Utils\n * @api public\n */\n\nfunction compatibleConstructor(thrown, errorLike) {\n  if (errorLike instanceof Error) {\n    // If `errorLike` is an instance of any error we compare their constructors\n    return thrown.constructor === errorLike.constructor || thrown instanceof errorLike.constructor;\n  } else if (errorLike.prototype instanceof Error || errorLike === Error) {\n    // If `errorLike` is a constructor that inherits from Error, we compare `thrown` to `errorLike` directly\n    return thrown.constructor === errorLike || thrown instanceof errorLike;\n  }\n\n  return false;\n}\n\n/**\n * ### .compatibleMessage(thrown, errMatcher)\n *\n * Checks if an error's message is compatible with a matcher (String or RegExp).\n * If the message contains the String or passes the RegExp test,\n * it is considered compatible.\n *\n * @name compatibleMessage\n * @param {Error} thrown error\n * @param {String|RegExp} errMatcher to look for into the message\n * @namespace Utils\n * @api public\n */\n\nfunction compatibleMessage(thrown, errMatcher) {\n  var comparisonString = typeof thrown === 'string' ? thrown : thrown.message;\n  if (errMatcher instanceof RegExp) {\n    return errMatcher.test(comparisonString);\n  } else if (typeof errMatcher === 'string') {\n    return comparisonString.indexOf(errMatcher) !== -1; // eslint-disable-line no-magic-numbers\n  }\n\n  return false;\n}\n\n/**\n * ### .getConstructorName(errorLike)\n *\n * Gets the constructor name for an Error instance or constructor itself.\n *\n * @name getConstructorName\n * @param {Error|ErrorConstructor} errorLike\n * @namespace Utils\n * @api public\n */\n\nfunction getConstructorName(errorLike) {\n  var constructorName = errorLike;\n  if (errorLike instanceof Error) {\n    constructorName = getFunctionName(errorLike.constructor);\n  } else if (typeof errorLike === 'function') {\n    // If `err` is not an instance of Error it is an error constructor itself or another function.\n    // If we've got a common function we get its name, otherwise we may need to create a new instance\n    // of the error just in case it's a poorly-constructed error. Please see chaijs/chai/issues/45 to know more.\n    constructorName = getFunctionName(errorLike);\n    if (constructorName === '') {\n      var newConstructorName = getFunctionName(new errorLike()); // eslint-disable-line new-cap\n      constructorName = newConstructorName || constructorName;\n    }\n  }\n\n  return constructorName;\n}\n\n/**\n * ### .getMessage(errorLike)\n *\n * Gets the error message from an error.\n * If `err` is a String itself, we return it.\n * If the error has no message, we return an empty string.\n *\n * @name getMessage\n * @param {Error|String} errorLike\n * @namespace Utils\n * @api public\n */\n\nfunction getMessage(errorLike) {\n  var msg = '';\n  if (errorLike && errorLike.message) {\n    msg = errorLike.message;\n  } else if (typeof errorLike === 'string') {\n    msg = errorLike;\n  }\n\n  return msg;\n}\n\nmodule.exports = {\n  compatibleInstance: compatibleInstance,\n  compatibleConstructor: compatibleConstructor,\n  compatibleMessage: compatibleMessage,\n  getMessage: getMessage,\n  getConstructorName: getConstructorName,\n};\n","'use strict';\n/* globals Symbol: false, Uint8Array: false, WeakMap: false */\n/*!\n * deep-eql\n * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\nvar type = require('type-detect');\nfunction FakeMap() {\n  this._key = 'chai/deep-eql__' + Math.random() + Date.now();\n}\n\nFakeMap.prototype = {\n  get: function get(key) {\n    return key[this._key];\n  },\n  set: function set(key, value) {\n    if (Object.isExtensible(key)) {\n      Object.defineProperty(key, this._key, {\n        value: value,\n        configurable: true,\n      });\n    }\n  },\n};\n\nvar MemoizeMap = typeof WeakMap === 'function' ? WeakMap : FakeMap;\n/*!\n * Check to see if the MemoizeMap has recorded a result of the two operands\n *\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @param {MemoizeMap} memoizeMap\n * @returns {Boolean|null} result\n*/\nfunction memoizeCompare(leftHandOperand, rightHandOperand, memoizeMap) {\n  // Technically, WeakMap keys can *only* be objects, not primitives.\n  if (!memoizeMap || isPrimitive(leftHandOperand) || isPrimitive(rightHandOperand)) {\n    return null;\n  }\n  var leftHandMap = memoizeMap.get(leftHandOperand);\n  if (leftHandMap) {\n    var result = leftHandMap.get(rightHandOperand);\n    if (typeof result === 'boolean') {\n      return result;\n    }\n  }\n  return null;\n}\n\n/*!\n * Set the result of the equality into the MemoizeMap\n *\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @param {MemoizeMap} memoizeMap\n * @param {Boolean} result\n*/\nfunction memoizeSet(leftHandOperand, rightHandOperand, memoizeMap, result) {\n  // Technically, WeakMap keys can *only* be objects, not primitives.\n  if (!memoizeMap || isPrimitive(leftHandOperand) || isPrimitive(rightHandOperand)) {\n    return;\n  }\n  var leftHandMap = memoizeMap.get(leftHandOperand);\n  if (leftHandMap) {\n    leftHandMap.set(rightHandOperand, result);\n  } else {\n    leftHandMap = new MemoizeMap();\n    leftHandMap.set(rightHandOperand, result);\n    memoizeMap.set(leftHandOperand, leftHandMap);\n  }\n}\n\n/*!\n * Primary Export\n */\n\nmodule.exports = deepEqual;\nmodule.exports.MemoizeMap = MemoizeMap;\n\n/**\n * Assert deeply nested sameValue equality between two objects of any type.\n *\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @param {Object} [options] (optional) Additional options\n * @param {Array} [options.comparator] (optional) Override default algorithm, determining custom equality.\n * @param {Array} [options.memoize] (optional) Provide a custom memoization object which will cache the results of\n    complex objects for a speed boost. By passing `false` you can disable memoization, but this will cause circular\n    references to blow the stack.\n * @return {Boolean} equal match\n */\nfunction deepEqual(leftHandOperand, rightHandOperand, options) {\n  // If we have a comparator, we can't assume anything; so bail to its check first.\n  if (options && options.comparator) {\n    return extensiveDeepEqual(leftHandOperand, rightHandOperand, options);\n  }\n\n  var simpleResult = simpleEqual(leftHandOperand, rightHandOperand);\n  if (simpleResult !== null) {\n    return simpleResult;\n  }\n\n  // Deeper comparisons are pushed through to a larger function\n  return extensiveDeepEqual(leftHandOperand, rightHandOperand, options);\n}\n\n/**\n * Many comparisons can be canceled out early via simple equality or primitive checks.\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @return {Boolean|null} equal match\n */\nfunction simpleEqual(leftHandOperand, rightHandOperand) {\n  // Equal references (except for Numbers) can be returned early\n  if (leftHandOperand === rightHandOperand) {\n    // Handle +-0 cases\n    return leftHandOperand !== 0 || 1 / leftHandOperand === 1 / rightHandOperand;\n  }\n\n  // handle NaN cases\n  if (\n    leftHandOperand !== leftHandOperand && // eslint-disable-line no-self-compare\n    rightHandOperand !== rightHandOperand // eslint-disable-line no-self-compare\n  ) {\n    return true;\n  }\n\n  // Anything that is not an 'object', i.e. symbols, functions, booleans, numbers,\n  // strings, and undefined, can be compared by reference.\n  if (isPrimitive(leftHandOperand) || isPrimitive(rightHandOperand)) {\n    // Easy out b/c it would have passed the first equality check\n    return false;\n  }\n  return null;\n}\n\n/*!\n * The main logic of the `deepEqual` function.\n *\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @param {Object} [options] (optional) Additional options\n * @param {Array} [options.comparator] (optional) Override default algorithm, determining custom equality.\n * @param {Array} [options.memoize] (optional) Provide a custom memoization object which will cache the results of\n    complex objects for a speed boost. By passing `false` you can disable memoization, but this will cause circular\n    references to blow the stack.\n * @return {Boolean} equal match\n*/\nfunction extensiveDeepEqual(leftHandOperand, rightHandOperand, options) {\n  options = options || {};\n  options.memoize = options.memoize === false ? false : options.memoize || new MemoizeMap();\n  var comparator = options && options.comparator;\n\n  // Check if a memoized result exists.\n  var memoizeResultLeft = memoizeCompare(leftHandOperand, rightHandOperand, options.memoize);\n  if (memoizeResultLeft !== null) {\n    return memoizeResultLeft;\n  }\n  var memoizeResultRight = memoizeCompare(rightHandOperand, leftHandOperand, options.memoize);\n  if (memoizeResultRight !== null) {\n    return memoizeResultRight;\n  }\n\n  // If a comparator is present, use it.\n  if (comparator) {\n    var comparatorResult = comparator(leftHandOperand, rightHandOperand);\n    // Comparators may return null, in which case we want to go back to default behavior.\n    if (comparatorResult === false || comparatorResult === true) {\n      memoizeSet(leftHandOperand, rightHandOperand, options.memoize, comparatorResult);\n      return comparatorResult;\n    }\n    // To allow comparators to override *any* behavior, we ran them first. Since it didn't decide\n    // what to do, we need to make sure to return the basic tests first before we move on.\n    var simpleResult = simpleEqual(leftHandOperand, rightHandOperand);\n    if (simpleResult !== null) {\n      // Don't memoize this, it takes longer to set/retrieve than to just compare.\n      return simpleResult;\n    }\n  }\n\n  var leftHandType = type(leftHandOperand);\n  if (leftHandType !== type(rightHandOperand)) {\n    memoizeSet(leftHandOperand, rightHandOperand, options.memoize, false);\n    return false;\n  }\n\n  // Temporarily set the operands in the memoize object to prevent blowing the stack\n  memoizeSet(leftHandOperand, rightHandOperand, options.memoize, true);\n\n  var result = extensiveDeepEqualByType(leftHandOperand, rightHandOperand, leftHandType, options);\n  memoizeSet(leftHandOperand, rightHandOperand, options.memoize, result);\n  return result;\n}\n\nfunction extensiveDeepEqualByType(leftHandOperand, rightHandOperand, leftHandType, options) {\n  switch (leftHandType) {\n    case 'String':\n    case 'Number':\n    case 'Boolean':\n    case 'Date':\n      // If these types are their instance types (e.g. `new Number`) then re-deepEqual against their values\n      return deepEqual(leftHandOperand.valueOf(), rightHandOperand.valueOf());\n    case 'Promise':\n    case 'Symbol':\n    case 'function':\n    case 'WeakMap':\n    case 'WeakSet':\n      return leftHandOperand === rightHandOperand;\n    case 'Error':\n      return keysEqual(leftHandOperand, rightHandOperand, [ 'name', 'message', 'code' ], options);\n    case 'Arguments':\n    case 'Int8Array':\n    case 'Uint8Array':\n    case 'Uint8ClampedArray':\n    case 'Int16Array':\n    case 'Uint16Array':\n    case 'Int32Array':\n    case 'Uint32Array':\n    case 'Float32Array':\n    case 'Float64Array':\n    case 'Array':\n      return iterableEqual(leftHandOperand, rightHandOperand, options);\n    case 'RegExp':\n      return regexpEqual(leftHandOperand, rightHandOperand);\n    case 'Generator':\n      return generatorEqual(leftHandOperand, rightHandOperand, options);\n    case 'DataView':\n      return iterableEqual(new Uint8Array(leftHandOperand.buffer), new Uint8Array(rightHandOperand.buffer), options);\n    case 'ArrayBuffer':\n      return iterableEqual(new Uint8Array(leftHandOperand), new Uint8Array(rightHandOperand), options);\n    case 'Set':\n      return entriesEqual(leftHandOperand, rightHandOperand, options);\n    case 'Map':\n      return entriesEqual(leftHandOperand, rightHandOperand, options);\n    case 'Temporal.PlainDate':\n    case 'Temporal.PlainTime':\n    case 'Temporal.PlainDateTime':\n    case 'Temporal.Instant':\n    case 'Temporal.ZonedDateTime':\n    case 'Temporal.PlainYearMonth':\n    case 'Temporal.PlainMonthDay':\n      return leftHandOperand.equals(rightHandOperand);\n    case 'Temporal.Duration':\n      return leftHandOperand.total('nanoseconds') === rightHandOperand.total('nanoseconds');\n    case 'Temporal.TimeZone':\n    case 'Temporal.Calendar':\n      return leftHandOperand.toString() === rightHandOperand.toString();\n    default:\n      return objectEqual(leftHandOperand, rightHandOperand, options);\n  }\n}\n\n/*!\n * Compare two Regular Expressions for equality.\n *\n * @param {RegExp} leftHandOperand\n * @param {RegExp} rightHandOperand\n * @return {Boolean} result\n */\n\nfunction regexpEqual(leftHandOperand, rightHandOperand) {\n  return leftHandOperand.toString() === rightHandOperand.toString();\n}\n\n/*!\n * Compare two Sets/Maps for equality. Faster than other equality functions.\n *\n * @param {Set} leftHandOperand\n * @param {Set} rightHandOperand\n * @param {Object} [options] (Optional)\n * @return {Boolean} result\n */\n\nfunction entriesEqual(leftHandOperand, rightHandOperand, options) {\n  // IE11 doesn't support Set#entries or Set#@@iterator, so we need manually populate using Set#forEach\n  if (leftHandOperand.size !== rightHandOperand.size) {\n    return false;\n  }\n  if (leftHandOperand.size === 0) {\n    return true;\n  }\n  var leftHandItems = [];\n  var rightHandItems = [];\n  leftHandOperand.forEach(function gatherEntries(key, value) {\n    leftHandItems.push([ key, value ]);\n  });\n  rightHandOperand.forEach(function gatherEntries(key, value) {\n    rightHandItems.push([ key, value ]);\n  });\n  return iterableEqual(leftHandItems.sort(), rightHandItems.sort(), options);\n}\n\n/*!\n * Simple equality for flat iterable objects such as Arrays, TypedArrays or Node.js buffers.\n *\n * @param {Iterable} leftHandOperand\n * @param {Iterable} rightHandOperand\n * @param {Object} [options] (Optional)\n * @return {Boolean} result\n */\n\nfunction iterableEqual(leftHandOperand, rightHandOperand, options) {\n  var length = leftHandOperand.length;\n  if (length !== rightHandOperand.length) {\n    return false;\n  }\n  if (length === 0) {\n    return true;\n  }\n  var index = -1;\n  while (++index < length) {\n    if (deepEqual(leftHandOperand[index], rightHandOperand[index], options) === false) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/*!\n * Simple equality for generator objects such as those returned by generator functions.\n *\n * @param {Iterable} leftHandOperand\n * @param {Iterable} rightHandOperand\n * @param {Object} [options] (Optional)\n * @return {Boolean} result\n */\n\nfunction generatorEqual(leftHandOperand, rightHandOperand, options) {\n  return iterableEqual(getGeneratorEntries(leftHandOperand), getGeneratorEntries(rightHandOperand), options);\n}\n\n/*!\n * Determine if the given object has an @@iterator function.\n *\n * @param {Object} target\n * @return {Boolean} `true` if the object has an @@iterator function.\n */\nfunction hasIteratorFunction(target) {\n  return typeof Symbol !== 'undefined' &&\n    typeof target === 'object' &&\n    typeof Symbol.iterator !== 'undefined' &&\n    typeof target[Symbol.iterator] === 'function';\n}\n\n/*!\n * Gets all iterator entries from the given Object. If the Object has no @@iterator function, returns an empty array.\n * This will consume the iterator - which could have side effects depending on the @@iterator implementation.\n *\n * @param {Object} target\n * @returns {Array} an array of entries from the @@iterator function\n */\nfunction getIteratorEntries(target) {\n  if (hasIteratorFunction(target)) {\n    try {\n      return getGeneratorEntries(target[Symbol.iterator]());\n    } catch (iteratorError) {\n      return [];\n    }\n  }\n  return [];\n}\n\n/*!\n * Gets all entries from a Generator. This will consume the generator - which could have side effects.\n *\n * @param {Generator} target\n * @returns {Array} an array of entries from the Generator.\n */\nfunction getGeneratorEntries(generator) {\n  var generatorResult = generator.next();\n  var accumulator = [ generatorResult.value ];\n  while (generatorResult.done === false) {\n    generatorResult = generator.next();\n    accumulator.push(generatorResult.value);\n  }\n  return accumulator;\n}\n\n/*!\n * Gets all own and inherited enumerable keys from a target.\n *\n * @param {Object} target\n * @returns {Array} an array of own and inherited enumerable keys from the target.\n */\nfunction getEnumerableKeys(target) {\n  var keys = [];\n  for (var key in target) {\n    keys.push(key);\n  }\n  return keys;\n}\n\nfunction getEnumerableSymbols(target) {\n  var keys = [];\n  var allKeys = Object.getOwnPropertySymbols(target);\n  for (var i = 0; i < allKeys.length; i += 1) {\n    var key = allKeys[i];\n    if (Object.getOwnPropertyDescriptor(target, key).enumerable) {\n      keys.push(key);\n    }\n  }\n  return keys;\n}\n\n/*!\n * Determines if two objects have matching values, given a set of keys. Defers to deepEqual for the equality check of\n * each key. If any value of the given key is not equal, the function will return false (early).\n *\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @param {Array} keys An array of keys to compare the values of leftHandOperand and rightHandOperand against\n * @param {Object} [options] (Optional)\n * @return {Boolean} result\n */\nfunction keysEqual(leftHandOperand, rightHandOperand, keys, options) {\n  var length = keys.length;\n  if (length === 0) {\n    return true;\n  }\n  for (var i = 0; i < length; i += 1) {\n    if (deepEqual(leftHandOperand[keys[i]], rightHandOperand[keys[i]], options) === false) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/*!\n * Recursively check the equality of two Objects. Once basic sameness has been established it will defer to `deepEqual`\n * for each enumerable key in the object.\n *\n * @param {Mixed} leftHandOperand\n * @param {Mixed} rightHandOperand\n * @param {Object} [options] (Optional)\n * @return {Boolean} result\n */\nfunction objectEqual(leftHandOperand, rightHandOperand, options) {\n  var leftHandKeys = getEnumerableKeys(leftHandOperand);\n  var rightHandKeys = getEnumerableKeys(rightHandOperand);\n  var leftHandSymbols = getEnumerableSymbols(leftHandOperand);\n  var rightHandSymbols = getEnumerableSymbols(rightHandOperand);\n  leftHandKeys = leftHandKeys.concat(leftHandSymbols);\n  rightHandKeys = rightHandKeys.concat(rightHandSymbols);\n\n  if (leftHandKeys.length && leftHandKeys.length === rightHandKeys.length) {\n    if (iterableEqual(mapSymbols(leftHandKeys).sort(), mapSymbols(rightHandKeys).sort()) === false) {\n      return false;\n    }\n    return keysEqual(leftHandOperand, rightHandOperand, leftHandKeys, options);\n  }\n\n  var leftHandEntries = getIteratorEntries(leftHandOperand);\n  var rightHandEntries = getIteratorEntries(rightHandOperand);\n  if (leftHandEntries.length && leftHandEntries.length === rightHandEntries.length) {\n    leftHandEntries.sort();\n    rightHandEntries.sort();\n    return iterableEqual(leftHandEntries, rightHandEntries, options);\n  }\n\n  if (leftHandKeys.length === 0 &&\n      leftHandEntries.length === 0 &&\n      rightHandKeys.length === 0 &&\n      rightHandEntries.length === 0) {\n    return true;\n  }\n\n  return false;\n}\n\n/*!\n * Returns true if the argument is a primitive.\n *\n * This intentionally returns true for all objects that can be compared by reference,\n * including functions and symbols.\n *\n * @param {Mixed} value\n * @return {Boolean} result\n */\nfunction isPrimitive(value) {\n  return value === null || typeof value !== 'object';\n}\n\nfunction mapSymbols(arr) {\n  return arr.map(function mapSymbol(entry) {\n    if (typeof entry === 'symbol') {\n      return entry.toString();\n    }\n\n    return entry;\n  });\n}\n","'use strict';\n\n/* !\n * Chai - getFuncName utility\n * Copyright(c) 2012-2016 Jake Luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\n\n/**\n * ### .getFuncName(constructorFn)\n *\n * Returns the name of a function.\n * When a non-function instance is passed, returns `null`.\n * This also includes a polyfill function if `aFunc.name` is not defined.\n *\n * @name getFuncName\n * @param {Function} funct\n * @namespace Utils\n * @api public\n */\n\nvar toString = Function.prototype.toString;\nvar functionNameMatch = /\\s*function(?:\\s|\\s*\\/\\*[^(?:*\\/)]+\\*\\/\\s*)*([^\\s\\(\\/]+)/;\nvar maxFunctionSourceLength = 512;\nfunction getFuncName(aFunc) {\n  if (typeof aFunc !== 'function') {\n    return null;\n  }\n\n  var name = '';\n  if (typeof Function.prototype.name === 'undefined' && typeof aFunc.name === 'undefined') {\n    // eslint-disable-next-line prefer-reflect\n    var functionSource = toString.call(aFunc);\n    // To avoid unconstrained resource consumption due to pathalogically large function names,\n    // we limit the available return value to be less than 512 characters.\n    if (functionSource.indexOf('(') > maxFunctionSourceLength) {\n      return name;\n    }\n    // Here we run a polyfill if Function does not support the `name` property and if aFunc.name is not defined\n    var match = functionSource.match(functionNameMatch);\n    if (match) {\n      name = match[1];\n    }\n  } else {\n    // If we've got a `name` property we just use it\n    name = aFunc.name;\n  }\n\n  return name;\n}\n\nmodule.exports = getFuncName;\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.loupe = {}));\n}(this, (function (exports) { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var ansiColors = {\n    bold: ['1', '22'],\n    dim: ['2', '22'],\n    italic: ['3', '23'],\n    underline: ['4', '24'],\n    // 5 & 6 are blinking\n    inverse: ['7', '27'],\n    hidden: ['8', '28'],\n    strike: ['9', '29'],\n    // 10-20 are fonts\n    // 21-29 are resets for 1-9\n    black: ['30', '39'],\n    red: ['31', '39'],\n    green: ['32', '39'],\n    yellow: ['33', '39'],\n    blue: ['34', '39'],\n    magenta: ['35', '39'],\n    cyan: ['36', '39'],\n    white: ['37', '39'],\n    brightblack: ['30;1', '39'],\n    brightred: ['31;1', '39'],\n    brightgreen: ['32;1', '39'],\n    brightyellow: ['33;1', '39'],\n    brightblue: ['34;1', '39'],\n    brightmagenta: ['35;1', '39'],\n    brightcyan: ['36;1', '39'],\n    brightwhite: ['37;1', '39'],\n    grey: ['90', '39']\n  };\n  var styles = {\n    special: 'cyan',\n    number: 'yellow',\n    bigint: 'yellow',\n    boolean: 'yellow',\n    undefined: 'grey',\n    null: 'bold',\n    string: 'green',\n    symbol: 'green',\n    date: 'magenta',\n    regexp: 'red'\n  };\n  var truncator = '';\n\n  function colorise(value, styleType) {\n    var color = ansiColors[styles[styleType]] || ansiColors[styleType];\n\n    if (!color) {\n      return String(value);\n    }\n\n    return \"\\x1B[\".concat(color[0], \"m\").concat(String(value), \"\\x1B[\").concat(color[1], \"m\");\n  }\n\n  function normaliseOptions() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$showHidden = _ref.showHidden,\n        showHidden = _ref$showHidden === void 0 ? false : _ref$showHidden,\n        _ref$depth = _ref.depth,\n        depth = _ref$depth === void 0 ? 2 : _ref$depth,\n        _ref$colors = _ref.colors,\n        colors = _ref$colors === void 0 ? false : _ref$colors,\n        _ref$customInspect = _ref.customInspect,\n        customInspect = _ref$customInspect === void 0 ? true : _ref$customInspect,\n        _ref$showProxy = _ref.showProxy,\n        showProxy = _ref$showProxy === void 0 ? false : _ref$showProxy,\n        _ref$maxArrayLength = _ref.maxArrayLength,\n        maxArrayLength = _ref$maxArrayLength === void 0 ? Infinity : _ref$maxArrayLength,\n        _ref$breakLength = _ref.breakLength,\n        breakLength = _ref$breakLength === void 0 ? Infinity : _ref$breakLength,\n        _ref$seen = _ref.seen,\n        seen = _ref$seen === void 0 ? [] : _ref$seen,\n        _ref$truncate = _ref.truncate,\n        truncate = _ref$truncate === void 0 ? Infinity : _ref$truncate,\n        _ref$stylize = _ref.stylize,\n        stylize = _ref$stylize === void 0 ? String : _ref$stylize;\n\n    var options = {\n      showHidden: Boolean(showHidden),\n      depth: Number(depth),\n      colors: Boolean(colors),\n      customInspect: Boolean(customInspect),\n      showProxy: Boolean(showProxy),\n      maxArrayLength: Number(maxArrayLength),\n      breakLength: Number(breakLength),\n      truncate: Number(truncate),\n      seen: seen,\n      stylize: stylize\n    };\n\n    if (options.colors) {\n      options.stylize = colorise;\n    }\n\n    return options;\n  }\n  function truncate(string, length) {\n    var tail = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : truncator;\n    string = String(string);\n    var tailLength = tail.length;\n    var stringLength = string.length;\n\n    if (tailLength > length && stringLength > tailLength) {\n      return tail;\n    }\n\n    if (stringLength > length && stringLength > tailLength) {\n      return \"\".concat(string.slice(0, length - tailLength)).concat(tail);\n    }\n\n    return string;\n  } // eslint-disable-next-line complexity\n\n  function inspectList(list, options, inspectItem) {\n    var separator = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ', ';\n    inspectItem = inspectItem || options.inspect;\n    var size = list.length;\n    if (size === 0) return '';\n    var originalLength = options.truncate;\n    var output = '';\n    var peek = '';\n    var truncated = '';\n\n    for (var i = 0; i < size; i += 1) {\n      var last = i + 1 === list.length;\n      var secondToLast = i + 2 === list.length;\n      truncated = \"\".concat(truncator, \"(\").concat(list.length - i, \")\");\n      var value = list[i]; // If there is more than one remaining we need to account for a separator of `, `\n\n      options.truncate = originalLength - output.length - (last ? 0 : separator.length);\n      var string = peek || inspectItem(value, options) + (last ? '' : separator);\n      var nextLength = output.length + string.length;\n      var truncatedLength = nextLength + truncated.length; // If this is the last element, and adding it would\n      // take us over length, but adding the truncator wouldn't - then break now\n\n      if (last && nextLength > originalLength && output.length + truncated.length <= originalLength) {\n        break;\n      } // If this isn't the last or second to last element to scan,\n      // but the string is already over length then break here\n\n\n      if (!last && !secondToLast && truncatedLength > originalLength) {\n        break;\n      } // Peek at the next string to determine if we should\n      // break early before adding this item to the output\n\n\n      peek = last ? '' : inspectItem(list[i + 1], options) + (secondToLast ? '' : separator); // If we have one element left, but this element and\n      // the next takes over length, the break early\n\n      if (!last && secondToLast && truncatedLength > originalLength && nextLength + peek.length > originalLength) {\n        break;\n      }\n\n      output += string; // If the next element takes us to length -\n      // but there are more after that, then we should truncate now\n\n      if (!last && !secondToLast && nextLength + peek.length >= originalLength) {\n        truncated = \"\".concat(truncator, \"(\").concat(list.length - i - 1, \")\");\n        break;\n      }\n\n      truncated = '';\n    }\n\n    return \"\".concat(output).concat(truncated);\n  }\n\n  function quoteComplexKey(key) {\n    if (key.match(/^[a-zA-Z_][a-zA-Z_0-9]*$/)) {\n      return key;\n    }\n\n    return JSON.stringify(key).replace(/'/g, \"\\\\'\").replace(/\\\\\"/g, '\"').replace(/(^\"|\"$)/g, \"'\");\n  }\n\n  function inspectProperty(_ref2, options) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        key = _ref3[0],\n        value = _ref3[1];\n\n    options.truncate -= 2;\n\n    if (typeof key === 'string') {\n      key = quoteComplexKey(key);\n    } else if (typeof key !== 'number') {\n      key = \"[\".concat(options.inspect(key, options), \"]\");\n    }\n\n    options.truncate -= key.length;\n    value = options.inspect(value, options);\n    return \"\".concat(key, \": \").concat(value);\n  }\n\n  function inspectArray(array, options) {\n    // Object.keys will always output the Array indices first, so we can slice by\n    // `array.length` to get non-index properties\n    var nonIndexProperties = Object.keys(array).slice(array.length);\n    if (!array.length && !nonIndexProperties.length) return '[]';\n    options.truncate -= 4;\n    var listContents = inspectList(array, options);\n    options.truncate -= listContents.length;\n    var propertyContents = '';\n\n    if (nonIndexProperties.length) {\n      propertyContents = inspectList(nonIndexProperties.map(function (key) {\n        return [key, array[key]];\n      }), options, inspectProperty);\n    }\n\n    return \"[ \".concat(listContents).concat(propertyContents ? \", \".concat(propertyContents) : '', \" ]\");\n  }\n\n  /* !\n   * Chai - getFuncName utility\n   * Copyright(c) 2012-2016 Jake Luer <jake@alogicalparadox.com>\n   * MIT Licensed\n   */\n\n  /**\n   * ### .getFuncName(constructorFn)\n   *\n   * Returns the name of a function.\n   * When a non-function instance is passed, returns `null`.\n   * This also includes a polyfill function if `aFunc.name` is not defined.\n   *\n   * @name getFuncName\n   * @param {Function} funct\n   * @namespace Utils\n   * @api public\n   */\n\n  var toString = Function.prototype.toString;\n  var functionNameMatch = /\\s*function(?:\\s|\\s*\\/\\*[^(?:*\\/)]+\\*\\/\\s*)*([^\\s\\(\\/]+)/;\n  var maxFunctionSourceLength = 512;\n  function getFuncName(aFunc) {\n    if (typeof aFunc !== 'function') {\n      return null;\n    }\n\n    var name = '';\n    if (typeof Function.prototype.name === 'undefined' && typeof aFunc.name === 'undefined') {\n      // eslint-disable-next-line prefer-reflect\n      var functionSource = toString.call(aFunc);\n      // To avoid unconstrained resource consumption due to pathalogically large function names,\n      // we limit the available return value to be less than 512 characters.\n      if (functionSource.indexOf('(') > maxFunctionSourceLength) {\n        return name;\n      }\n      // Here we run a polyfill if Function does not support the `name` property and if aFunc.name is not defined\n      var match = functionSource.match(functionNameMatch);\n      if (match) {\n        name = match[1];\n      }\n    } else {\n      // If we've got a `name` property we just use it\n      name = aFunc.name;\n    }\n\n    return name;\n  }\n\n  var getFuncName_1 = getFuncName;\n\n  var getArrayName = function getArrayName(array) {\n    // We need to special case Node.js' Buffers, which report to be Uint8Array\n    if (typeof Buffer === 'function' && array instanceof Buffer) {\n      return 'Buffer';\n    }\n\n    if (array[Symbol.toStringTag]) {\n      return array[Symbol.toStringTag];\n    }\n\n    return getFuncName_1(array.constructor);\n  };\n\n  function inspectTypedArray(array, options) {\n    var name = getArrayName(array);\n    options.truncate -= name.length + 4; // Object.keys will always output the Array indices first, so we can slice by\n    // `array.length` to get non-index properties\n\n    var nonIndexProperties = Object.keys(array).slice(array.length);\n    if (!array.length && !nonIndexProperties.length) return \"\".concat(name, \"[]\"); // As we know TypedArrays only contain Unsigned Integers, we can skip inspecting each one and simply\n    // stylise the toString() value of them\n\n    var output = '';\n\n    for (var i = 0; i < array.length; i++) {\n      var string = \"\".concat(options.stylize(truncate(array[i], options.truncate), 'number')).concat(i === array.length - 1 ? '' : ', ');\n      options.truncate -= string.length;\n\n      if (array[i] !== array.length && options.truncate <= 3) {\n        output += \"\".concat(truncator, \"(\").concat(array.length - array[i] + 1, \")\");\n        break;\n      }\n\n      output += string;\n    }\n\n    var propertyContents = '';\n\n    if (nonIndexProperties.length) {\n      propertyContents = inspectList(nonIndexProperties.map(function (key) {\n        return [key, array[key]];\n      }), options, inspectProperty);\n    }\n\n    return \"\".concat(name, \"[ \").concat(output).concat(propertyContents ? \", \".concat(propertyContents) : '', \" ]\");\n  }\n\n  function inspectDate(dateObject, options) {\n    var stringRepresentation = dateObject.toJSON();\n\n    if (stringRepresentation === null) {\n      return 'Invalid Date';\n    }\n\n    var split = stringRepresentation.split('T');\n    var date = split[0]; // If we need to - truncate the time portion, but never the date\n\n    return options.stylize(\"\".concat(date, \"T\").concat(truncate(split[1], options.truncate - date.length - 1)), 'date');\n  }\n\n  function inspectFunction(func, options) {\n    var name = getFuncName_1(func);\n\n    if (!name) {\n      return options.stylize('[Function]', 'special');\n    }\n\n    return options.stylize(\"[Function \".concat(truncate(name, options.truncate - 11), \"]\"), 'special');\n  }\n\n  function inspectMapEntry(_ref, options) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n\n    options.truncate -= 4;\n    key = options.inspect(key, options);\n    options.truncate -= key.length;\n    value = options.inspect(value, options);\n    return \"\".concat(key, \" => \").concat(value);\n  } // IE11 doesn't support `map.entries()`\n\n\n  function mapToEntries(map) {\n    var entries = [];\n    map.forEach(function (value, key) {\n      entries.push([key, value]);\n    });\n    return entries;\n  }\n\n  function inspectMap(map, options) {\n    var size = map.size - 1;\n\n    if (size <= 0) {\n      return 'Map{}';\n    }\n\n    options.truncate -= 7;\n    return \"Map{ \".concat(inspectList(mapToEntries(map), options, inspectMapEntry), \" }\");\n  }\n\n  var isNaN = Number.isNaN || function (i) {\n    return i !== i;\n  }; // eslint-disable-line no-self-compare\n\n\n  function inspectNumber(number, options) {\n    if (isNaN(number)) {\n      return options.stylize('NaN', 'number');\n    }\n\n    if (number === Infinity) {\n      return options.stylize('Infinity', 'number');\n    }\n\n    if (number === -Infinity) {\n      return options.stylize('-Infinity', 'number');\n    }\n\n    if (number === 0) {\n      return options.stylize(1 / number === Infinity ? '+0' : '-0', 'number');\n    }\n\n    return options.stylize(truncate(number, options.truncate), 'number');\n  }\n\n  function inspectBigInt(number, options) {\n    var nums = truncate(number.toString(), options.truncate - 1);\n    if (nums !== truncator) nums += 'n';\n    return options.stylize(nums, 'bigint');\n  }\n\n  function inspectRegExp(value, options) {\n    var flags = value.toString().split('/')[2];\n    var sourceLength = options.truncate - (2 + flags.length);\n    var source = value.source;\n    return options.stylize(\"/\".concat(truncate(source, sourceLength), \"/\").concat(flags), 'regexp');\n  }\n\n  function arrayFromSet(set) {\n    var values = [];\n    set.forEach(function (value) {\n      values.push(value);\n    });\n    return values;\n  }\n\n  function inspectSet(set, options) {\n    if (set.size === 0) return 'Set{}';\n    options.truncate -= 7;\n    return \"Set{ \".concat(inspectList(arrayFromSet(set), options), \" }\");\n  }\n\n  var stringEscapeChars = new RegExp(\"['\\\\u0000-\\\\u001f\\\\u007f-\\\\u009f\\\\u00ad\\\\u0600-\\\\u0604\\\\u070f\\\\u17b4\\\\u17b5\" + \"\\\\u200c-\\\\u200f\\\\u2028-\\\\u202f\\\\u2060-\\\\u206f\\\\ufeff\\\\ufff0-\\\\uffff]\", 'g');\n  var escapeCharacters = {\n    '\\b': '\\\\b',\n    '\\t': '\\\\t',\n    '\\n': '\\\\n',\n    '\\f': '\\\\f',\n    '\\r': '\\\\r',\n    \"'\": \"\\\\'\",\n    '\\\\': '\\\\\\\\'\n  };\n  var hex = 16;\n  var unicodeLength = 4;\n\n  function escape(char) {\n    return escapeCharacters[char] || \"\\\\u\".concat(\"0000\".concat(char.charCodeAt(0).toString(hex)).slice(-unicodeLength));\n  }\n\n  function inspectString(string, options) {\n    if (stringEscapeChars.test(string)) {\n      string = string.replace(stringEscapeChars, escape);\n    }\n\n    return options.stylize(\"'\".concat(truncate(string, options.truncate - 2), \"'\"), 'string');\n  }\n\n  function inspectSymbol(value) {\n    if ('description' in Symbol.prototype) {\n      return value.description ? \"Symbol(\".concat(value.description, \")\") : 'Symbol()';\n    }\n\n    return value.toString();\n  }\n\n  var getPromiseValue = function getPromiseValue() {\n    return 'Promise{}';\n  };\n\n  try {\n    var _process$binding = process.binding('util'),\n        getPromiseDetails = _process$binding.getPromiseDetails,\n        kPending = _process$binding.kPending,\n        kRejected = _process$binding.kRejected;\n\n    if (Array.isArray(getPromiseDetails(Promise.resolve()))) {\n      getPromiseValue = function getPromiseValue(value, options) {\n        var _getPromiseDetails = getPromiseDetails(value),\n            _getPromiseDetails2 = _slicedToArray(_getPromiseDetails, 2),\n            state = _getPromiseDetails2[0],\n            innerValue = _getPromiseDetails2[1];\n\n        if (state === kPending) {\n          return 'Promise{<pending>}';\n        }\n\n        return \"Promise\".concat(state === kRejected ? '!' : '', \"{\").concat(options.inspect(innerValue, options), \"}\");\n      };\n    }\n  } catch (notNode) {\n    /* ignore */\n  }\n\n  var inspectPromise = getPromiseValue;\n\n  function inspectObject(object, options) {\n    var properties = Object.getOwnPropertyNames(object);\n    var symbols = Object.getOwnPropertySymbols ? Object.getOwnPropertySymbols(object) : [];\n\n    if (properties.length === 0 && symbols.length === 0) {\n      return '{}';\n    }\n\n    options.truncate -= 4;\n    options.seen = options.seen || [];\n\n    if (options.seen.indexOf(object) >= 0) {\n      return '[Circular]';\n    }\n\n    options.seen.push(object);\n    var propertyContents = inspectList(properties.map(function (key) {\n      return [key, object[key]];\n    }), options, inspectProperty);\n    var symbolContents = inspectList(symbols.map(function (key) {\n      return [key, object[key]];\n    }), options, inspectProperty);\n    options.seen.pop();\n    var sep = '';\n\n    if (propertyContents && symbolContents) {\n      sep = ', ';\n    }\n\n    return \"{ \".concat(propertyContents).concat(sep).concat(symbolContents, \" }\");\n  }\n\n  var toStringTag = typeof Symbol !== 'undefined' && Symbol.toStringTag ? Symbol.toStringTag : false;\n  function inspectClass(value, options) {\n    var name = '';\n\n    if (toStringTag && toStringTag in value) {\n      name = value[toStringTag];\n    }\n\n    name = name || getFuncName_1(value.constructor); // Babel transforms anonymous classes to the name `_class`\n\n    if (!name || name === '_class') {\n      name = '<Anonymous Class>';\n    }\n\n    options.truncate -= name.length;\n    return \"\".concat(name).concat(inspectObject(value, options));\n  }\n\n  function inspectArguments(args, options) {\n    if (args.length === 0) return 'Arguments[]';\n    options.truncate -= 13;\n    return \"Arguments[ \".concat(inspectList(args, options), \" ]\");\n  }\n\n  var errorKeys = ['stack', 'line', 'column', 'name', 'message', 'fileName', 'lineNumber', 'columnNumber', 'number', 'description'];\n  function inspectObject$1(error, options) {\n    var properties = Object.getOwnPropertyNames(error).filter(function (key) {\n      return errorKeys.indexOf(key) === -1;\n    });\n    var name = error.name;\n    options.truncate -= name.length;\n    var message = '';\n\n    if (typeof error.message === 'string') {\n      message = truncate(error.message, options.truncate);\n    } else {\n      properties.unshift('message');\n    }\n\n    message = message ? \": \".concat(message) : '';\n    options.truncate -= message.length + 5;\n    var propertyContents = inspectList(properties.map(function (key) {\n      return [key, error[key]];\n    }), options, inspectProperty);\n    return \"\".concat(name).concat(message).concat(propertyContents ? \" { \".concat(propertyContents, \" }\") : '');\n  }\n\n  function inspectAttribute(_ref, options) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        value = _ref2[1];\n\n    options.truncate -= 3;\n\n    if (!value) {\n      return \"\".concat(options.stylize(key, 'yellow'));\n    }\n\n    return \"\".concat(options.stylize(key, 'yellow'), \"=\").concat(options.stylize(\"\\\"\".concat(value, \"\\\"\"), 'string'));\n  }\n  function inspectHTMLCollection(collection, options) {\n    // eslint-disable-next-line no-use-before-define\n    return inspectList(collection, options, inspectHTML, '\\n');\n  }\n  function inspectHTML(element, options) {\n    var properties = element.getAttributeNames();\n    var name = element.tagName.toLowerCase();\n    var head = options.stylize(\"<\".concat(name), 'special');\n    var headClose = options.stylize(\">\", 'special');\n    var tail = options.stylize(\"</\".concat(name, \">\"), 'special');\n    options.truncate -= name.length * 2 + 5;\n    var propertyContents = '';\n\n    if (properties.length > 0) {\n      propertyContents += ' ';\n      propertyContents += inspectList(properties.map(function (key) {\n        return [key, element.getAttribute(key)];\n      }), options, inspectAttribute, ' ');\n    }\n\n    options.truncate -= propertyContents.length;\n    var truncate = options.truncate;\n    var children = inspectHTMLCollection(element.children, options);\n\n    if (children && children.length > truncate) {\n      children = \"\".concat(truncator, \"(\").concat(element.children.length, \")\");\n    }\n\n    return \"\".concat(head).concat(propertyContents).concat(headClose).concat(children).concat(tail);\n  }\n\n  var symbolsSupported = typeof Symbol === 'function' && typeof Symbol.for === 'function';\n  var chaiInspect = symbolsSupported ? Symbol.for('chai/inspect') : '@@chai/inspect';\n  var nodeInspect = false;\n\n  try {\n    // eslint-disable-next-line global-require\n    var nodeUtil = require('util');\n\n    nodeInspect = nodeUtil.inspect ? nodeUtil.inspect.custom : false;\n  } catch (noNodeInspect) {\n    nodeInspect = false;\n  }\n\n  function FakeMap() {\n    // eslint-disable-next-line prefer-template\n    this.key = 'chai/loupe__' + Math.random() + Date.now();\n  }\n\n  FakeMap.prototype = {\n    // eslint-disable-next-line object-shorthand\n    get: function get(key) {\n      return key[this.key];\n    },\n    // eslint-disable-next-line object-shorthand\n    has: function has(key) {\n      return this.key in key;\n    },\n    // eslint-disable-next-line object-shorthand\n    set: function set(key, value) {\n      if (Object.isExtensible(key)) {\n        Object.defineProperty(key, this.key, {\n          // eslint-disable-next-line object-shorthand\n          value: value,\n          configurable: true\n        });\n      }\n    }\n  };\n  var constructorMap = new (typeof WeakMap === 'function' ? WeakMap : FakeMap)();\n  var stringTagMap = {};\n  var baseTypesMap = {\n    undefined: function undefined$1(value, options) {\n      return options.stylize('undefined', 'undefined');\n    },\n    null: function _null(value, options) {\n      return options.stylize(null, 'null');\n    },\n    boolean: function boolean(value, options) {\n      return options.stylize(value, 'boolean');\n    },\n    Boolean: function Boolean(value, options) {\n      return options.stylize(value, 'boolean');\n    },\n    number: inspectNumber,\n    Number: inspectNumber,\n    bigint: inspectBigInt,\n    BigInt: inspectBigInt,\n    string: inspectString,\n    String: inspectString,\n    function: inspectFunction,\n    Function: inspectFunction,\n    symbol: inspectSymbol,\n    // A Symbol polyfill will return `Symbol` not `symbol` from typedetect\n    Symbol: inspectSymbol,\n    Array: inspectArray,\n    Date: inspectDate,\n    Map: inspectMap,\n    Set: inspectSet,\n    RegExp: inspectRegExp,\n    Promise: inspectPromise,\n    // WeakSet, WeakMap are totally opaque to us\n    WeakSet: function WeakSet(value, options) {\n      return options.stylize('WeakSet{}', 'special');\n    },\n    WeakMap: function WeakMap(value, options) {\n      return options.stylize('WeakMap{}', 'special');\n    },\n    Arguments: inspectArguments,\n    Int8Array: inspectTypedArray,\n    Uint8Array: inspectTypedArray,\n    Uint8ClampedArray: inspectTypedArray,\n    Int16Array: inspectTypedArray,\n    Uint16Array: inspectTypedArray,\n    Int32Array: inspectTypedArray,\n    Uint32Array: inspectTypedArray,\n    Float32Array: inspectTypedArray,\n    Float64Array: inspectTypedArray,\n    Generator: function Generator() {\n      return '';\n    },\n    DataView: function DataView() {\n      return '';\n    },\n    ArrayBuffer: function ArrayBuffer() {\n      return '';\n    },\n    Error: inspectObject$1,\n    HTMLCollection: inspectHTMLCollection,\n    NodeList: inspectHTMLCollection\n  }; // eslint-disable-next-line complexity\n\n  var inspectCustom = function inspectCustom(value, options, type) {\n    if (chaiInspect in value && typeof value[chaiInspect] === 'function') {\n      return value[chaiInspect](options);\n    }\n\n    if (nodeInspect && nodeInspect in value && typeof value[nodeInspect] === 'function') {\n      return value[nodeInspect](options.depth, options);\n    }\n\n    if ('inspect' in value && typeof value.inspect === 'function') {\n      return value.inspect(options.depth, options);\n    }\n\n    if ('constructor' in value && constructorMap.has(value.constructor)) {\n      return constructorMap.get(value.constructor)(value, options);\n    }\n\n    if (stringTagMap[type]) {\n      return stringTagMap[type](value, options);\n    }\n\n    return '';\n  };\n\n  var toString$1 = Object.prototype.toString; // eslint-disable-next-line complexity\n\n  function inspect(value, options) {\n    options = normaliseOptions(options);\n    options.inspect = inspect;\n    var _options = options,\n        customInspect = _options.customInspect;\n    var type = value === null ? 'null' : _typeof(value);\n\n    if (type === 'object') {\n      type = toString$1.call(value).slice(8, -1);\n    } // If it is a base value that we already support, then use Loupe's inspector\n\n\n    if (baseTypesMap[type]) {\n      return baseTypesMap[type](value, options);\n    } // If `options.customInspect` is set to true then try to use the custom inspector\n\n\n    if (customInspect && value) {\n      var output = inspectCustom(value, options, type);\n\n      if (output) {\n        if (typeof output === 'string') return output;\n        return inspect(output, options);\n      }\n    }\n\n    var proto = value ? Object.getPrototypeOf(value) : false; // If it's a plain Object then use Loupe's inspector\n\n    if (proto === Object.prototype || proto === null) {\n      return inspectObject(value, options);\n    } // Specifically account for HTMLElements\n    // eslint-disable-next-line no-undef\n\n\n    if (value && typeof HTMLElement === 'function' && value instanceof HTMLElement) {\n      return inspectHTML(value, options);\n    }\n\n    if ('constructor' in value) {\n      // If it is a class, inspect it like an object but add the constructor name\n      if (value.constructor !== Object) {\n        return inspectClass(value, options);\n      } // If it is an object with an anonymous prototype, display it as an object.\n\n\n      return inspectObject(value, options);\n    } // last chance to check if it's an object\n\n\n    if (value === Object(value)) {\n      return inspectObject(value, options);\n    } // We have run out of options! Just stringify the value\n\n\n    return options.stylize(String(value), type);\n  }\n  function registerConstructor(constructor, inspector) {\n    if (constructorMap.has(constructor)) {\n      return false;\n    }\n\n    constructorMap.set(constructor, inspector);\n    return true;\n  }\n  function registerStringTag(stringTag, inspector) {\n    if (stringTag in stringTagMap) {\n      return false;\n    }\n\n    stringTagMap[stringTag] = inspector;\n    return true;\n  }\n  var custom = chaiInspect;\n\n  exports.custom = custom;\n  exports.default = inspect;\n  exports.inspect = inspect;\n  exports.registerConstructor = registerConstructor;\n  exports.registerStringTag = registerStringTag;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","'use strict';\n\n/* !\n * Chai - pathval utility\n * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>\n * @see https://github.com/logicalparadox/filtr\n * MIT Licensed\n */\n\n/**\n * ### .hasProperty(object, name)\n *\n * This allows checking whether an object has own\n * or inherited from prototype chain named property.\n *\n * Basically does the same thing as the `in`\n * operator but works properly with null/undefined values\n * and other primitives.\n *\n *     var obj = {\n *         arr: ['a', 'b', 'c']\n *       , str: 'Hello'\n *     }\n *\n * The following would be the results.\n *\n *     hasProperty(obj, 'str');  // true\n *     hasProperty(obj, 'constructor');  // true\n *     hasProperty(obj, 'bar');  // false\n *\n *     hasProperty(obj.str, 'length'); // true\n *     hasProperty(obj.str, 1);  // true\n *     hasProperty(obj.str, 5);  // false\n *\n *     hasProperty(obj.arr, 'length');  // true\n *     hasProperty(obj.arr, 2);  // true\n *     hasProperty(obj.arr, 3);  // false\n *\n * @param {Object} object\n * @param {String|Symbol} name\n * @returns {Boolean} whether it exists\n * @namespace Utils\n * @name hasProperty\n * @api public\n */\n\nfunction hasProperty(obj, name) {\n  if (typeof obj === 'undefined' || obj === null) {\n    return false;\n  }\n\n  // The `in` operator does not work with primitives.\n  return name in Object(obj);\n}\n\n/* !\n * ## parsePath(path)\n *\n * Helper function used to parse string object\n * paths. Use in conjunction with `internalGetPathValue`.\n *\n *      var parsed = parsePath('myobject.property.subprop');\n *\n * ### Paths:\n *\n * * Can be infinitely deep and nested.\n * * Arrays are also valid using the formal `myobject.document[3].property`.\n * * Literal dots and brackets (not delimiter) must be backslash-escaped.\n *\n * @param {String} path\n * @returns {Object} parsed\n * @api private\n */\n\nfunction parsePath(path) {\n  var str = path.replace(/([^\\\\])\\[/g, '$1.[');\n  var parts = str.match(/(\\\\\\.|[^.]+?)+/g);\n  return parts.map(function mapMatches(value) {\n    if (\n      value === 'constructor' ||\n      value === '__proto__' ||\n      value === 'prototype'\n    ) {\n      return {};\n    }\n    var regexp = /^\\[(\\d+)\\]$/;\n    var mArr = regexp.exec(value);\n    var parsed = null;\n    if (mArr) {\n      parsed = { i: parseFloat(mArr[1]) };\n    } else {\n      parsed = { p: value.replace(/\\\\([.[\\]])/g, '$1') };\n    }\n\n    return parsed;\n  });\n}\n\n/* !\n * ## internalGetPathValue(obj, parsed[, pathDepth])\n *\n * Helper companion function for `.parsePath` that returns\n * the value located at the parsed address.\n *\n *      var value = getPathValue(obj, parsed);\n *\n * @param {Object} object to search against\n * @param {Object} parsed definition from `parsePath`.\n * @param {Number} depth (nesting level) of the property we want to retrieve\n * @returns {Object|Undefined} value\n * @api private\n */\n\nfunction internalGetPathValue(obj, parsed, pathDepth) {\n  var temporaryValue = obj;\n  var res = null;\n  pathDepth = typeof pathDepth === 'undefined' ? parsed.length : pathDepth;\n\n  for (var i = 0; i < pathDepth; i++) {\n    var part = parsed[i];\n    if (temporaryValue) {\n      if (typeof part.p === 'undefined') {\n        temporaryValue = temporaryValue[part.i];\n      } else {\n        temporaryValue = temporaryValue[part.p];\n      }\n\n      if (i === pathDepth - 1) {\n        res = temporaryValue;\n      }\n    }\n  }\n\n  return res;\n}\n\n/* !\n * ## internalSetPathValue(obj, value, parsed)\n *\n * Companion function for `parsePath` that sets\n * the value located at a parsed address.\n *\n *  internalSetPathValue(obj, 'value', parsed);\n *\n * @param {Object} object to search and define on\n * @param {*} value to use upon set\n * @param {Object} parsed definition from `parsePath`\n * @api private\n */\n\nfunction internalSetPathValue(obj, val, parsed) {\n  var tempObj = obj;\n  var pathDepth = parsed.length;\n  var part = null;\n  // Here we iterate through every part of the path\n  for (var i = 0; i < pathDepth; i++) {\n    var propName = null;\n    var propVal = null;\n    part = parsed[i];\n\n    // If it's the last part of the path, we set the 'propName' value with the property name\n    if (i === pathDepth - 1) {\n      propName = typeof part.p === 'undefined' ? part.i : part.p;\n      // Now we set the property with the name held by 'propName' on object with the desired val\n      tempObj[propName] = val;\n    } else if (typeof part.p !== 'undefined' && tempObj[part.p]) {\n      tempObj = tempObj[part.p];\n    } else if (typeof part.i !== 'undefined' && tempObj[part.i]) {\n      tempObj = tempObj[part.i];\n    } else {\n      // If the obj doesn't have the property we create one with that name to define it\n      var next = parsed[i + 1];\n      // Here we set the name of the property which will be defined\n      propName = typeof part.p === 'undefined' ? part.i : part.p;\n      // Here we decide if this property will be an array or a new object\n      propVal = typeof next.p === 'undefined' ? [] : {};\n      tempObj[propName] = propVal;\n      tempObj = tempObj[propName];\n    }\n  }\n}\n\n/**\n * ### .getPathInfo(object, path)\n *\n * This allows the retrieval of property info in an\n * object given a string path.\n *\n * The path info consists of an object with the\n * following properties:\n *\n * * parent - The parent object of the property referenced by `path`\n * * name - The name of the final property, a number if it was an array indexer\n * * value - The value of the property, if it exists, otherwise `undefined`\n * * exists - Whether the property exists or not\n *\n * @param {Object} object\n * @param {String} path\n * @returns {Object} info\n * @namespace Utils\n * @name getPathInfo\n * @api public\n */\n\nfunction getPathInfo(obj, path) {\n  var parsed = parsePath(path);\n  var last = parsed[parsed.length - 1];\n  var info = {\n    parent:\n      parsed.length > 1 ?\n        internalGetPathValue(obj, parsed, parsed.length - 1) :\n        obj,\n    name: last.p || last.i,\n    value: internalGetPathValue(obj, parsed),\n  };\n  info.exists = hasProperty(info.parent, info.name);\n\n  return info;\n}\n\n/**\n * ### .getPathValue(object, path)\n *\n * This allows the retrieval of values in an\n * object given a string path.\n *\n *     var obj = {\n *         prop1: {\n *             arr: ['a', 'b', 'c']\n *           , str: 'Hello'\n *         }\n *       , prop2: {\n *             arr: [ { nested: 'Universe' } ]\n *           , str: 'Hello again!'\n *         }\n *     }\n *\n * The following would be the results.\n *\n *     getPathValue(obj, 'prop1.str'); // Hello\n *     getPathValue(obj, 'prop1.att[2]'); // b\n *     getPathValue(obj, 'prop2.arr[0].nested'); // Universe\n *\n * @param {Object} object\n * @param {String} path\n * @returns {Object} value or `undefined`\n * @namespace Utils\n * @name getPathValue\n * @api public\n */\n\nfunction getPathValue(obj, path) {\n  var info = getPathInfo(obj, path);\n  return info.value;\n}\n\n/**\n * ### .setPathValue(object, path, value)\n *\n * Define the value in an object at a given string path.\n *\n * ```js\n * var obj = {\n *     prop1: {\n *         arr: ['a', 'b', 'c']\n *       , str: 'Hello'\n *     }\n *   , prop2: {\n *         arr: [ { nested: 'Universe' } ]\n *       , str: 'Hello again!'\n *     }\n * };\n * ```\n *\n * The following would be acceptable.\n *\n * ```js\n * var properties = require('tea-properties');\n * properties.set(obj, 'prop1.str', 'Hello Universe!');\n * properties.set(obj, 'prop1.arr[2]', 'B');\n * properties.set(obj, 'prop2.arr[0].nested.value', { hello: 'universe' });\n * ```\n *\n * @param {Object} object\n * @param {String} path\n * @param {Mixed} value\n * @api private\n */\n\nfunction setPathValue(obj, path, val) {\n  var parsed = parsePath(path);\n  internalSetPathValue(obj, val, parsed);\n  return obj;\n}\n\nmodule.exports = {\n  hasProperty: hasProperty,\n  getPathInfo: getPathInfo,\n  getPathValue: getPathValue,\n  setPathValue: setPathValue,\n};\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.typeDetect = factory());\n}(this, (function () { 'use strict';\n\n/* !\n * type-detect\n * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\nvar promiseExists = typeof Promise === 'function';\n\n/* eslint-disable no-undef */\nvar globalObject = typeof self === 'object' ? self : global; // eslint-disable-line id-blacklist\n\nvar symbolExists = typeof Symbol !== 'undefined';\nvar mapExists = typeof Map !== 'undefined';\nvar setExists = typeof Set !== 'undefined';\nvar weakMapExists = typeof WeakMap !== 'undefined';\nvar weakSetExists = typeof WeakSet !== 'undefined';\nvar dataViewExists = typeof DataView !== 'undefined';\nvar symbolIteratorExists = symbolExists && typeof Symbol.iterator !== 'undefined';\nvar symbolToStringTagExists = symbolExists && typeof Symbol.toStringTag !== 'undefined';\nvar setEntriesExists = setExists && typeof Set.prototype.entries === 'function';\nvar mapEntriesExists = mapExists && typeof Map.prototype.entries === 'function';\nvar setIteratorPrototype = setEntriesExists && Object.getPrototypeOf(new Set().entries());\nvar mapIteratorPrototype = mapEntriesExists && Object.getPrototypeOf(new Map().entries());\nvar arrayIteratorExists = symbolIteratorExists && typeof Array.prototype[Symbol.iterator] === 'function';\nvar arrayIteratorPrototype = arrayIteratorExists && Object.getPrototypeOf([][Symbol.iterator]());\nvar stringIteratorExists = symbolIteratorExists && typeof String.prototype[Symbol.iterator] === 'function';\nvar stringIteratorPrototype = stringIteratorExists && Object.getPrototypeOf(''[Symbol.iterator]());\nvar toStringLeftSliceLength = 8;\nvar toStringRightSliceLength = -1;\n/**\n * ### typeOf (obj)\n *\n * Uses `Object.prototype.toString` to determine the type of an object,\n * normalising behaviour across engine versions & well optimised.\n *\n * @param {Mixed} object\n * @return {String} object type\n * @api public\n */\nfunction typeDetect(obj) {\n  /* ! Speed optimisation\n   * Pre:\n   *   string literal     x 3,039,035 ops/sec 1.62% (78 runs sampled)\n   *   boolean literal    x 1,424,138 ops/sec 4.54% (75 runs sampled)\n   *   number literal     x 1,653,153 ops/sec 1.91% (82 runs sampled)\n   *   undefined          x 9,978,660 ops/sec 1.92% (75 runs sampled)\n   *   function           x 2,556,769 ops/sec 1.73% (77 runs sampled)\n   * Post:\n   *   string literal     x 38,564,796 ops/sec 1.15% (79 runs sampled)\n   *   boolean literal    x 31,148,940 ops/sec 1.10% (79 runs sampled)\n   *   number literal     x 32,679,330 ops/sec 1.90% (78 runs sampled)\n   *   undefined          x 32,363,368 ops/sec 1.07% (82 runs sampled)\n   *   function           x 31,296,870 ops/sec 0.96% (83 runs sampled)\n   */\n  var typeofObj = typeof obj;\n  if (typeofObj !== 'object') {\n    return typeofObj;\n  }\n\n  /* ! Speed optimisation\n   * Pre:\n   *   null               x 28,645,765 ops/sec 1.17% (82 runs sampled)\n   * Post:\n   *   null               x 36,428,962 ops/sec 1.37% (84 runs sampled)\n   */\n  if (obj === null) {\n    return 'null';\n  }\n\n  /* ! Spec Conformance\n   * Test: `Object.prototype.toString.call(window)``\n   *  - Node === \"[object global]\"\n   *  - Chrome === \"[object global]\"\n   *  - Firefox === \"[object Window]\"\n   *  - PhantomJS === \"[object Window]\"\n   *  - Safari === \"[object Window]\"\n   *  - IE 11 === \"[object Window]\"\n   *  - IE Edge === \"[object Window]\"\n   * Test: `Object.prototype.toString.call(this)``\n   *  - Chrome Worker === \"[object global]\"\n   *  - Firefox Worker === \"[object DedicatedWorkerGlobalScope]\"\n   *  - Safari Worker === \"[object DedicatedWorkerGlobalScope]\"\n   *  - IE 11 Worker === \"[object WorkerGlobalScope]\"\n   *  - IE Edge Worker === \"[object WorkerGlobalScope]\"\n   */\n  if (obj === globalObject) {\n    return 'global';\n  }\n\n  /* ! Speed optimisation\n   * Pre:\n   *   array literal      x 2,888,352 ops/sec 0.67% (82 runs sampled)\n   * Post:\n   *   array literal      x 22,479,650 ops/sec 0.96% (81 runs sampled)\n   */\n  if (\n    Array.isArray(obj) &&\n    (symbolToStringTagExists === false || !(Symbol.toStringTag in obj))\n  ) {\n    return 'Array';\n  }\n\n  // Not caching existence of `window` and related properties due to potential\n  // for `window` to be unset before tests in quasi-browser environments.\n  if (typeof window === 'object' && window !== null) {\n    /* ! Spec Conformance\n     * (https://html.spec.whatwg.org/multipage/browsers.html#location)\n     * WhatWG HTML$7.7.3 - The `Location` interface\n     * Test: `Object.prototype.toString.call(window.location)``\n     *  - IE <=11 === \"[object Object]\"\n     *  - IE Edge <=13 === \"[object Object]\"\n     */\n    if (typeof window.location === 'object' && obj === window.location) {\n      return 'Location';\n    }\n\n    /* ! Spec Conformance\n     * (https://html.spec.whatwg.org/#document)\n     * WhatWG HTML$3.1.1 - The `Document` object\n     * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n     *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-26809268)\n     *       which suggests that browsers should use HTMLTableCellElement for\n     *       both TD and TH elements. WhatWG separates these.\n     *       WhatWG HTML states:\n     *         > For historical reasons, Window objects must also have a\n     *         > writable, configurable, non-enumerable property named\n     *         > HTMLDocument whose value is the Document interface object.\n     * Test: `Object.prototype.toString.call(document)``\n     *  - Chrome === \"[object HTMLDocument]\"\n     *  - Firefox === \"[object HTMLDocument]\"\n     *  - Safari === \"[object HTMLDocument]\"\n     *  - IE <=10 === \"[object Document]\"\n     *  - IE 11 === \"[object HTMLDocument]\"\n     *  - IE Edge <=13 === \"[object HTMLDocument]\"\n     */\n    if (typeof window.document === 'object' && obj === window.document) {\n      return 'Document';\n    }\n\n    if (typeof window.navigator === 'object') {\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/multipage/webappapis.html#mimetypearray)\n       * WhatWG HTML$8.6.1.5 - Plugins - Interface MimeTypeArray\n       * Test: `Object.prototype.toString.call(navigator.mimeTypes)``\n       *  - IE <=10 === \"[object MSMimeTypesCollection]\"\n       */\n      if (typeof window.navigator.mimeTypes === 'object' &&\n          obj === window.navigator.mimeTypes) {\n        return 'MimeTypeArray';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/multipage/webappapis.html#pluginarray)\n       * WhatWG HTML$8.6.1.5 - Plugins - Interface PluginArray\n       * Test: `Object.prototype.toString.call(navigator.plugins)``\n       *  - IE <=10 === \"[object MSPluginsCollection]\"\n       */\n      if (typeof window.navigator.plugins === 'object' &&\n          obj === window.navigator.plugins) {\n        return 'PluginArray';\n      }\n    }\n\n    if ((typeof window.HTMLElement === 'function' ||\n        typeof window.HTMLElement === 'object') &&\n        obj instanceof window.HTMLElement) {\n      /* ! Spec Conformance\n      * (https://html.spec.whatwg.org/multipage/webappapis.html#pluginarray)\n      * WhatWG HTML$4.4.4 - The `blockquote` element - Interface `HTMLQuoteElement`\n      * Test: `Object.prototype.toString.call(document.createElement('blockquote'))``\n      *  - IE <=10 === \"[object HTMLBlockElement]\"\n      */\n      if (obj.tagName === 'BLOCKQUOTE') {\n        return 'HTMLQuoteElement';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/#htmltabledatacellelement)\n       * WhatWG HTML$4.9.9 - The `td` element - Interface `HTMLTableDataCellElement`\n       * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n       *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-82915075)\n       *       which suggests that browsers should use HTMLTableCellElement for\n       *       both TD and TH elements. WhatWG separates these.\n       * Test: Object.prototype.toString.call(document.createElement('td'))\n       *  - Chrome === \"[object HTMLTableCellElement]\"\n       *  - Firefox === \"[object HTMLTableCellElement]\"\n       *  - Safari === \"[object HTMLTableCellElement]\"\n       */\n      if (obj.tagName === 'TD') {\n        return 'HTMLTableDataCellElement';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/#htmltableheadercellelement)\n       * WhatWG HTML$4.9.9 - The `td` element - Interface `HTMLTableHeaderCellElement`\n       * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n       *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-82915075)\n       *       which suggests that browsers should use HTMLTableCellElement for\n       *       both TD and TH elements. WhatWG separates these.\n       * Test: Object.prototype.toString.call(document.createElement('th'))\n       *  - Chrome === \"[object HTMLTableCellElement]\"\n       *  - Firefox === \"[object HTMLTableCellElement]\"\n       *  - Safari === \"[object HTMLTableCellElement]\"\n       */\n      if (obj.tagName === 'TH') {\n        return 'HTMLTableHeaderCellElement';\n      }\n    }\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   Float64Array       x 625,644 ops/sec 1.58% (80 runs sampled)\n  *   Float32Array       x 1,279,852 ops/sec 2.91% (77 runs sampled)\n  *   Uint32Array        x 1,178,185 ops/sec 1.95% (83 runs sampled)\n  *   Uint16Array        x 1,008,380 ops/sec 2.25% (80 runs sampled)\n  *   Uint8Array         x 1,128,040 ops/sec 2.11% (81 runs sampled)\n  *   Int32Array         x 1,170,119 ops/sec 2.88% (80 runs sampled)\n  *   Int16Array         x 1,176,348 ops/sec 5.79% (86 runs sampled)\n  *   Int8Array          x 1,058,707 ops/sec 4.94% (77 runs sampled)\n  *   Uint8ClampedArray  x 1,110,633 ops/sec 4.20% (80 runs sampled)\n  * Post:\n  *   Float64Array       x 7,105,671 ops/sec 13.47% (64 runs sampled)\n  *   Float32Array       x 5,887,912 ops/sec 1.46% (82 runs sampled)\n  *   Uint32Array        x 6,491,661 ops/sec 1.76% (79 runs sampled)\n  *   Uint16Array        x 6,559,795 ops/sec 1.67% (82 runs sampled)\n  *   Uint8Array         x 6,463,966 ops/sec 1.43% (85 runs sampled)\n  *   Int32Array         x 5,641,841 ops/sec 3.49% (81 runs sampled)\n  *   Int16Array         x 6,583,511 ops/sec 1.98% (80 runs sampled)\n  *   Int8Array          x 6,606,078 ops/sec 1.74% (81 runs sampled)\n  *   Uint8ClampedArray  x 6,602,224 ops/sec 1.77% (83 runs sampled)\n  */\n  var stringTag = (symbolToStringTagExists && obj[Symbol.toStringTag]);\n  if (typeof stringTag === 'string') {\n    return stringTag;\n  }\n\n  var objPrototype = Object.getPrototypeOf(obj);\n  /* ! Speed optimisation\n  * Pre:\n  *   regex literal      x 1,772,385 ops/sec 1.85% (77 runs sampled)\n  *   regex constructor  x 2,143,634 ops/sec 2.46% (78 runs sampled)\n  * Post:\n  *   regex literal      x 3,928,009 ops/sec 0.65% (78 runs sampled)\n  *   regex constructor  x 3,931,108 ops/sec 0.58% (84 runs sampled)\n  */\n  if (objPrototype === RegExp.prototype) {\n    return 'RegExp';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   date               x 2,130,074 ops/sec 4.42% (68 runs sampled)\n  * Post:\n  *   date               x 3,953,779 ops/sec 1.35% (77 runs sampled)\n  */\n  if (objPrototype === Date.prototype) {\n    return 'Date';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise.prototype-@@tostringtag)\n   * ES6$25.4.5.4 - Promise.prototype[@@toStringTag] should be \"Promise\":\n   * Test: `Object.prototype.toString.call(Promise.resolve())``\n   *  - Chrome <=47 === \"[object Object]\"\n   *  - Edge <=20 === \"[object Object]\"\n   *  - Firefox 29-Latest === \"[object Promise]\"\n   *  - Safari 7.1-Latest === \"[object Promise]\"\n   */\n  if (promiseExists && objPrototype === Promise.prototype) {\n    return 'Promise';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   set                x 2,222,186 ops/sec 1.31% (82 runs sampled)\n  * Post:\n  *   set                x 4,545,879 ops/sec 1.13% (83 runs sampled)\n  */\n  if (setExists && objPrototype === Set.prototype) {\n    return 'Set';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   map                x 2,396,842 ops/sec 1.59% (81 runs sampled)\n  * Post:\n  *   map                x 4,183,945 ops/sec 6.59% (82 runs sampled)\n  */\n  if (mapExists && objPrototype === Map.prototype) {\n    return 'Map';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   weakset            x 1,323,220 ops/sec 2.17% (76 runs sampled)\n  * Post:\n  *   weakset            x 4,237,510 ops/sec 2.01% (77 runs sampled)\n  */\n  if (weakSetExists && objPrototype === WeakSet.prototype) {\n    return 'WeakSet';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   weakmap            x 1,500,260 ops/sec 2.02% (78 runs sampled)\n  * Post:\n  *   weakmap            x 3,881,384 ops/sec 1.45% (82 runs sampled)\n  */\n  if (weakMapExists && objPrototype === WeakMap.prototype) {\n    return 'WeakMap';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-dataview.prototype-@@tostringtag)\n   * ES6$24.2.4.21 - DataView.prototype[@@toStringTag] should be \"DataView\":\n   * Test: `Object.prototype.toString.call(new DataView(new ArrayBuffer(1)))``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (dataViewExists && objPrototype === DataView.prototype) {\n    return 'DataView';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%mapiteratorprototype%-@@tostringtag)\n   * ES6$23.1.5.2.2 - %MapIteratorPrototype%[@@toStringTag] should be \"Map Iterator\":\n   * Test: `Object.prototype.toString.call(new Map().entries())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (mapExists && objPrototype === mapIteratorPrototype) {\n    return 'Map Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%setiteratorprototype%-@@tostringtag)\n   * ES6$23.2.5.2.2 - %SetIteratorPrototype%[@@toStringTag] should be \"Set Iterator\":\n   * Test: `Object.prototype.toString.call(new Set().entries())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (setExists && objPrototype === setIteratorPrototype) {\n    return 'Set Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%arrayiteratorprototype%-@@tostringtag)\n   * ES6$22.1.5.2.2 - %ArrayIteratorPrototype%[@@toStringTag] should be \"Array Iterator\":\n   * Test: `Object.prototype.toString.call([][Symbol.iterator]())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (arrayIteratorExists && objPrototype === arrayIteratorPrototype) {\n    return 'Array Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%stringiteratorprototype%-@@tostringtag)\n   * ES6$21.1.5.2.2 - %StringIteratorPrototype%[@@toStringTag] should be \"String Iterator\":\n   * Test: `Object.prototype.toString.call(''[Symbol.iterator]())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (stringIteratorExists && objPrototype === stringIteratorPrototype) {\n    return 'String Iterator';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   object from null   x 2,424,320 ops/sec 1.67% (76 runs sampled)\n  * Post:\n  *   object from null   x 5,838,000 ops/sec 0.99% (84 runs sampled)\n  */\n  if (objPrototype === null) {\n    return 'Object';\n  }\n\n  return Object\n    .prototype\n    .toString\n    .call(obj)\n    .slice(toStringLeftSliceLength, toStringRightSliceLength);\n}\n\nreturn typeDetect;\n\n})));\n","<template>\n<div class=\"wrapper body\">\n    <div class=\"main-panel\">\n        <div class=\"content mt-6\">\n            <div class=\"row d-flex justify-content-center\">\n                <div class=\"col-md-10 mr-auto ml-auto\">\n                    <wizard @complete=\"wizardComplete\" finishButtonText=\"Generate Questions\">\n                        <template #header>\n                            <h3 class=\"card-title\">Insert text</h3>\n                            <h3 class=\"description\">Insert your text here</h3>\n                        </template>\n\n                        <template #default=\"slotProps\">\n                            <wizard-tab :beforeChange=\"() => validateText(slotProps)\" id=\"new-text-tab\">\n                                <template #label>\n                                    New Text\n                                </template>\n                                <div class=\"wizard-tab-content\">\n                                    <div class=\"form-group\">\n                                        <textarea class=\"form-control qgen-text-style\" v-model=\"text\" placeholder=\"Enter at least 10 characters\" rows=\"16\"></textarea>\n                                    </div>\n                                </div>\n\n                            </wizard-tab>\n\n                            <wizard-tab :beforeChange=\"() => validateAnnotations(slotProps)\" :afterRender=\"annotationsTabAfterRender\" id=\"text-annotation-tab\">\n                                <template #label>\n                                    Text Annotation\n                                </template>\n                                <div v-show=\"annotationsReceived\" class=\"wizard-tab-content\">\n                                    <div class=\"form-group row\">\n                                        <div class=\"ml-5 col-lg-2 d-flex align-items-center\">\n                                            <p-checkbox v-model=\"rlIsSelected\" :binary=\"true\" :pt=\"{\n                                                        input: ({ props, state }) => ({\n                                                            class: state.focused ? 'rl-checkbox-focus' : 'rl-checkbox',\n                                                        })\n                                                    }\" />\n                                            <label class=\"m-2\"> RL </label>\n                                        </div>\n                                        <div class=\"col-lg-3 d-flex align-items-center\">\n                                            <p-checkbox v-model=\"nerIsSelected\" :binary=\"true\" :pt=\"{\n                                                        input: ({ props, state }) => ({\n                                                            class: state.focused ? 'ner-checkbox-focus' : 'ner-checkbox',\n                                                        })\n                                                    }\" />\n                                            <label class=\"m-2\">Named entity (NER)</label>\n                                        </div>\n                                        <div class=\"col-lg-3 d-flex align-items-center\">\n                                            <p-checkbox v-model=\"oracleIsSelected\" :binary=\"true\" :pt=\"{\n                                                        input: ({ props, state }) => ({\n                                                            class: state.focused ? 'oracle-checkbox-focus' : 'oracle-checkbox',\n                                                        })\n                                                    }\" />\n                                            <label class=\"m-2\">Oracle (Answer Selector)</label>\n                                        </div>\n                                        <div class=\"col-lg-3 d-flex align-items-center\">\n                                            <p-checkbox v-model=\"userAnnIsSelected\" :binary=\"true\" :pt=\"{\n                                                        input: ({ props, state }) => ({\n                                                            class: state.focused ? 'user-checkbox-focus' : 'user-checkbox',\n                                                        })\n                                                    }\" />\n                                            <label class=\"m-2\">User annotated (Please enable to create)</label>\n                                        </div>\n                                    </div>\n                                    <div id=\"annotated-text\" class=\"text-justify qgen-text-style\" v-html=\"annotatedText\" :style=\"setUnselectableIfUserAnnNotChecked()\" @mouseup=\"handleOnMouseUpEvent($event)\"></div>\n                                </div>\n                                <div v-if=\"!annotationsReceived\" class=\"wizard-tab-content d-flex justify-content-center align-items-center\">\n                                    <p-progress-spinner/>\n                                </div>\n                            </wizard-tab>\n\n                            <wizard-tab :beforeChange=\"() => validateParameters(slotProps)\" id=\"parameters-tab\">\n                                <template #label>\n                                    Parameters\n                                </template>\n                                <div class=\"wizard-tab-content\">\n                                    <div class=\"form-group d-flex flex-column justify-content-center align-items-center h-100 qgen-text-style\">\n                                        <!-- <label class=\"h6\"><span class=\"badge rounded-pill bg-warning m-1\">!</span>Parameters configuration is currently not supported</label> -->\n                                        <div class=\"form-floating mb-3 w-50\">\n                                            <input id=\"nbQuest\" type=\"number\" class=\"form-control\" v-model=\"numberOfQuestions\" >\n                                            <label class=\"h6\" for=\"nbQuest\">Select the number of questions (per answer)</label>\n                                        </div>\n                                        <div class=\"form-floating w-50\">\n                                            <input id=\"nbOpt\" type=\"number\" class=\"form-control\" v-model=\"numberOfOptions\" >\n                                            <label class=\"h6\" for=\"nbOpt\">Select the number of options (per question)</label>\n                                        </div>\n                                    </div>\n                                </div>\n                            </wizard-tab>\n\n                            <wizard-tab id=\"generated-questions-tab\">\n                                <template #label>\n                                    Generated Questions\n                                </template>\n                                <div v-show=\"questionsReceived\" class=\"wizard-tab-content\">\n                                    <div class=\"form-group row\">\n                                        <Table :data=\"tableData\" :isSortable=\"false\" :withCustomBody=\"true\" :isScrollable=\"true\" setScrollHeight=\"500px\">\n                                            <template #column=\"{rowData, currentColumnData}\">\n                                                <div v-if=\"currentColumnData.key == 'relevant' || currentColumnData.key == 'grammar' || currentColumnData.key == 'coherence'\" class=\"w-100 d-flex justify-content-start\">\n                                                    <p-checkbox v-model=\"rowData[currentColumnData.key]\" :binary=\"true\" />\n                                                </div>\n                                                <div v-else>\n                                                    {{rowData[currentColumnData.key]}}\n                                                </div>\n                                            </template>\n                                        </Table>\n                                    </div>\n                                </div>\n                                <div v-if=\"!questionsReceived\" class=\"wizard-tab-content d-flex justify-content-center align-items-center\">\n                                    <p-progress-spinner/>\n                                </div>\n                            </wizard-tab>\n                        </template>\n\n                        <template #footer=\"{nextTab, prevTab, activeTabIndex, tabCount, navigateToTab, uncheckNextTabs}\">\n                            <div class=\"w-100 d-flex justify-content-between align-items-center\">\n                                <div>\n                                    <button v-if=\"activeTabIndex > 0\" @click=\"prevTab\" class=\"btn btn-default m-2\">\n                                        Previous\n                                    </button>\n                                </div>\n                                <div>\n                                    <button v-if=\"activeTabIndex < tabCount - 2\" @click=\"nextTab\" class=\"btn btn-primary m-2\">\n                                        Next\n                                    </button>\n                                    <button v-else-if=\"activeTabIndex == tabCount - 2\" @click=\"nextTab\" class=\"btn btn-primary m-2\">\n                                        Generate Questions\n                                    </button>\n                                    <div v-else class=\"d-flex justify-content-between align-items-center\">\n                                        <button v-if=\"questionsReceived\" @click=\"doExportJsonAsExcel\" class=\"btn btn-success m-2\">\n                                            Download Test\n                                        </button>\n                                        <button v-if=\"questionsReceived\" @click=\"resetWizard(navigateToTab, uncheckNextTabs)\" class=\"btn btn-primary m-2\">\n                                            New Text\n                                        </button>\n                                    </div>\n                                    \n                                </div>\n                            </div>\n                        </template>\n\n                    </wizard>\n                </div>\n            </div>\n\n        </div>\n\n    </div>\n</div>\n</template>\n\n<script>\nimport WizardTab from '@/components/qgen/WizardTab.vue'\nimport Wizard from '@/components/qgen/Wizard.vue'\nimport Table from '@/components/widgets/Table.vue'\n\n\nimport {\n    inject\n} from 'vue';\n\nimport {\n  TOAST_SERVICE\n} from \"@/services/toast-service.interface\"\n\nimport {\n    ANNOTATION_SERVICE,\n    UserSelectedAnnotationCallbacks\n} from '@/services/annotation-service.interface';\nimport {\n    QGEN_SERVICE,\n    QGenAnswerRequest,\n    QGenTestRequest\n} from '@/services/qgen-service.interface';\nimport {\n    convertQGenAnswerExtendedToAnnotation,\n    convertAnnotationToQGenAnswer,\n    convertQGenTestsToQuestionsTable,\n    convertQGenTestsToExcelData\n} from '@/components/qgen/qgen-converters';\n\nimport {\n    exportJsonAsExcel\n} from '@/util/excel-utils';\n\nexport default {\n    components: {\n        Wizard,\n        WizardTab,\n        Table\n    },\n    data() {\n        return {\n            /* Toast service */\n            toastService: null,\n\n            /* New Text */\n            text: \"Alexander Graham Bell was born in Edinburgh, Scotland on March 3, 1847. When he was only eleven years old, he invented a machine that could clean wheat. Graham studied anatomy and physiology at the University of London, but moved with his family to Quebec, Canada in 1870. Bell soon moved to Boston, Massachusetts. In 1871, he began working with deaf people and published the system of Visible Hearing that was developed by his father. Visible hearing illustrated how the tongue, lips, and throat are used to produce vocal sounds. In 1872, Bell founded a school for the deaf which soon became part of Boston University. Alexander Graham Bell is best known for his invention of the telephone. While trying to discover the secret of transmitting multiple messages on a single wire, Bell heard the sound of a plucked string along some of the electrical wire. One of Bell's assistants, Thomas A. Watson, was trying to reactivate a telephone transmitter. After hearing the sound, Bell believed he could send the sound of a human voice over the wire. After receiving a patent on March 7, 1876 for transmitting sound along a single wire, he successfully transmitted human speech on March 10th. Bell's telephone patent was one of the most valuable patents ever issued. He started the Bell Telephone Company in 1877. Bell went on to invent a precursor to the modern day air conditioner, and a device, called a \\\"photophone\\\", that enabled sound to be transmitted on a beam of light. Today's fiber optic and laser communication systems are based on Bell's photophone research. In 1898, Alexander Graham Bell and his son-in-law took over the National Geographic Society and built it into one of the most recognized magazines in the world. Bell also helped found Science Magazine, one of the most respected research journals in the world.\",\n            lastProcessedTextCleansed: \"\",\n\n            /* Text Annotation step */\n            annotationService: null,\n            annotatedText: \"\",\n            rlIsSelected: false,\n            nerIsSelected: false,\n            oracleIsSelected: false,\n            userAnnIsSelected: false,\n            annotationsReceived: false,\n            annotationsRendered: false,\n            annotations: [],\n            lastProcessedAnnotations: \"\",\n\n            /* Parameters step */\n            numberOfQuestions: 1,\n            numberOfOptions: 4,\n            tableData: {},\n            qgenTests: null,\n\n            /* Generated Questions step */\n            questionsReceived: false\n        }\n    },\n\n    created() {\n        this.annotationService = inject(ANNOTATION_SERVICE);\n        this.qgenService = inject(QGEN_SERVICE);\n        this.toastService = inject(TOAST_SERVICE);\n    },\n\n    mounted() {\n        this.annotationService.init(\"annotated-text\", {\n            onUserAddedAnnotation: this.onUserAnnotationAdded,\n            onUserDeletedAnnotation: this.onUserAnnotationDeleted,\n            onUserUpdatedAnnotation: this.onUserAnnotationUpdated\n        }, this.annotationFormatter);\n\n        const annotatedTextParent = document.getElementsByClassName(\"r6o-content-wrapper\")[0];\n        const secondChild = annotatedTextParent.children[1];\n\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.type === \"childList\") {\n                    const taggingSection = document.querySelectorAll(\"div.r6o-widget.r6o-tag\")[0]\n\n                    if (taggingSection != undefined) {\n                        taggingSection.remove();\n                    }\n\n                    const editableCommentSection = document.querySelectorAll(\"div.r6o-widget.comment.editable\")[0]\n\n                    if (editableCommentSection != undefined) {\n                        editableCommentSection.remove();\n                    }\n\n                    const innerEditor = document.getElementsByClassName(\"r6o-editor-inner\")[0];\n                    if (innerEditor != undefined) {\n                        innerEditor.classList.add(\"rounded-3\");\n                    }\n\n                    const dropdownMenu = document.getElementsByClassName(\"r6o-arrow-down\")[0];\n                    if (dropdownMenu != undefined) {\n                        dropdownMenu.remove();\n                    }\n\n                    const footer = document.getElementsByClassName(\"r6o-footer\")[0];\n\n                    if (footer != undefined) {\n                        const buttons = footer.querySelectorAll(\"button\");\n\n                        buttons.forEach((button) => {\n                            if (button.innerText == \"Cancel\") {\n                                for (const cssClass of button.classList) {\n                                    button.classList.remove(cssClass);\n                                }\n                                button.classList.add(\"btn\");\n                                button.classList.add(\"btn-outline-danger\");\n                                button.classList.add(\"m-2\")\n                            } else if (button.innerText == \"Ok\") {\n                                for (const cssClass of button.classList) {\n                                    button.classList.remove(cssClass);\n                                }\n                                button.classList.add(\"btn\");\n                                button.classList.add(\"btn-primary\");\n                                button.classList.add(\"my-2\");\n                                button.classList.add(\"mr-2\");\n                            }\n                        });\n\n                        const innerEditor = document.getElementsByClassName(\"r6o-editor-inner\")[0];\n                        const observer = new MutationObserver((mutations) => {\n                            mutations.forEach((mutation) => {\n                                if (mutation.type === \"childList\") {\n                                    const taggingSectionRestored = document.querySelectorAll(\"div.r6o-widget.r6o-tag\")[0]\n\n                                    if (taggingSectionRestored != undefined) {\n                                        taggingSectionRestored.remove();\n                                    }\n                                }\n                            });\n                        });\n\n                        observer.observe(innerEditor, {\n                            childList: true\n                        });\n                    }\n\n                }\n            });\n        });\n\n        observer.observe(secondChild, {\n            childList: true\n        });\n    },\n    methods: {\n        annotationsTabAfterRender() {\n            if (this.annotationsReceived && !this.annotationsRendered) {\n                this.showAllAnnotations();\n                this.annotationsRendered = true;\n            }\n        },\n        generateRandomId() {\n            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n        },\n        setUnselectableIfUserAnnNotChecked() {\n            if (!this.userAnnIsSelected) {\n                return \"user-select: none;\"\n            } else {\n                return \"\"\n            }\n        },\n        handleOnMouseUpEvent(event) {\n            if (event.target.localName == \"div\" && !this.userAnnIsSelected) {\n                this.info(\"User annotated checkbox not selected\", \"Please select the User annotated checkbox first to create new annotations\")\n            }\n        },\n        validateStep(ref) {\n            return this.$refs[ref].validate()\n        },\n        wizardComplete() {\n            // this.$router.push({\n            //     name: \"TextsCollection\"\n            // })\n        },\n        validateText(slotProps) {\n            // Keep only alphanumeric characters for comparison\n            let cleansedText = this.text.replace(/[^a-z0-9]/gi, '');\n\n            // If the text is empty, then we don't need to process it\n            if (cleansedText == \"\") {\n                this.info(\"Empty text\", \"Please insert a text\")\n                return Promise.resolve(false)\n            }\n\n            // If the text is the same as the last processed text, then we don't need to process it again\n            if (cleansedText == this.lastProcessedTextCleansed) {\n                return Promise.resolve(true)\n            }\n\n            // Clear the annotations step if the text is different\n            this.clearAnnotationStep();\n\n            // Uncheck the next tabs (navigation is not allowed)\n            slotProps.uncheckNextTabs();\n\n            this.getAnnotations().then((response) => {\n                // Keep the state of the text for future comparison\n                this.lastProcessedTextCleansed = cleansedText;\n\n                this.annotatedText = response.text;\n                this.annotations = response.answers.map((ann) => {\n                    return convertQGenAnswerExtendedToAnnotation(ann)\n                })\n                this.annotationsReceived = true;\n\n                let annotationsTypes = this.annotations.map((ann) => {\n                    return ann.type;\n                });\n            }).catch((error) => {\n                this.error(\"Error\", error)\n                \n                // Force the user to go back to the previous tab\n                slotProps.prevTab();\n\n                // Uncheck the next tabs (navigation is not allowed)\n                slotProps.uncheckNextTabs();\n            });\n\n            return Promise.resolve(true)\n        },\n        getAnnotations() {\n            return this.qgenService.getAnswers({\n                'text': this.text\n            })\n        },\n        validateAnnotations() {\n            if (this.getVisibleAnnotations().length == 0) {\n                this.info(\"No annotations selected\", \"Please annotate the text or toggle the checkboxes to select the annotations\")\n                return Promise.resolve(false)\n            }\n\n            return Promise.resolve(true)\n        },\n        checkIfSameAnnotations(ann1, ann2) {\n            return ann1.id == ann2.id;\n        },\n        onUserAnnotationAdded(annotation) {\n            this.annotations.push(annotation);\n        },\n        onUserAnnotationDeleted(annotation) {\n            // find the annotation by id and delete it\n            this.annotations = this.annotations.filter((ann) => {\n                return ann.id != annotation.id;\n            });\n        },\n        onUserAnnotationUpdated(updatedAnnotation) {\n            // find the annotation by id and update it\n            this.annotations = this.annotations.map((ann) => {\n                if (ann.id == updatedAnnotation.id) {\n                    return updatedAnnotation;\n                } else {\n                    return ann;\n                }\n            });\n        },\n        showAllAnnotations() {\n            this.rlIsSelected = true;\n            this.nerIsSelected = true;\n            this.oracleIsSelected = true;\n            this.userAnnIsSelected = true;\n        },\n        showAnnotationsByType(type) {\n            let annotations = this.annotations.filter((ann) => {\n                return ann.type == type;\n            });\n\n            for (let i = 0; i < annotations.length; i++) {\n                this.annotationService.addAnnotation(annotations[i]);\n            }\n        },\n        hideAnnotationsByType(type) {\n            let annotations = this.annotations.filter((ann) => {\n                return ann.type == type;\n            });\n\n            for (let i = 0; i < annotations.length; i++) {\n                this.annotationService.deleteAnnotation(annotations[i]);\n            }\n        },\n        getVisibleAnnotations(){\n            let visibleAnnotations = [];\n\n            if (this.rlIsSelected) {\n                visibleAnnotations = visibleAnnotations.concat(this.annotations.filter((ann) => {\n                    return ann.type == \"rl\";\n                }));\n            }\n\n            if (this.nerIsSelected) {\n                visibleAnnotations = visibleAnnotations.concat(this.annotations.filter((ann) => {\n                    return ann.type == \"ner\";\n                }));\n            }\n\n            if (this.oracleIsSelected) {\n                visibleAnnotations = visibleAnnotations.concat(this.annotations.filter((ann) => {\n                    return ann.type == \"oracle\";\n                }));\n            }\n\n            if (this.userAnnIsSelected) {\n                visibleAnnotations = visibleAnnotations.concat(this.annotations.filter((ann) => {\n                    return ann.type == \"user\";\n                }));\n            }\n\n            return visibleAnnotations;\n        },\n        annotationFormatter(annotation) {\n            const typeToCSSClass = {\n                \"rl\": \"rl-annotation-format\",\n                \"ner\": \"ner-annotation-format\",\n                \"oracle\": \"oracle-annotation-format\",\n                \"user\": \"user-annotation-format\"\n            }\n            return typeToCSSClass[annotation.type];\n        },\n        validateParameters(slotProps) {\n            // Send only the visible annotations\n            let visibleAnnotations = this.getVisibleAnnotations();\n\n            // If the annotations are the same as the last processed annotations, then we don't need to process them again\n            if (JSON.stringify(visibleAnnotations) == this.lastProcessedAnnotations) {\n                return Promise.resolve(true)\n            } else {\n                this.questionsReceived = false;\n            }\n\n            this.getTest().then((response) => {\n                // Keep the state of the annotations for future comparison\n                this.lastProcessedAnnotations = JSON.stringify(visibleAnnotations);\n\n                this.qgenTests = response.tests;\n                this.tableData = convertQGenTestsToQuestionsTable(response.tests)\n                this.questionsReceived = true;\n            }).catch((error) => {\n                this.error(\"Error\", error)\n\n                // Force the user to go back to the previous tab\n                slotProps.prevTab();\n\n                // Uncheck the next tabs (navigation is not allowed)\n                slotProps.uncheckNextTabs();\n            });\n\n            return Promise.resolve(true)\n        },\n        getTest() {\n            let answers = this.getVisibleAnnotations().map((ann) => {\n                return convertAnnotationToQGenAnswer(ann)\n            });\n            let payload = {\n                text: this.text,\n                answers: answers\n            }\n            return this.qgenService.getTest(payload)\n        },\n        success(header, footer) {\n            this.toastService && this.toastService.success(footer, header)\n        },\n        info(header, footer) {\n            this.toastService && this.toastService.info(footer, header)\n        },\n        error(header, footer) {\n            this.toastService && this.toastService.error(footer, header, -1)\n        },\n        clearAnnotationStep() {\n            this.rlIsSelected = false;\n            this.nerIsSelected = false;\n            this.oracleIsSelected = false;\n            this.userAnnIsSelected = false;\n            this.annotationsReceived = false;\n            this.annotationsRendered = false;\n            this.annotations = [];\n            this.lastProcessedAnnotations = \"\";\n            this.annotationService.clearAnnotations();\n        },\n        resetWizard(navigateToTab, uncheckNextTabs) {\n            this.text = \"\";\n            this.lastProcessedTextCleansed = \"\";\n            this.clearAnnotationStep();\n            this.numberOfQuestions = 1;\n            this.numberOfOptions = 4;\n            this.tableData = {};\n            this.qgenTests = null;\n            this.questionsReceived = false;\n            navigateToTab(0);\n            uncheckNextTabs();\n        },\n        doExportJsonAsExcel() {\n            if (this.questionsReceived) {\n                const settings = {\n                    fileName: \"Questions and Answers\",\n                    extraLength: 3,\n                    writeMode: \"writeFile\", \n                    writeOptions: {},\n                }\n                exportJsonAsExcel(convertQGenTestsToExcelData(this.qgenTests), settings)\n            }\n        }\n    },\n\n    watch: {\n        rlIsSelected(newValue, oldValue) {\n            if (newValue == true) {\n                this.showAnnotationsByType(\"rl\");\n            } else {\n                this.hideAnnotationsByType(\"rl\");\n            }\n        },\n        nerIsSelected(newValue, oldValue) {\n            if (newValue == true) {\n                this.showAnnotationsByType(\"ner\");\n            } else {\n                this.hideAnnotationsByType(\"ner\");\n            }\n        },\n        oracleIsSelected(newValue, oldValue) {\n            if (newValue == true) {\n                this.showAnnotationsByType(\"oracle\");\n            } else {\n                this.hideAnnotationsByType(\"oracle\");\n            }\n        },\n        userAnnIsSelected(newValue, oldValue) {\n            if (newValue == true) {\n                this.showAnnotationsByType(\"user\");\n            } else {\n                this.hideAnnotationsByType(\"user\");\n            }\n        },\n    }\n}\n</script>\n\n<style lang=\"scss\">\n.my-span-class:hover {\n    outline: 1px solid black;\n}\n\n.annotated {\n    font-weight: bold;\n}\n</style><style>\n#annotated-text .r6o-selection {\n    background-color: #ff74bec0 !important;\n    border-radius: 3px !important;\n}\n\n.rl-annotation-format {\n    background-color: #9077ffa9 !important;\n    border-bottom: 2px solid #7556fd !important;\n    border-radius: 3px !important;\n}\n\n.rl-checkbox {\n    background-color: #9077ffa9 !important;\n    border-color: #7556fd !important;\n}\n\n.rl-checkbox-focus {\n    background-color: #9077ffa9 !important;\n    border-color: #7556fd !important;\n    box-shadow: 0 0 0 0.2rem #9077ff44 !important;\n}\n\n.oracle-annotation-format {\n    background-color: #ff864ec7 !important;\n    border-color: #ff5b0fc7 !important;\n}\n\n.oracle-checkbox {\n    background-color: #ff864ec7 !important;\n    border-color: #ff5b0fc7 !important;\n}\n\n.oracle-checkbox-focus {\n    background-color: #ff864ec7 !important;\n    border-color: #ff5b0fc7 !important;\n    box-shadow: 0 0 0 0.2rem #ff864e44 !important;\n}\n\n.ner-annotation-format {\n    background-color: #e8485580 !important;\n    border-bottom: 2px solid #e60517ab !important;\n    border-radius: 3px !important;\n}\n\n.ner-checkbox {\n    background-color: #E8485580 !important;\n    border-color: #e60517ab !important;\n}\n\n.ner-checkbox-focus {\n    background-color: #E8485580 !important;\n    border-color: #e60517ab !important;\n    box-shadow: 0 0 0 0.2rem #E8485544 !important;\n}\n\n.user-annotation-format {\n    background-color: #3185fc8c !important;\n    border-bottom: 2px solid #3185FCbb !important;\n    border-radius: 3px !important;\n}\n\n.user-checkbox {\n    background-color: #3185FC8c !important;\n    border-color: #3185FCbb !important;\n}\n\n.user-checkbox-focus {\n    background-color: #3185FC8c !important;\n    border-color: #3185FCbb !important;\n    box-shadow: 0 0 0 0.2rem #3185FC44 !important;\n}\n\ndiv.r6o-editor-inner>.r6o-widget.comment+.r6o-widget.comment.editable {\n    visibility: hidden !important;\n    display: none !important;\n}\n\nul.r6o-comment-dropdown-menu>li+li {\n    visibility: hidden !important;\n    display: none !important;\n}\n\n.wizard-tab-content {\n    height: 450px;\n}\n\n.qgen-text-style {\n    font-family: \"Avenir\", Helvetica, Arial, sans-serif;\n    padding: 1.5rem;\n    line-height: 1.6;\n    font-size: 0.9rem\n}\n\n.body {\n    background-color: #f8f9fa;\n}\n</style>\n","<template>\n<div class=\"tab-pane fade\" role=\"tabpanel\" :id=\"tabId\" :aria-hidden=\"!active\" :aria-labelledby=\"`step-${tabId}`\" :class=\"{'active show': active}\" v-show=\"active\">\n    <slot></slot>\n</div>\n</template>\n\n<script>\nexport default {\n    name: 'wizard-tab',\n    props: {\n        label: {\n            type: String,\n            description: 'Wizard tab label (title)'\n        },\n        id: {\n            type: String,\n            description: 'wizard tab id'\n        },\n        beforeChange: {\n            type: Function,\n            description: 'Function to execute before switching to another tab. Can be Function<boolean> or Function<Promise<boolean>>'\n        },\n        afterRender: {\n            type: Function,\n            optional: true,\n            description: 'Function to execute after tab is rendered'\n        },\n    },\n    inject: ['addTab', 'removeTab'],\n    data() {\n        return {\n            active: false,\n            checked: false,\n            hasError: false,\n            tabId: ''\n        }\n    },\n    mounted() {\n        this.addTab(this)\n    },\n    unmounted() {\n        if (this.$el && this.$el.parentNode) {\n            this.$el.parentNode.removeChild(this.$el)\n        }\n        this.removeTab(this)\n    },\n    updated() {\n        this.afterRender && this.afterRender()\n    }\n}\n</script>\n\n<style>\n</style>\n","import { render } from \"./WizardTab.vue?vue&type=template&id=3c1eb014\"\nimport script from \"./WizardTab.vue?vue&type=script&lang=js\"\nexport * from \"./WizardTab.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n<div class=\"wizard-container\" :id=\"wizardId\">\n    <div class=\"card card-wizard active\" :class=\"[wizardClasses, {'card-transparent': plain}]\">\n        <form @submit.prevent>\n            <div class=\"card-header text-center\">\n                <slot name=\"header\" v-if=\"showHeader && !$slots.header()\">\n                    <h3 class=\"card-title\">{{title}}</h3>\n                    <h3 class=\"description\">{{subTitle}}</h3>\n                </slot>\n\n                <div class=\"wizard-navigation w-100 h-100\">\n                    <div class=\"row nav nav-pills\">\n                        <div v-for=\"(tab, index) in tabs\" :key=\"tab.title\" :tabindex=\"tab.checked ? 0 : ''\" :id=\"`step-${tab.tabId}`\" :aria-controls=\"tab.tabId\" :aria-disabled=\"tab.active\" :aria-selected=\"tab.active\" :ref=\"`tab-${index}`\" class=\"col nav-item wizard-tab-link\" :style=\"linkWidth\">\n                            <a class=\"nav-link\" @click=\"navigateToTab(index)\" :class=\"[{'disabled-wizard-link': !tab.checked}, {active: tab.active}, {checked: tab.checked}]\" data-toggle=\"tab\">\n                                <tab-item-content :tab=\"tab\"></tab-item-content>\n                            </a>\n                        </div>\n                    </div>\n                    <div class=\"moving-tab\" :class=\"{'error-link': activeTab.hasError}\" v-if=\"activeTab\" style=\"transition: transform 0.5s cubic-bezier(0.29, 1.42, 0.79, 1); width: 100%;\" :style=\"movingTabStyles\">\n                        <tab-item-content :tab=\"activeTab\" :moving-tab=\"true\"></tab-item-content>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"card-body\">\n                <div class=\"tab-content\">\n                    <slot :activeIndex=\"activeTabIndex\" :activeTab=\"activeTab\" :uncheck-next-tabs=\"uncheckNextTabs\" :prev-tab=\"prevTab\">\n\n                    </slot>\n                </div>\n            </div>\n\n            <div class=\"card-footer\">\n                <slot name=\"footer\" :next-tab=\"nextTab\" :prev-tab=\"prevTab\" :activeTabIndex=\"activeTabIndex\" :tabCount=\"tabCount\" :navigateToTab=\"navigateToTab\" :uncheck-next-tabs=\"uncheckNextTabs\">\n                    <div class=\"w-100 d-flex justify-content-between align-items-center\">\n                        <div>\n                            <button v-if=\"activeTabIndex > 0\" @click=\"prevTab\" class=\"btn btn-default m-2\">\n                                {{prevButtonText}}\n                            </button>\n                        </div>\n                        <div>\n                            <button v-if=\"activeTabIndex < tabCount - 1\" @click=\"nextTab\" class=\"btn btn-primary m-2\">\n                                {{nextButtonText}}\n                            </button>\n                            <button v-else @click=\"nextTab\" class=\"btn btn-primary m-2\">{{finishButtonText}}</button>\n                        </div>\n                    </div>\n                </slot>\n            </div>\n\n        </form>\n    </div>\n</div>\n</template>\n\n<script>\nimport {\n    throttle\n} from '@/util/throttle';\nimport {\n    h\n} from 'vue';\n\nfunction randomString(maxChars = 7) {\n    const possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n    let text = \"\";\n\n    for (let i = 0; i < maxChars; i++)\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n}\nexport default {\n    name: 'simple-wizard',\n    props: {\n        wizardClasses: {\n            type: [String, Object, Array],\n            description: 'Wizard card classes'\n        },\n        plain: {\n            type: Boolean,\n            default: false,\n            description: 'Whether wizard should be on plain background'\n        },\n        showHeader: {\n            type: Boolean,\n            default: true,\n            description: 'Whether Wizard header should be displayed'\n        },\n        startIndex: {\n            type: Number,\n            default: 0,\n            description: 'Wizard start index (activated tab to start with)'\n        },\n        title: {\n            type: String,\n            default: 'Title',\n            description: 'Wizard title'\n        },\n        subTitle: {\n            type: String,\n            default: 'Subtitle',\n            description: 'Wizard sub title'\n        },\n        prevButtonText: {\n            type: String,\n            default: 'Previous',\n            description: 'Previous button text'\n        },\n        nextButtonText: {\n            type: String,\n            default: 'Next',\n            description: 'Next button text'\n        },\n        finishButtonText: {\n            type: String,\n            default: 'Finish',\n            description: 'Finish button text'\n        },\n        vertical: {\n            type: Boolean,\n            description: 'Whether wizard tabs should be vertical'\n        }\n    },\n    components: {\n        TabItemContent: {\n            props: ['tab', 'movingTab'],\n            render() {\n                if (this.movingTab) {\n                    return h('span')\n                }\n\n                return h('span', [this.tab.$slots.label() || this.tab.label])\n            }\n        }\n    },\n    provide() {\n        return {\n            addTab: this.addTab,\n            removeTab: this.removeTab\n        }\n    },\n    data() {\n        return {\n            tabs: [],\n            activeTabIndex: 0,\n            tabLinkWidth: 0,\n            tabLinkHeight: 50,\n            wizardId: randomString(),\n            // onResize will be called on window resize event but only once every 40ms (25 times per second)\n            onResizeWithThrottle: throttle(this.onResize, 40)\n        }\n    },\n    computed: {\n        tabCount() {\n            return this.tabs.length;\n        },\n        linkWidth() {\n            let width = 100;\n            if (this.tabCount > 0) {\n                width = 100 / this.tabCount\n            }\n            if (this.vertical) {\n                width = 100;\n            }\n            return {\n                width: `${width}%`\n            };\n        },\n        activeTab() {\n            return this.tabs[this.activeTabIndex]\n        },\n        movingTabStyles() {\n            let translateXValue = this.tabLinkWidth * this.activeTabIndex;\n            let translateYValue = 0;\n            if (this.vertical) {\n                translateYValue = this.tabLinkHeight * this.activeTabIndex\n                translateXValue = 0;\n            }\n            let styles = {\n                transform: `translate3d(${translateXValue}px, ${translateYValue}px, 0px)`,\n            };\n            if (this.tabLinkWidth !== 0) {\n                styles.width = `${this.tabLinkWidth}px`;\n            }\n            \n            return styles;\n        }\n    },\n    methods: {\n        addTab(tab) {\n            // find index of tab in the default slot array based on wizard tab id\n            let index = this.$slots.default().findIndex(slot => slot.props.id === tab.id)\n\n            tab.tabId = `${index}`\n            if (!this.activeTab && index === 0) {\n                tab.active = true;\n                tab.checked = true\n            }\n            this.onResize();\n            this.tabs.splice(index, 0, tab)\n        },\n        removeTab(tab) {\n            const tabs = this.tabs;\n            const index = tabs.indexOf(tab);\n\n            if (index > -1) {\n                tabs.splice(index, 1)\n            }\n        },\n        validate(tab) {\n            let tabToValidate = tab || this.activeTab\n            let beforeChange = tabToValidate.beforeChange\n            if (beforeChange) {\n                return Promise.resolve(beforeChange()).then(res => {\n                    this.activeTab.hasError = res ? false : true\n                    return res;\n                }).catch(() => {\n                    this.activeTab.hasError = true\n                })\n            } else {\n                return Promise.resolve(true);\n            }\n        },\n        async nextTab() {\n            let isValid = await this.validate();\n            if (isValid && this.activeTabIndex === this.tabCount - 1) {\n                this.$emit('complete');\n            }\n            if (isValid && this.activeTabIndex < this.tabCount - 1) {\n                this.activeTabIndex++\n            }\n\n            return isValid\n        },\n        prevTab() {\n            this.activeTabIndex--;\n        },\n        async navigateToTab(index) {\n            if (this.tabs[index].checked) {\n                // recursively validate each tab\n                if (index > this.activeTabIndex) {\n                    let valid = await this.nextTab();\n                    if (valid) {\n                        this.navigateToTab(index)\n                    }\n                } else {\n                    this.activeTabIndex = index\n                }\n            }\n        },\n        uncheckNextTabs() {\n            for (let i = this.activeTabIndex + 1; i < this.tabCount; i++) {\n                this.tabs[i].checked = false\n            }\n        },\n        onResize() {\n            let tabLinks = document.querySelectorAll(`#${this.wizardId} .wizard-tab-link`);\n            if (tabLinks.length > 0 && this.tabCount > 0) {\n                let {\n                    clientWidth,\n                    clientHeight\n                } = tabLinks[0];\n                this.tabLinkWidth = clientWidth;\n                this.tabLinkHeight = clientHeight;\n            }\n        },\n    },\n    mounted() {\n        this.activeTabIndex = this.startIndex;\n        this.$nextTick(() => {\n            this.tabs[this.activeTabIndex].active = true;\n            this.tabs[this.activeTabIndex].checked = true;\n            this.onResize();\n        });\n        window.addEventListener('resize', () => {\n            this.onResizeWithThrottle()\n        }, false);\n    },\n    watch: {\n        activeTabIndex(newValue, oldValue) {\n            if (newValue !== oldValue) {\n                let oldTab = this.tabs[oldValue];\n                let newTab = this.tabs[newValue];\n                oldTab.active = false;\n                newTab.active = true;\n\n                if (!newTab.checked) {\n                    newTab.checked = true\n                }\n                this.$emit('tab-change', oldTab, newTab);\n                this.$emit('update:startIndex', newValue);\n            }\n        }\n    }\n}\n</script>\n\n<style lang=\"scss\">\n.moving-tab {\n    position: absolute;\n    top: 15px;\n    left: 12px;\n    height: 50px;\n    background-color: #fff;\n    border-bottom: 2px solid #b700ff;\n    z-index: 2;\n}\n\n/* Tab content animation */\n.tab-content {\n    display: flex; // to avoid horizontal scroll when animating\n\n    .tab-pane {\n        display: block;\n        animation: fadeIn 0.5s;\n        width: 100%;\n    }\n}\n\n/**\n    Extra niceties. Display error tabs and disable navigation unvisited tabs\n   */\n.wizard-navigation .nav-link {\n\n    &.active,\n    &.checked {\n        cursor: pointer;\n    }\n}\n\n.disabled-wizard-link {\n    cursor: not-allowed;\n}\n</style>\n","import { set } from \"lodash\";\n\n/**\n * Simple throttle function that returns a throttler function for the passed function\n * @param handlerFunc\n * @param [timeout] the throttle interval\n */\nexport function throttle(handlerFunc, timeout = 66) {\n  let resizeTimeout = false;\n\n  return function () {\n    if (resizeTimeout) return;\n\n    resizeTimeout = true;\n    handlerFunc();\n    setTimeout(function () {\n      resizeTimeout = false;\n    }, timeout);\n  }\n}\n","import { render } from \"./Wizard.vue?vue&type=template&id=62a2ce56\"\nimport script from \"./Wizard.vue?vue&type=script&lang=js\"\nexport * from \"./Wizard.vue?vue&type=script&lang=js\"\n\nimport \"./Wizard.vue?vue&type=style&index=0&id=62a2ce56&lang=scss\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import chai from './index.js';\n\nexport const expect = chai.expect;\nexport const version = chai.version;\nexport const Assertion = chai.Assertion;\nexport const AssertionError = chai.AssertionError;\nexport const util = chai.util;\nexport const config = chai.config;\nexport const use = chai.use;\nexport const should = chai.should;\nexport const assert = chai.assert;\nexport const core = chai.core;\n\nexport default chai;\n","import { QGenAnswerExtended, QGenAnswer, QGenTest } from '@/data-objects/qgen-dtos';\nimport { Annotation } from '@/services/annotation-service.interface';\nimport { TableInput } from '@/components/widgets/table-input';\nimport { ExcelData, ExcelSheet } from '@/util/excel-utils';\nimport { assert } from 'chai';\n\nfunction generateRandomAnnotationId() {\n    return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n}\n\nexport function convertQGenAnswerExtendedToAnnotation(answer: QGenAnswerExtended): Annotation {\n    return {\n        id: generateRandomAnnotationId(),\n        type: answer.type.toLowerCase(),\n        start: answer.start,\n        end: answer.end,\n        text: answer.text,\n        label: answer.type.toUpperCase()\n    }\n}\n\nexport function convertAnnotationToQGenAnswer(annotation: Annotation): QGenAnswer {\n    return {\n        start: annotation.start,\n        end: annotation.end\n    }\n}\n\nexport function convertQGenTestsToQuestionsTable(tests: QGenTest[]): TableInput {\n    const input: TableInput = {\n        columns: [{\n            key: 'question',\n            displayName: 'Question',\n        },\n        {\n            key: 'correct_answer',\n            displayName: 'Correct Answer',\n        },\n        {\n            key: 'option_2',\n            displayName: 'Option 2',\n        },\n        {\n            key: 'option_3',\n            displayName: 'Option 3',\n        },\n        {\n            key: 'option_4',\n            displayName: 'Option 4',\n        },\n        {\n            key: 'relevant',\n            displayName: 'Relevant',\n        },\n        {\n            key: 'grammar',\n            displayName: 'Grammar',\n        },\n        {\n            key: 'coherence',\n            displayName: 'Coherence',\n        }],\n        rows: []\n    }\n\n    for (const test of tests) {\n        const row = {\n            question: test.question,\n            correct_answer: test.answer,\n            option_2: test.distractors[0],\n            option_3: test.distractors[1],\n            option_4: test.distractors[2],\n            relevant: false,\n            grammar: false,\n            coherence: false\n        }\n        input.rows.push(row);\n    }\n\n    return input;\n}\n\nexport function convertQGenTestsToExcelData(tests: QGenTest[]): ExcelData {\n    const data: ExcelData = {\n        sheets: []\n    }\n\n    const sheet: ExcelSheet = {\n        sheet: 'Test',\n        columns: [\n            { label: 'Question', value: 'question' },\n            { label: 'Correct Answer', value: 'correct_answer' }\n        ],\n        content: []\n    }\n\n    assert (tests.length > 0, 'Tests array is empty');\n\n    const nbOptions = tests[0].distractors.length;\n    for (let i = 0; i < nbOptions; i++) {\n        sheet.columns.push({ label: `Option ${i + 2}`, value: `option_${i + 2}` });\n    }\n\n    for (const test of tests) {\n        const row: any = {\n            question: test.question,\n            correct_answer: test.answer\n        }\n\n        for (let i = 0; i < nbOptions; i++) {\n            row[`option_${i + 2}`] = test.distractors[i];\n        }\n\n        sheet.content.push(row);\n    }\n\n    data.sheets.push(sheet);\n\n    return data;\n}","import xlsx from \"json-as-xlsx\";\n\nexport interface ExcelColumn {\n    label: string;\n    value: string;\n}\n\nexport interface ExcelRow {\n    [key: string]: any;\n}\n\nexport interface ExcelSheet {\n    sheet: string;\n    columns: ExcelColumn[];\n    content: ExcelRow[];\n}\n\nexport interface ExcelData {\n    sheets: ExcelSheet[];\n}\n\nexport interface ExcelSettings {\n    fileName: string;\n    extraLength: number;\n    writeMode: string;\n    writeOptions: any;\n}\n  \nexport function exportJsonAsExcel(data: ExcelData, settings: ExcelSettings) {\n    xlsx(data.sheets, settings)\n}","import { render } from \"./GenerateQuestions.vue?vue&type=template&id=aa093b6a\"\nimport script from \"./GenerateQuestions.vue?vue&type=script&lang=js\"\nexport * from \"./GenerateQuestions.vue?vue&type=script&lang=js\"\n\nimport \"./GenerateQuestions.vue?vue&type=style&index=0&id=aa093b6a&lang=scss\"\nimport \"./GenerateQuestions.vue?vue&type=style&index=1&id=aa093b6a&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <p-datatable \n      :value=\"data.rows\" \n      :responsiveLayout=\"isScrollable ? 'scroll' : ''\" \n      :scrollable=\"isScrollable\" \n      :scrollHeight=\"setScrollHeight\"\n      :stripedRows=\"true\" >\n      <p-column\n        v-for=\"col of data.columns\"\n        :field=\"col.key\"\n        :header=\"col.displayName\"\n        :key=\"col.key\"\n        :sortable=\"isSortable\"\n      >\n      <template v-if=\"withCustomBody\" #body=\"{data}\">\n        <slot :rowData=\"data\" :currentColumnData=\"col\" name=\"column\">\n        </slot>\n      </template>\n    </p-column>\n    </p-datatable>\n  </template>\n  \n  <script>\n  import {\n      TableInput\n  } from \"./table-input\";\n  \n  export default {\n    props: {\n      data: TableInput,\n      isScrollable: {\n        type: Boolean,\n        default: true,\n        required: false,\n      },\n      isSortable: {\n        type: Boolean,\n        default: true,\n        required: false,\n      },\n      withCustomBody: {\n        type: Boolean,\n        default: false,\n        required: false,\n      },\n      setScrollHeight: {\n        type: String,\n        default: \"750px\",\n        required: false,\n      },\n    },\n    data() {\n      return {};\n    },\n  };\n  </script>\n","import { render } from \"./Table.vue?vue&type=template&id=370e893f\"\nimport script from \"./Table.vue?vue&type=script&lang=js\"\nexport * from \"./Table.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.libraryName=exports.xlsx=exports.getWorksheetColumnWidths=exports.getJsonSheetRow=exports.getContentProperty=exports.utils=void 0;const xlsx_1=require(\"@e965/xlsx\");Object.defineProperty(exports,\"utils\",{enumerable:true,get:function(){return xlsx_1.utils}});const getContentProperty=(content,property)=>{const accessContentProperties=(content,properties)=>{const value=content[properties[0]];if(properties.length===1){return value!==null&&value!==void 0?value:\"\"}if(value===undefined||value===null||typeof value===\"string\"||typeof value===\"boolean\"||typeof value===\"number\"||value instanceof Date){return\"\"}return accessContentProperties(value,properties.slice(1))};const properties=property.split(\".\");return accessContentProperties(content,properties)};exports.getContentProperty=getContentProperty;const getJsonSheetRow=(content,columns)=>{const jsonSheetRow={};columns.forEach(column=>{if(typeof column.value===\"function\"){jsonSheetRow[column.label]=column.value(content)}else{jsonSheetRow[column.label]=(0,exports.getContentProperty)(content,column.value)}});return jsonSheetRow};exports.getJsonSheetRow=getJsonSheetRow;const applyColumnFormat=(worksheet,columnIds,columnFormats)=>{var _a;for(let i=0;i<columnIds.length;i+=1){const columnFormat=columnFormats[i];if(!columnFormat){continue}const column=xlsx_1.utils.decode_col(columnIds[i]);const range=xlsx_1.utils.decode_range((_a=worksheet[\"!ref\"])!==null&&_a!==void 0?_a:\"\");for(let row=range.s.r+1;row<=range.e.r;++row){const ref=xlsx_1.utils.encode_cell({r:row,c:column});if(worksheet[ref]){worksheet[ref].z=columnFormat}}}};const getWorksheetColumnIds=worksheet=>{var _a;const columnRange=xlsx_1.utils.decode_range((_a=worksheet[\"!ref\"])!==null&&_a!==void 0?_a:\"\");const columnIds=[];for(let C=columnRange.s.c;C<=columnRange.e.c;C++){const address=xlsx_1.utils.encode_col(C);columnIds.push(address)}return columnIds};const getObjectLength=object=>{if(typeof object===\"string\"){return Math.max(...object.split(\"\\n\").map(string=>string.length))}if(typeof object===\"number\"){return object.toString().length}if(typeof object===\"boolean\"){return object?\"true\".length:\"false\".length}if(object instanceof Date){return object.toString().length}return 0};const getWorksheetColumnWidths=(worksheet,extraLength=1)=>{const columnLetters=getWorksheetColumnIds(worksheet);return columnLetters.map(column=>{const columnCells=Object.keys(worksheet).filter(cell=>{return cell.replace(/[0-9]/g,\"\")===column});const maxWidthCell=columnCells.reduce((maxWidth,cellId)=>{const cell=worksheet[cellId];const cellContentLength=getObjectLength(cell.v);if(!cell.z){return Math.max(maxWidth,cellContentLength)}const cellFormatLength=cell.z.length;const largestWidth=Math.max(cellContentLength,cellFormatLength);return Math.max(maxWidth,largestWidth)},0);return{width:maxWidthCell+extraLength}})};exports.getWorksheetColumnWidths=getWorksheetColumnWidths;const getWorksheet=(jsonSheet,settings)=>{let jsonSheetRows;if(jsonSheet.content.length>0){jsonSheetRows=jsonSheet.content.map(contentItem=>{return(0,exports.getJsonSheetRow)(contentItem,jsonSheet.columns)})}else{jsonSheetRows=jsonSheet.columns.map(column=>({[column.label]:\"\"}))}const worksheet=xlsx_1.utils.json_to_sheet(jsonSheetRows);const worksheetColumnIds=getWorksheetColumnIds(worksheet);const worksheetColumnFormats=jsonSheet.columns.map(jsonSheetColumn=>{var _a;return(_a=jsonSheetColumn.format)!==null&&_a!==void 0?_a:null});applyColumnFormat(worksheet,worksheetColumnIds,worksheetColumnFormats);worksheet[\"!cols\"]=(0,exports.getWorksheetColumnWidths)(worksheet,settings.extraLength);return worksheet};const writeWorkbook=(workbook,settings={})=>{var _a,_b,_c,_d;var _e;const RTL=Boolean(settings.RTL);(_a=workbook.Workbook)!==null&&_a!==void 0?_a:workbook.Workbook={};(_b=(_e=workbook.Workbook).Views)!==null&&_b!==void 0?_b:_e.Views=[{}];workbook.Workbook.Views.forEach(view=>{view.RTL=RTL});const filename=`${(_c=settings.fileName)!==null&&_c!==void 0?_c:\"Spreadsheet\"}.xlsx`;const writeOptions=(_d=settings.writeOptions)!==null&&_d!==void 0?_d:{};if(settings.writeMode===\"write\"){return(0,xlsx_1.write)(workbook,writeOptions)}else if(settings.writeMode===\"writeFile\"){return(0,xlsx_1.writeFile)(workbook,filename,writeOptions)}else{return writeOptions.type===\"buffer\"?(0,xlsx_1.write)(workbook,writeOptions):(0,xlsx_1.writeFile)(workbook,filename,writeOptions)}};const xlsx=(jsonSheets,settings={},workbookCallback=()=>{})=>{if(jsonSheets.length===0)return;const workbook=xlsx_1.utils.book_new();jsonSheets.forEach((actualSheet,actualIndex)=>{var _a;const worksheet=getWorksheet(actualSheet,settings);const worksheetName=(_a=actualSheet.sheet)!==null&&_a!==void 0?_a:`Sheet ${actualIndex+1}`;xlsx_1.utils.book_append_sheet(workbook,worksheet,worksheetName)});workbookCallback(workbook);return writeWorkbook(workbook,settings)};exports.xlsx=xlsx;exports.default=exports.xlsx;exports.libraryName=\"json-as-xlsx\";module.exports=exports.xlsx;module.exports.getContentProperty=exports.getContentProperty;module.exports.getJsonSheetRow=exports.getJsonSheetRow;module.exports.getWorksheetColumnWidths=exports.getWorksheetColumnWidths;module.exports.utils=xlsx_1.utils;"],"names":["cptable","version","d","D","e","i","length","charCodeAt","charAt","j","split","module","exports","DO_NOT_EXPORT_CODEPAGE","root","factory","cpt","this","magic","sbcs_cache","dbcs_cache","magic_cache","magic_decode","magic_encode","cpdcache","cpecache","sfcc","x","String","fromCharCode","cca","has_buf","Buffer","Buffer_from","nbfs","from","buf","enc","bind","allocUnsafe","n","mdl","mdb","make_EE","E","EE","keys","Object","len","ee","sbcs_encode","cp","data","ofmt","out","w","isBuffer","slice","toString","call","sbcs_decode","dec","DD","c","dbcs_encode","f","jj","k","dbcs_decode","utf8_d","map","ww","direct","encache","s","null_enc","cp_decache","decache","forEach","last_enc","last_cp","cache","sbcs","dbcs","BM","SetD","encode","C","M","isstr","Error","indexOf","tt","join","decode","F","Array","match","dash","o64","c1","c2","c3","e1","e2","e3","e4","l","push","hascp","utils","XLSX","make_xlsx_lib","$cptable","current_codepage","current_ansi","VALID_ANSI","CS2CP","set_ansi","reset_ansi","set_cp","reset_cp","char_codes","o","utf16leread","utf16lereadu","utf16beread","debom","_getchar","_getansi","set_cptable","cpdoit","DENSE","DIF_XL","Base64_map","Base64_encode","input","isNaN","Base64_encode_pass","Base64_encode_arr","Base64_decode","replace","process","versions","node","buf_utf16le","new_raw_buf","alloc","Uint8Array","new_unsafe_buf","s2a","s2ab","ArrayBuffer","view","a2s","isArray","a2u","ab2a","bconcat","bufs","concat","maxlen","set","apply","utf8decode","content","widx","L","ridx","chr0","chr1","_strrev","pad0","v","t","fill","pad_","rpad_","pad0r1","Math","round","pad0r2","p2_32","pow","pad0r","SSF_isgeneral","days","months","SSF_init_table","table_fmt","SSF_default_map","SSF_default_str","SSF_frac","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","SSF_parse_date_code","opts","b2","date","time","dow","dout","T","u","y","m","H","S","abs","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","SSF_fix_hijri","SSF_strip_decimal","SSF_normalize_exp","SSF_small_exp","toFixed","toPrecision","toExponential","SSF_large_exp","SSF_general_num","V","log","LOG10E","substr","toUpperCase","SSF_general","SSF_format","datenum","SSF_write_date","type","fmt","val","ss0","ss","outl","outstr","commaify","pct1","write_num_pct","sfmt","mul","write_num","write_num_cm","idx","write_num_exp","period","fakee","$$","$1","$2","$3","frac1","write_num_f1","r","aval","sign","den","parseInt","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","_frac","carry","flr","write_num_flt","ffmt","ri","ff","oa","min","max","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","lastIndexOf","SSF_split_fmt","in_str","SSF_abstime","fmt_is_date","eval_fmt","flen","dt","lst","hr","toLowerCase","ssm","bt","nstr","myv","ostr","vv","decpt","lasti","retval","cfregex2","chkcond","thresh","parseFloat","choose_fmt","lat","m1","m2","dateNF","table","SSF_load","undefined","SSF_load_table","tbl","make_ssf","SSF","format","load","_table","load_table","parse_date_code","is_date","get_table","SSFImplicit","dateNFregex","dateNF_regex","lastIndex","RegExp","dateNF_fix","Y","datestr","timestr","bad_formats","SSF__load","_fs","CRC32","signed_crc_table","Int32Array","T0","slice_by_16_tables","subarray","TT","T1","T2","T3","T4","T5","T6","T7","T8","T9","Ta","Tb","Tc","Td","Te","Tf","crc32_bstr","bstr","seed","crc32_buf","crc32_str","CFB","fs","namecmp","R","Z","dirname","p","filename","write_dos_date","hms","getHours","getMinutes","getSeconds","write_shift","ymd","parse_dos_date","read_shift","setMilliseconds","setFullYear","setMonth","setHours","setMinutes","setSeconds","parse_extra_field","blob","prep_blob","flags","sz","tgt","mtime","atime","ctime","mt","sz1","sz2","usz","csz","get_fs","parse","file","options","parse_zip","parse_mad","mver","ssz","nmfs","difat_sec_cnt","dir_start","minifat_start","difat_start","fat_addrs","mv","check_get_mver","header","check_shifts","dir_cnt","chk","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","name","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","read_directory","build_full_paths","shift","raw","HEADER_SIGNATURE","nsectors","ceil","FI","FP","pl","dad","get_mfat_entry","entry","payload","mini","start","size","MSSZ","__readInt32LE","new_buf","cnt","sector","get_sector_list","chkd","buf_chain","modulus","addr","nodes","__toBuffer","sl","seen","minifat_store","namelen","__utf16le","color","clsid","state","ct","read_date","storage","offset","__readUInt32LE","read_file","readFileSync","read","init_cfb","cfb","CLSID","seed_cfb","nm","find","rebuild_cfb","gc","_file","pop","now","fullPaths","create","HEADER_CLSID","sort","elt","_write","_opts","fileType","write_mad","write_zip","mini_size","fat_size","mini_cnt","mfat_cnt","fat_base","fat_cnt","difat_cnt","HEADER_SIG","chainit","consts","DIFSECT","FATSECT","_nm","console","error","copy","path","UCFullPaths","UCPaths","UCPath","_zlib","MAXREGSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","write_file","writeFileSync","write","use_zlib","zlib","InflateRaw","InflRaw","_processChunk","_finishFlushFlag","bytesRead","message","_inflateRawSync","_inflate","_deflateRawSync","deflateRawSync","_deflate","CLEN_ORDER","LEN_LN","DST_LN","bit_swap_8","use_typed_arrays","bitswap8","bit_swap_n","b","rev","read_bits_2","bl","h","read_bits_3","read_bits_4","read_bits_5","read_bits_7","read_bits_n","write_bits_3","write_bits_1","write_bits_8","write_bits_16","realloc","a","zero_fill_array","build_tree","clens","cmap","MAX","ccode","bl_count","Uint16Array","ctree","cleni","fix_lmap","fix_dmap","dlens","_deflateRaw","DST_LN_RE","LEN_LN_RE","write_stored","boff","write_huff_fixed","addrs","hash","mlen","len_eb","dst_eb","off","dyn_lmap","dyn_dmap","dyn_cmap","dyn_len_1","dyn_len_2","dyn","_HLIT","_HDIST","_HCLEN","next_code","hcodes","h1","h2","inflate","outbuf","woff","OL","max_len_1","max_len_2","bits","code","dst","warn_or_throw","wrn","msg","fcnt","start_cd","efsz","fcsz","EF","parse_local_file","meth","crc32","_csz","_usz","ef","cfb_add","unsafe","cdirs","method","compression","desc","fp","fi","crcs","sz_cd","namebuf","ContentTypeMap","get_content_type","ctype","ext","write_base64_76","write_quoted_printable","text","encoded","si","end","tmp","parse_quoted_printable","di","line","oi","parse_mime","fdata","fname","cte","trim","row","test","mboundary","boundary","start_di","ca","cstr","dispcnt","csl","qp","cfb_new","fpath","cfb_gc","cfb_del","splice","cfb_mov","old_name","new_name","writeFile","ReadShift","CheckField","_inflateRaw","set_fs","blobify","write_dl","Deno","TextEncoder","utf8write","IE_SaveFile","Blob","navigator","msSaveBlob","saveAs","URL","document","createElement","createObjectURL","url","chrome","downloads","download","revokeObjectURL","setTimeout","href","body","appendChild","click","removeChild","b64","$","File","Folder","open","encoding","close","read_binary","infile","ks","o2","prototype","hasOwnProperty","evert_key","obj","key","K","evert","evert_num","evert_arr","dnthresh","UTC","dnthresh1","dnthresh2","epoch","getTime","res","numdate","setTime","parse_isodur","sec","pdre1","pdre2","pdre3","parseDate","cc2str","arr","debomit","TextDecoder","dup","JSON","stringify","fuzzynum","Number","isFinite","NaN","wt","FDRE1","FDRE2","FDISO","utc_append_works","valueOf","fuzzytime1","fuzzytime2","lower_months","fuzzydate","local_to_utc","lower","lnos","getYear","split_regex","safe_split_regex","re","def","utc_to_local","utc","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","local","getMilliseconds","getdatastr","asNodeBuffer","asBinary","_data","getContent","getdatabin","getdata","safegetzipfile","zip","g","getzipfile","getzipdata","safe","getzipstr","getzipbin","zipentries","zip_add_file","zip_new","zip_read","resolve_path","result","target","step","XML_HEADER","attregexg","tagregex1","tagregex2","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","skip_LC","z","eq","quot","strip_ns","encodings","rencoding","unescapexml","encregex","coderegex","raw_unescapexml","xlsx","decregex","charegex","escapexml","escapexmltag","htmlcharegex","escapehtml","escapexlml","xlml_fixstr","entregex","entrepl","xlml_unfixstr","parsexmlbool","value","utf8reada","orig","utf8readb","utf8readc","utf8corpus","utf8read","matchtag","mtcache","htmldecode","entities","vtregex","vt_cache","vtvregex","vtmregex","parseVector","matches","baseType","WTF","wtregex","writetag","wxt_helper","writextag","write_w3cdtf","toISOString","write_vt","xlml_normalize","xlmlregex","XMLNS","CORE_PROPS","CUST_PROPS","EXT_PROPS","CT","RELS","TCMNT","XMLNS_main","XLMLNS","read_double_le","Infinity","write_double_le","bs","av","LN2","___toBuffer","___utf16le","__readUInt16LE","___hexlify","__hexlify","___utf8","__readUInt8","__utf8","___lpstr","__lpstr","___cpstr","__cpstr","___lpwstr","__lpwstr","___lpp4","__lpp4","___8lpp4","__8lpp4","___double","__double","is_buf","readUInt32LE","readDoubleLE","__readInt16LE","__readInt32BE","oI","oR","loc","oo","lens","__writeUInt32LE","__writeInt32LE","__writeUInt16LE","WriteShift","cpp","hexstr","fld","pos","parsenoop","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","curbuf","endbuf","next","_bufs","write_record","ba","shift_cell_xls","cell","cRel","rRel","biff","shift_range_xls","range","encode_cell_xls","encode_cell","fix_col","fix_row","encode_range_xls","encode_row","encode_col","decode_row","rowstr","unfix_row","decode_col","colstr","unfix_col","col","split_cell","decode_cell","decode_range","encode_range","cs","ce","fix_range","a1","formula_quote_sheet_name","sname","safe_decode_range","safe_format_cell","XF","numFmtId","format_cell","BErr","sheet_to_workbook","sheet","sheets","SheetNames","Sheets","sheet_add_aoa","_ws","dense","ws","_R","_C","origin","_origin","_range","__R","__Rstr","__C","nullError","sheetStubs","cellDates","cell_ref","aoa_to_sheet","parse_Int32LE","write_UInt32LE","parse_XLWideString","cchCharacters","write_XLWideString","_null","parse_StrRun","ich","ifnt","write_StrRun","run","parse_RichStr","rgsStrRun","dwSizeStrRun","write_RichStr","require","parse_BrtCommentText","write_BrtCommentText","parse_XLSBCell","iStyleRef","write_XLSBCell","parse_XLSBShortCell","write_XLSBShortCell","parse_XLSBCodeName","write_XLSBCodeName","parse_XLNullableWideString","write_XLNullableWideString","parse_XLNameWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","write_RkNumber","d100","parse_RfX","write_RfX","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","parse_BrtColor","xColorType","index","nTS","bR","bG","bB","auto","icv","XLSIcv","rgb","rgb2Hex","theme","tint","write_BrtColor","parse_FontFlags","fBold","fItalic","fUnderline","fStrikeout","fOutline","fShadow","fCondense","fExtend","write_FontFlags","font","grbit","italic","strike","outline","shadow","condense","extend","parse_ClipboardFormatOrString","ClipFmt","parse_ClipboardFormatOrAnsiString","parse_ClipboardFormatOrUnicodeString","VT_I2","VT_I4","VT_BOOL","VT_VARIANT","VT_UI4","VT_FILETIME","VT_BLOB","VT_CF","VT_VECTOR_VARIANT","VT_VECTOR_LPSTR","VT_STRING","VT_USTR","VT_CUSTOM","DocSummaryPIDDSI","SummaryPIDSI","CountryEnum","XLSFillPattern","rgbify","_XLSIcv","RBErr","XLSLblBuiltIn","ct2type","CT_LIST","workbooks","xlsm","xlsb","xlam","xltx","strs","comments","charts","dialogs","macros","metadata","styles","new_ct","rels","threadedcomments","links","coreprops","extprops","custprops","themes","calcchains","vba","drawings","people","TODO","xmlns","parse_ct","ctext","Extension","ContentType","PartName","calcchain","sst","style","defaults","write_ct","type2ct","xsd","xsi","f1","bookType","f2","f3","WB","SHEET","HLINK","VML","XPATH","XMISS","XLINK","CXML","CXMLP","CMNT","SST","STY","THEME","CHART","CHARTEX","CS","WS","DS","MS","IMG","DRAW","XLMETA","PEOPLE","CONN","VBA","get_rels_path","parse_rels","currentFilePath","rel","Type","Target","Id","TargetMode","canonictarget","write_rels","rid","add_rels","rId","relobj","targetmode","CT_ODS","parse_manifest","Rn","FEtag","exec","write_manifest","manifest","write_rdf_type","write_rdf_has","write_rdf","rdf","write_meta_ods","wb","CORE_PROPS_REGEX","parse_core_props","cur","cp_doit","write_core_props","dc","dcterms","dcmitype","Props","CreatedDate","ModifiedDate","PseudoPropsPairs","load_props_pairs","HP","TOP","props","hp","parts","Worksheets","NamedRanges","DefinedNames","Chartsheets","ChartNames","parse_ext_props","xml","HeadingPairs","TitlesOfParts","write_ext_props","W","Application","vt","custregex","parse_cust_props","toks","warn","write_cust_props","pid","evert_XLMLDPM","XLMLDocPropsMap","Title","Subject","Author","Keywords","Comments","LastAuthor","RevNumber","LastPrinted","Category","Manager","Company","AppVersion","ContentStatus","Identifier","Language","xlml_set_prop","xlml_write_docprops","xlml_write_custprops","Custprops","BLACKLIST","parse_FILETIME","dwLowDateTime","dwHighDateTime","write_FILETIME","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtUnalignedString","parse_VtVecLpwstrValue","ret","parse_VtVecUnalignedLpstrValue","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","headerParts","parse_VtVecHeadingPairValue","cElements","parse_dictionary","CodePage","dict","parse_BLOB","bytes","parse_ClipboardData","Size","write_TypedPropertyValue","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","XLSPSSkip","guess_property_type","write_PropertySet","entries","RE","hdr","piao","prop","pr","pio","unshift","pinfo","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","SystemIdentifier","PSet1","PSet0","rval","FMTID","write_PropertySetStream","entries2","clsid2","ps0","ps1","parsenoop2","writezeroes","parslurp","writebool","parseuint16","writeuint16","parseuint16a","parse_Bes","write_Bes","parse_ShortXLUnicodeString","cch","fHighByte","parse_XLUnicodeRichExtendedString","cbExtRst","fExtSt","fRichSt","width","cRun","write_XLUnicodeRichExtendedString","xlstr","nfmts","otext","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","write_XLUnicodeString","parse_ControlInfo","accel","parse_URLMoniker","extra","parse_FileMoniker","cAnti","preamble","ansiPath","unicodePath","parse_HyperlinkMoniker","parse_HyperlinkString","write_HyperlinkString","parse_Hyperlink","sVer","displayName","targetFrameName","moniker","oleMoniker","guid","fileTime","Loc","Tooltip","write_Hyperlink","hl","hashidx","Pretarget","parse_LongRGBA","parse_LongRGB","parse_XLSCell","rw","ixfe","write_XLSCell","parse_frtHeader","rt","parse_OptXLUnicodeString","parse_XTI","iSupBook","itabFirst","itabLast","parse_RkRec","parse_AddinUdf","udfName","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","write_Ref8U","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtNts","fSharedNote","parse_FtCf","cf","parse_FtSkip","FtTab","parse_FtArray","fts","ft","parse_BOF","BIFFVer","write_BOF","parse_InterfaceHdr","parse_WriteAccess","UserName","write_WriteAccess","b8","parse_WsBool","fDialog","fBelow","fRight","parse_BoundSheet8","hidden","hs","write_BoundSheet8","parse_SST","ucnt","Count","Unique","write_SST","parse_ExtSST","extsst","dsst","parse_Row","miyRw","level","hpt","parse_ForceFullCalculation","fullcalc","parse_RecalcId","parse_DefaultRowHeight","fl","Unsynced","DyZero","ExAsc","ExDsc","parse_Window1","xWn","yWn","dxWn","dyWn","iTabCur","iTabFirst","ctabSel","wTabRatio","Pos","Dim","Flags","CurTab","FirstTab","Selected","TabRatio","write_Window1","parse_Window2","RTL","write_Window2","parse_Pane","parse_Font","dyHeight","write_Font","b5","parse_LabelSst","isst","write_LabelSst","os","parse_Label","biffguess","write_Label","parse_Format","fmtstr","write_Format","parse_BIFF2Format","write_BIFF2Format","write_BIFF4Format","parse_Dimensions","write_Dimensions","parse_RK","rkrec","rknum","parse_MulRk","rkrecs","lastcol","parse_MulBlank","ixfes","parse_CellStyleXF","patternType","cellStyles","alc","fWrap","alcV","fJustLast","trot","cIndent","fShrinkToFit","iReadOrder","fAtrNum","fAtrFnt","fAtrAlc","fAtrBdr","fAtrPat","fAtrProt","dgLeft","dgRight","dgTop","dgBottom","icvLeft","icvRight","grbitDiag","icvTop","icvBottom","icvDiag","dgDiag","icvFore","icvBack","fsxButton","parse_XF","fStyle","write_XF","ixfeP","parse_BIFF2XF","write_BIFF2XF","xf","write_BIFF3XF","write_BIFF4XF","parse_BIFF3XF","parse_BIFF4XF","parse_Guts","write_Guts","guts","parse_BoolErr","write_BoolErr","parse_Number","xnum","write_Number","parse_XLHeaderFooter","parse_SupBook","ctab","sbcch","virtPath","rgst","parse_ExternName","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","Name","parse_Lbl","chKey","cce","itab","npflen","rgce","parse_NameParsedFormula","parse_ExternSheet","parse_BIFF5ExternSheet","parse_NameCmt","cchName","cchComment","comment","parse_ShrFmla","ref","cUse","parse_SharedParsedFormula","parse_Array","parse_ArrayParsedFormula","parse_MTRSettings","fMTREnabled","fUserSetThreadCount","cUserThreadCount","parse_NoteSh","idObj","stAuthor","parse_Note","cmnt","write_NOTE_BIFF2","parse_MergeCells","merges","cmcs","write_MergeCells","parse_Obj","parse_BIFF5Obj","cmo","parse_BIFF5OT","parse_TxO","texts","lastobj","cchText","parse_HLink","hlink","write_HLink","O","parse_HLinkTooltip","wzTooltip","write_HLinkTooltip","parse_Country","write_Country","parse_ClrtClient","ccv","parse_Palette","parse_XFCRC","cxfs","crc","parse_ColInfo","coldx","write_ColInfo","parse_Setup","footer","parse_ShtProps","area","write_RRTabId","parse_Blank","parse_Scl","parse_String","parse_ImData","env","lcb","write_BIFF2Cell","ifmt","parse_BIFF2STR","parse_BIFF2NUM","num","write_BIFF2NUM","parse_BIFF2INT","write_BIFF2INT","parse_BIFF2STRING","parse_BIFF2BOOLERR","bestart","parse_BIFF2FONTXTRA","parse_RString","parse_BIFF4SheetInfo","DBF_SUPPORTED_VERSIONS","DBF","dbf_codepage_map","dbf_reverse_map","dbf_to_aoa","memo","vfp","l7","nrow","fpos","rlen","current_cp","codepage","fields","field","hend","hi","lo","sheetRows","dbf_to_sheet","wch","dbf_to_workbook","_RLEN","sheet_to_dbf","old_cp","aoa","sheet_to_json","headers","cols","hcnt","coltypes","colwidths","coldecimals","guess","_guess","hf","_f","hb","rout","_n","_l","_s","to_workbook","to_sheet","from_sheet","SYLK","sylk_escapes","AA","BA","CA","DA","HA","JA","AE","BE","CE","HE","AI","BI","CI","HI","AO","BO","CO","DO","HO","AU","BU","CU","HU","Aa","Ba","Ca","Da","Ha","Ja","Ae","Be","Ce","He","Ai","Bi","Ci","Hi","Ao","Bo","Co","Do","Ho","Au","Bu","Cu","Hu","KC","Kc","DN","Dn","Hy","sylk_char_regex","sylk_char_fn","_","decode_sylk_char","newcc","encode_sylk_str","sylk_to_aoa","sylk_to_aoa_str","records","rj","formats","next_cell_format","sht","rowinfo","colinfo","cw","Mval","Workbook","WBProps","Names","rstr","record","d1904","nn","Sheet","Ref","rc_to_a1","C_seen_K","C_seen_X","C_seen_S","C_seen_E","formula","cell_t","cellText","shrbase","shift_formula_str","F_seen","hpx","pt2px","process_col","sylk_to_workbook","aoasht","outwb","write_ws_cell_sylk","a1_to_rc","write_ws_cmnt_sylk","write_ws_cols_sylk","rec","wpx","width2px","px2char","write_ws_rows_sylk","rows","px2pt","sheet_to_sylk","_formats","RS","_lastfmt","DIF","dif_to_aoa","dif_to_aoa_str","dif_to_sheet","dif_to_workbook","make_value","make_value_str","sheet_to_dif","_DIF_XL","ETH","eth_to_aoa","eth_to_sheet","eth_to_workbook","sep","meta","sheet_to_eth_data","coord","sheet_to_eth","PRN","set_text_arr","prn_to_aoa_str","lines","guess_seps","guess_sep_weights","guess_sep","instr","dsv_to_sheet_str","FS","sepcc","startcc","_re","finish_cell","fuzzyfmla","news","cellNF","outer","prn_to_sheet_str","prn_to_sheet","firstbyte","prn_to_workbook","sheet_to_prn","read_wb_ID","OLD_WTF","WK_","lotushopper","Enum","WK1Enum","lotus_to_workbook","lotus_to_workbook_buf","LOTUS_DATE_FMTS","next_n","sidx","snames","realnames","sdata","refguess","lastcell","qpw_to_workbook_buf","vers","qpro","works","works2","tmpcell","WK3Enum","osheets","rnames","sheet_to_wk1","write_biff_rec","write_BOF_WK1","write_RANGE","max_R","write_INTEGER","write_NUMBER","write_LABEL","book_to_wk3","write_BOF_WK3","write_XFORMAT_SHEETNAME","wsidx","write_NUMBER_17","write_LABEL_16","wscnt","parse_RANGE","parse_cell","get_wk1_fmt","parse_LABEL","parse_STRING","parse_INTEGER","parse_NUMBER","parse_FORMULA","wk1_fmla_to_csf","wk1_parse_rc","FuncTab","BinOpTab","argc","argL","argR","args","parse_cell_3","parse_LABEL_16","parse_NUMBER_18","parse_NUMBER_17","v1","v2","log2","parse_FORMULA_19","parse_NUMBER_25","parse_NUMBER_27","parse_FORMULA_28","parse_SHEETNAMECS","parse_SHEETNAMELP","parse_SHEETINFOQP","parse_XFORMAT","QPWNFTable","FMTS","book_append_sheet","CC","fmtidx","delta","newcell","parse_rpr","rpr","pass","uval","family","valign","parse_rs","tregex","rpregex","parse_r","rregex","rend","rs","filter","rs_to_html","nlregex","parse_rpr2","intro","outro","align","r_to_html","terms","sitregex","sirregex","sirphregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","parse_sst_xml","count","uniqueCount","straywsregex","write_sst_xml","bookSST","sitag","parse_BrtBeginSst","parse_sst_bin","write_BrtBeginSst","write_BrtSSTItem","write_sst_bin","_JS2ANSI","parse_CRYPTOVersion","Major","Minor","parse_DataSpaceVersionInfo","U","parse_DataSpaceMapEntry","comps","parse_DataSpaceMap","parse_DataSpaceDefinition","parse_TransformInfoHeader","parse_Primary","ename","cmode","parse_EncryptionHeader","AlgID","valid","AlgIDHash","KeySize","ProviderType","CSPName","parse_EncryptionVerifier","Salt","Verifier","VerifierHash","parse_EncryptionInfo","parse_EncInfoStd","parse_EncInfoExt","parse_EncInfoAgl","verifier","KeyData","encryptedHmacKey","encryptedHmacValue","encs","uri","parse_RC4CryptoHeader","EncryptionVersionInfo","EncryptionHeader","EncryptionVerifier","parse_RC4Header","EncryptedVerifier","EncryptedVerifierHash","crypto_CreatePasswordVerifier_Method1","Password","PasswordArray","PasswordByte","Intermediate1","Intermediate2","Intermediate3","PasswordDecoded","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","Ror","Byte","XorRor","byte1","byte2","CreateXorKey_Method1","XorKey","CurrentElement","Char","password","Temp","PasswordLastChar","PadIndex","Index","ObfuscationArray","crypto_DecryptData_Method1","Data","XorArrayIndex","XorArray","Value","crypto_MakeXorDecryptor","parse_XORObfuscation","verificationBytes","insitu","parse_FilePassHeader","Info","parse_FilePass","rtf_to_sheet","rtf_to_sheet_str","rowtf","rtfre","last_index","rtf_to_workbook","sheet_to_rtf","hex2RGB","rgb2HSL","G","H6","L2","hsl2RGB","hsl","X","h6","rgb_tint","hex","DEF_MDW","MAX_MDW","MIN_MDW","MDW","px","char2width","chr","cycle_width","collw","find_mdw_colw","_MDW","coll","customWidth","DEF_PPI","PPI","pt","XLMLPatternTypeMap","parse_borders","Borders","border","diagonalUp","diagonalDown","parse_fills","Fills","bgColor","indexed","fgColor","parse_fonts","Fonts","bold","underline","vertAlign","scheme","themeElements","clrScheme","parse_numFmts","NumberFmt","formatCode","write_numFmts","NF","cellXF_uint","cellXF_bool","parse_cellXfs","CellXf","alignment","vertical","horizontal","textRotation","indent","wrapText","write_cellXfs","cellXfs","parse_sty_xml","numFmtRegex","cellXfRegex","fillsRegex","fontsRegex","bordersRegex","write_sty_xml","parse_BrtFmt","stFmtCode","write_BrtFmt","parse_BrtFont","bls","bCharSet","charset","write_BrtFont","sss","rev_XLSBFillPTNames","XLSBFillPTNames","parse_BrtFill","write_BrtFill","fls","parse_BrtXF","ixfeParent","write_BrtXF","flow","write_Blxf","parse_BrtBorder","write_BrtBorder","write_BrtStyle","xfId","builtinId","write_BrtBeginTableStyles","defTableStyle","defPivotStyle","parse_sty_bin","write_FMTS_bin","write_FONTS_bin","write_FILLS_bin","write_BORDERS_bin","write_CELLSTYLEXFS_bin","fontId","fillId","borderId","write_CELLXFS_bin","write_STYLES_bin","write_DXFS_bin","write_TABLESTYLES_bin","write_COLORPALETTE_bin","write_sty_bin","XLSXThemeClrScheme","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","clrsregex","fntsregex","fmtsregex","parse_themeElements","themeltregex","parse_theme_xml","write_theme","Themes","themeXLSX","parse_Theme","dwThemeVersion","themeXML","parse_ColorTheme","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_XFExtGradient","parse_ExtProp","extType","parse_XFExt","cexts","update_xfext","xfext","xfe","parse_BrtMdtinfo","write_BrtMdtinfo","parse_BrtMdb","write_BrtMdb","write_BrtBeginEsfmd","parse_BrtBeginEsmdb","write_BrtBeginEsmdb","cm","parse_xlmeta_bin","Types","Cell","metatype","write_xlmeta_bin","parse_xlmeta_xml","lastmeta","offsets","write_xlmeta_xml","parse_cc_xml","parse_BrtCalcChainItem$","parse_cc_bin","parse_xlink_xml","parse_xlink_bin","parse_drawing","shapevmlregex","parse_vml","cidx","aidx","ObjectType","ws_get_cell_stub","write_vml","csize","bbox","_shapeid","_comments","joinstyle","gradientshapeok","coordsize","write_vml_comment","fillopts","angle","fillparm","fillxml","shadata","on","fillcolor","strokecolor","sheet_insert_comments","threaded","author","parse_comments_xml","authors","commentList","authtag","cmnttag","authorId","textMatch","write_comments_xml","iauthor","ID","lastauthor","ts","tcnt","parse_tcmnt_xml","tidx","personId","write_tcmnt_xml","carr","rootid","tcopts","tcid","parentId","parse_people_xml","displayname","write_people_xml","person","userId","providerId","parse_BrtBeginComment","rfx","write_BrtBeginComment","parse_BrtCommentAuthor","write_BrtCommentAuthor","parse_comments_bin","write_comments_bin","_ia","CT_VBA","make_vba_xls","newcfb","newpath","fill_vba_xls","VBAFMTS","parse_ds_bin","parse_ds_xml","parse_ms_bin","parse_ms_xml","rcregex","rcbase","rcfunc","fstr","crefregex","$0","$4","$5","shift_formula_xlsx","_xlfn","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceElfLoc","fQuoted","parse_RgceLocRel","parse_RgceLocRel_BIFF2","cl","rl","parse_PtgArea","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrIfError","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgNameX_BIFF5","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgRefErr3d","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgTbl","parse_PtgElfLoc","parse_PtgElfNoop","parse_PtgElfCol","parse_PtgElfColS","parse_PtgElfColSV","parse_PtgElfColV","parse_PtgElfLel","parse_PtgElfRadical","parse_PtgElfRadicalLel","parse_PtgElfRadicalS","parse_PtgElfRw","parse_PtgElfRwV","PtgListRT","parse_PtgList","coltype","parse_PtgSxName","parse_PtgSheet","parse_PtgEndSheet","parse_PtgMemAreaN","parse_PtgMemNoMemN","parse_PtgAttrNoop","PtgTypes","PtgDupes","Ptg18","Ptg19","parse_RgbExtra","parse_Rgce","ptgs","stringify_array","PtgBinOp","PtgAdd","PtgConcat","PtgDiv","PtgEq","PtgGe","PtgGt","PtgLe","PtgLt","PtgMul","PtgNe","PtgPower","PtgSub","make_3d_range","get_ixti_raw","supbooks","XTI","SID","get_ixti","ixtiraw","stringify_formula","stack","nameidx","last_sp","sp","fflen","func","lbl","names","xlfn","externbook","bookidx","ixtidata","lp","rp","sharedf","parsedf","fnd","arrayf","PtgNonDisp","_left","rgcb","parse_XLSCellParsedFormula","parse_FormulaValue","write_FormulaValue","parse_Formula","cbf","shared","write_Formula","o1","o3","bf","parse_XLSBParsedFormula","parse_XLSBArrayParsedFormula","parse_XLSBCellParsedFormula","parse_XLSBNameParsedFormula","parse_XLSBSharedParsedFormula","write_XLSBFormulaNum","oint","write_XLSBFormulaErr","write_XLSBFormulaBool","write_XLSBFormulaStr","postamble","write_XLSBFormulaRef","write_XLSBFormulaRef3D","lastbang","write_XLSBFormulaRefErr3D","write_XLSBFormulaRange","_str","write_XLSBFormulaRangeWS","write_XLSBFormulaArea3D","write_XLSBFormula","write_XLSBNameParsedFormula","ods_to_csf_formula","csf_to_ods_formula","ods_to_csf_3D","csf_to_ods_3D","_ssfopts","browser_has_Map","Map","get_sst_id","has","revarr","get","col_obj_w","outlineLevel","default_margins","margins","mode","defs","left","right","top","bottom","get_cell_style","revssf","ssf","applyNumberFormat","safe_format","fmtid","fillid","raw_rgb","check_ws","parse_ws_xml_dim","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","afregex","marginregex","sheetprregex","sheetprregex2","svsregex","parse_ws_xml","data1","data2","mtch","sheetPr","parse_ws_xml_sheetpr","parse_ws_xml_sheetpr2","nodim","svs","parse_ws_xml_sheetviews","columns","parse_ws_xml_cols","parse_ws_xml_data","afilter","parse_ws_xml_autofilter","_merge","parse_ws_xml_hlinks","parse_ws_xml_margins","tmpref","write_ws_xml_merges","codeName","CodeName","write_ws_xml_sheetpr","needed","vbaraw","cname","outlineprops","summaryBelow","summaryRight","above","sheetprot_deffalse","sheetprot_deftrue","write_ws_xml_protection","location","Rel","tooltip","rng","margin","write_ws_xml_margins","seencol","coli","colm","colM","write_ws_xml_cols","write_ws_xml_autofilter","sviewregex","Views","zoomScale","zoom","rightToLeft","write_ws_xml_sheetviews","sview","workbookViewId","write_ws_xml_cell","oldt","oldv","_vv","Strings","revStrings","display","cellregex","rowregex","isregex","refregex","match_v","match_f","sstr","ftag","cells","cref","tagr","tagc","do_format","rowobj","rowrite","marr","marrlen","xlen","rstarti","outa","ht","rslice","cellFormula","___f","_tag","xlmeta","_r","write_ws_xml_data","params","height","_cell","customHeight","write_ws_xml","rdata","_drawing","sheetFormat","defaultRowHeight","baseColWidth","outlineLevelRow","relc","ignoreEC","numberStoredAsText","sqref","parse_BrtRowHdr","write_BrtRowHdr","ncolspan","lcs","caddr","first","last","write_row_header","parse_BrtWsDim","write_BrtWsDim","parse_BrtWsFmtInfo","parse_BrtWsProp","write_BrtWsProp","parse_BrtCellBlank","write_BrtCellBlank","ncell","parse_BrtShortBlank","write_BrtShortBlank","parse_BrtCellBool","fBool","write_BrtCellBool","parse_BrtShortBool","write_BrtShortBool","parse_BrtCellError","bError","write_BrtCellError","parse_BrtShortError","write_BrtShortError","parse_BrtCellIsst","write_BrtCellIsst","parse_BrtShortIsst","write_BrtShortIsst","parse_BrtCellReal","write_BrtCellReal","parse_BrtShortReal","write_BrtShortReal","parse_BrtCellRk","write_BrtCellRk","parse_BrtShortRk","write_BrtShortRk","parse_BrtCellRString","parse_BrtCellSt","write_BrtCellSt","parse_BrtShortSt","write_BrtShortSt","parse_BrtFmlaBool","parse_BrtFmlaError","parse_BrtFmlaNum","parse_BrtFmlaString","parse_BrtMergeCell","write_BrtMergeCell","write_BrtBeginMergeCells","parse_BrtHLink","relId","write_BrtHLink","locidx","parse_BrtPane","parse_BrtArrFmla","fAlwaysCalc","parse_BrtShrFmla","write_BrtColInfo","BrtMarginKeys","parse_BrtMargins","write_BrtMargins","parse_BrtBeginWsView","write_BrtBeginWsView","write_BrtCellIgnoreEC","write_BrtSheetProtection","parse_BrtDVal","parse_BrtDVal14","parse_ws_bin","ai","af","vm","RR","aii","_d","write_ws_bin_cell","last_seen","write_CELLTABLE","cap","write_MERGECELLS","write_COLINFOS","write_IGNOREECS","write_HLINKS","write_LEGACYDRAWING","write_AUTOFILTER","write_WSVIEWS2","write_WSFMTINFO","write_SHEETPROTECT","write_ws_bin","parse_Cache","nf","parse_chart","csheet","nc","parse_cs_xml","parse_BrtCsProp","parse_cs_bin","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","push_defaults_array","push_defaults","parse_wb_defaults","CalcPr","WBView","safe1904","badchars","check_ws_name","check_wb_names","N","codes","cn","check_wb","dn","wbnsregex","parse_wb_xml","dname","dnstart","Hidden","Comment","localSheetId","write_wb_xml","write_names","workbookPr","sheetId","parse_BrtBundleSh","iTabID","strRelID","write_BrtBundleSh","parse_BrtWbProp","defaultThemeVersion","strName","autoCompressPictures","backupFile","checkCompatibility","filterPrivacy","hidePivotFieldList","promptedSolutions","publishItems","refreshAllConnections","saveExternalLinkValues","showBorderUnselectedTables","showInkAnnotation","showObjects","showPivotChartFilter","updateLinks","write_BrtWbProp","parse_BrtFRTArchID$","ArchID","parse_BrtName","Ptg","write_BrtName","parse_wb_bin","write_BUNDLESHS","viz","write_BrtFileVersion","write_BrtBookView","write_BOOKVIEWS","vistab","write_BRTNAMES","write_SELF_EXTERNS_xlsb","write_EXTERNALS_xlsb","write_wb_bin","parse_wb","parse_ws","parse_cs","parse_ms","parse_ds","parse_sty","parse_sst","parse_cmnt","parse_cc","parse_xlink","parse_xlmeta","XLMLFormatMap","attregexg2","attregex2","xlml_parsexmltag","words","xlml_parsexmltagobj","xlml_format","xlml_set_custprop","oval","safe_format_xlml","process_style_xlml","stag","Interior","I","Pattern","parse_xlml_data","csty","sid","StyleID","interiors","Parent","Formula","ArrayRange","xlml_prefix_dname","xlml_clean_comment","parse_xlml_xml","opening","ishtml","_o","html_to_workbook","sheetnames","cursheet","sheetname","dtag","didx","fidx","pidx","cstys","wsprops","raw_Rn3","HRef","HRefScreenTip","MergeAcross","MergeDown","cma","cmd","AutoFitHeight","Height","Format","ssfidx","Width","_col","Span","_NamedRange","_DefinedName","RefersTo","AutoFilter","Range","parse_fods","Margin","pagemargins","Top","Left","Right","Bottom","bookSheets","bookProps","parse_xlml","fix_read_opts","write_props_xlml","write_wb_xlml","write_sty_xlml","write_name_xlml","write_names_xlml","write_ws_xlml_names","write_ws_xlml_wsopts","objects","scenarios","selectLockedCells","selectUnlockedCells","write_ws_xlml_comment","write_ws_xlml_cell","attr","mi","_v","write_ws_xlml_row","write_ws_xlml_table","skip","write_ws_xlml","write_xlml","parse_compobj","AnsiUserType","AnsiClipboardFormat","Reserved1","UnicodeClipboardFormat","Reserved2","CONTINUE_RT","slurp","RecordType","nextrt","XLSRecordEnum","ll","safe_format_xf","make_cell","parse_workbook","rngC","rngR","temp_val","country","Directory","last_formula","cur_sheet","Preamble","last_cell","XFs","palette","biff4w","get_rgb","process_cell_style","xfd","addcell","file_depth","afi","rrtabid","lastuser","winlocked","wtf","last_lbl","last_RT","BIFF2Fmt","BIFF2FmtTable","FilterDatabases","seen_codepage","Date1904","WriteProtect","cpval","CalcRefMode","FullCalc","ExternCount","tmpri","fakebs8","_fr","_fc","_fe","_arraystart","_j","_ixfe","b4idx","b2idx","TxO","ImData","noteobj","Encryption","Metadata","Country","PSCLSID","SI","DSI","UDI","parse_xls_props","DocSummary","Summary","write_xls_props","Keys","DSEntries","SEntries","CEntries","DocSummaryRE","SummaryRE","CEntries2","parse_xlscfb","CompObj","WorkbookP","bookVBA","bookFiles","write_xlscfb","wbpath","write_biff_buf","write_biff_continue","write_BIFF2BERR","write_BIFF2LABEL","write_comments_biff2","write_ws_biff2_cell","_BIFF2FmtTable","write_ws_biff2","write_biff2_buf","_Fonts","b8oid","b8ocnts","write_MsoDrawingGroup","acc","write_comments_biff8","_oasc","notes","baseid","ci","oasc","oact","txo","cont","conf","notesh","write_FONTS_biff8","write_FMTS_biff8","write_FEAT","write_CELLXFS_biff8","write_ws_biff8_hlinks","HL","write_ws_cols_biff8","write_ws_biff8_cell","write_ws_biff8","_WB","_sheet","MAX_ROWS","write_biff8_global","_sheets","_wb","blen","write_biff8_buf","fix_write_opts","html_to_sheet","mtch2","hd","midx","colspan","rowspan","_t","make_html_row","editable","HTML_BEGIN","HTML_END","book_new","make_html_preamble","sheet_to_html","sheet_add_dom","tagName","or_R","or_C","is_dom_element_hidden","elts","hasAttribute","getAttribute","innerHTML","Aelts","getElementsByTagName","Aelti","parse_dom_table","table_to_book","element","get_computed_style","get_get_computed_style_function","getPropertyValue","ownerDocument","defaultView","getComputedStyle","parse_text_p","fixed","parse_ods_styles","_nfm","number_format_map","NFtag","tNF","etpos","parse_content_xml","nfidx","sheetag","rowtag","textptag","ctag","textp","textpidx","oldtextp","oldtextpidx","textR","oldtextR","row_ol","mrange","mR","mC","rowpeat","colpeat","atag","_Ref","creator","creatoridx","isstub","intable","rptR","rpt","annotag","xlmlidx","styletag","nrange","ptp","parse_ods","Styles","write_styles_ods","master_styles","write_number_format_ods","nopts","has_time","np","write_names_ods","scoped","namei","odsref","write_content_ods","write_text_p","null_cell_xml","write_ws","nfs","ods","ROWS","_Fref","text_p","_tgt","acreator","apayload","aprops","write_automatic_styles_ods","colobj","nfi","fods","write_ods","u8_to_dataview","array","DataView","buffer","byteOffset","byteLength","u8str","u8","stru8","u8concat","u8a","popcnt","readDecimal128LE","exp","mantissa","writeDecimal128LE","parse_varint49","ptr","varint","write_varint49","parse_packed_varints","write_packed_varints","nums","varint_to_i32","i32","parse_shallow","write_shallow","proto","item","mappa","parse_iwa_file","_a","messages","merge","write_iwa_file","ias","ia","midata","aipayload","mid","parse_snappy_chunk","chunks","clen","u8i","decompress_iwa_file","compress_iwa_file","frame","numbers_lut_new","rsst","nfmt","fmla","ferr","numbers_format_cell","_b","_c","ver","dur","dstyle","dmin","dmax","autodur","dstr","zstr","parse_old_storage","lut","dv","getUint32","zidx","ieee","doff","getFloat64","rts","parse_new_storage","d128","cmntidx","iwa_to_s5s_comment","write_new_storage","setFloat64","irsst","findIndex","setUint32","s5s_to_iwa_comment","write_old_storage","parse_cell_storage","parse_TSP_Reference","pb","write_TSP_Reference","numbers_add_oref","iwa","orefs","orefidx","numbers_del_oref","parse_TST_TableDataList","le","rtp","rtpref","mtype","tswpsa","richtext","sfields","smartfields","sf","_a2","_b2","objtype","parse_TSD_CommentStorageArchive","parse_TST_TileRowInfo","_e","_g","_h","_i","_k","_m","used_storage_u8","used_storage","wide_offsets","used_storage_offsets","getUint16","parse_TST_Tile","nrows","reduce","csp","as","asp","replies","pi","reply","s5s","parse_TST_TableModelArchive","dws","store","tile","tl","ref2","mtype2","_tile","parse_TST_TableInfoArchive","tableref","parse_TN_SheetArchive","shapeoffs","parse_TN_DocumentArchive","sheetoffs","root2","parse_numbers_iwa","indices","packets","packet","docroot","iwam","write_TST_TileRowInfo","wide","tri","new_7","new_4","last_offset","cell_storage","_dv","_last_offset","_cell_storage","setUint16","celload","_celload","write_iwam","get_unique_msgid","dep","dependents","build_numbers_deps","deps","mess","write_TSP_Color_RGB","Float32Array","get_author_color","random","write_numbers_iwa","numbers","numbers_iwa_find","sheetrefs","numbers_add_ws","write_numbers_ws","numbers_iwa_doit","ainfo","numbers_add_meta","mlist","newid","newloc","numbers_add_msg","numbers_meta_add_dep","parentidx","mm","parent","dep2","numbers_meta_del_dep","sheetref","newsheetref","remap","arch","doc","tiaref","sheetroot","sa","drawables","tia","tmaref","tiaroot","da","dap","oldtmaref","tma","tmaroot","uuid","new_uuid","srrta","hsoa","hsa","hseadata","hsea","oldref","newref","row_headers","tspref","tiles","tst","oldtileref","newtileref","oldtile","wsname","sheetidx","rootref","write_numbers_tma","USE_WIDE_ROWS","tmafile","trunc","R_","LUT","row_header_ref","rowhead","_x","base_bucket","R2","_bucket","col_header_ref","colhead","rbtree","tilestore","tstride","tileref","save_token","mlst","ntiles","newtileid","tiledata","tilerow","newtile","tilecontent","mergeid","sstref","sstroot","sstdata","rsstref","rsstroot","rsstdata","style_indices","tswpsaid","tswpsarefs","newhlinkid","smartfield","rtpaid","cmntref","cmntroot","cmntdata","aaaid2","csaid2","aaaid","csaid","fix_opts_func","get_sheet_type","safe_parse_wbrels","wbrels","parse_sheet_legacy_drawing","dfile","draw","safe_parse_sheet","relsPath","sheetRels","stype","drelsp","chartp","crelsp","tcomments","strip_front_slash","_zip","index_zip","Bun","readSync","binname","dir","link","propdata","bookDeps","wbsheets","wbext","wbrelsi","wbrelsfile","nmode","wsloop","snjseen","snj","Deps","bin","parse_xlsxcfb","dsm","seds","einfo","decrypt_agile","decrypt_std76","write_zip_xlsb","foo","vbafmt","_sn","wsrels","_type","need_vml","needtc","rId1","write_zip_xlsx","read_cfb","read_zip","read_plaintext","main","read_plaintext_raw","read_utf16","bstrify","read_prn","ab","vu","write_cfb_ctr","write_zip_type","write_zip_denouement","write_zip_typeXLSX","oopts","ftype","generate","encrypt_agile","write_cfb_type","write_string_type","bom","write_stxt_type","write_binary_type","writeSyncXLSX","writeSync","sheet_to_txt","sheet_to_csv","resolve_book_type","_BT","writeFileSyncXLSX","writeFileAsync","_cb","Function","make_json_row","defval","isempty","defineProperty","enumerable","__rowNum__","rawNumbers","outi","counter","header_cnt","skipHidden","blankrows","qreg","make_csv_row","txt","datarow","forceQuotes","endregex","strip","sheet_to_formulae","cmds","sheet_add_json","js","skipHeader","ROW","JS","json_to_sheet","RC","wb_sheet_idx","sh","roll","book_set_sheet_visibility","vis","cell_set_number_format","cell_set_hyperlink","cell_set_internal_link","cell_add_comment","sheet_set_array_formula","dynamic","rngstr","wsr","_Readable","table_to_sheet","sheet_to_row_object_array","sheet_get_cell","SHEET_VISIBLE","SHEET_HIDDEN","SHEET_VERY_HIDDEN","set_readable","write_csv_stream","stream","BOM","_read","write_html_stream","write_json_stream","objectMode","__stream","to_json","to_html","to_csv","readFile","writeXLSX","writeFileXLSX","strmod","Readable","window","exclude","excludes","arguments","excludeProps","AssertionError","_props","showDiff","captureStackTrace","constructor","toJSON","used","util","use","fn","config","assertion","core","expect","should","assert","_chai","flag","Assertion","ssfi","lockSsfi","proxify","includeStack","addProperty","addMethod","addChainableMethod","chainingBehavior","overwriteProperty","overwriteMethod","overwriteChainableMethod","expr","negateMsg","expected","_actual","ok","getMessage","actual","getActual","assertionErrorObjectProperties","operator","getOperator","truncateThreshold","useProxy","proxyExcludedKeys","chai","an","article","SameValueZero","includeChainingBehavior","include","objType","flagMsg","negate","isDeep","descriptor","included","isEql","eql","some","firstErr","numErrs","propAssertion","transferFlags","property","err","checkError","compatibleConstructor","inspect","assertExist","checkArguments","assertEqual","prevLockSsfi","_obj","assertEql","assertAbove","errorMessage","doLength","msgPrefix","nType","shouldThrow","to","have","printObj","itemsCount","assertLeast","assertBelow","assertMost","assertInstanceOf","isInstanceOf","TypeError","getName","assertProperty","isNested","isOwn","nameType","hasProperty","pathInfo","getPathInfo","exists","assertOwnProperty","assertOwnPropertyDescriptor","actualDescriptor","getOwnPropertyDescriptor","assertLengthChain","assertLength","assertMatch","assertKeys","keysType","deepStr","mixedArgsMsg","getOwnEnumerableProperties","any","all","expectedKey","actualKey","every","compareByInspect","assertThrows","errorLike","errMsgMatcher","caughtErr","is","everyArgIsUndefined","everyArgIsDefined","Boolean","errorLikeFail","errMsgMatcherFail","errorLikeString","getConstructorName","isCompatibleInstance","compatibleInstance","isCompatibleConstructor","placeholder","isCompatibleMessage","compatibleMessage","respondTo","itself","context","satisfy","matcher","objDisplay","closeTo","deltaMessage","isSubsetOf","subset","superset","cmp","contains","ordered","elem","matchIdx","elem2","oneOf","list","be","possibility","assertChanges","subject","initial","final","msgObj","assertIncreases","assertDecreases","assertDelta","expression","behavior","realDelta","chain","finish","startType","finishType","failMsg","failNegateMsg","isExtensible","isSealed","isFrozen","express","errmsg","isOk","isNotOk","not","equal","act","notEqual","strictEqual","notStrictEqual","deepEqual","deepStrictEqual","notDeepEqual","isAbove","abv","isAtLeast","atlst","least","isBelow","blw","below","isAtMost","atmst","most","isTrue","isNotTrue","isFalse","isNotFalse","isNull","isNotNull","isNotNaN","exist","notExists","isUndefined","isDefined","isFunction","isNotFunction","isObject","isNotObject","isNotArray","isString","isNotString","isNumber","isNotNumber","finite","isBoolean","isNotBoolean","typeOf","notTypeOf","instanceOf","notInstanceOf","inc","notInclude","deepInclude","deep","notDeepInclude","nestedInclude","nested","notNestedInclude","deepNestedInclude","notDeepNestedInclude","ownInclude","own","notOwnInclude","deepOwnInclude","notDeepOwnInclude","notMatch","notProperty","propertyVal","notPropertyVal","deepPropertyVal","notDeepPropertyVal","ownProperty","notOwnProperty","ownPropertyVal","notOwnPropertyVal","deepOwnPropertyVal","notDeepOwnPropertyVal","nestedProperty","notNestedProperty","nestedPropertyVal","notNestedPropertyVal","deepNestedPropertyVal","notDeepNestedPropertyVal","lengthOf","hasAnyKeys","hasAllKeys","containsAllKeys","contain","doesNotHaveAnyKeys","doesNotHaveAllKeys","hasAnyDeepKeys","hasAllDeepKeys","containsAllDeepKeys","doesNotHaveAnyDeepKeys","doesNotHaveAllDeepKeys","throws","assertErr","throw","doesNotThrow","val2","approximately","sameMembers","set1","set2","same","members","notSameMembers","sameDeepMembers","notSameDeepMembers","sameOrderedMembers","notSameOrderedMembers","sameDeepOrderedMembers","notSameDeepOrderedMembers","includeMembers","notIncludeMembers","includeDeepMembers","notIncludeDeepMembers","includeOrderedMembers","notIncludeOrderedMembers","includeDeepOrderedMembers","notIncludeDeepOrderedMembers","inList","changes","change","changesBy","tmpMsg","by","doesNotChange","changesButNotBy","but","increases","increase","increasesBy","doesNotIncrease","increasesButNotBy","decreases","decrease","decreasesBy","doesNotDecrease","doesNotDecreaseBy","decreasesButNotBy","ifError","extensible","isNotExtensible","sealed","isNotSealed","frozen","isNotFrozen","isEmpty","empty","isNotEmpty","alias","loadShould","shouldGetter","Symbol","BigInt","shouldSetter","configurable","writable","val1","errt","errs","Throw","Should","addLengthGuard","canSetPrototype","setPrototypeOf","testFn","excludeNames","getOwnPropertyNames","propDesc","ctx","chainableBehavior","__methods","chainableMethodWrapper","newAssertion","asserterNames","asserterName","pd","fnLengthDesc","assertionName","isChainable","methodWrapper","isProxyEnabled","getter","propertyGetter","types","art","or","__flags","isObjectType","objectType","objectTypes","getOwnEnumerablePropertySymbols","getOwnPropertySymbols","sym","object","getPrototypeOf","pathval","expectTypes","loupe","showHidden","depth","colors","truncate","Proxy","Reflect","kstr","_chainingBehavior","_method","_super","overwritingMethodWrapper","origLockSsfi","_get","overwritingPropertyGetter","getProperties","builtins","stringDistanceCapped","strA","strB","ch","nonChainableMethodName","proxyGetter","suggestion","suggestionDistance","dist","includeAll","getFunctionName","thrown","errMatcher","comparisonString","constructorName","newConstructorName","FakeMap","_key","MemoizeMap","WeakMap","memoizeCompare","leftHandOperand","rightHandOperand","memoizeMap","isPrimitive","leftHandMap","memoizeSet","comparator","extensiveDeepEqual","simpleResult","simpleEqual","memoize","memoizeResultLeft","memoizeResultRight","comparatorResult","leftHandType","extensiveDeepEqualByType","keysEqual","iterableEqual","regexpEqual","generatorEqual","entriesEqual","equals","total","objectEqual","leftHandItems","rightHandItems","getGeneratorEntries","hasIteratorFunction","iterator","getIteratorEntries","iteratorError","generator","generatorResult","accumulator","done","getEnumerableKeys","getEnumerableSymbols","allKeys","leftHandKeys","rightHandKeys","leftHandSymbols","rightHandSymbols","mapSymbols","leftHandEntries","rightHandEntries","functionNameMatch","maxFunctionSourceLength","getFuncName","aFunc","functionSource","global","_typeof","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_arr","minLen","_arrayLikeToArray","arr2","ansiColors","dim","inverse","black","red","green","yellow","blue","magenta","cyan","white","brightblack","brightred","brightgreen","brightyellow","brightblue","brightmagenta","brightcyan","brightwhite","grey","special","number","bigint","boolean","null","string","symbol","regexp","truncator","colorise","styleType","normaliseOptions","_ref","_ref$showHidden","_ref$depth","_ref$colors","_ref$customInspect","customInspect","_ref$showProxy","showProxy","_ref$maxArrayLength","maxArrayLength","_ref$breakLength","breakLength","_ref$seen","_ref$truncate","_ref$stylize","stylize","tail","tailLength","stringLength","inspectList","inspectItem","separator","originalLength","output","peek","truncated","secondToLast","nextLength","truncatedLength","quoteComplexKey","inspectProperty","_ref2","_ref3","inspectArray","nonIndexProperties","listContents","propertyContents","getFuncName_1","getArrayName","toStringTag","inspectTypedArray","inspectDate","dateObject","stringRepresentation","inspectFunction","inspectMapEntry","mapToEntries","inspectMap","inspectNumber","inspectBigInt","inspectRegExp","sourceLength","source","arrayFromSet","values","inspectSet","stringEscapeChars","escapeCharacters","unicodeLength","escape","char","inspectString","inspectSymbol","description","getPromiseValue","_process$binding","binding","getPromiseDetails","kPending","kRejected","Promise","resolve","_getPromiseDetails","_getPromiseDetails2","innerValue","notNode","inspectPromise","inspectObject","properties","symbols","symbolContents","inspectClass","inspectArguments","errorKeys","inspectObject$1","inspectAttribute","inspectHTMLCollection","collection","inspectHTML","getAttributeNames","head","headClose","children","symbolsSupported","for","chaiInspect","nodeInspect","nodeUtil","custom","noNodeInspect","constructorMap","stringTagMap","baseTypesMap","function","Set","WeakSet","Arguments","Int8Array","Uint8ClampedArray","Int16Array","Uint32Array","Float64Array","Generator","HTMLCollection","NodeList","inspectCustom","toString$1","_options","HTMLElement","registerConstructor","inspector","registerStringTag","stringTag","default","parsePath","mArr","parsed","internalGetPathValue","pathDepth","temporaryValue","part","internalSetPathValue","tempObj","propName","propVal","info","getPathValue","setPathValue","promiseExists","globalObject","self","symbolExists","mapExists","setExists","weakMapExists","weakSetExists","dataViewExists","symbolIteratorExists","symbolToStringTagExists","setEntriesExists","mapEntriesExists","setIteratorPrototype","mapIteratorPrototype","arrayIteratorExists","arrayIteratorPrototype","stringIteratorExists","stringIteratorPrototype","toStringLeftSliceLength","toStringRightSliceLength","typeDetect","typeofObj","mimeTypes","plugins","objPrototype","class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_createVNode","_component_wizard","onComplete","$options","wizardComplete","finishButtonText","_withCtx","_hoisted_6","_hoisted_7","slotProps","_component_wizard_tab","beforeChange","validateText","label","_hoisted_8","_hoisted_9","$data","$event","validateAnnotations","afterRender","annotationsTabAfterRender","_hoisted_10","_hoisted_11","_hoisted_12","_component_p_checkbox","rlIsSelected","binary","focused","_hoisted_13","_hoisted_14","nerIsSelected","_hoisted_15","_hoisted_16","oracleIsSelected","_hoisted_17","_hoisted_18","userAnnIsSelected","_hoisted_19","annotatedText","_normalizeStyle","setUnselectableIfUserAnnNotChecked","onMouseup","_cache","handleOnMouseUpEvent","annotationsReceived","_hoisted_21","_component_p_progress_spinner","validateParameters","_hoisted_22","_hoisted_23","_hoisted_24","numberOfQuestions","_hoisted_25","_hoisted_26","numberOfOptions","_hoisted_27","_hoisted_28","_hoisted_29","_component_Table","tableData","isSortable","withCustomBody","isScrollable","setScrollHeight","column","rowData","currentColumnData","_hoisted_30","_hoisted_31","_toDisplayString","questionsReceived","_hoisted_32","nextTab","prevTab","activeTabIndex","tabCount","navigateToTab","uncheckNextTabs","_hoisted_33","onClick","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","doExportJsonAsExcel","resetWizard","_hoisted_38","_normalizeClass","active","role","tabId","_renderSlot","_ctx","$slots","optional","inject","checked","hasError","mounted","addTab","unmounted","$el","parentNode","removeTab","updated","__exports__","wizardId","$props","wizardClasses","plain","onSubmit","_withModifiers","showHeader","title","subTitle","_Fragment","_renderList","tabs","tabindex","linkWidth","_component_tab_item_content","activeTab","movingTabStyles","activeIndex","prevButtonText","nextButtonText","throttle","handlerFunc","timeout","resizeTimeout","randomString","maxChars","possible","startIndex","components","TabItemContent","render","movingTab","provide","tabLinkWidth","tabLinkHeight","onResizeWithThrottle","onResize","computed","translateXValue","translateYValue","transform","methods","slot","validate","tabToValidate","then","catch","isValid","$emit","tabLinks","querySelectorAll","clientWidth","clientHeight","$nextTick","addEventListener","watch","newValue","oldValue","oldTab","newTab","generateRandomAnnotationId","substring","convertQGenAnswerExtendedToAnnotation","answer","convertAnnotationToQGenAnswer","annotation","convertQGenTestsToQuestionsTable","tests","question","correct_answer","option_2","distractors","option_3","option_4","relevant","grammar","coherence","convertQGenTestsToExcelData","nbOptions","exportJsonAsExcel","settings","Wizard","WizardTab","Table","toastService","lastProcessedTextCleansed","annotationService","annotationsRendered","annotations","lastProcessedAnnotations","qgenTests","created","ANNOTATION_SERVICE","qgenService","QGEN_SERVICE","TOAST_SERVICE","init","onUserAddedAnnotation","onUserAnnotationAdded","onUserDeletedAnnotation","onUserAnnotationDeleted","onUserUpdatedAnnotation","onUserAnnotationUpdated","annotationFormatter","annotatedTextParent","getElementsByClassName","secondChild","observer","MutationObserver","mutations","mutation","taggingSection","remove","editableCommentSection","innerEditor","classList","add","dropdownMenu","buttons","button","innerText","cssClass","taggingSectionRestored","observe","childList","showAllAnnotations","generateRandomId","event","localName","validateStep","$refs","cleansedText","clearAnnotationStep","getAnnotations","response","answers","ann","getAnswers","getVisibleAnnotations","checkIfSameAnnotations","ann1","ann2","updatedAnnotation","showAnnotationsByType","addAnnotation","hideAnnotationsByType","deleteAnnotation","visibleAnnotations","typeToCSSClass","getTest","success","clearAnnotations","fileName","extraLength","writeMode","writeOptions","_createBlock","_component_p_datatable","responsiveLayout","scrollable","scrollHeight","stripedRows","_component_p_column","sortable","TableInput","required","libraryName","getWorksheetColumnWidths","getJsonSheetRow","getContentProperty","xlsx_1","accessContentProperties","jsonSheetRow","applyColumnFormat","worksheet","columnIds","columnFormats","columnFormat","getWorksheetColumnIds","columnRange","address","getObjectLength","columnLetters","columnCells","maxWidthCell","maxWidth","cellId","cellContentLength","cellFormatLength","largestWidth","getWorksheet","jsonSheet","jsonSheetRows","contentItem","worksheetColumnIds","worksheetColumnFormats","jsonSheetColumn","writeWorkbook","workbook","jsonSheets","workbookCallback","actualSheet","actualIndex","worksheetName"],"sourceRoot":""}